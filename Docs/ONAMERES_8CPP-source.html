<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ONAMERES.CPP Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>ONAMERES.CPP</h1><a href="ONAMERES_8CPP.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : ONAMERES.CPP</span>
00002 <span class="comment">//Description : NameRes Class Definition</span>
00003 <span class="comment">//Owner                 : Fred</span>
00004 
00005 <span class="preprocessor">#include &lt;All.h&gt;</span>
00006 <span class="preprocessor">#include &lt;<a class="code" href="OVGA_8H.html">OVGA.H</a>&gt;</span>
00007 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00008 <span class="preprocessor">#include &lt;OSTR.h&gt;</span>
00009 <span class="preprocessor">#include &lt;OMISC.h&gt;</span>
00010 <span class="preprocessor">#include &lt;<a class="code" href="OGAMESET_8H.html">OGAMESET.H</a>&gt;</span>
00011 <span class="preprocessor">#include &lt;ONAMERES.h&gt;</span>
00012 
00013 <span class="comment">//----------- Define constants -------------//</span>
00014 
<a name="l00015"></a><a class="code" href="ONAMERES_8CPP.html#a0">00015</a> <span class="preprocessor">#define FIRST_NAME_DB     "N_FIRST"</span>
<a name="l00016"></a><a class="code" href="ONAMERES_8CPP.html#a1">00016</a> <span class="preprocessor"></span><span class="preprocessor">#define MIDDLE_NAME_DB      "N_MID"</span>
<a name="l00017"></a><a class="code" href="ONAMERES_8CPP.html#a2">00017</a> <span class="preprocessor"></span><span class="preprocessor">#define LAST_NAME_DB        "N_LAST"</span>
00018 <span class="preprocessor"></span>
00019 <span class="comment">//----------- Begin of function NameRes Constructor -----//</span>
<a name="l00021"></a><a class="code" href="classNameRes.html#a0">00021</a> <span class="comment">NameRes::NameRes() {</span>
00022     init_flag=0;
00023 }
00024 
00025 <span class="comment">//------------- End of function NameRes Constructor -----//</span>
00026 
00027 <span class="comment">//----------- Begin of function NameRes Destructor ------//</span>
00029 <span class="comment"></span>
<a name="l00030"></a><a class="code" href="classNameRes.html#a1">00030</a> <a class="code" href="classNameRes.html#a1">NameRes::~NameRes</a>() {
00031     <a class="code" href="classNameRes.html#a3">deinit</a>();
00032 }
00033 
00034 <span class="comment">//------------- End of function NameRes Destructor ------//</span>
00035 
00036 <span class="comment">//----------- Begin of function NameRes::init --------//</span>
<a name="l00038"></a><a class="code" href="classNameRes.html#a2">00038</a> <span class="comment">void NameRes::init() {</span>
00039     <span class="keywordflow">if</span>( init_flag )
00040         <span class="keywordflow">return</span>;
00041 
00042     load_first_name();
00043     load_info(<a class="code" href="ONAMERES_8CPP.html#a1">MIDDLE_NAME_DB</a>, &amp;middle_name_array, middle_name_count );
00044     load_info(<a class="code" href="ONAMERES_8CPP.html#a2">LAST_NAME_DB</a>  , &amp;last_name_array  , last_name_count   );
00045 
00046     <span class="comment">//----------------------------------------//</span>
00047 
00048     init_flag=1;
00049 }
00050 
00051 <span class="comment">//------------- End of function NameRes::init --------//</span>
00052 
00053 <span class="comment">//----------- Begin of function NameRes::deinit --------//</span>
<a name="l00055"></a><a class="code" href="classNameRes.html#a3">00055</a> <span class="comment">void NameRes::deinit() {</span>
00056     <span class="keywordflow">if</span>( init_flag ) {
00057         <a class="code" href="ALL_8H.html#a8">mem_del</a>(first_name_array);
00058         <a class="code" href="ALL_8H.html#a8">mem_del</a>(middle_name_array);
00059         <a class="code" href="ALL_8H.html#a8">mem_del</a>(last_name_array);
00060 
00061         init_flag=0;
00062     }
00063 }
00064 
00065 <span class="comment">//------------- End of function NameRes::deinit --------//</span>
00066 
00067 <span class="comment">//----------- Begin of function NameRes::load_first_name -------//</span>
00069 <span class="comment">void NameRes::load_first_name() {</span>
00070     <a class="code" href="structFirstNameRec.html">FirstNameRec</a>  *firstNameRec;
00071     <a class="code" href="structFirstNameInfo.html">FirstNameInfo</a> *firstNameInfo;
00072     <span class="keywordtype">int</span>         i;
00073     <a class="code" href="classDatabase.html">Database</a>    *dbFirstName = game_set.open_db(<a class="code" href="ONAMERES_8CPP.html#a0">FIRST_NAME_DB</a>);
00074 
00075     first_name_count = (short) dbFirstName-&gt;<a class="code" href="classDatabase.html#a7">rec_count</a>();
00076     first_name_array = (<a class="code" href="structFirstNameInfo.html">FirstNameInfo</a>*) <a class="code" href="ALL_8H.html#a5">mem_add</a>( <span class="keyword">sizeof</span>(<a class="code" href="structFirstNameInfo.html">FirstNameInfo</a>)*first_name_count );
00077 
00078     <span class="comment">//------ read in firstName bitmap info array -------//</span>
00079 
00080     memset( first_name_array, 0, <span class="keyword">sizeof</span>(<a class="code" href="structFirstNameInfo.html">FirstNameInfo</a>) * first_name_count );
00081 
00082     <span class="keywordflow">for</span>( i=0 ; i&lt;first_name_count ; i++ ) {
00083         firstNameRec  = (<a class="code" href="structFirstNameRec.html">FirstNameRec</a>*) dbFirstName-&gt;<a class="code" href="classDatabase.html#a4">read</a>(i+1);
00084         firstNameInfo = first_name_array+i;
00085 
00086         m.rtrim_fld( firstNameInfo-&gt;<a class="code" href="structFirstNameInfo.html#m0">name</a>, firstNameRec-&gt;<a class="code" href="structFirstNameRec.html#m0">name</a>, firstNameRec-&gt;<a class="code" href="structFirstNameRec.html#s1s0">NAME_LEN</a> );
00087 
00088         <span class="keywordflow">if</span>( firstNameRec-&gt;<a class="code" href="structFirstNameRec.html#m1">gender</a>==<span class="charliteral">'F'</span> )
00089             firstNameInfo-&gt;<a class="code" href="structFirstNameInfo.html#m1">gender</a> = <span class="charliteral">'F'</span>;
00090         <span class="keywordflow">else</span>
00091             firstNameInfo-&gt;<a class="code" href="structFirstNameInfo.html#m1">gender</a> = <span class="charliteral">'M'</span>;
00092     }
00093 }
00094 
00095 <span class="comment">//----------- End of function NameRes::load_first_name -------//</span>
00096 
00097 <span class="comment">//----------- Begin of function NameRes::load_info -------//</span>
00099 <span class="comment">void NameRes::load_info(char* dbFileName, NameInfo** nameArrayPtr, short&amp; nameCount) {</span>
00100     <a class="code" href="structNameRec.html">NameRec</a>  *nameRec;
00101     <a class="code" href="structNameInfo.html">NameInfo</a> *nameInfo;
00102     <a class="code" href="classDatabase.html">Database</a> *dbName = game_set.open_db(dbFileName);
00103 
00104     nameCount     = (short) dbName-&gt;<a class="code" href="classDatabase.html#a7">rec_count</a>();
00105     *nameArrayPtr = (<a class="code" href="structNameInfo.html">NameInfo</a>*) <a class="code" href="ALL_8H.html#a5">mem_add</a>( <span class="keyword">sizeof</span>(<a class="code" href="structNameInfo.html">NameInfo</a>)*nameCount );
00106 
00107     <span class="comment">//------ read in name bitmap info array -------//</span>
00108 
00109     memset( *nameArrayPtr, 0, <span class="keyword">sizeof</span>(<a class="code" href="structNameInfo.html">NameInfo</a>) * nameCount );
00110 
00111     <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0 ; i&lt;nameCount ; i++ ) {
00112         nameRec  = (<a class="code" href="structNameRec.html">NameRec</a>*) dbName-&gt;<a class="code" href="classDatabase.html#a4">read</a>(i+1);
00113         nameInfo = *nameArrayPtr + i;
00114 
00115         m.rtrim_fld( nameInfo-&gt;<a class="code" href="structNameInfo.html#m0">name</a>, nameRec-&gt;<a class="code" href="structNameRec.html#m0">name</a>, nameRec-&gt;<a class="code" href="structNameRec.html#s1s0">NAME_LEN</a> );
00116     }
00117 }
00118 
00119 <span class="comment">//----------- End of function NameRes::load_info -------//</span>
00120 
00121 <span class="comment">//----------- Begin of function NameRes::get_name_str -------//</span>
<a name="l00123"></a><a class="code" href="classNameRes.html#a4">00123</a> <span class="comment">char* NameRes::get_name_str(int firstNameId, int middleNameId, int lastNameId) {</span>
00124     <span class="keyword">static</span> <a class="code" href="classString.html">String</a> str;
00125 
00126     str  = first_name_array[firstNameId-1].name;
00127     <span class="comment">//str += " ";</span>
00128     <span class="comment">//str += middle_name_array[middleNameId-1].name;</span>
00129     str += <span class="stringliteral">" "</span>;
00130     str += last_name_array[lastNameId-1].name;
00131 
00132     <span class="keywordflow">return</span> str;
00133 }
00134 
00135 <span class="comment">//----------- End of function NameRes::get_name_str -------//</span>
00136 
00137 <span class="comment">//----------- Begin of function NameRes::is_male -------//</span>
<a name="l00139"></a><a class="code" href="classNameRes.html#a5">00139</a> <span class="comment">bool NameRes::is_male(int firstNameId) {</span>
00140     <span class="keywordflow">return</span> first_name_array[firstNameId-1].gender == <span class="charliteral">'M'</span>;
00141 }
00142 
00143 <span class="comment">//----------- End of function NameRes::is_male -------//</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:38:08 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
