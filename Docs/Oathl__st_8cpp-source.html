<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Oathl_st.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Oathl_st.cpp</h1><a href="Oathl__st_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : OAthl_st.cpp</span>
00002 <span class="comment">//Description : Athletics Class Definition related to Simulation and Statistics/History</span>
00003 <span class="comment">//Owner       : Fred</span>
00004 
00005 <span class="comment">// ES library header file</span>
00006 <span class="preprocessor">#include &lt;OMATH.H&gt;</span>
00007 
00008 <span class="comment">// CU header file</span>
00009 <span class="preprocessor">#include &lt;OINFO.h&gt;</span>
00010 <span class="preprocessor">#include &lt;ONEWS.h&gt;</span>
00011 <span class="preprocessor">#include &lt;OCHANCE.H&gt;</span>
00012 <span class="preprocessor">#include &lt;OPSCHOOL.h&gt;</span>
00013 <span class="preprocessor">#include &lt;OFinance.h&gt;</span>
00014 <span class="preprocessor">#include &lt;OEnroll.H&gt;</span>
00015 <span class="preprocessor">#include &lt;OSCHLRES.h&gt;</span>
00016 <span class="preprocessor">#include &lt;OPEERSCH.h&gt;</span>
00017 <span class="preprocessor">#include "OAthleti.h"</span>
00018 
00019 <span class="comment">//----------- Define constants -------------//</span>
00020 <span class="comment">//int Athletics::football_game_count[NCAA_LEVEL_COUNT] = { 10, 11, 12 };</span>
00021 <span class="comment">//int Athletics::basketball_game_count[NCAA_LEVEL_COUNT] = { 25, 30, 35 };</span>
00022 
00023 <span class="comment">//----------- Define static variables -------------//</span>
00024 <span class="keyword">static</span> <span class="keywordtype">int</span> base_cost_array[<a class="code" href="Oathleti_8h.html#a5a1">NCAA_LEVEL_COUNT</a>] = { 700, 1800, 3000 };
00025 <span class="keyword">static</span> <span class="keywordtype">int</span> base_revenue_array[<a class="code" href="Oathleti_8h.html#a5a1">NCAA_LEVEL_COUNT</a>] = { 125, 650, 2500};
00026 
00027 <span class="comment">//----------- Define static functions -------------//</span>
00028 <span class="comment">//----------- Define static class member variables -------------//</span>
00029 
00030 <span class="comment">//----------- Begin of function Athletics::init_data  -----//</span>
<a name="l00032"></a><a class="code" href="classAthletics.html#a9">00032</a> <span class="comment">void Athletics::init_data_pre_finance() {</span>
00033     <span class="comment">//0304 subce memset(athletic_office,... in battle.cpp</span>
00034 
00035     <span class="keywordtype">int</span> dum1[] = { 10, 11, 12 };
00036     <span class="keywordtype">int</span> dum2[] = { 25, 30, 35 };
00037 
00038     memcpy(football_game_count, dum1, <span class="keyword">sizeof</span>(dum1));
00039     memcpy(basketball_game_count, dum2, <span class="keyword">sizeof</span>(dum2));
00040 
00041     <span class="comment">//---------------------//</span>
00042     <span class="comment">// refer to email: Re: Q24. misc.</span>
00043 
00044     <span class="comment">/*</span>
00045 <span class="comment">      &gt;&gt;&gt; During game initialization:</span>
00046 <span class="comment"></span>
00047 <span class="comment">      * Parse total athletics cost as follows:</span>
00048 <span class="comment"></span>
00049 <span class="comment">      InterCollCost[0]  = Athletics:D [initLevel]</span>
00050 <span class="comment"></span>
00051 <span class="comment">      FrInterCollCost   = InterCollCost[0]/TotAthCost[0]</span>
00052 <span class="comment"></span>
00053 <span class="comment">      TotAthCost[0]     = HE.Initialization:Initial_Conditions:(cols AP + AQ)</span>
00054 <span class="comment">    */</span>
00055 
00056     <a class="code" href="ALL_8H.html#a0">err_when</a>(<a class="code" href="Oathleti_8h.html#a5a1">NCAA_LEVEL_COUNT</a> != <a class="code" href="Gamedef_8h.html#a73a25">INPUT_OPTION_COUNT</a>);
00057 
00058     <a class="code" href="classPeerSchool.html">PeerSchool</a> *player = school_res.player_peer_school;
00059 
00060     <span class="keywordtype">int</span> interCollCost = base_cost_array[ncaa_level_input];
00061     <span class="keywordtype">int</span> totalCost = player-&gt;<a class="code" href="classSchool.html#m65">athletics_salaries</a> + player-&gt;<a class="code" href="classSchool.html#m66">athletics_other_expense</a>;
00062 
00063     fraction_intercollege_cost = char(interCollCost * 100 / totalCost);
00064 }
00065 
00066 <span class="comment">//----------- End of function Athletics::init_data_pre_finance -----//</span>
00067 
00068 <span class="comment">//----------- Begin of function Athletics::init_data -----//</span>
<a name="l00070"></a><a class="code" href="classAthletics.html#a10">00070</a> <span class="comment">void Athletics::init_data() {</span>
00071     <span class="comment">//assume called: memset(this, 0, sizeof(Athletics));</span>
00072 
00073     init_expense = (int) finance.expense_array[<a class="code" href="Ofinance_8h.html#a104a50">AC_ATHLETICS</a>].total;
00074 
00075     <span class="comment">//assume after enroll.init_data() called</span>
00076     init_top_male_matrics = enroll_res.male_matrics_top_athletes;
00077     init_top_female_matrics = enroll_res.matrics_top_athletes - enroll_res.male_matrics_top_athletes;
00078 
00079     <span class="keywordflow">if</span> ( !init_top_male_matrics )
00080         init_top_male_matrics = 10;
00081     <span class="keywordflow">if</span> ( !init_top_female_matrics )
00082         init_top_female_matrics = 7;
00083 
00084     init_ability_male_matrics = 50;
00085     init_ability_female_matrics = 50;
00086 
00087     total_cost_norm = (int) finance.expense_array[<a class="code" href="Ofinance_8h.html#a104a50">AC_ATHLETICS</a>].total;
00088 
00089     calc_probability_win();
00090 
00091     init_win_prob = (football_probability_win + basketball_probability_win ) / 2;
00092 
00093     <a class="code" href="ALL_8H.html#a0">err_when</a>(init_expense &lt;=0 || init_top_male_matrics&lt;=0 || init_top_female_matrics&lt;=0
00094              || init_win_prob&lt;=0
00095              || init_ability_female_matrics&lt;=0 || init_ability_male_matrics&lt;=0);
00096 
00097     <span class="comment">//---------------------//</span>
00098     <span class="comment">// assume called after finance</span>
00099     update_history(UPDATE_ALL);
00100 }
00101 
00102 <span class="comment">//------------- End of function Athletics::init_data -----//</span>
00103 
00104 <span class="comment">//----------- Begin of function Athletics::next_day ------//</span>
<a name="l00106"></a><a class="code" href="classAthletics.html#a11">00106</a> <span class="comment">void Athletics::next_day() {</span>
00107     <span class="keyword">static</span> <span class="keywordtype">short</span> trimesterDays = 0;
00108 
00109     <span class="keywordtype">bool</span> isFootballGame;
00110     <span class="keywordtype">short</span> trimesterTotalDays = player_school.trimester_array[player_school.cur_trimester].total_days;
00111     <span class="keywordtype">short</span> tmp = -1;
00112 
00113     <span class="comment">//------ after initalization, reset the variables ----//</span>
00114 
00115     <span class="keywordflow">if</span>( info.prerun_year==0 &amp;&amp; info.game_year==1 &amp;&amp; info.game_month==9 &amp;&amp; info.game_day==2 ) {
00116         avg_percent_win = 0;
00117         football_percent_win = 0;
00118         basketball_percent_win = 0;
00119         total_game = 0;
00120         total_football_game = 0;
00121         total_basketball_game = 0;
00122     }
00123 
00124     <span class="comment">//---------------------------------------------//</span>
00125 
00126     <span class="comment">// Fall: update football men</span>
00127     <span class="keywordflow">if</span> ( player_school.cur_trimester == <a class="code" href="Gamedef_8h.html#a79a36">AUTUMN</a> ) {
00128         isFootballGame = <span class="keyword">true</span>;
00129 
00130         <span class="keywordflow">if</span> ( info.is_begin_trimester() ) {
00131             trimesterDays = 0;
00132 
00133             <span class="comment">// assume optimization is called first</span>
00134             <span class="comment">//update_history(UPDATE_YEAR);</span>
00135         }
00136 
00137         tmp = trimesterTotalDays / football_game_count[ncaa_level_input];
00138     }
00139 
00140     <span class="comment">// Spring: update women basketball</span>
00141     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( player_school.cur_trimester == <a class="code" href="Gamedef_8h.html#a79a37">WINTER</a> ) {
00142         isFootballGame = <span class="keyword">false</span>;
00143         <span class="keywordflow">if</span> ( info.game_day == player_school.trimester_array[player_school.cur_trimester].start_day
00144              &amp;&amp; info.game_month == player_school.trimester_array[player_school.cur_trimester].start_month )
00145             trimesterDays = 0;
00146 
00147         tmp = trimesterTotalDays / basketball_game_count[ncaa_level_input];
00148     }
00149     <span class="keywordflow">else</span>
00150         tmp = -1;
00151 
00152     trimesterDays++;
00153     <span class="keywordflow">if</span> ( tmp &gt; 0 &amp;&amp; trimesterDays % tmp == 0 ) {    <span class="comment">// it's time to play</span>
00154         update_win_lost(isFootballGame);
00155     }
00156 
00157     <span class="comment">// start of a month</span>
00158     <span class="keywordflow">if</span> ( info.game_day == 1 ) {
00159         <span class="comment">// start of a year</span>
00160         <span class="keywordflow">if</span> ( info.game_month == finance.fiscal_year_start_month ) {
00161             last_ncaa_level_input = ncaa_level_input;   <span class="comment">// post last_ncaa_level_input</span>
00162             update_history(UPDATE_YEAR);
00163         }
00164 
00165         update_history(UPDATE_MONTH);
00166     }
00167 }
00168 
00169 <span class="comment">//------------- End of function Athletics::next_day ------//</span>
00170 
00171 <span class="comment">//----------- Begin of function Athletics::update_win_lost --------//</span>
00173 <span class="comment">void Athletics::update_win_lost(bool isFootballGame) {</span>
00174     <span class="keywordtype">bool</span> win;
00175     <span class="keywordtype">char</span> graphIndex;
00176     <span class="keywordtype">char</span> incr;
00177 
00178     <span class="keywordflow">if</span> ( isFootballGame ) {
00179         <span class="keywordflow">if</span>( total_football_game &gt;= football_game_count[ncaa_level_input] * info.year_passed )
00180             <span class="keywordflow">return</span>;
00181 
00182         total_game++;
00183         total_football_game++;
00184 
00185         win = (math.get_random_float() &lt; football_probability_win) ? <span class="keyword">true</span> : <span class="keyword">false</span>;
00186         graphIndex = (win) ? HISTORY_YEAR_COUNT-1 : HISTORY_YEAR_COUNT2-1;
00187         incr = (win) ? 1: 0;
00188 
00189         avg_percent_win = ((total_game-1) * avg_percent_win +incr) / total_game;
00190         football_percent_win = ((total_football_game-1) * football_percent_win +incr) / total_football_game;
00191 
00192         football_graph[graphIndex]++;
00193 
00194         <span class="keywordflow">if</span>(info.prerun_year == 0 &amp;&amp;
00195            <span class="comment">// only in December or January</span>
00196            (info.game_month == 12 || info.game_month == 1) ) {
00197             <span class="keywordflow">if</span> ( win || chance_event.test_chance==<a class="code" href="Onews_8h.html#a51a38">NEWS_FOOTBALL_GAME</a> )
00198                 <span class="comment">// 990427</span>
00199                 news_array.football_game( football_graph[HISTORY_YEAR_COUNT-1] );
00200         }
00201     }
00202     <span class="keywordflow">else</span> {
00203         <span class="keywordflow">if</span>( total_basketball_game &gt;= basketball_game_count[ncaa_level_input]  * info.year_passed )
00204             <span class="keywordflow">return</span>;
00205 
00206         total_game++;
00207         total_basketball_game++;
00208 
00209         win = (math.get_random_float() &lt; basketball_probability_win) ? <span class="keyword">true</span> : <span class="keyword">false</span>;
00210         graphIndex = (win) ? HISTORY_YEAR_COUNT-1 : HISTORY_YEAR_COUNT2-1;
00211         incr = (win) ? 1: 0;
00212 
00213         avg_percent_win = ((total_game-1) * avg_percent_win + incr) / total_game;
00214         basketball_percent_win = ((total_basketball_game-1) * basketball_percent_win +incr) / total_basketball_game;
00215 
00216         basketball_graph[graphIndex]++;
00217 
00218         <span class="comment">// only in March</span>
00219         <span class="keywordflow">if</span>( info.prerun_year==0 &amp;&amp; info.game_month==3 ) {
00220             <span class="keywordflow">if</span> ( win || chance_event.test_chance==<a class="code" href="Onews_8h.html#a51a39">NEWS_BASKETBALL_GAME</a> )
00221                 <span class="comment">// 990505</span>
00222                 news_array.basketball_game( basketball_graph[HISTORY_YEAR_COUNT-1] );
00223         }
00224     }
00225 }
00226 
00227 <span class="comment">//------------- End of function Athletics::update_win_lost --------//</span>
00228 
00229 <span class="comment">//----------- Begin of function Athletics::update_history_sub --------//</span>
00231 <span class="comment">void Athletics::update_history_sub() {</span>
00232     history_value[<a class="code" href="Gamedef_8h.html#a82a55">FIRST_H_THIS_YEAR</a>-1] = (float) finance.revenue_array[<a class="code" href="Ofinance_8h.html#a101a38">AC_INTERCOLLEGIATE_ATHLETICS</a>].total;
00233     history_value[<a class="code" href="Gamedef_8h.html#a82a56">SECOND_H_THIS_YEAR</a>-1] = (float) finance.expense_array[<a class="code" href="Ofinance_8h.html#a104a50">AC_ATHLETICS</a>].total;
00234 
00235     history_value[<a class="code" href="Gamedef_8h.html#a82a55">FIRST_H_THIS_YEAR</a>] = (float) finance.projected_revenue_array[<a class="code" href="Ofinance_8h.html#a101a38">AC_INTERCOLLEGIATE_ATHLETICS</a>].this_year.total;
00236     history_value[<a class="code" href="Gamedef_8h.html#a82a56">SECOND_H_THIS_YEAR</a>] = (float) finance.projected_expense_array[<a class="code" href="Ofinance_8h.html#a104a50">AC_ATHLETICS</a>].this_year.total;
00237 
00238     history_value[<a class="code" href="Gamedef_8h.html#a82a55">FIRST_H_THIS_YEAR</a>+1] = (float) finance.projected_revenue_array[<a class="code" href="Ofinance_8h.html#a101a38">AC_INTERCOLLEGIATE_ATHLETICS</a>].next_year.total;
00239     history_value[<a class="code" href="Gamedef_8h.html#a82a56">SECOND_H_THIS_YEAR</a>+1] = (float) finance.projected_expense_array[<a class="code" href="Ofinance_8h.html#a104a50">AC_ATHLETICS</a>].next_year.total;
00240 }
00241 
00242 <span class="comment">//------------- End of function Athletics::update_history_sub --------//</span>
00243 
00244 <span class="comment">//----------- Begin of function Athletics::update_history ------//</span>
00249 <span class="comment">void Athletics::update_history(char update_flag) {</span>
00250     <span class="keywordtype">float</span> input;
00251     <span class="keywordtype">int</span> h;
00252 
00253     <span class="keywordflow">switch</span> (update_flag) {
00254     <span class="keywordflow">case</span> UPDATE_MONTH:
00255         input = (avg_percent_win) / init_win_prob;
00256 
00257         input = math.dual_response_func(0.300f,1.980f,3,1.279f,2.345f,1.087f,3.243f, input);
00258 
00259         <span class="comment">//              revenue_multiplier = math.latency_func(0.89f, revenue_multiplier, input);</span>
00260         <span class="comment">//## chea 300899 change latency_func(HE.RespF_Defs.Rev 230899 E-mail)</span>
00261         revenue_multiplier = player_school.latency_func(0.85f, revenue_multiplier, input);
00262 
00263         <span class="comment">//askbill: eq. below and why monthly</span>
00264         <span class="comment">/*</span>
00265 <span class="comment">          BaseAthleticsRev =</span>
00266 <span class="comment">          BaseAthleticsRev*(1+finance.inflation_rate / 100.0f);</span>
00267 <span class="comment"></span>
00268 <span class="comment">          AthleticsRev[t] =     multiplier*BaseAthleticsRev;</span>
00269 <span class="comment">        */</span>
00270         update_history_sub();                       <span class="comment">// this line shouldn't be called by init_data()!!??</span>
00271         <span class="keywordflow">break</span>;
00272 
00273     <span class="keywordflow">case</span> UPDATE_YEAR:
00274         calc_probability_win();
00275 
00276         <span class="comment">// part 1       // shift_win_lost_graph</span>
00277 
00278         <span class="keywordflow">for</span> ( h=0; h&lt;HISTORY_YEAR_COUNT2-1; h++) {
00279             football_graph[h] = football_graph[h+1];
00280             basketball_graph[h] = basketball_graph[h+1];
00281         }
00282         basketball_graph[h] = football_graph[h] = 0;
00283 
00284         h = HISTORY_YEAR_COUNT-1;
00285         basketball_graph[h] = football_graph[h] = 0;
00286 
00287         <span class="comment">// part 2</span>
00288 
00289         <span class="comment">// 1 of 2: shift history to "left"</span>
00290         <span class="comment">//</span>
00291 
00292         <a class="code" href="Gamedef_8h.html#a14">shift_history</a>(history_value, HISTORY_YEAR_COUNT2);
00293 
00294         <span class="comment">// 2 of 2: update current year values</span>
00295         update_history_sub();
00296         <span class="keywordflow">break</span>;
00297 
00298     <span class="keywordflow">case</span> UPDATE_ALL:
00299         update_history(UPDATE_YEAR);
00300         update_history(UPDATE_MONTH);
00301 
00302         avg_percent_win = 0;
00303         football_percent_win = 0;
00304         basketball_percent_win = 0;
00305         total_game = 0;
00306         total_football_game = 0;
00307         total_basketball_game = 0;
00308         <span class="keywordflow">break</span>;
00309 
00310     <span class="keywordflow">default</span>:
00311         <a class="code" href="ALL_8H.html#a1">err_here</a>();
00312         <span class="keywordflow">break</span>;
00313     }
00314 }
00315 
00316 <span class="comment">//------------- End of function Athletics::update_history ------//</span>
00317 
00318 <span class="comment">//---------- Begin of function Athletics::calc_probability_win -----------//</span>
00320 <span class="comment">void Athletics::calc_probability_win() {</span>
00321 <span class="preprocessor">#define VAR_COUNT 3</span>
00322 <span class="preprocessor"></span>    <span class="keywordtype">int</span> i;
00323     <span class="keywordtype">float</span> input[VAR_COUNT];
00324     memset(input, 0, <span class="keyword">sizeof</span>(input));
00325 
00326     <span class="comment">// For male</span>
00327 
00328     <span class="comment">//--------------//</span>
00329     <span class="comment">// 1103 athletic expenditures/normal athletic expenditures for chosen level of competition</span>
00330 
00331     input[0] = (float) finance.projected_expense_array[<a class="code" href="Ofinance_8h.html#a104a50">AC_ATHLETICS</a>].this_year.total / total_cost_norm;
00332 
00333     <span class="comment">//----//</span>
00334     input[0] *= (float) finance.cost_rise_policy_array[<a class="code" href="Ofinance_8h.html#a112a81">PL_ATHLETICS</a>].penalty_multiplier2;
00335 
00336     <span class="comment">//--------------//</span>
00337     input[1] = float(enroll_res.male_matrics_top_athletes) / init_top_male_matrics;
00338 
00339     <span class="comment">//--------------//</span>
00340     input[2] = float(enroll_res.avg_athletic_talent_male_matrics) / init_ability_male_matrics;
00341 
00342     <span class="comment">//--------------//</span>
00343     input[0] = math.dual_response_func(0.200f,0.380f,0.800f,0.218f,1.441f,0.588f,1.266f, input[0]);
00344     input[1] = math.dual_response_func(0.200f,0.356f,0.800f,0.263f,1.528f,0.236f,1.219f, input[1]);
00345     input[2] = math.dual_response_func(0.200f,0.395f,0.800f,0.291f,1.773f,0.380f,1.367f, input[2]);
00346 
00347     <span class="keywordtype">float</span> weight[VAR_COUNT] = {0.50f, 0.25f, 0.25f, };
00348 
00349     <span class="keywordtype">float</span> newValue = 0;
00350     <span class="keywordflow">for</span>(i=0; i&lt;VAR_COUNT; i++)
00351         newValue += weight[i] * input[i];
00352 
00353     <span class="keywordflow">if</span>( ncaa_level_input==<a class="code" href="Oathleti_8h.html#a6a4">ATHLETICS_DIVISION_1</a> )
00354         newValue *= 0.666f;
00355     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ncaa_level_input==<a class="code" href="Oathleti_8h.html#a6a2">ATHLETICS_DIVISION_3</a> )
00356         newValue += (1-newValue) * 0.333f;
00357 
00358     <span class="comment">//  football_probability_win = math.latency_func( 0.33f, football_probability_win, newValue);</span>
00359     <span class="comment">//## chea 300899 change latency_func(HE.RespF_Defs.Rev 230899 E-mail)</span>
00360     football_probability_win = player_school.latency_func( 0.40f, football_probability_win, newValue);
00361 
00362     <span class="comment">//--------------//</span>
00363     <span class="comment">// For female</span>
00364     <span class="comment">//--------------//</span>
00365 
00366     input[0] = (float) finance.projected_expense_array[<a class="code" href="Ofinance_8h.html#a104a50">AC_ATHLETICS</a>].this_year.total / total_cost_norm;
00367 
00368     <span class="comment">//----//</span>
00369     input[0] *= (float) finance.cost_rise_policy_array[<a class="code" href="Ofinance_8h.html#a112a81">PL_ATHLETICS</a>].penalty_multiplier2;
00370 
00371     <span class="comment">//--------------//</span>
00372     input[1] = float(enroll_res.matrics_top_athletes - enroll_res.male_matrics_top_athletes )/ init_top_female_matrics;
00373 
00374     <span class="comment">//--------------//</span>
00375     input[2] = float(enroll_res.avg_athletic_talent_female_matrics) / init_ability_female_matrics;
00376 
00377     <span class="comment">//--------------//</span>
00378     input[0] = math.dual_response_func(0.200f,0.500f,0.800f,0.401f,0.401f,0.701f,1.299f, input[0]);
00379     input[1] = math.dual_response_func(0.200f,0.621f,0.800f,0.768f,0.883f,0.833f,1.665f, input[1]);
00380     input[2] = math.dual_response_func(0.200f,0.588f,0.800f,0.779f,0.839f,0.787f,1.755f, input[2]);
00381 
00382     newValue = 0;
00383     <span class="keywordflow">for</span>(i=0; i&lt;VAR_COUNT; i++)
00384         newValue += weight[i] * input[i];
00385 
00386     <span class="keywordflow">if</span>( ncaa_level_input==<a class="code" href="Oathleti_8h.html#a6a4">ATHLETICS_DIVISION_1</a> )
00387         newValue *= 0.666f;
00388     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ncaa_level_input==<a class="code" href="Oathleti_8h.html#a6a2">ATHLETICS_DIVISION_3</a> )
00389         newValue += (1-newValue) * 0.333f;
00390 
00391     <span class="comment">//  basketball_probability_win = math.latency_func( 0.33f, basketball_probability_win, newValue);</span>
00392     <span class="comment">//## chea 300899 change latency_func(HE.RespF_Defs.Rev 230899 E-mail)</span>
00393     basketball_probability_win = player_school.latency_func( 0.35f, basketball_probability_win, newValue);
00394 
00395 }
00396 
00397 <span class="comment">//---------- End of function Athletics::calc_probability_win -----------//</span>
00398 
00399 <span class="comment">//---------- Begin of function Athletics::input_2_ncaa_level -----------//</span>
<a name="l00403"></a><a class="code" href="classAthletics.html#a12">00403</a> <span class="comment">void Athletics::input_2_ncaa_level(int newNcaaLevel) {</span>
00404     <span class="comment">//990528 calc_adjusted_revenue_expense(int &amp;revenue, int &amp;expense);</span>
00405 
00406     <span class="comment">//--------------//</span>
00407 
00408     <span class="comment">//  float remap[] = {4.5f, 3, 1.5f};        // High:   value = 1.5; Medium: value = 3; Low:    value = 4.5</span>
00409     <span class="keywordtype">float</span> remap[] = {3,3,3};
00410 
00411     ncaa_level_input = newNcaaLevel;                <span class="comment">// set the current one to new one</span>
00412 
00413     ncaa_level_value = remap[ncaa_level_input];     <span class="comment">// get the new level value</span>
00414 
00415     <a class="code" href="ALL_8H.html#a0">err_when</a>(<a class="code" href="Gamedef_8h.html#a73a22">INPUT_LOW</a> != 0 || ncaa_level_input &gt; 2);
00416 }
00417 
00418 <span class="comment">//---------- End of function Athletics::input_2_ncaa_level -----------//</span>
00419 
00420 <span class="comment">//---------- Begin of function Athletics::calc_adjusted_revenue_expense -----------//</span>
<a name="l00424"></a><a class="code" href="classAthletics.html#a13">00424</a> <span class="comment">void Athletics::calc_adjusted_revenue_expense(int &amp;revenue, int &amp;expense) {</span>
00425     <span class="comment">/*</span>
00426 <span class="comment">      req24.txt:</span>
00427 <span class="comment"></span>
00428 <span class="comment">      &gt;&gt;&gt; At the time of a competition level change (in year t):</span>
00429 <span class="comment"></span>
00430 <span class="comment">      * ChangeRatioInterCollCost = Athletics:D [newLevel]/Athletics:D[oldLevel]</span>
00431 <span class="comment">      ChangeRatioAthRevenue    = Athletics:G [newLevel]/Athletics:G[oldLevel]</span>
00432 <span class="comment"></span>
00433 <span class="comment">      * ExpenditureNormalizationRatio = Athletics:D [newLevel]/TotAthCost[t]</span>
00434 <span class="comment"></span>
00435 <span class="comment">      * TotalAthCost[t#] = FrInterCollCost * TotAthCost[t] *</span>
00436 <span class="comment">      ChangeRatioInterCollCost +  (1-FrInterCollCost)*TotAthCost[t]);</span>
00437 <span class="comment">      then set the "other" cost to 60% of</span>
00438 <span class="comment">      total cost and salary cost to the remainder</span>
00439 <span class="comment"></span>
00440 <span class="comment">      AthRevenue[t#]   = AthRevenue[t] * ChangeRatioAthRevenue</span>
00441 <span class="comment"></span>
00442 <span class="comment">      # Substitute the new values for the old ones just before the resource allocation</span>
00443 <span class="comment">      for year t+1: the don't appear in the year-t financial but they represent the</span>
00444 <span class="comment">      starting values for the resource allocation.</span>
00445 <span class="comment"></span>
00446 <span class="comment">      * AthCostNorm[t+1] = Athletics:G [newLevel] * ExpenditureNormalizationRatio</span>
00447 <span class="comment"></span>
00448 <span class="comment">      (Used to calculat win probabilities starting in year t+1.)</span>
00449 <span class="comment"></span>
00450 <span class="comment">    */</span>
00451     <span class="keywordtype">float</span> changeRatioInterCollCost = float(base_cost_array[ncaa_level_input]) / base_cost_array[last_ncaa_level_input];
00452     <span class="keywordtype">float</span> changeRatioAthRevenue = float(base_revenue_array[ncaa_level_input]) / base_revenue_array[last_ncaa_level_input];
00453 
00454     <span class="comment">//---------------//</span>
00455     expense = (int) finance.expense_array[<a class="code" href="Ofinance_8h.html#a104a50">AC_ATHLETICS</a>].total;
00456     <span class="keywordtype">float</span> expenditureNormalizationRatio = float(base_cost_array[ncaa_level_input]) / expense;
00457 
00458     expense = int( fraction_intercollege_cost * expense * changeRatioInterCollCost / 100.0f
00459                    + (1.0f-fraction_intercollege_cost/100) * expense );
00460 
00461     revenue = (int) finance.revenue_array[<a class="code" href="Ofinance_8h.html#a101a38">AC_INTERCOLLEGIATE_ATHLETICS</a>].total;
00462     revenue = int(revenue * changeRatioAthRevenue);
00463 
00464     <span class="comment">//---------------//</span>
00465     total_cost_norm = int(base_revenue_array[ncaa_level_input] * expenditureNormalizationRatio);
00466 
00467     <a class="code" href="ALL_8H.html#a0">err_when</a>(total_cost_norm&lt;=0);
00468 }
00469 
00470 <span class="comment">//---------- End of function Athletics::calc_adjusted_revenue_expense -----------//</span>
00471 
00472 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00473 <span class="preprocessor"></span><span class="comment">//---------- Begin of function Athletics::save_initial_data -----------//</span>
00475 <span class="comment">void Athletics::save_initial_data() {</span>
00476     <span class="comment">// use result of pre-run year</span>
00477     initial_football_graph[0] = football_graph[HISTORY_YEAR_COUNT-2];
00478     initial_football_graph[1] = football_graph[1*HISTORY_YEAR_COUNT+HISTORY_YEAR_COUNT-2];
00479     initial_basketball_graph[0] = basketball_graph[HISTORY_YEAR_COUNT-2];
00480     initial_basketball_graph[1] = basketball_graph[1*HISTORY_YEAR_COUNT+HISTORY_YEAR_COUNT-2];
00481 }
00482 
00483 <span class="comment">//---------- End of function Athletics::save_initial_data -----------//</span>
00484 <span class="preprocessor">#endif</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:37:13 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
