<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Oletter.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Oletter.cpp</h1><a href="Oletter_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00002 <span class="preprocessor">#include &lt;OCONFIG.H&gt;</span>
00003 <span class="preprocessor">#include &lt;<a class="code" href="OGAMESET_8H.html">OGAMESET.H</a>&gt;</span>
00004 <span class="preprocessor">#include &lt;OWORLDMT.H&gt;</span>
00005 <span class="preprocessor">#include &lt;<a class="code" href="OGSET_8H.html">OGSET.H</a>&gt;</span>
00006 <span class="preprocessor">#include &lt;<a class="code" href="OVGA_8H.html">OVGA.H</a>&gt;</span>
00007 <span class="preprocessor">#include &lt;<a class="code" href="OMOUSE2_8H.html">OMOUSE2.H</a>&gt;</span>
00008 <span class="preprocessor">#include &lt;<a class="code" href="COLOR_8H.html">COLOR.H</a>&gt;</span>
00009 <span class="preprocessor">#include &lt;OFINANCE.H&gt;</span>
00010 <span class="preprocessor">#include &lt;OPSCHOOL.H&gt;</span>
00011 <span class="preprocessor">#include &lt;OFONT.H&gt;</span>
00012 <span class="preprocessor">#include &lt;<a class="code" href="ODATE_8H.html">ODATE.H</a>&gt;</span>
00013 <span class="preprocessor">#include &lt;OGAMESTR.H&gt;</span>
00014 <span class="preprocessor">#include &lt;OMOUSE.H&gt;</span>
00015 <span class="preprocessor">#include &lt;OLETTER.H&gt;</span>
00016 <span class="preprocessor">#include &lt;<a class="code" href="OVBROW98_8H.html">OVBROW98.H</a>&gt;</span>
00017 <span class="preprocessor">#include &lt;OIFACE.H&gt;</span>
00018 <span class="preprocessor">#include &lt;OFACULTY.H&gt;</span>
00019 <span class="preprocessor">#include &lt;ODEPT.H&gt;</span>
00020 <span class="preprocessor">#include &lt;<a class="code" href="ONAMERES_8H.html">ONAMERES.H</a>&gt;</span>
00021 <span class="preprocessor">#include &lt;<a class="code" href="ODEPTRES_8H.html">ODEPTRES.H</a>&gt;</span>
00022 <span class="preprocessor">#include &lt;OENROLL.H&gt;</span>
00023 <span class="preprocessor">#include &lt;<a class="code" href="OSTUOFF_8H.html">OSTUOFF.H</a>&gt;</span>
00024 <span class="preprocessor">#include &lt;<a class="code" href="OSCHLRES_8H.html">OSCHLRES.H</a>&gt;</span>
00025 <span class="preprocessor">#include &lt;<a class="code" href="OPEERSCH_8H.html">OPEERSCH.H</a>&gt;</span>
00026 <span class="preprocessor">#include &lt;OATHLETI.H&gt;</span>
00027 <span class="preprocessor">#include &lt;OINFO.H&gt;</span>
00028 <span class="preprocessor">#include &lt;OBUTTON.H&gt;</span>
00029 <span class="preprocessor">#include &lt;OMATH.H&gt;</span>
00030 <span class="preprocessor">#include &lt;OLOSEGAM.H&gt;</span>
00031 
00032 <span class="keyword">enum</span> {                                            <span class="comment">// screen coordinates</span>
00033     <a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a> = <a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>+15,
00034     <a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a> = <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>+25,
00035     <a class="code" href="Oletter_8cpp.html#a45a26">REPORT_X2</a> = <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-15,
00036     <a class="code" href="Oletter_8cpp.html#a45a27">REPORT_Y2</a> = <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-55
00037 };
00038 
00039 <span class="keyword">enum</span> {
00040     <a class="code" href="Oletter_8cpp.html#a46a28">BOTTOM_BUTTON_X0</a> = <a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>+70,
00041     <a class="code" href="Oletter_8cpp.html#a46a29">BOTTOM_BUTTON_X1</a> = <a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>+170,
00042     <a class="code" href="Oletter_8cpp.html#a46a30">BOTTOM_BUTTON_Y1</a> = <a class="code" href="Oletter_8cpp.html#a45a27">REPORT_Y2</a>+15,
00043     <a class="code" href="Oletter_8cpp.html#a46a31">BOTTOM_BUTTON_X2</a> = <a class="code" href="Oletter_8cpp.html#a45a26">REPORT_X2</a>-20,
00044     <a class="code" href="Oletter_8cpp.html#a46a32">BOTTOM_BUTTON_Y2</a> = <a class="code" href="Oletter_8cpp.html#a45a27">REPORT_Y2</a>+40
00045 };
00046 
00047 <span class="keyword">enum</span> {
00048     <a class="code" href="Oletter_8cpp.html#a47a33">BOTTOM_BUTTON_WIDTH</a> = 125,
00049     <a class="code" href="Oletter_8cpp.html#a47a34">BOTTOM_BUTTON_HEIGHT</a> = 25,
00050     <a class="code" href="Oletter_8cpp.html#a47a35">HELP_BUTTON_COUNT</a> = 3,
00051     <a class="code" href="Oletter_8cpp.html#a47a36">BOTTOM_BUTTON_DISTANCE</a>
00052     = (<a class="code" href="Oletter_8cpp.html#a46a31">BOTTOM_BUTTON_X2</a>-<a class="code" href="Oletter_8cpp.html#a46a29">BOTTOM_BUTTON_X1</a>-<a class="code" href="Oletter_8cpp.html#a47a33">BOTTOM_BUTTON_WIDTH</a>*2)/3
00053 };
00054 
00055 <span class="keyword">enum</span> {                                            <span class="comment">// the bg image id</span>
00056     <a class="code" href="Oletter_8cpp.html#a48a37">BG_PIC_ID</a> = 6
00057 };
00058 
00059 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00060 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">float</span> protagonist_ck1 = 3.50f;
00061 <span class="keyword">static</span> <span class="keywordtype">float</span> protagonist_ck2 = 1.75f;
00062 <span class="keyword">static</span> <span class="keywordtype">float</span> protagonist_ck3 = 1.50f;
00063 <span class="preprocessor">#endif</span>
00064 <span class="preprocessor"></span>
00065 <span class="keyword">static</span> <span class="keywordtype">short</span> *bottom_button_up_bitmap[<a class="code" href="Oletter_8cpp.html#a47a35">HELP_BUTTON_COUNT</a>];
00066 <span class="keyword">static</span> <span class="keywordtype">short</span> *bottom_button_down_bitmap[<a class="code" href="Oletter_8cpp.html#a47a35">HELP_BUTTON_COUNT</a>];
00067 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00068 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="classButton.html">Button</a> button_return;
00069 <span class="preprocessor">#endif</span>
00070 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="classButton.html">Button</a> button_back;
00071 <span class="keyword">static</span> <a class="code" href="classButton.html">Button</a> button_pgup;
00072 <span class="keyword">static</span> <a class="code" href="classButton.html">Button</a> button_pgdn;
00073 <span class="keyword">static</span> <span class="keywordtype">int</span> letter_report_init_flag;
00074 <span class="keyword">static</span> <span class="keywordtype">void</span> welcome_letter_disp_rep_row(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>);
00075 <span class="keyword">static</span> <span class="keywordtype">int</span> welcome_letter_detect_rep_row(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>);
00076 <span class="keyword">static</span> <span class="keywordtype">void</span> eval_letter_disp_rep_row(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>);
00077 <span class="keyword">static</span> <span class="keywordtype">int</span> eval_letter_detect_rep_row(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>);
00078 
00079 <span class="keyword">static</span> <a class="code" href="classVBrowse98.html">VBrowse98</a> letter_browser;
00080 <span class="keyword">static</span> <span class="keywordtype">int</span> name_id1,name_id2,name_id3;
00081 <span class="keyword">static</span> <span class="keywordtype">int</span> staff2_name_id1,staff2_name_id2,staff2_name_id3;
00082 <span class="keyword">static</span> <span class="keywordtype">double</span> surplusDeficit;
00083 
00084 <span class="keyword">static</span> old_scen_page_number=-1;
00085 <span class="keyword">static</span> max_scen_page_number=2;
00086 
00087 <span class="keyword">static</span> old_welcome_page_number=-1;
00088 <span class="keyword">static</span> max_welcome_page_number=5;
00089 
00090 <span class="keyword">static</span> old_eval_page_number=-1;
00091 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00092 <span class="preprocessor"></span><span class="keyword">static</span> max_eval_page_number=4;
00093 <span class="preprocessor">#else</span>
00094 <span class="preprocessor"></span><span class="keyword">static</span> max_eval_page_number=3;
00095 <span class="preprocessor">#endif</span>
00096 <span class="preprocessor"></span>
00097 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00098 <span class="preprocessor"></span><span class="keyword">static</span> old_state_page_number=-1;
00099 <span class="keyword">static</span> max_state_page_number=3;
00100 <span class="preprocessor">#endif</span>
00101 <span class="preprocessor"></span>
00102 <span class="comment">//--------- Define sort_data -----------//</span>
00103 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00106 <span class="preprocessor">struct SortData {</span>
00107 <span class="preprocessor"></span>    <span class="keywordtype">int</span> idx;
00108     <span class="keywordtype">float</span> strength;
00109     <span class="keywordtype">float</span> consistency;
00110     <span class="keywordtype">float</span> k1;
00111     <span class="keywordtype">char</span> tag;
00112 };
00113 <span class="preprocessor">#else</span>
<a name="l00116"></a><a class="code" href="structSortData.html">00116</a> <span class="preprocessor">struct SortData {</span>
<a name="l00117"></a><a class="code" href="structSortData.html#m0">00117</a> <span class="preprocessor"></span>    <span class="keywordtype">int</span> idx;
<a name="l00118"></a><a class="code" href="structSortData.html#m1">00118</a>     <span class="keywordtype">float</span> data;
<a name="l00119"></a><a class="code" href="structSortData.html#m2">00119</a>     <span class="keywordtype">char</span> tag;
00120 };
00121 <span class="preprocessor">#endif</span>
00122 <span class="preprocessor"></span>
00123 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structSortData.html">SortData</a> sort_data[SCORE_VAR_COUNT];
00124 
00125 <span class="comment">//---------- define text ----------------------//</span>
00126 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00127 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">char</span> *area_str[SCORE_VAR_COUNT]= {
00128     <span class="stringliteral">"Degrees granted                       "</span>,
00129     <span class="stringliteral">"Faculty research performance          "</span>,
00130     <span class="stringliteral">"Institutional prestige                                       "</span>,
00131     <span class="stringliteral">"Educational quality                  "</span>,
00132     <span class="stringliteral">"Scholarship broadly defined          "</span>,        <span class="comment">// 1007</span>
00133     <span class="stringliteral">"Student diversity                    "</span>,
00134     <span class="stringliteral">"Faculty diversity                    "</span>,
00135     <span class="stringliteral">"Alumni giving                 "</span>,
00136     <span class="stringliteral">"Faculty morale                       "</span>,
00137     <span class="stringliteral">"Student morale                       "</span>,
00138     <span class="stringliteral">"Staff morale                         "</span>,
00139     <span class="stringliteral">"Current surplus deficit percent      "</span>,
00140     <span class="stringliteral">"Smoothed surplus deficit percent     "</span>,
00141     <span class="stringliteral">"Endowment payout rate relative       "</span>,        <span class="comment">// 1007</span>
00142     <span class="stringliteral">"Deferred maintenance backlog percent "</span>,
00143 };
00144 <span class="preprocessor">#endif</span>
00145 <span class="preprocessor"></span>
00146 <span class="comment">//------- Begin of function Letter::Letter -----------//</span>
<a name="l00148"></a><a class="code" href="classLetter.html#a0">00148</a> <span class="comment">Letter::Letter() {</span>
00149     <span class="comment">//  init();</span>
00150 }
00151 
00152 <span class="comment">//--------- End of function Letter::Letter -----------//</span>
00153 
00154 <span class="comment">//------- Begin of function Letter::~Letter -----------//</span>
<a name="l00156"></a><a class="code" href="classLetter.html#a1">00156</a> <span class="comment">Letter::~Letter() {</span>
00157     deinit();
00158 }
00159 
00160 <span class="comment">//--------- End of function Letter::~Letter -----------//</span>
00161 
00162 <span class="comment">//------- Begin of function Letter::deinit ---------------//</span>
<a name="l00164"></a><a class="code" href="classLetter.html#a5">00164</a> <span class="comment">void Letter::deinit() {</span>
00165     <span class="comment">//--------- deallocate memory -------------//</span>
00166     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="Oletter_8cpp.html#a47a35">HELP_BUTTON_COUNT</a>; i++) {
00167         <span class="keywordflow">if</span> (bottom_button_up_bitmap[i]) {
00168             <a class="code" href="ALL_8H.html#a8">mem_del</a>(bottom_button_up_bitmap[i]);
00169             <a class="code" href="ALL_8H.html#a8">mem_del</a>(bottom_button_down_bitmap[i]);
00170             bottom_button_up_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00171             bottom_button_down_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00172         }
00173     }
00174     letter_report_init_flag = 0;
00175 }
00176 
00177 <span class="comment">//--------- End of function Letter::deinit ---------------//</span>
00178 
00179 <span class="comment">//------- Begin of function Letter::init -----------------//</span>
<a name="l00181"></a><a class="code" href="classLetter.html#a4">00181</a> <span class="comment">void Letter::init() {</span>
00182     memset(<span class="keyword">this</span>,0,<span class="keyword">sizeof</span>(<a class="code" href="classLetter.html">Letter</a>));
00183     name_id1=m.random(name_res.first_name_count)+1;
00184     name_id2=m.random(name_res.middle_name_count)+1;
00185     name_id3=m.random(name_res.last_name_count)+1;
00186     staff2_name_id1=m.random(name_res.first_name_count);
00187     staff2_name_id2=m.random(name_res.middle_name_count);
00188     staff2_name_id3=m.random(name_res.last_name_count);
00189     eval_page_number=1;
00190     welcome_page_number=1;
00191     scen_page_number=1;
00192 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00193 <span class="preprocessor"></span>    state_page_number=1;
00194 <span class="preprocessor">#endif</span>
00195 <span class="preprocessor"></span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="Oletter_8cpp.html#a47a35">HELP_BUTTON_COUNT</a>; i++) {
00196         bottom_button_up_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00197         bottom_button_down_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00198     }
00199     letter_report_init_flag = 0;
00200 }
00201 
00202 <span class="comment">//--------- End of function Letter::init -----------------//</span>
00203 
00204 <span class="comment">/*</span>
00205 <span class="comment">enum{</span>
00206 <span class="comment">  WELCOME_LETTER_PART1_BEGIN=1,</span>
00207 <span class="comment">  WELCOME_LETTER_PART1_END=14,</span>
00208 <span class="comment">  WELCOME_LETTER_PART2_BEGIN=15,</span>
00209 <span class="comment">};</span>
00210 <span class="comment"></span>
00211 <span class="comment">static void welcome_letter_disp_rep_row(int recno, int x, int y,int refreshFlag)</span>
00212 <span class="comment">{</span>
00213 <span class="comment">};</span>
00214 <span class="comment"></span>
00215 <span class="comment">static int welcome_letter_detect_rep_row(int recno, int x, int y)</span>
00216 <span class="comment">{</span>
00217 <span class="comment">return 0;</span>
00218 <span class="comment">};</span>
00219 <span class="comment"></span>
00220 <span class="comment">static void eval_letter_disp_rep_row(int recno, int x, int y,int refreshFlag)</span>
00221 <span class="comment">{</span>
00222 <span class="comment">static char * eval_context[]={</span>
00223 <span class="comment">"",</span>
00224 <span class="comment">"",</span>
00225 <span class="comment">"To   : ",</span>
00226 <span class="comment">"          President, ",</span>
00227 <span class="comment">"From:",</span>
00228 <span class="comment">"          Chair, Board of Trustees",</span>
00229 <span class="comment">"Date :   September 1,",</span>
00230 <span class="comment">"",</span>
00231 <span class="comment">"Dear President",</span>
00232 <span class="comment">"        The Compensation Committee of the Board has completed your performance evaluation",</span>
00233 <span class="comment"></span>
00234 <span class="comment">"for      -      . The Committee believes your performance has been weak. This",</span>
00235 <span class="comment">"will be reflected in your salary for next year.",</span>
00236 <span class="comment">"",</span>
00237 <span class="comment"></span>
00238 <span class="comment">"The Committee judges the degree of improvement or degradation in each of the fifteen performance",</span>
00239 <span class="comment">"areas listed below. While these do not provide a complete view of the University, we believe they",</span>
00240 <span class="comment">"cover the most important areas. In many cases, the absolute level of the criterion is less",</span>
00241 <span class="comment">"important than the trend. With this in mind, 8.0f estimated the percent increase or decrease",</span>
00242 <span class="comment">"over last year's score and arrayed the indicators accordingly.",</span>
00243 <span class="comment">"",</span>
00244 <span class="comment">"The Committee and full Board would appreciate your continuing attention to these matters.",</span>
00245 <span class="comment">"We would like to see positive trends for all the items during the next year.",</span>
00246 <span class="comment"></span>
00247 <span class="comment">"",</span>
00248 <span class="comment">"",</span>
00249 <span class="comment">"",</span>
00250 <span class="comment">"",</span>
00251 <span class="comment">"",</span>
00252 <span class="comment">"",</span>
00253 <span class="comment">"",</span>
00254 <span class="comment">"",</span>
00255 <span class="comment">"",</span>
00256 <span class="comment">"",</span>
00257 <span class="comment">"",</span>
00258 <span class="comment">"",</span>
00259 <span class="comment">"",</span>
00260 <span class="comment">"",</span>
00261 <span class="comment">"",</span>
00262 <span class="comment">"",</span>
00263 <span class="comment">"",</span>
00264 <span class="comment">"",</span>
00265 <span class="comment">"",</span>
00266 <span class="comment">"",</span>
00267 <span class="comment">"",</span>
00268 <span class="comment">};</span>
00269 <span class="comment"></span>
00270 <span class="comment">int tab1=x+5;</span>
00271 <span class="comment">int tab2=x+20;</span>
00272 <span class="comment">String str;</span>
00273 <span class="comment">String str2;</span>
00274 <span class="comment"></span>
00275 <span class="comment">str=eval_context[recno];</span>
00276 <span class="comment">font_san.put(tab2,y+2,str);</span>
00277 <span class="comment"></span>
00278 <span class="comment">if(recno==2)</span>
00279 <span class="comment">{</span>
00280 <span class="comment">str2=player_school.player_first_name;</span>
00281 <span class="comment">str2+=" ";</span>
00282 <span class="comment">str2+=player_school.player_last_name;</span>
00283 <span class="comment">font_blue_san.put(tab2+48,y+2,str2);</span>
00284 <span class="comment">}</span>
00285 <span class="comment">if(recno==3)</span>
00286 <span class="comment">{</span>
00287 <span class="comment">str2=player_school.school_name;</span>
00288 <span class="comment">font_blue_san.put(tab2+120,y+2,str2);</span>
00289 <span class="comment">}</span>
00290 <span class="comment">if(recno==4)</span>
00291 <span class="comment">{</span>
00292 <span class="comment">str2=name_res.get_name_str(name_id1,name_id2,name_id3);</span>
00293 <span class="comment">font_blue_san.put(tab2+48,y+2,str2);</span>
00294 <span class="comment">}</span>
00295 <span class="comment">if(recno==6)</span>
00296 <span class="comment">{</span>
00297 <span class="comment">if(info.game_month&lt;9)</span>
00298 <span class="comment">str2=m.format(info.game_year-1,16);</span>
00299 <span class="comment">else</span>
00300 <span class="comment">str2=m.format(info.game_year,16);</span>
00301 <span class="comment">font_blue_san.put(tab2+150,y+2,str2);</span>
00302 <span class="comment">}</span>
00303 <span class="comment">if(recno==8)</span>
00304 <span class="comment">{</span>
00305 <span class="comment">str2=player_school.player_last_name;</span>
00306 <span class="comment">str2+=" ,";</span>
00307 <span class="comment">font_blue_san.put(tab2+100,y+2,str2);</span>
00308 <span class="comment">}</span>
00309 <span class="comment">if(recno==10)</span>
00310 <span class="comment">{</span>
00311 <span class="comment">if(info.game_month&lt;9)</span>
00312 <span class="comment">str2=m.format(info.game_year-2,16);</span>
00313 <span class="comment">else</span>
00314 <span class="comment">str2=m.format(info.game_year-1,16);</span>
00315 <span class="comment">font_blue_san.put(tab2+20,y+2,str2);</span>
00316 <span class="comment">if(info.game_month&lt;9)</span>
00317 <span class="comment">str2=m.format(info.game_year-1,16);</span>
00318 <span class="comment">else</span>
00319 <span class="comment">str2=m.format(info.game_year,16);</span>
00320 <span class="comment">font_blue_san.put(tab2+60,y+2,str2);</span>
00321 <span class="comment">}</span>
00322 <span class="comment">if(recno==12)</span>
00323 <span class="comment">{</span>
00324 <span class="comment">if(finance.last_year.asset_array[AC_OPERATING_RESERVE] &lt; 0)</span>
00325 <span class="comment">{</span>
00326 <span class="comment">str2="        Last year the University's operating reserve was in the red by ";</span>
00327 <span class="comment">str2+=m.format(-finance.last_year.asset_array[AC_OPERATING_RESERVE],2);</span>
00328 <span class="comment">str2+=" thousand.";</span>
00329 <span class="comment">font_red_san.put(tab2,y+2,str2);</span>
00330 <span class="comment">}</span>
00331 <span class="comment">if(finance.last_year.asset_array[AC_OPERATING_RESERVE] &gt; 0)</span>
00332 <span class="comment">{</span>
00333 <span class="comment">str2="        Last year the University's operating reserve was in the blue by ";</span>
00334 <span class="comment">str2+=m.format(finance.last_year.asset_array[AC_OPERATING_RESERVE],2);</span>
00335 <span class="comment">str2+=" thousand.";</span>
00336 <span class="comment">font_blue_san.put(tab2,y+2,str2);</span>
00337 <span class="comment">}</span>
00338 <span class="comment">}</span>
00339 <span class="comment">};</span>
00340 <span class="comment"></span>
00341 <span class="comment">static int eval_letter_detect_rep_row(int recno, int x, int y)</span>
00342 <span class="comment">{</span>
00343 <span class="comment">return 0;</span>
00344 <span class="comment">};</span>
00345 <span class="comment">*/</span>
00346 
00348 <span class="keyword">enum</span>{<a class="code" href="Oletter_8cpp.html#a49a38">TMP_SCENARIO_COUNT</a> = 10};
00349 <span class="keyword">static</span> <span class="keywordtype">int</span> max_scn_page[<a class="code" href="Oletter_8cpp.html#a49a38">TMP_SCENARIO_COUNT</a>] = {
00350     1,3,3,3,3,3,3,2,3,3
00351 };
00352 <span class="keyword">static</span> <span class="keywordtype">int</span> scn_id[<a class="code" href="Oletter_8cpp.html#a49a38">TMP_SCENARIO_COUNT</a>] = {
00353     <a class="code" href="Opschool_8h.html#a63a22">SCN_RAISE_SALARY</a>,
00354     <a class="code" href="Opschool_8h.html#a63a23">SCN_INVEST_ACADEMIC</a>,
00355     <a class="code" href="Opschool_8h.html#a63a24">SCN_TEACHING_QUALITY</a>,                           <span class="comment">//## fred0301</span>
00356     <a class="code" href="Opschool_8h.html#a63a25">SCN_RESEARCH_QUALITY</a>,                           <span class="comment">//## fred0301</span>
00357     <a class="code" href="Opschool_8h.html#a63a26">SCN_WINNING_ATHLETICS</a>,
00358     <a class="code" href="Opschool_8h.html#a63a27">SCN_LIMIT_TUITION_GROWTH</a>,
00359     <a class="code" href="Opschool_8h.html#a63a28">SCN_COMPENSATE_FOR_ENROLLMENT_SHIFTS</a>,           <span class="comment">//## fred0301</span>
00360     <a class="code" href="Opschool_8h.html#a63a29">SCN_STUDENT_DIVERSITY</a>,
00361     <a class="code" href="Opschool_8h.html#a63a30">SCN_FACULTY_DIVERSITY</a>,
00362     <a class="code" href="Opschool_8h.html#a63a31">SCN_BALANCE_BUDGET</a>,
00363 };
00364 <span class="keyword">static</span> <span class="keywordtype">char</span>* scn_name[<a class="code" href="Oletter_8cpp.html#a49a38">TMP_SCENARIO_COUNT</a>] = {
00365     <span class="stringliteral">"Scenario 1  -- PAY BETTER"</span>,
00366     <span class="stringliteral">"Scenario 2  -- ALLOCATE NEW MONEY"</span>,
00367     <span class="stringliteral">"Scenario 3  -- TEACH BETTER"</span>,
00368     <span class="stringliteral">"Scenario 4  -- IMPROVE RESEARCH PERFORMANCE"</span>,
00369     <span class="stringliteral">"Scenario 5  -- WIN GAMES"</span>,
00370     <span class="stringliteral">"Scenario 6  -- REDUCE TUITION"</span>,
00371     <span class="stringliteral">"Scenario 7  -- RESPOND TO ENROLLMENT SHIFTS"</span>,
00372     <span class="stringliteral">"Scenario 8  -- ENROLL MORE MINORITY STUDENTS"</span>,
00373     <span class="stringliteral">"Scenario 9  -- HIRE MORE MINORITY FACULTY MEMBERS"</span>,
00374     <span class="stringliteral">"Scenario 10 -- BALANCE THE BUDGET"</span>,
00375 };
00376 
00378 
<a name="l00379"></a><a class="code" href="classLetter.html#a6">00379</a> <span class="keywordtype">void</span> <a class="code" href="classLetter.html#a6">Letter::scen_welcome_letter_report</a>(<span class="keywordtype">int</span> refreshFlag) {
00380     <span class="keywordtype">int</span> tab1=<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>,tab2=<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>+70,
00381         tab3=<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>+100,tab4=<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>+700;
00382     <span class="keywordtype">int</span> vtab1=<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>+20,vtab2=<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>+70,
00383         vtab3=<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>+100,vtab4=<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>+350;
00384 
00385     vga.use_back();
00386 
00387     <span class="keywordflow">if</span> (refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>) {
00388         <span class="keywordflow">if</span>(letter_report_init_flag )
00389             <a class="code" href="classLetter.html#a5">deinit</a>();
00390 
00391         <span class="comment">//------------- paint the background ----------------//</span>
00392         <span class="keywordflow">if</span> (!letter_report_init_flag) {
00393             sys.set_speed(0);
00394             max_scen_page_number=max_scn_page[player_school.scenario_id-1];
00395             user_interface.bg_img(<a class="code" href="Oletter_8cpp.html#a48a37">BG_PIC_ID</a>, &amp;vga_back);
00396 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00397 <span class="preprocessor"></span>            letter_date = info.game_start_date;
00398 <span class="preprocessor">#endif</span>
00399 <span class="preprocessor"></span>            font_letter.center_put(<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>+50,<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>,<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>+680,<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>+20,<span class="stringliteral">"Scenario Welcome Letter "</span>);
00400             font_letter.center_put(<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>+50,<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>+30,<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>+680,<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>+50,scn_name[player_school.scenario_id-1]);
00401             letter_report_init_flag = 1;
00402             button_back.<a class="code" href="classButton.html#a10">create_text</a>(350,vtab4+7,450,vtab4+28,<span class="stringliteral">"Proceed"</span>);
00403             button_pgup.<a class="code" href="classButton.html#a10">create_text</a>(570,vtab4-10,660,vtab4+13,<span class="stringliteral">"Prev. page"</span>);
00404             button_pgdn.<a class="code" href="classButton.html#a10">create_text</a>(570,vtab4+15,660,vtab4+38,<span class="stringliteral">"Next page"</span>);
00405         }
00406     }
00407     <span class="keywordflow">else</span> {
00408         vga.use_back();
00409     }
00410 
00411     <span class="keywordflow">if</span>((<a class="code" href="classLetter.html#m2">scen_page_number</a>!=old_scen_page_number)||(refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>)) {
00412         old_scen_page_number=<a class="code" href="classLetter.html#m2">scen_page_number</a>;
00413         <a class="code" href="classString.html">String</a> context;
00414 
00416         <span class="comment">// Scn 1 SCN_BALANCE_BUDGET //</span>
00418 <span class="comment">        if(player_school.scenario_id==SCN_BALANCE_BUDGET) {</span>
00419             <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m2">scen_page_number</a>==1) {
00420                 context = <span class="stringliteral">"To : "</span>;
00421                 context += player_school.player_first_name;
00422                 context += <span class="stringliteral">" "</span>;
00423                 context += player_school.player_last_name;
00424                 context += <span class="stringliteral">", "</span>;
00425                 context += player_school.school_name;
00426 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00427 <span class="preprocessor"></span>                context += <span class="stringliteral">"           "</span>;
00428                 context += info.date_str_julian(letter_date);
00429 <span class="preprocessor">#else</span>
00430 <span class="preprocessor"></span>                context += <span class="stringliteral">"           September 1, "</span>;
00431                 context +=m.format(info.game_year,16);
00432 <span class="preprocessor">#endif</span>
00433 <span class="preprocessor"></span>                context +=<span class="stringliteral">"\nFrom : "</span>;
00434                 context +=name_res.get_name_str(name_id1,name_id2,name_id3);
00435                 context +=<span class="stringliteral">", Chair, Board of Trustees\n\n\n"</span>;
00436                 context +=<span class="stringliteral">"    The budget deficit you project alarms the Board. "</span>;
00437 
00438                 <span class="keywordflow">if</span>(player_school.school_type==<a class="code" href="Gamedef_8h.html#a81a41">PRIVATE_SCHOOL</a>)
00439                     context +=<span class="stringliteral">"Unexpected shortfalls in research grants, gifts, and other income"</span>;
00440                 <span class="keywordflow">if</span>(player_school.school_type==<a class="code" href="Gamedef_8h.html#a81a42">LIBERAL_ARTS_SCHOOL</a>)
00441                     context +=<span class="stringliteral">"Unexpected shortfalls in gifts, tuition and other income"</span>;
00442                 <span class="keywordflow">if</span>(player_school.school_type==<a class="code" href="Gamedef_8h.html#a81a43">PUBLIC_SCHOOL</a>)
00443                     context +=<span class="stringliteral">"Unexpected shortfalls in research grants, state appropriations, tuition and other income"</span>;
00444                 <span class="keywordflow">if</span>(player_school.school_type==<a class="code" href="Gamedef_8h.html#a81a44">COMPREHENSIVE_SCHOOL</a>)
00445                     context +=<span class="stringliteral">"Unexpected shortfalls in state appropriations and other income"</span>;
00446 
00447                 context +=<span class="stringliteral">" have thrown the budget "</span>;
00448                 context +=m.format(finance.this_year.surplus_deficit,2);
00449                 context +=<span class="stringliteral">" thousands into the "</span>;
00450                 <span class="keywordflow">if</span>(finance.this_year.surplus_deficit&lt;0)
00451                     context+=<span class="stringliteral">"red "</span>;
00452                 <span class="keywordflow">else</span>
00453                     context+=<span class="stringliteral">"black "</span>;
00454                 context +=<span class="stringliteral">".  Worse, hopes of more income anytime soon are vain.  At our recent meeting, you disappointed the Board by advancing no remedy to cope with the new circumstances promptly.\n"</span>;
00455             }
00456 
00457             <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m2">scen_page_number</a>==2) {
00458                 context = <span class="stringliteral">"We are disturbed that you currently are targeting a 3 percent budget \</span>
00459 <span class="stringliteral">                                                          deficit for next year.\n\n"</span>;
00460 
00461                 context +=<span class="stringliteral">"    You must act immediately. "</span>;
00462                 context +=<span class="stringliteral">"Although some actions may require more than one year to phase in, you must balance the budget within three years from now. "</span>;
00463                 context +=<span class="stringliteral">"Furthermore, after achieving a balanced budget during years 4, 5, 6, you should run surpluses for years 7, 8, 9 or until reserves rise to their current level of "</span>;
00464                 context +=m.format(player_school.scenario_target[0],2);
00465                 context +=<span class="stringliteral">" thousand."</span>;
00466             }
00467 
00468             <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m2">scen_page_number</a>==3) {
00469                 context = <span class="stringliteral">"You must accomplish the above without diminishing the average \"Performance "</span>;
00470                 context += <span class="stringliteral">"indicators\" and \"Attitudes toward the institution\" scores (listed on the \"Score\" screen.)"</span>;
00471 
00472             }
00473         }
00474 
00476         <span class="comment">// Scn 2 SCN_RAISE_SALARY //</span>
00478 <span class="comment">        if(player_school.scenario_id==SCN_RAISE_SALARY) {</span>
00479             <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m2">scen_page_number</a>==1) {
00480                 context = <span class="stringliteral">"To : "</span>;
00481                 context += player_school.player_first_name;
00482                 context += <span class="stringliteral">" "</span>;
00483                 context += player_school.player_last_name;
00484                 context += <span class="stringliteral">", "</span>;
00485                 context += player_school.school_name;
00486 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00487 <span class="preprocessor"></span>                context += <span class="stringliteral">"           "</span>;
00488                 context += info.date_str_julian(letter_date);
00489 <span class="preprocessor">#else</span>
00490 <span class="preprocessor"></span>                context += <span class="stringliteral">"           September 1, "</span>;
00491                 context +=m.format(info.game_year,16);
00492 <span class="preprocessor">#endif</span>
00493 <span class="preprocessor"></span>                context +=<span class="stringliteral">"\nFrom : "</span>;
00494                 context +=name_res.get_name_str(name_id1,name_id2,name_id3);
00495                 context +=<span class="stringliteral">", Chair, Board of Trustees\n\n"</span>;
00496                 context +=<span class="stringliteral">"    The Board agrees with the concern you expressed about faculty salaries "</span>;
00497                 context +=<span class="stringliteral">"at our last meeting.  At the meeting you convinced "</span>;
00498                 context +=<span class="stringliteral">"us that the salaries we offer are 14% below the market. "</span>;
00499                 context +=<span class="stringliteral">"Because competitive salaries are expected to remain constant, this means our salaries need to improve by 14%. We hope you can accomplish this within ten years, or in less time if possible."</span>;
00500                 <span class="comment">/*</span>
00501 <span class="comment">                  if(player_school.school_type==PRIVATE_SCHOOL || player_school.school_type==LIBERAL_ARTS_SCHOOL)</span>
00502 <span class="comment">                  {</span>
00503 <span class="comment">                  context +="Further, because salaries at competing institutions will grow about 20% during the next five years, ";</span>
00504 <span class="comment">                  context +="our university must increase salaries 10 plus 20, or 30% within five years.\n";</span>
00505 <span class="comment">                  }</span>
00506 <span class="comment">                  else</span>
00507 <span class="comment">                  {</span>
00508 <span class="comment">                  context +="Further, because salaries at competing institutions will grow about 10% during the next five years, ";</span>
00509 <span class="comment">                  context +="our university must increase salaries 10 plus 10, or 20% within five years.\n";</span>
00510 <span class="comment">                  }</span>
00511 <span class="comment">                */</span>
00512             }       
00513             <span class="comment">/*</span>
00514 <span class="comment">              if(scen_page_number==2)</span>
00515 <span class="comment">              {</span>
00516 <span class="comment"></span>
00517 <span class="comment">              if(player_school.school_type==PRIVATE_SCHOOL || player_school.school_type==LIBERAL_ARTS_SCHOOL)</span>
00518 <span class="comment">              {</span>
00519 <span class="comment">              context ="    We ask you to pass from analysis to prescription. Because our faculty is the University, we must remedy our low salaries as soon as possible. How will you raise faculty \ </span>
00520 <span class="comment">              salaries 30% and pay for the raises?  What combination of new money and reduced or eliminated programs will you use to finance the raises? Consider carefully \ </span>
00521 <span class="comment">              how, beyond a more contented faculty, the higher salaries guarantee the continuity and ";</span>
00522 <span class="comment">              }</span>
00523 <span class="comment">              else</span>
00524 <span class="comment">              {</span>
00525 <span class="comment">              context ="    We ask you to pass from analysis to prescription. Because our faculty is the University, we must remedy our low salaries as soon as possible. How will you raise faculty \ </span>
00526 <span class="comment">              salaries 20% and pay for the raises?  What combination of new money and reduced or eliminated programs will you use to finance the raises? Consider carefully \ </span>
00527 <span class="comment">              how, beyond a more contented faculty, the higher salaries guarantee the continuity and ";</span>
00528 <span class="comment">              }</span>
00529 <span class="comment"></span>
00530 <span class="comment">              context +="increase the worth of our university.";</span>
00531 <span class="comment">              }</span>
00532 <span class="comment"></span>
00533 <span class="comment">              if(scen_page_number==3)</span>
00534 <span class="comment">              {</span>
00535 <span class="comment">              }</span>
00536 <span class="comment">            */</span>
00537         }   
00538 
00540         <span class="comment">// Scn 3 SCN_INVEST_ACADEMIC //</span>
00542 <span class="comment">        if(player_school.scenario_id==SCN_INVEST_ACADEMIC) {</span>
00543             <span class="keywordflow">if</span>(scen_page_number==1) {
00544                 context = <span class="stringliteral">"To : "</span>;
00545                 context += player_school.player_first_name;
00546                 context += <span class="stringliteral">" "</span>;
00547                 context += player_school.player_last_name;
00548                 context += <span class="stringliteral">", "</span>;
00549                 context += player_school.school_name;
00550 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00551 <span class="preprocessor"></span>                context += <span class="stringliteral">"           "</span>;
00552                 context += info.date_str_julian(letter_date );
00553 <span class="preprocessor">#else</span>
00554 <span class="preprocessor"></span>                context += <span class="stringliteral">"           September 1, "</span>;
00555                 context +=m.format(info.game_year,16);
00556 <span class="preprocessor">#endif</span>
00557 <span class="preprocessor"></span>                context +=<span class="stringliteral">"\nFrom : "</span>;
00558                 context +=name_res.get_name_str(name_id1,name_id2,name_id3);
00559                 context +=<span class="stringliteral">", Chair, Board of Trustees\n\n"</span>;
00560                 context +=<span class="stringliteral">"    Congratulations. "</span>;
00561                 <span class="comment">// find a female</span>
00562                 <span class="keywordtype">int</span> staff_number=game_set.open_db(<span class="stringliteral">"N_FIRST"</span>)-&gt;rec_count();
00563                 <span class="keywordflow">while</span>(name_res.is_male(staff2_name_id1)) {
00564                     staff2_name_id1++;
00565                     <span class="keywordflow">if</span>(staff2_name_id1&gt;staff_number)staff2_name_id1=1;
00566                 }
00567                 context +=name_res.get_name_str(staff2_name_id1,staff2_name_id2,staff2_name_id3);
00568                 context +=<span class="stringliteral">" has just pledged "</span>;
00569                 context +=m.format(player_school.scenario_base1,2);
00570                 context +=<span class="stringliteral">" thousands to enhance the "</span>;
00571 
00572                 <span class="keywordflow">if</span>(player_school.school_type==<a class="code" href="Gamedef_8h.html#a81a41">PRIVATE_SCHOOL</a>)
00573                     context +=<span class="stringliteral">"sciences and allied fields"</span>;
00574                 <span class="keywordflow">if</span>(player_school.school_type==<a class="code" href="Gamedef_8h.html#a81a42">LIBERAL_ARTS_SCHOOL</a>)
00575                     context +=<span class="stringliteral">"humanities and allied fields"</span>;
00576                 <span class="keywordflow">if</span>(player_school.school_type==<a class="code" href="Gamedef_8h.html#a81a43">PUBLIC_SCHOOL</a>)
00577                     context +=<span class="stringliteral">"social sciences and allied fields"</span>;
00578                 <span class="keywordflow">if</span>(player_school.school_type==<a class="code" href="Gamedef_8h.html#a81a44">COMPREHENSIVE_SCHOOL</a>)
00579                     context +=<span class="stringliteral">"business, education, applied science and technology"</span>;
00580 
00581                 context +=<span class="stringliteral">" at our university. "</span>;
00582                 context +=<span class="stringliteral">"The pledge will raise next year's budget (for "</span>;
00583 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00584 <span class="preprocessor"></span>                context += info.date_str_ymd( date.year(letter_date)+1, 0, 0 );
00585 <span class="preprocessor">#else</span>
00586 <span class="preprocessor"></span>                context +=m.format(info.game_year+1,16);
00587 <span class="preprocessor">#endif</span>
00588 <span class="preprocessor"></span>                context +=<span class="stringliteral">") by about "</span>;
00589                 context +=m.format(player_school.scenario_base2,2);
00590                 context +=<span class="stringliteral">" thousand.\n\n"</span>;
00591 
00592                 context +=<span class="stringliteral">"    The donor gave to improve "</span>;
00593 
00594                 <span class="comment">//-------- show the list of active departments related to the scenario -----//</span>
00595 
00596                 <span class="keywordtype">char</span>* departmentPrivate[] = {
00597                     <span class="stringliteral">"biology"</span>, <span class="stringliteral">"chemistry"</span>, <span class="stringliteral">"physics"</span>, <span class="stringliteral">"mathematics"</span>, <span class="stringliteral">"computer science"</span>,
00598                     <span class="stringliteral">"engineering"</span>, <span class="stringliteral">"environmental science"</span>, <a class="code" href="OHELP_8H.html#a0">NULL</a>
00599                 };
00600 
00601                 <span class="keywordtype">char</span>* departmentLiberalArts[] = {
00602                     <span class="stringliteral">"American studies"</span>, <span class="stringliteral">"classics"</span>, <span class="stringliteral">"English"</span>, <span class="stringliteral">"history"</span>, <span class="stringliteral">"philosophy"</span>,
00603                     <span class="stringliteral">"foreign languages"</span>, <span class="stringliteral">"art"</span>, <span class="stringliteral">"music"</span>, <span class="stringliteral">"drama"</span>, <a class="code" href="OHELP_8H.html#a0">NULL</a>
00604                 };
00605 
00606                 <span class="keywordtype">char</span>* departmentPublic[] = {
00607                     <span class="stringliteral">"anthropology and sociology"</span>, <span class="stringliteral">"economics"</span>, <span class="stringliteral">"law"</span>, <span class="stringliteral">"political science"</span>,
00608                     <span class="stringliteral">"psychology"</span>, <span class="stringliteral">"gender/ethnic studies"</span>, <span class="stringliteral">"communication"</span>, <a class="code" href="OHELP_8H.html#a0">NULL</a>
00609                 };
00610 
00611                 <span class="keywordtype">char</span>* departmentCompreh[] = {
00612                     <span class="stringliteral">"agricultural science"</span>, <span class="stringliteral">"technology services"</span>, <span class="stringliteral">"business"</span>, <span class="stringliteral">"education"</span>,
00613                     <span class="stringliteral">"health services"</span>, <a class="code" href="OHELP_8H.html#a0">NULL</a>
00614                 };
00615 
00616                 <span class="keywordtype">char</span>** departmentList;
00617                 <span class="keywordtype">int</span>  hasDepartmentCount=0, thisCount=0;
00618 
00619                 <span class="keywordflow">if</span>(player_school.school_type==<a class="code" href="Gamedef_8h.html#a81a41">PRIVATE_SCHOOL</a>)
00620                     departmentList = departmentPrivate;
00621                 <span class="keywordflow">if</span>(player_school.school_type==<a class="code" href="Gamedef_8h.html#a81a42">LIBERAL_ARTS_SCHOOL</a>)
00622                     departmentList = departmentLiberalArts;
00623                 <span class="keywordflow">if</span>(player_school.school_type==<a class="code" href="Gamedef_8h.html#a81a43">PUBLIC_SCHOOL</a>)
00624                     departmentList = departmentPublic;
00625                 <span class="keywordflow">if</span>(player_school.school_type==<a class="code" href="Gamedef_8h.html#a81a44">COMPREHENSIVE_SCHOOL</a>)
00626                     departmentList = departmentCompreh;
00627 
00628                 <span class="comment">// count the number of available departments for later placement of the word "and"</span>
00629                 <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0 ; i&lt;12 &amp;&amp; departmentList[i] ; i++ ) {
00630                     <span class="keywordflow">if</span>( department_array.has_department(departmentList[i]) )
00631                         hasDepartmentCount++;
00632                 }
00633 
00634                 <span class="comment">// count the number of available departments for later placement of the word "and"</span>
00635                 <span class="keywordflow">for</span>( i=0 ; i&lt;12 &amp;&amp; departmentList[i] ; i++ ) {
00636                     <span class="keywordflow">if</span>( department_array.has_department(departmentList[i]) ) {
00637                         thisCount++;
00638 
00639                         context += departmentList[i];
00640 
00641                         <span class="keywordflow">if</span>( thisCount == hasDepartmentCount ) <span class="comment">// last one</span>
00642                             context += <span class="stringliteral">"."</span>;
00643                         <span class="comment">// second last one</span>
00644                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( thisCount == hasDepartmentCount-1 )
00645                             context += <span class="stringliteral">" and "</span>;
00646                         <span class="keywordflow">else</span>
00647                             context += <span class="stringliteral">", "</span>;
00648                     }
00649                 }
00650             }
00651 
00652             <span class="keywordflow">if</span>(scen_page_number==2) {
00653                 context =<span class="stringliteral">"How will you achieve the goal for which she gave so generously? \n\n\</span>
00654 <span class="stringliteral">                                                                    You could concentrate big money on one or two departments or\n\</span>
00655 <span class="stringliteral">                                                                spend a little on many. The number of students affected by an alternative represents one criterion for \</span>
00656 <span class="stringliteral">                                                                selection. Another criterion is how your allocation of resources affects nonscience departments \</span>
00657 <span class="stringliteral">                                                                and such important facets of university life as the quality of teaching."</span>;
00658             }
00659             <span class="keywordflow">if</span>(scen_page_number==3) {
00660                 context =<span class="stringliteral">"    The Board will judge your \</span>
00661 <span class="stringliteral">                                                                success first in meeting the donor's expectations, which may encourage other donors, \</span>
00662 <span class="stringliteral">                                                                and then in lifting the prestige of our university."</span>;
00663             }
00664         }
00665 
00667         <span class="comment">// Scn 4 SCN_TEACHING_QUALITY //</span>
00669 <span class="comment">        if(player_school.scenario_id==SCN_TEACHING_QUALITY) {</span>
00670             <span class="keywordflow">if</span>(scen_page_number==1) {
00671                 context = <span class="stringliteral">"To : "</span>;
00672                 context += player_school.player_first_name;
00673                 context += <span class="stringliteral">" "</span>;
00674                 context += player_school.player_last_name;
00675                 context += <span class="stringliteral">", "</span>;
00676                 context += player_school.school_name;
00677 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00678 <span class="preprocessor"></span>                context += <span class="stringliteral">"           "</span>;
00679                 context += info.date_str_julian(letter_date);
00680 <span class="preprocessor">#else</span>
00681 <span class="preprocessor"></span>                context += <span class="stringliteral">"           September 1, "</span>;
00682                 context += m.format(info.game_year,16);
00683 <span class="preprocessor">#endif</span>
00684 <span class="preprocessor"></span>                context += <span class="stringliteral">"\nFrom : "</span>;
00685                 context += name_res.get_name_str(name_id1,name_id2,name_id3);
00686                 context += <span class="stringliteral">", Chair, Board of Trustees\n\n\n"</span>;
00687 
00688                 context +=<span class="stringliteral">"    The recent report by the accreditation team alarms the Board. Our proud university \</span>
00689 <span class="stringliteral">                                        should not be cited for poor teaching. Something must be done.\n\n\</span>
00690 <span class="stringliteral">                                            The team attributes our failure to inattention to education rather than to lack of \</span>
00691 <span class="stringliteral">                                        resources. They cited discontinued courses, student"</span>;
00692                 <span class="comment">// find a female</span>
00693             }
00694             <span class="keywordflow">if</span>(scen_page_number==2) {
00695                 context =<span class="stringliteral">"demoralization, and insufficient \</span>
00696 <span class="stringliteral">                                        faculty time and attention devoted to students. They cited poor teaching in the \</span>
00697 <span class="stringliteral">                                        classroom. While some departments received a passing grade, most cry out for improvement.\n\n"</span>;
00698                 context +=<span class="stringliteral">"    In five rather than the usual ten years, the accreditation team will return. At that time, the Board \</span>
00699 <span class="stringliteral">                                expects the University's educational quality will be rated good. "</span>;
00700                 <span class="comment">//                              context += m.format(player_school.sub_score[S_EDUCATIONAL_QUALITY][THIS_MONTH],1);                      //BUGHERE</span>
00701                 context +=<span class="stringliteral">"When they come in ten years for \</span>
00702 <span class="stringliteral">                                                                our next regular examination, we expect our teaching will be rated excellent."</span>;
00703                 <span class="comment">//                              context += m.format(player_school.sub_score[S_EDUCATIONAL_QUALITY][THIS_MONTH]+15,1);;          //BUGHERE</span>
00704                 <span class="comment">//                              context +="excellent.";</span>
00705             }
00706             <span class="keywordflow">if</span>(scen_page_number==3) {
00707                 context =<span class="stringliteral">"    Remembering the team's opinion that a lack of physical and financial \</span>
00708 <span class="stringliteral">                                        resources did not cause our poor teaching, the Board does not expect a \</span>
00709 <span class="stringliteral">                                        mere plea for more money to achieve accreditation. Rather, we expect a plan to put in our classrooms a \</span>
00710 <span class="stringliteral">                                        faculty that loves to teach."</span>;
00711                 <span class="comment">//                              How will you reach these goals?";</span>
00712             }
00713         }
00714 
00715         <span class="keywordflow">if</span>(player_school.scenario_id==<a class="code" href="Opschool_8h.html#a63a25">SCN_RESEARCH_QUALITY</a>) {
00716             <span class="keywordflow">if</span>(scen_page_number==1) {
00717                 context = <span class="stringliteral">"To : "</span>;
00718                 context += player_school.player_first_name;
00719                 context += <span class="stringliteral">" "</span>;
00720                 context += player_school.player_last_name;
00721                 context += <span class="stringliteral">", "</span>;
00722                 context += player_school.school_name;
00723 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00724 <span class="preprocessor"></span>                context += <span class="stringliteral">"           "</span>;
00725                 context += info.date_str_julian(letter_date);
00726 <span class="preprocessor">#else</span>
00727 <span class="preprocessor"></span>                context += <span class="stringliteral">"           September 1, "</span>;
00728                 context += m.format(info.game_year,16);
00729 <span class="preprocessor">#endif</span>
00730 <span class="preprocessor"></span>                context += <span class="stringliteral">"\nFrom : "</span>;
00731                 context += name_res.get_name_str(name_id1,name_id2,name_id3);
00732                 context += <span class="stringliteral">", Chair, Board of Trustees\n\n\n"</span>;
00733                 context +=<span class="stringliteral">"    At our last meeting you convinced the Board that faculty research and scholarship at our university are mediocre by national standards. \</span>
00734 <span class="stringliteral">                                        Something must be done.\n\n\</span>
00735 <span class="stringliteral">                                            The Faculty Senate Research Committee attributes this condition to a lack of commitment \</span>
00736 <span class="stringliteral">                                        by both faculty and administrators rather than a"</span>;
00737             }
00738             <span class="keywordflow">if</span>(scen_page_number==2) {
00739                 context = <span class="stringliteral">"lack of resources. The Committee blames excessive teaching loads \</span>
00740 <span class="stringliteral">                                        and insufficient research support. \</span>
00741 <span class="stringliteral">                                        They blame low faculty morale. \</span>
00742 <span class="stringliteral">                                        Most departments require improvement.\n\n"</span>;
00743                 context += <span class="stringliteral">"    In ten years, the Board and the Faculty Senate want the University's performance rating in scholarship to be strong. "</span>;
00744                 context += <span class="stringliteral">"The rating reflects the scholarship of integration, application, and \</span>
00745 <span class="stringliteral">                                        teaching as well as knowledge"</span>;
00746             }
00747             <span class="keywordflow">if</span>(scen_page_number==3) {
00748                 context =<span class="stringliteral">"creation. Remembering that the University's lackluster \</span>
00749 <span class="stringliteral">                                        research performance is not due to a lack of physical and financial resources, \</span>
00750 <span class="stringliteral">                                        the Board expects more than a \</span>
00751 <span class="stringliteral">                                        plea for money. Rather, we expect a plan to breathe life into our laboratories and \</span>
00752 <span class="stringliteral">                                        to reestablish the University's preeminence as a center of scholarship and discovery. How will you reach these goals?"</span>;
00753             }
00754         }
00755 
00756         <span class="keywordflow">if</span>(player_school.scenario_id==<a class="code" href="Opschool_8h.html#a63a26">SCN_WINNING_ATHLETICS</a>) {
00757             <span class="keywordflow">if</span>(scen_page_number==1) {
00758                 context = <span class="stringliteral">"To : "</span>;
00759                 context += player_school.player_first_name;
00760                 context += <span class="stringliteral">" "</span>;
00761                 context += player_school.player_last_name;
00762                 context += <span class="stringliteral">", "</span>;
00763                 context += player_school.school_name;
00764 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00765 <span class="preprocessor"></span>                context += <span class="stringliteral">"           "</span>;
00766                 context += info.date_str_julian(letter_date);
00767 <span class="preprocessor">#else</span>
00768 <span class="preprocessor"></span>                context += <span class="stringliteral">"           September 1, "</span>;
00769                 context += m.format(info.game_year,16);
00770 <span class="preprocessor">#endif</span>
00771 <span class="preprocessor"></span>                context += <span class="stringliteral">"\nFrom : "</span>;
00772                 context += name_res.get_name_str(name_id1,name_id2,name_id3);
00773                 context += <span class="stringliteral">", Chair, Board of Trustees\n\n\n"</span>;
00774                 context +=<span class="stringliteral">"    The Alumni Association has impressed upon the Board the mediocrity of our athletes. \</span>
00775 <span class="stringliteral">                                        The Board agrees that our institution should win more games, thereby strengthening the loyalty \</span>
00776 <span class="stringliteral">                                        of alumni and attracting new students to all our departments.  Something must be done."</span>;
00777             }
00778             <span class="keywordflow">if</span>(scen_page_number==2) {
00779                 context =<span class="stringliteral">"    The Alumni Association criticizes our admissions standards as too high and our athletics budget as too low. \</span>
00780 <span class="stringliteral">                                        We are faulted in particular for providing insufficient financial aid for athletes. \</span>
00781 <span class="stringliteral">                                        The Alumni expect our inattention to athletes to be corrected without damaging the academic \</span>
00782 <span class="stringliteral">                                        performance that, at bottom, represents the worth of our university. "</span>;
00783                 context +=<span class="stringliteral">"    In four years, the Board and Alumni Association will review your progress"</span>;
00784 
00785                 <span class="comment">//                              context +=player_school.goal_deadline[PLAQUE_SILVER];</span>
00786                 <span class="comment">//                              context +=" years,";</span>
00787 
00788             }
00789             <span class="keywordflow">if</span>(scen_page_number==3) {
00790                 context =<span class="stringliteral">"as reflected in our teams' victories. By then, we want \</span>
00791 <span class="stringliteral">                                                        our teams to win more than 60% of their games. We would \</span>
00792 <span class="stringliteral">                                                        be especially pleased if they were \</span>
00793 <span class="stringliteral">                                                        then winning more than 60% in a higher NCAA Division. \</span>
00794 <span class="stringliteral">                                                        How will you achieve these goals and at what cost?"</span>;
00795 
00796                 <span class="comment">//                                      context ="we want our teams to win more than 60 percent of \ </span>
00797                 <span class="comment">//                                      their games. We would be especially pleased if they were then winning more than 60 \ </span>
00798                 <span class="comment">//                                      percent in a higher league.  How will you achieve these goals and at what cost?";</span>
00799             }
00800         }
00801         <span class="keywordflow">if</span>(player_school.scenario_id==<a class="code" href="Opschool_8h.html#a63a27">SCN_LIMIT_TUITION_GROWTH</a>) {
00802             <span class="keywordflow">if</span>(scen_page_number==1) {
00803                 context = <span class="stringliteral">"To : "</span>;
00804                 context += player_school.player_first_name;
00805                 context += <span class="stringliteral">" "</span>;
00806                 context += player_school.player_last_name;
00807                 context += <span class="stringliteral">", "</span>;
00808                 context += player_school.school_name;
00809 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00810 <span class="preprocessor"></span>                context += <span class="stringliteral">"           "</span>;
00811                 context += info.date_str_julian(letter_date);
00812 <span class="preprocessor">#else</span>
00813 <span class="preprocessor"></span>                context += <span class="stringliteral">"           September 1, "</span>;
00814                 context += m.format(info.game_year,16);
00815 <span class="preprocessor">#endif</span>
00816 <span class="preprocessor"></span>                context += <span class="stringliteral">"\nFrom : "</span>;
00817                 context += name_res.get_name_str(name_id1,name_id2,name_id3);
00818                 context += <span class="stringliteral">", Chair, Board of Trustees\n\n\n"</span>;
00819                 context +=<span class="stringliteral">"    The Board notes with alarm that our tuition has \</span>
00820 <span class="stringliteral">                                        escalated at a real rate of 3% per year. \</span>
00821 <span class="stringliteral">                                        Equal extravagance at other institutions does not relieve us \</span>
00822 <span class="stringliteral">                                        of our responsibility to lessen the burden on our students and \</span>
00823 <span class="stringliteral">                                        their parents. People will rebel if higher education continues to \</span>
00824 <span class="stringliteral">                                        be seen"</span>;
00825             }
00826             <span class="keywordflow">if</span>(scen_page_number==2) {
00827                 context =<span class="stringliteral">"as pushing aside their other needs.\n\n\</span>
00828 <span class="stringliteral">                                            Believing the time has come to take a stand, the Board notifies you of its firm policy \</span>
00829 <span class="stringliteral">                                        that our tuition shall not rise. In fact, the Board would like tuition to go down.\n\n\</span>
00830 <span class="stringliteral">                                            Until now the University has estimated the growth of nontuition revenue, funded new \</span>
00831 <span class="stringliteral">                                        programs, salary increases, and other costs, and then closed the gap by raising tuition. \</span>
00832 <span class="stringliteral">                                        You will now estimate tuition like "</span>;
00833             }
00834             <span class="keywordflow">if</span>(scen_page_number==3) {
00835                 context =<span class="stringliteral">"other revenue and close the gap by disciplining expenditures. The new \</span>
00836 <span class="stringliteral">                                        budgeting will strengthen internal financial discipline by forcing trade-offs \</span>
00837 <span class="stringliteral">                                        among competing expenditures.  Most important, tuition \</span>
00838 <span class="stringliteral">                                        reductions will make us accessible to a larger pool of talented students, thus \</span>
00839 <span class="stringliteral">                                        ensuring the worth and continuity of our university."</span>;
00840             }
00841         }
00842         <span class="keywordflow">if</span>(player_school.scenario_id==<a class="code" href="Opschool_8h.html#a63a28">SCN_COMPENSATE_FOR_ENROLLMENT_SHIFTS</a>) {
00843             <span class="comment">/*                  int yy1,yy2,yy3;</span>
00844 <span class="comment">                                //BUGHERE</span>
00845 <span class="comment">                                yy1=(int)(player_school.scenario_target[0]/SCN3_TARGET_MULTIPLIER);</span>
00846 <span class="comment">                                yy2=(int)(player_school.scenario_target[1]*SCN3_TARGET_MULTIPLIER);</span>
00847 <span class="comment">                                yy3=(int)(player_school.scenario_target[2]/SCN3_TARGET_MULTIPLIER);</span>
00848 <span class="comment">            */</span>
00849             <span class="keywordflow">if</span>(scen_page_number==1) {
00850                 context = <span class="stringliteral">"To : "</span>;
00851                 context += player_school.player_first_name;
00852                 context += <span class="stringliteral">" "</span>;
00853                 context += player_school.player_last_name;
00854                 context += <span class="stringliteral">", "</span>;
00855                 context += player_school.school_name;
00856 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00857 <span class="preprocessor"></span>                context += <span class="stringliteral">"           "</span>;
00858                 context += info.date_str_julian(letter_date);
00859 <span class="preprocessor">#else</span>
00860 <span class="preprocessor"></span>                context += <span class="stringliteral">"           September 1, "</span>;
00861                 context += m.format(info.game_year,16);
00862 <span class="preprocessor">#endif</span>
00863 <span class="preprocessor"></span>                context += <span class="stringliteral">"\nFrom : "</span>;
00864                 context += name_res.get_name_str(name_id1,name_id2,name_id3);
00865                 context += <span class="stringliteral">", Chair, Board of Trustees\n\n\n"</span>;
00866                 context +=<span class="stringliteral">"    Shifts of enrollment among departments have distorted course listings, overloaded some \</span>
00867 <span class="stringliteral">                                        teachers and buildings, and left others idle. These shifts leave some courses half-filled while \</span>
00868 <span class="stringliteral">                                        students are foreclosed from desired, overfilled courses. Some departments have \</span>
00869 <span class="stringliteral">                                        upped the proportion of lecture courses to accommodate increased student numbers."</span>;
00870             }
00871             <span class="keywordflow">if</span>(scen_page_number==2) {
00872 
00873                 context =<span class="stringliteral">"    Because the world has moved on and made a return to the previous pattern unlikely, the \</span>
00874 <span class="stringliteral">                                        Board shares the concern you expressed at our last meeting.  Going beyond describing \</span>
00875 <span class="stringliteral">                                        misalignments, however, how will you restructure \</span>
00876 <span class="stringliteral">                                        our academic programs and faculty resources to match today's needs?\</span>
00877 <span class="stringliteral">                                        \n\n    By the second semester of year "</span>;
00878 
00879                 context +=m.format(date.year(info.game_start_date)+player_school.goal_deadline[<a class="code" href="Opschool_8h.html#a64a35">PLAQUE_BRONZE</a>],4);
00880 
00881                 context +=<span class="stringliteral">", the Board expects educational quality to increase"</span>;
00882                 <span class="comment">//                              context +=m.format(yy1,1);</span>
00883                 <span class="comment">//                              context +=" to ";</span>
00884                 <span class="comment">//                              context +=m.format(player_school.scenario_target[0],1);</span>
00885                 context +=<span class="stringliteral">", course denials to decrease, and average"</span>;
00886             }
00887             <span class="keywordflow">if</span>(scen_page_number==3) {
00888                 <span class="comment">//                              context =" from ";</span>
00889                 <span class="comment">//                              context +=m.format(yy2,1);</span>
00890                 <span class="comment">//                              context +=" to ";</span>
00891                 <span class="comment">//                              context +=m.format(player_school.scenario_target[1],1);</span>
00892                 context =<span class="stringliteral">"teaching load hours to rise "</span>;
00893                 <span class="comment">//                              context +=m.format(yy3,1);</span>
00894                 <span class="comment">//                              context +=" to ";</span>
00895                 <span class="comment">//                              context +=m.format(player_school.scenario_target[2],1);</span>
00896                 context +=<span class="stringliteral">"substantially. What is your plan?"</span>;
00897             }
00898         }
00899         <span class="keywordflow">if</span>(player_school.scenario_id==<a class="code" href="Opschool_8h.html#a63a29">SCN_STUDENT_DIVERSITY</a>) {
00900             <span class="keywordflow">if</span>(scen_page_number==1) {
00901                 context = <span class="stringliteral">"To : "</span>;
00902                 context += player_school.player_first_name;
00903                 context += <span class="stringliteral">" "</span>;
00904                 context += player_school.player_last_name;
00905                 context += <span class="stringliteral">", "</span>;
00906                 context += player_school.school_name;
00907 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00908 <span class="preprocessor"></span>                context += <span class="stringliteral">"           "</span>;
00909                 context += info.date_str_julian(letter_date);
00910 <span class="preprocessor">#else</span>
00911 <span class="preprocessor"></span>                context += <span class="stringliteral">"           September 1, "</span>;
00912                 context += m.format(info.game_year,16);
00913 <span class="preprocessor">#endif</span>
00914 <span class="preprocessor"></span>                context += <span class="stringliteral">"\nFrom : "</span>;
00915                 context += name_res.get_name_str(name_id1,name_id2,name_id3);
00916                 context += <span class="stringliteral">", Chair, Board of Trustees\n\n\n"</span>;
00917                 context += <span class="stringliteral">"    The Board shares your concern about the scarcity of minorities among our students. \</span>
00918 <span class="stringliteral">                                        Further, because minorities are equally scarce among freshmen as among seniors, we see no \</span>
00919 <span class="stringliteral">                                        evidence that time will cure the problem. Instead, you must act \</span>
00920 <span class="stringliteral">                                        promptly to increase the number of minorities."</span>;
00921 
00922             }
00923             <span class="keywordflow">if</span>(scen_page_number==2) {
00924                 context += <span class="stringliteral">"    The Board sets your goal as boosting the number of minority students twofold in ten \</span>
00925 <span class="stringliteral">                                        years, that is, from "</span>;
00926                 context+=m.format(player_school.scenario_base,3);
00927                 context+=<span class="stringliteral">" to "</span>;
00928                 context+=m.format(player_school.scenario_target[0],3);
00929                 context += <span class="stringliteral">". At the same time, we expect this will make us \</span>
00930 <span class="stringliteral">                                        accessible to new pools of talented students, guaranteeing the worth and thus continuity \</span>
00931 <span class="stringliteral">                                        of our university."</span>;
00932             }
00933         }
00934         <span class="keywordflow">if</span>(player_school.scenario_id==<a class="code" href="Opschool_8h.html#a63a30">SCN_FACULTY_DIVERSITY</a>) {
00935             <span class="keywordflow">if</span>(scen_page_number==1) {
00936                 context = <span class="stringliteral">"To : "</span>;
00937                 context += player_school.player_first_name;
00938                 context += <span class="stringliteral">" "</span>;
00939                 context += player_school.player_last_name;
00940                 context += <span class="stringliteral">", "</span>;
00941                 context += player_school.school_name;
00942 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00943 <span class="preprocessor"></span>                context += <span class="stringliteral">"           "</span>;
00944                 context += info.date_str_julian(letter_date);
00945 <span class="preprocessor">#else</span>
00946 <span class="preprocessor"></span>                context += <span class="stringliteral">"           September 1, "</span>;
00947                 context += m.format(info.game_year,16);
00948 <span class="preprocessor">#endif</span>
00949 <span class="preprocessor"></span>                context += <span class="stringliteral">"\nFrom : "</span>;
00950                 context += name_res.get_name_str(name_id1,name_id2,name_id3);
00951                 context += <span class="stringliteral">", Chair, Board of Trustees\n\n\n"</span>;
00952                 context += <span class="stringliteral">"    At our last meeting, you told the Board your concern about the few minorities and \</span>
00953 <span class="stringliteral">                                        women on the faculty. We agree heartily and expect the shortfall to be redressed \</span>
00954 <span class="stringliteral">                                        promptly.\n\n"</span>;
00955                 context += <span class="stringliteral">"    You told us the University has about the same underrepresentation"</span>;
00956             }
00957             <span class="keywordflow">if</span>(scen_page_number==2) {
00958                 context=<span class="stringliteral">"in all \</span>
00959 <span class="stringliteral">                                        fields, and that minorities are even more underrepresented than women are. The scarcity of \</span>
00960 <span class="stringliteral">                                        minorities and women among young as well as old faculty shows the problem will not \</span>
00961 <span class="stringliteral">                                        correct itself.\n\n    The Board sets your goal as boosting minority representation by \</span>
00962 <span class="stringliteral">                                        50% in five years."</span>;
00963                 <span class="comment">//                              : that \ </span>
00964                 <span class="comment">//                                      is, from ";</span>
00965 
00966                 <span class="comment">//                              context+=m.format(player_school.scenario_target[0]/1.5f,3);</span>
00967                 <span class="comment">//                              context+=" to ";</span>
00968                 <span class="comment">//                              context+=m.format(player_school.scenario_target[0],3);</span>
00969                 context+=<span class="stringliteral">". For women, the goal is a 25% increase in five years."</span>;
00970                 <span class="comment">//: from ";</span>
00971                 <span class="comment">//                              context+=m.format(player_school.scenario_target[1]/1.25f,3);</span>
00972                 <span class="comment">//                              context+=" to ";</span>
00973                 <span class="comment">//                              context+=m.format(player_school.scenario_target[1],3);</span>
00974 
00975             }
00976             <span class="keywordflow">if</span>(scen_page_number==3) {
00977                 context=<span class="stringliteral">"    We ask how you will accomplish these goals and with what change \</span>
00978 <span class="stringliteral">                                        in budget and staff size. At the same time, we expect the enhanced representation of women \</span>
00979 <span class="stringliteral">                                        and minorities on the faculty to enrich all aspects of university life."</span>;
00980             }
00981         }
00982 
00983         font_letter.put_paragraph(180,190,670,440,context.str_buf);
00984         <a class="code" href="classString.html">String</a> pagestr;
00985         pagestr = scen_page_number;
00986         pagestr += <span class="stringliteral">"/"</span>;
00987         pagestr += max_scen_page_number;
00988         font_letter.put(680,vtab4+20,pagestr.<a class="code" href="classString.html#m0">str_buf</a>);
00989 
00990         button_back.<a class="code" href="classButton.html#a20">paint</a>();
00991         <span class="keywordflow">if</span>(scen_page_number&lt;=1)button_pgup.<a class="code" href="classButton.html#a26">disable</a>();
00992         <span class="keywordflow">if</span>(scen_page_number&gt;=max_scen_page_number)button_pgdn.<a class="code" href="classButton.html#a26">disable</a>();
00993 
00994         button_pgup.<a class="code" href="classButton.html#a20">paint</a>();
00995         button_pgdn.<a class="code" href="classButton.html#a20">paint</a>();
00996 
00997         <span class="keywordflow">if</span>(refreshFlag != <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>)
00998             vga.blt_buf(180,190,670,440);
00999     }
01000     <span class="comment">//------- blt the back buffer to front buffer -------//</span>
01001 
01002     <span class="keywordflow">if</span>(refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>)
01003         vga.blt_buf(<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>, <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>);
01004 
01005     vga.use_front();
01006 }
01007 
<a name="l01008"></a><a class="code" href="classLetter.html#a9">01008</a> <span class="keywordtype">int</span> <a class="code" href="classLetter.html#a9">Letter::scen_welcome_letter_detect</a>() {
01009     <span class="keywordflow">if</span> (!letter_report_init_flag)
01010         <span class="keywordflow">return</span> 0;
01011     vga.use_front();
01012     <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m2">scen_page_number</a>&lt;max_scen_page_number)
01013         <span class="keywordflow">if</span>(button_pgdn.<a class="code" href="classButton.html#a21">detect</a>()) {
01014             <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m2">scen_page_number</a>&lt;max_scen_page_number)
01015                 <a class="code" href="classLetter.html#m2">scen_page_number</a>++;
01016             sys.redraw_all_flag=1;
01017         };
01018 
01019     <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m2">scen_page_number</a>&gt;1)
01020         <span class="keywordflow">if</span>(button_pgup.<a class="code" href="classButton.html#a21">detect</a>()) {
01021             <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m2">scen_page_number</a>&gt;1)
01022                 <a class="code" href="classLetter.html#m2">scen_page_number</a>--;
01023             sys.redraw_all_flag=1;
01024         };
01025 
01026     <span class="keywordflow">if</span>(button_back.<a class="code" href="classButton.html#a21">detect</a>()   ||
01027        (m.upper(mouse.is_key(mouse.scan_code, mouse.event_skey_state, (<a class="code" href="OCOLTBL_8H.html#a2">WORD</a>) 0, <a class="code" href="OMOUSE2_8H.html#a15a14">K_UNIQUE_KEY</a>))==<span class="charliteral">'W'</span>)) {
01028         <a class="code" href="classLetter.html#m2">scen_page_number</a>=1;
01029         old_scen_page_number=-1;
01030         <span class="keywordflow">if</span>(sys.save_view_mode!=<a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a>) {
01031             sys.set_staying_view_mode(0);
01032             sys.set_view_mode(<a class="code" href="Osys_8h.html#a45a9">MODE_NORMAL</a>);
01033         }
01034         <span class="keywordflow">else</span> {
01035             sys.set_staying_view_mode(<a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a>);
01036         }
01037         <span class="keywordflow">return</span> 1;
01038     }
01039     <span class="keywordflow">return</span> 0;
01040 }
01041 
01043 
<a name="l01044"></a><a class="code" href="Oletter_8cpp.html#a43">01044</a> <span class="keywordtype">int</span> <a class="code" href="Oletter_8cpp.html#a43">compare_ascend</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *arg1,<span class="keyword">const</span> <span class="keywordtype">void</span> *arg2) {
01045     <span class="keywordtype">float</span> p,q;
01046 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01047 <span class="preprocessor"></span>    p=((<span class="keyword">struct </span><a class="code" href="structSortData.html">SortData</a>*)arg1)-&gt;strength;
01048     q=((<span class="keyword">struct </span><a class="code" href="structSortData.html">SortData</a>*)arg2)-&gt;strength;
01049 <span class="preprocessor">#else</span>
01050 <span class="preprocessor"></span>    p=((<span class="keyword">struct </span><a class="code" href="structSortData.html">SortData</a>*)arg1)-&gt;data;
01051     q=((<span class="keyword">struct </span><a class="code" href="structSortData.html">SortData</a>*)arg2)-&gt;data;
01052 <span class="preprocessor">#endif</span>
01053 <span class="preprocessor"></span>
01054     <span class="keywordflow">if</span>(p&lt;q)<span class="keywordflow">return</span> -1;
01055     <span class="keywordflow">if</span>(p&gt;q)<span class="keywordflow">return</span> 1;
01056     <span class="keywordflow">return</span> 0;
01057 };
01058 
<a name="l01059"></a><a class="code" href="Oletter_8cpp.html#a44">01059</a> <span class="keywordtype">int</span> <a class="code" href="Oletter_8cpp.html#a44">compare_descend</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *arg1,<span class="keyword">const</span> <span class="keywordtype">void</span> *arg2) {
01060     <span class="keywordtype">float</span> p,q;
01061 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01062 <span class="preprocessor"></span>    p=((<span class="keyword">struct </span><a class="code" href="structSortData.html">SortData</a>*)arg1)-&gt;strength;
01063     q=((<span class="keyword">struct </span><a class="code" href="structSortData.html">SortData</a>*)arg2)-&gt;strength;
01064 <span class="preprocessor">#else</span>
01065 <span class="preprocessor"></span>    p=((<span class="keyword">struct </span><a class="code" href="structSortData.html">SortData</a>*)arg1)-&gt;data;
01066     q=((<span class="keyword">struct </span><a class="code" href="structSortData.html">SortData</a>*)arg2)-&gt;data;
01067 <span class="preprocessor">#endif</span>
01068 <span class="preprocessor"></span>
01069     <span class="keywordflow">if</span>(p&gt;q)<span class="keywordflow">return</span> -1;
01070     <span class="keywordflow">if</span>(p&lt;q)<span class="keywordflow">return</span> 1;
01071     <span class="keywordflow">return</span> 0;
01072 };
01073 
01074 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01075 <span class="preprocessor"></span><span class="keywordtype">int</span> sort_consistency(<span class="keyword">const</span> <span class="keywordtype">void</span> *arg1, <span class="keyword">const</span> <span class="keywordtype">void</span> *arg2) {
01076     <span class="keywordtype">float</span> p,q;
01077 
01078     p=((<span class="keyword">struct </span><a class="code" href="structSortData.html">SortData</a>*)arg1)-&gt;consistency;
01079     q=((<span class="keyword">struct </span><a class="code" href="structSortData.html">SortData</a>*)arg2)-&gt;consistency;
01080 
01081     <span class="keywordflow">if</span>(p&gt;q)<span class="keywordflow">return</span> -1;
01082     <span class="keywordflow">if</span>(p&lt;q)<span class="keywordflow">return</span> 1;
01083     <span class="keywordflow">return</span> 0;
01084 }
01085 <span class="preprocessor">#endif</span>
01086 <span class="preprocessor"></span>
01087 <span class="comment">//---------- Begin of function Letter::welcome_letter_report ------------//</span>
<a name="l01088"></a><a class="code" href="classLetter.html#a7">01088</a> <span class="keywordtype">void</span> <a class="code" href="classLetter.html#a7">Letter::welcome_letter_report</a>(<span class="keywordtype">int</span> refreshFlag) {
01089     <span class="keywordtype">int</span> tab1=<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>,tab2=<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>+70,
01090         tab3=<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>+100,tab4=<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>+700;
01091     <span class="keywordtype">int</span> vtab1=<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>+20,vtab2=<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>+70,
01092         vtab3=<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>+100,vtab4=<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>+350;
01093 
01094     vga.use_back();
01095 
01096     <span class="keywordflow">if</span> (refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>) {
01097         <span class="keywordflow">if</span>(letter_report_init_flag )
01098             <a class="code" href="classLetter.html#a5">deinit</a>();
01099 
01100         <span class="comment">//------------- paint the background ----------------//</span>
01101         <span class="keywordflow">if</span> (!letter_report_init_flag) {
01102             sys.set_speed(0);
01103             user_interface.bg_img(<a class="code" href="Oletter_8cpp.html#a48a37">BG_PIC_ID</a>, &amp;vga_back);
01104 
01105             font_letter.center_put(<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>+50,<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>,<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>+680,<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>+20,<span class="stringliteral">"Welcome Letter "</span>);
01106 
01107             letter_report_init_flag = 1;
01108             button_back.<a class="code" href="classButton.html#a10">create_text</a>(350,vtab4+7,450,vtab4+28,<span class="stringliteral">"Proceed"</span>);
01109             button_pgup.<a class="code" href="classButton.html#a10">create_text</a>(570,vtab4-10,660,vtab4+13,<span class="stringliteral">"Prev. page"</span>);
01110             button_pgdn.<a class="code" href="classButton.html#a10">create_text</a>(570,vtab4+15,660,vtab4+38,<span class="stringliteral">"Next page"</span>);
01111         }
01112     }
01113     <span class="keywordflow">else</span> {
01114         vga.use_back();
01115     }
01116 
01117     <span class="keywordflow">if</span>((<a class="code" href="classLetter.html#m1">welcome_page_number</a>!=old_welcome_page_number)||(refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>)) {
01118         old_welcome_page_number=<a class="code" href="classLetter.html#m1">welcome_page_number</a>;
01119         <a class="code" href="classString.html">String</a> context;
01120 
01121         <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m1">welcome_page_number</a>==1) {
01122             context = <span class="stringliteral">"To      :    "</span>;
01123             context += player_school.player_first_name;
01124             context += <span class="stringliteral">" "</span>;
01125             context += player_school.player_last_name;
01126             context += <span class="stringliteral">"\n"</span>;
01127 
01128             context += <span class="stringliteral">"              President, "</span>;
01129             context += player_school.school_name;
01130             context += <span class="stringliteral">"\n"</span>;
01131 
01132             context += <span class="stringliteral">"From  :    "</span>;
01133             context += name_res.get_name_str(name_id1,name_id2,name_id3);
01134             context += <span class="stringliteral">"\n"</span>;
01135 
01136             context += <span class="stringliteral">"              Chair, Board of Trustees"</span>,
01137                 context += <span class="stringliteral">"\n"</span>;
01138 
01139 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01140 <span class="preprocessor"></span>            context += <span class="stringliteral">"Date   :    "</span>;
01141             context += info.date_str_julian(letter_date);
01142 <span class="preprocessor">#else</span>
01143 <span class="preprocessor"></span>            context += <span class="stringliteral">"Date   :    September 1, "</span>;
01144             context +=m.format(info.game_year,16);
01145 <span class="preprocessor">#endif</span>
01146 <span class="preprocessor"></span>            context += <span class="stringliteral">"\n"</span>;
01147             context += <span class="stringliteral">"\n"</span>;
01148 
01149             context +=<span class="stringliteral">"Dear President "</span>;
01150             context +=player_school.player_last_name;
01151             font_letter.put_paragraph(185,120,670,250,context.<a class="code" href="classString.html#m0">str_buf</a>);
01152 
01153             context =<span class="stringliteral">"    Welcome to "</span>;
01154             context +=player_school.school_name;
01155             context +=<span class="stringliteral">". The Board is pleased to have as distinguished a person as yourself as our new president.\n\n"</span>;
01156             context +=<span class="stringliteral">"    The University has "</span>;
01157             context +=m.format(department_array.department_count,4);
01158             context +=<span class="stringliteral">" departments with "</span>;
01159             context +=m.format(department_array_faculty_level_history_FT,4);
01160             context +=<span class="stringliteral">" faculty members. We enroll "</span>;
01161             context +=m.format(enroll_res_total_student_count,4);
01162             context +=<span class="stringliteral">" students and have "</span>;
01163             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=department_array.size(), totalDollar=0; i&gt;0; i--) {
01164                 <span class="keywordflow">if</span> (department_array.is_deleted(i))
01165                     <span class="keywordflow">continue</span>;
01166                 <span class="comment">// fix in ver 2</span>
01167                 <span class="comment">//totalDollar += department_array_total_research_dollar[i];</span>
01168                 totalDollar += department_array_total_research_dollar[i-1];
01169             }
01170             context +=m.format(totalDollar,2);
01171             context +=<span class="stringliteral">" thousands of sponsored research expenditures monthly. The breakdown by departments is as follows :"</span>;
01172             <span class="comment">//                  context +=m.format(department_res_general_dept_student_level_historyMT,4);</span>
01173             <span class="comment">//                  context +=" students have yet to declare a major)";</span>
01174             <span class="comment">//                  context +="\n";</span>
01175             font_letter.put_paragraph(185,250,670,420,context.<a class="code" href="classString.html#m0">str_buf</a>);
01176         }
01177         <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m1">welcome_page_number</a>==2) {
01178             <span class="keywordtype">int</span> list_tab1=185;
01179             <span class="keywordtype">int</span> list_tab2=500;
01180             <span class="keywordtype">int</span> list_tab3=580;
01181             <span class="keywordtype">int</span> list_tab4=660;
01182             <span class="keywordtype">int</span> list_start_y=130;
01183             <span class="keywordtype">int</span> list_line_spacing=290/(1+department_array.size());
01184 
01185             font_letter.put(list_tab2-50,list_start_y,<span class="stringliteral">"Faculty"</span>);
01186             font_letter.put(list_tab3-50,list_start_y,<span class="stringliteral">"Students"</span>);
01187             font_letter.put(list_tab4-50,list_start_y,<span class="stringliteral">"Research"</span>);
01188 
01189             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;=department_array.size();i++) {
01190                 <span class="keywordflow">if</span>(!department_array.is_deleted(i)) {
01191                     <span class="keywordtype">int</span> y=list_start_y+i*list_line_spacing;
01192                     <a class="code" href="classString.html">String</a> tmp;
01193                     tmp=department_array[i]-&gt;name();
01194                     tmp.<a class="code" href="classString.html#m0">str_buf</a>[tmp.<a class="code" href="classString.html#a5">len</a>()-10]=<span class="charliteral">'\0'</span>;
01195                     font_letter.put(list_tab1,y,tmp.<a class="code" href="classString.html#m0">str_buf</a>);
01196                     <span class="comment">// fix in ver 2</span>
01197                     <span class="comment">//font_letter.right_put(list_tab2,y,m.format(department_array_faculty_array_faculty_count[i],4));</span>
01198                     <span class="comment">//font_letter.right_put(list_tab3,y,m.format(department_array_student_array_student_count[i],4));</span>
01199                     <span class="comment">//font_letter.right_put(list_tab4,y,m.format(department_array_total_research_dollar[i],2));</span>
01200                     font_letter.right_put(list_tab2,y,m.format(department_array_faculty_array_faculty_count[i-1],4));
01201                     font_letter.right_put(list_tab3,y,m.format(department_array_student_array_student_count[i-1],4));
01202                     font_letter.right_put(list_tab4,y,m.format(department_array_total_research_dollar[i-1],2));
01203                 }
01204             }
01205         }
01206         <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m1">welcome_page_number</a>==3) {
01207             context =<span class="stringliteral">"    Traditional undergraduates number "</span>;
01208             context +=m.format(enroll_res_student_count_UG_TRADITION,4);
01209             context +=<span class="stringliteral">", of which "</span>;
01210             context +=m.format(student_office_percent_demanding_places_sl1,3);
01211             context +=<span class="stringliteral">" live in on-campus residence halls"</span>;
01212             context +=<span class="stringliteral">" and "</span>;
01213             context +=m.format(department_res_general_dept_student_array_student_count,4);
01214             context +=<span class="stringliteral">" have yet to declare a major."</span>;
01215 
01216             context +=<span class="stringliteral">" About "</span>;
01217             context +=m.format(10 * school_res_player_peer_school_percent_get_bacc_in_5_year,3);
01218             context +=<span class="stringliteral">" graduate within five years. The University receives "</span>;
01219             <span class="comment">//                  context +=m.format(enroll_res_applications_rate_UG_TRADITION,4);                //### fred 1127  //## chea081099</span>
01220             <span class="comment">//### fred 1127  //## chea081099</span>
01221             context +=m.format(enroll_res_applications_rate_UG_TRADITION,26);
01222             context +=<span class="stringliteral">" applications for every traditional undergraduate space. An additional "</span>;
01223             context +=m.format(enroll_res_student_count_UG_NONTRADITION,4);
01224             <span class="comment">//                  context +=m.format(enroll_res_student_count_UG_TRADITION,4);</span>
01225             context +=<span class="stringliteral">" students attend part-time "</span>;
01226             context +=<span class="stringliteral">" (nontraditional undergraduates) and "</span>;
01227             context +=m.format(enroll_res_student_count_DISTANCE_LEARN,4);
01228             context +=<span class="stringliteral">" students enroll as distance learners."</span>;
01229             context +=<span class="stringliteral">" About "</span>;
01230             context +=m.format(enroll_res_overall_percent_minority,3);
01231             context +=<span class="stringliteral">" of students are minorities and "</span>;
01232             context +=m.format(enroll_res_overall_percent_female,3);
01233             context +=<span class="stringliteral">" are women."</span>;
01234             context +=<span class="stringliteral">" We have "</span>,
01235                 context +=m.format(enroll_res_student_count_MASTER,4);
01236             context +=<span class="stringliteral">" master's students and "</span>;
01237             context +=m.format(enroll_res_student_count_DOCTOR,4);
01238             context +=<span class="stringliteral">" doctoral students. "</span>,
01239                 font_letter.put_paragraph(185,160,670,340,context.<a class="code" href="classString.html#m0">str_buf</a>);
01240 
01241             <span class="comment">//                  font_letter.put_paragraph(185,340,670,400,context.str_buf);</span>
01242         }
01243         <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m1">welcome_page_number</a>==4) {
01244             context =<span class="stringliteral">"    Of our "</span>;
01245             context +=m.format(department_array_faculty_level_history_FT,4);
01246             context +=<span class="stringliteral">" faculty members, "</span>;
01247             <span class="comment">//        context +=m.format(department_array_faculty_count_on_tenure_line,1);</span>
01248             <span class="comment">//## chea 110809 change by b.massy</span>
01249             context +=m.format(department_array_faculty_count_on_tenure_line,0);
01250 
01251             context +=<span class="stringliteral">" are on the tenure line and "</span>;
01252             <span class="comment">//                  context +=m.format(department_array_faculty_count_tenured,1);</span>
01253             <span class="comment">//## chea 110809 change by b.massy</span>
01254             context +=m.format(department_array_faculty_count_tenured,0);
01255 
01256             context +=<span class="stringliteral">" are tenured. "</span>;
01257             <span class="comment">/*</span>
01258 <span class="comment">              context +=" We believe the tenure-line faculty scores at the ";</span>
01259 <span class="comment">              context +=m.format(department_array.faculty_rank_in_research_talent,1);;</span>
01260 <span class="comment">              context +="th";</span>
01261 <span class="comment">              context +=" percentile nationally in research talent and the ";</span>
01262 <span class="comment">              context +=m.format(department_array.faculty_rank_in_scholarship_talent,1);</span>
01263 <span class="comment">              context +="th";</span>
01264 <span class="comment">              context +=" percentile in scholarly talent, and that our whole faculty scores at the ";</span>
01265 <span class="comment">              context +=m.format(department_array.faculty_rank_in_teaching_talent,1);</span>
01266 <span class="comment">              context +="th";</span>
01267 <span class="comment">              context +=" percentile in teaching talent. ";</span>
01268 <span class="comment">            */</span>
01269             context +=<span class="stringliteral">"About "</span>;
01270             <span class="keywordtype">int</span> percentMinor = (department_array_faculty_gender_history_MINORITY_MALE_HISTORY_YEAR_COUNT_1+
01271                                 department_array_faculty_gender_history_MINORITY_FEMALE_HISTORY_YEAR_COUNT_1) * 100
01272                 / department_array_faculty_gender_history_GENDER_ETHNIC_TYPE_COUNT_N_TOTAL_1_HISTORY_YEAR_COUNT_1;
01273 
01274             <span class="keywordtype">int</span> percentFemale = (department_array_faculty_gender_history_MINORITY_FEMALE_HISTORY_YEAR_COUNT_1+
01275                                  department_array_faculty_gender_history_NONMINORITY_FEMALE_HISTORY_YEAR_COUNT_1) * 100
01276                 / department_array_faculty_gender_history_GENDER_ETHNIC_TYPE_COUNT_N_TOTAL_1_HISTORY_YEAR_COUNT_1;
01277 
01278             context +=m.format(percentMinor,3);
01279             context +=<span class="stringliteral">" of faculty are minorities and "</span>;
01280             context +=m.format(percentFemale,3);
01281             context +=<span class="stringliteral">" are women."</span>;
01282             context +=<span class="stringliteral">"\n\n"</span>;
01283             context +=<span class="stringliteral">"  The University's men's football and women's basketball teams compete at the Division level "</span>;
01284 
01285             <span class="keywordflow">if</span>(player_school_athletic_program_intensity==<a class="code" href="Gamedef_8h.html#a73a24">INPUT_HIGH</a>)
01286                 context +=<span class="stringliteral">"I"</span>;
01287             <span class="keywordflow">if</span>(player_school_athletic_program_intensity==<a class="code" href="Gamedef_8h.html#a73a23">INPUT_MEDIUM</a>)
01288                 context +=<span class="stringliteral">"II"</span>;
01289             <span class="keywordflow">if</span>(player_school_athletic_program_intensity==<a class="code" href="Gamedef_8h.html#a73a22">INPUT_LOW</a>)
01290                 context +=<span class="stringliteral">"III"</span>;
01291 
01292             context +=<span class="stringliteral">". Last year's win/loss records were "</span>;
01293 
01294             <span class="comment">// Athletics *off = &amp;athletics_office;</span>
01295 
01296             <span class="keywordtype">int</span> winCount, lossCount;
01297 
01298             winCount = int(off_football_probability_win * off_football_game_count_off_ncaa_level_input);
01299             lossCount = int(off_football_game_count_off_ncaa_level_input - winCount);
01300             context +=m.format(winCount,1);
01301             context +=<span class="stringliteral">"-"</span>;
01302             context +=m.format(lossCount,1);
01303             context +=<span class="stringliteral">" and "</span>;
01304 
01305             winCount = int(off_basketball_probability_win * off_basketball_game_count_off_ncaa_level_input);
01306             lossCount = int(off_basketball_game_count_off_ncaa_level_input - winCount);
01307             context +=m.format(winCount,1);
01308             context +=<span class="stringliteral">"-"</span>;
01309             context +=m.format(lossCount,1);
01310             context +=<span class="stringliteral">", respectively."</span>;
01311             font_letter.put_paragraph(185,180,670,420,context.<a class="code" href="classString.html#m0">str_buf</a>);
01312         }
01313 
01314         <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m1">welcome_page_number</a>==5) {
01315             <span class="comment">/*  </span>
01316 <span class="comment">                "",</span>
01317 <span class="comment">                "",</span>
01318 <span class="comment">                "",</span>
01319 <span class="comment">                "We will be watching these areas with special care during the years ahead.",</span>
01320 <span class="comment"></span>
01321 <span class="comment">                "The Board is counting on you and we wish you every success.",</span>
01322 <span class="comment">                "",</span>
01323 <span class="comment">                "We also want you to consider the following",</span>
01324 <span class="comment">            */</span>
01325             <span class="comment">//                  context="";</span>
01326 
01327             <span class="keywordtype">int</span> surplusDeficit = (int)finance_last_year_surplus_deficit;
01328 
01329             <span class="keywordflow">if</span>(surplusDeficit!=0) {
01330                 context= <span class="stringliteral">"    Last year the University's budget was in the "</span>;
01331                 <span class="keywordflow">if</span>(finance_last_year_surplus_deficit&lt;0)
01332                     context+=<span class="stringliteral">"red "</span>;
01333                 <span class="keywordflow">else</span>
01334                     context+=<span class="stringliteral">"black "</span>;
01335 
01336                 context+=<span class="stringliteral">"by "</span>;
01337 
01338                 <span class="keywordflow">if</span>(surplusDeficit&lt;0) {
01339                     context+=m.format(-surplusDeficit,2);
01340                 }
01341                 <span class="keywordflow">else</span> {
01342                     context+=m.format(surplusDeficit,2);
01343                 }
01344 
01345                 context += <span class="stringliteral">" thousand ("</span>;
01346 
01347                 <span class="keywordflow">if</span>(surplusDeficit&lt;0)                      <span class="comment">//## chea 110899 change by b.massy</span>
01348                     context+=m.format((<span class="keywordtype">float</span>)-surplusDeficit * 100 / finance_total_expense_total,24);
01349                 <span class="keywordflow">else</span>
01350                     context+=m.format((<span class="keywordtype">float</span>)surplusDeficit * 100 / finance_total_expense_total,24);
01351 
01352                 context += <span class="stringliteral">" of expenditures). "</span>;
01353             }
01354 
01355             <span class="keywordtype">double</span> test_surplus=finance_total_expense_total/finance_last_year_surplus_deficit;
01356             <span class="keywordflow">if</span>(test_surplus==0.0)<span class="keywordflow">return</span>;
01357             <span class="keywordflow">if</span>(test_surplus&lt;-0.25)
01358                 context+=<span class="stringliteral">"The Board hopes you will correct this weak financial performance."</span>;
01359             <span class="keywordflow">if</span>(test_surplus&gt;0.0)
01360                 context+=<span class="stringliteral">"The Board hopes you will maintain this kind of strong financial performance."</span>;
01361             <span class="keywordflow">else</span>
01362                 context+=<span class="stringliteral">""</span>;
01363 
01364             font_letter.put_paragraph(185,170,670,240,context.<a class="code" href="classString.html#m0">str_buf</a>);
01365 
01366             context=<span class="stringliteral">"    The Board is counting on you and we wish you every success."</span>;
01367             font_letter.put_paragraph(185,250,670,420,context.<a class="code" href="classString.html#m0">str_buf</a>);
01368         }
01369 
01370         <a class="code" href="classString.html">String</a> pagestr;
01371         pagestr = <a class="code" href="classLetter.html#m1">welcome_page_number</a>;
01372         pagestr += <span class="stringliteral">"/"</span>;
01373         pagestr += max_welcome_page_number;
01374         font_letter.put(680,vtab4+20,pagestr.<a class="code" href="classString.html#m0">str_buf</a>);
01375 
01376         button_back.<a class="code" href="classButton.html#a20">paint</a>();
01377         <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m1">welcome_page_number</a>&lt;=1)button_pgup.<a class="code" href="classButton.html#a26">disable</a>();
01378         <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m1">welcome_page_number</a>&gt;=max_welcome_page_number)button_pgdn.<a class="code" href="classButton.html#a26">disable</a>();
01379 
01380         button_pgup.<a class="code" href="classButton.html#a20">paint</a>();
01381         button_pgdn.<a class="code" href="classButton.html#a20">paint</a>();
01382 
01383         <span class="keywordflow">if</span>(refreshFlag != <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>)
01384             vga.blt_buf(185,140,670,420);
01385         <span class="comment">//              vga.blt_buf(350,vtab4+10,450,vtab4+28);</span>
01386         <span class="comment">//              vga.blt_buf(570,vtab4-10,660,vtab4+13);</span>
01387         <span class="comment">//              vga.blt_buf(570,vtab4+15,660,vtab4+38);</span>
01388     }
01389     <span class="comment">//------- blt the back buffer to front buffer -------//</span>
01390 
01391     <span class="keywordflow">if</span>(refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>)
01392         vga.blt_buf(<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>, <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>);
01393 
01394     vga.use_front();
01395 }
01396 
01397 <span class="comment">//---------- End of function Letter::welcome_letter_report ------------//</span>
01398 
01399 <span class="comment">//---------- End of function Letter::welcome_letter_detect ------------//</span>
<a name="l01400"></a><a class="code" href="classLetter.html#a10">01400</a> <span class="keywordtype">int</span> <a class="code" href="classLetter.html#a10">Letter::welcome_letter_detect</a>() {
01401     <span class="keywordflow">if</span> (!letter_report_init_flag)
01402         <span class="keywordflow">return</span> 0;
01403     vga.use_front();
01404     <span class="comment">//  letter_browser.detect();</span>
01405     <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m1">welcome_page_number</a>&lt;max_welcome_page_number)
01406         <span class="keywordflow">if</span>(button_pgdn.<a class="code" href="classButton.html#a21">detect</a>()) {
01407             <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m1">welcome_page_number</a>&lt;max_welcome_page_number)
01408                 <a class="code" href="classLetter.html#m1">welcome_page_number</a>++;
01409             sys.redraw_all_flag=1;
01410         };
01411 
01412     <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m1">welcome_page_number</a>&gt;1)
01413         <span class="keywordflow">if</span>(button_pgup.<a class="code" href="classButton.html#a21">detect</a>()) {
01414             <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m1">welcome_page_number</a>&gt;1)
01415                 <a class="code" href="classLetter.html#m1">welcome_page_number</a>--;
01416             sys.redraw_all_flag=1;
01417         };
01418 
01419     <span class="keywordflow">if</span>(button_back.<a class="code" href="classButton.html#a21">detect</a>()) {
01420         <a class="code" href="classLetter.html#m1">welcome_page_number</a>=1;
01421         old_welcome_page_number=-1;
01422         <span class="keywordflow">if</span>(sys.save_view_mode!=<a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a>) {
01423             sys.set_staying_view_mode(0);
01424             sys.set_speed(sys.save_speed);
01425             sys.set_view_mode(<a class="code" href="Osys_8h.html#a45a9">MODE_NORMAL</a>);
01426             sys.save_view_mode=<a class="code" href="Osys_8h.html#a45a9">MODE_NORMAL</a>;
01427         }
01428         <span class="keywordflow">else</span>
01429             sys.set_staying_view_mode(<a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a>);
01430         <span class="keywordflow">return</span> 1;
01431     }
01432 
01433     <span class="keywordflow">if</span>(m.upper(mouse.is_key(mouse.scan_code, mouse.event_skey_state, (<a class="code" href="OCOLTBL_8H.html#a2">WORD</a>) 0, <a class="code" href="OMOUSE2_8H.html#a15a14">K_UNIQUE_KEY</a>))==<span class="charliteral">'W'</span>) {
01434         <a class="code" href="classLetter.html#m1">welcome_page_number</a>=1;
01435         old_welcome_page_number=-1;
01436         <span class="keywordflow">if</span>(sys.save_view_mode!=<a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a>) {
01437             sys.set_staying_view_mode(0);
01438             sys.view_mode=<a class="code" href="Osys_8h.html#a45a33">MODE_WELCOME_LETTER</a>;
01439             sys.save_view_mode=<a class="code" href="Osys_8h.html#a45a9">MODE_NORMAL</a>;
01440         }
01441         <span class="keywordflow">else</span>
01442             sys.set_staying_view_mode(<a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a>);
01443         <span class="keywordflow">return</span> 1;
01444     }
01445     <span class="keywordflow">return</span> 0;
01446 }
01447 
01448 <span class="comment">//---------- End of function Letter::welcome_letter_detect ------------//</span>
01449 
01451 
01452 <span class="comment">//---------- Begin of function Letter::eval_letter_report ------------//</span>
<a name="l01453"></a><a class="code" href="classLetter.html#a8">01453</a> <span class="keywordtype">void</span> <a class="code" href="classLetter.html#a8">Letter::eval_letter_report</a>(<span class="keywordtype">int</span> refreshFlag) {
01454     <span class="keywordtype">int</span> tab1=<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>,tab2=<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>+70,
01455         tab3=<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>+100,tab4=<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>+700;
01456     <span class="keywordtype">int</span> vtab1=<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>+20,vtab2=<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>+70,
01457         vtab3=<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>+100,vtab4=<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>+350;
01458 
01459     vga.use_back();
01460 
01461     <span class="keywordflow">if</span> (refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>) {
01462         <span class="keywordflow">if</span>(letter_report_init_flag )
01463             <a class="code" href="classLetter.html#a5">deinit</a>();
01464 
01465         <span class="comment">//------------- paint the background ----------------//</span>
01466         <span class="keywordflow">if</span> (!letter_report_init_flag) {
01467             sys.set_speed(0);
01468             user_interface.bg_img(<a class="code" href="Oletter_8cpp.html#a48a37">BG_PIC_ID</a>, &amp;vga_back);
01469 
01470             font_letter.center_put(<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>+50,<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>,<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>+680,<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>+20,<span class="stringliteral">"Evaluation Letter "</span>);
01471 
01472             letter_report_init_flag = 1;
01473             button_back.<a class="code" href="classButton.html#a10">create_text</a>(350,vtab4+7,450,vtab4+28,<span class="stringliteral">"Proceed"</span>);
01474             button_pgup.<a class="code" href="classButton.html#a10">create_text</a>(570,vtab4-10,660,vtab4+13,<span class="stringliteral">"Prev. page"</span>);
01475             button_pgdn.<a class="code" href="classButton.html#a10">create_text</a>(570,vtab4+15,660,vtab4+38,<span class="stringliteral">"Next page"</span>);
01476         }
01477     }
01478     <span class="keywordflow">else</span> {
01479         vga.use_back();
01480     }
01481 
01482     <span class="keywordflow">if</span>( <a class="code" href="classLetter.html#m0">eval_page_number</a> &gt; max_eval_page_number )
01483         <a class="code" href="classLetter.html#m0">eval_page_number</a> = max_eval_page_number;
01484 
01485     <span class="comment">//----------------------------------------------//</span>
01486 
01487     <span class="keywordflow">if</span>((<a class="code" href="classLetter.html#m0">eval_page_number</a>!=old_eval_page_number)||(refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>)) {
01488         <span class="comment">//--- recalculate the # of pages it has ----//</span>
01489 
01490 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01491 <span class="preprocessor"></span>        max_eval_page_number = 1 + eval_letter_show_poor_area(1) + eval_letter_show_good_area(1) + eval_letter_show_mixed_area(1);
01492 <span class="preprocessor">#else</span>
01493 <span class="preprocessor"></span>        max_eval_page_number = 1 + eval_letter_show_poor_area(1) + eval_letter_show_good_area(1);
01494 <span class="preprocessor">#endif</span>
01495 <span class="preprocessor"></span>
01496         old_eval_page_number=<a class="code" href="classLetter.html#m0">eval_page_number</a>;
01497 
01498         <span class="comment">//--------------------------------------------//</span>
01499 
01500         <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m0">eval_page_number</a>==1) {
01501             eval_letter_show_first_page();
01502         }
01503 
01504         <span class="comment">//---------------------------------------------------------//</span>
01505 
01506         <span class="keywordflow">if</span>( <a class="code" href="classLetter.html#m0">eval_page_number</a>==2 ) {
01507             <span class="keywordflow">if</span>( !eval_letter_show_poor_area() ) {
01508                 eval_letter_show_good_area();
01509             }
01510         }
01511 
01512         <span class="comment">//---------------------------------------------------------//</span>
01513 
01514         <span class="keywordflow">if</span>( <a class="code" href="classLetter.html#m0">eval_page_number</a>==3 ) {
01515             eval_letter_show_good_area();
01516         }
01517 
01518 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01519 <span class="preprocessor"></span>        <span class="keywordflow">if</span> ( <a class="code" href="classLetter.html#m0">eval_page_number</a> == 4 ) {
01520             eval_letter_show_mixed_area();
01521         }
01522 <span class="preprocessor">#endif</span>
01523 <span class="preprocessor"></span>
01524         <span class="comment">//-------- show letter now ------------//</span>
01525 
01526         <a class="code" href="classString.html">String</a> pagestr;
01527         pagestr = <a class="code" href="classLetter.html#m0">eval_page_number</a>;
01528         pagestr += <span class="stringliteral">"/"</span>;
01529         pagestr += max_eval_page_number;
01530         font_letter.put(680,vtab4+20,pagestr.<a class="code" href="classString.html#m0">str_buf</a>);
01531 
01532         button_back.<a class="code" href="classButton.html#a20">paint</a>();
01533         <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m0">eval_page_number</a>&lt;=1)button_pgup.<a class="code" href="classButton.html#a26">disable</a>();
01534         <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m0">eval_page_number</a>&gt;=max_eval_page_number)button_pgdn.<a class="code" href="classButton.html#a26">disable</a>();
01535 
01536         button_pgup.<a class="code" href="classButton.html#a20">paint</a>();
01537         button_pgdn.<a class="code" href="classButton.html#a20">paint</a>();
01538 
01539         <span class="keywordflow">if</span>(refreshFlag != <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>)
01540             vga.blt_buf(185,140,670,420);
01541     }
01542 
01543     <span class="comment">//------- blt the back buffer to front buffer -------//</span>
01544 
01545     <span class="keywordflow">if</span>(refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>)
01546         vga.blt_buf(<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>, <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>);
01547 
01548     vga.use_front();
01549 }
01550 
01551 <span class="comment">//---------- End of function Letter::eval_letter_report ------------//</span>
01552 
01553 <span class="comment">//---------- End of function Letter::eval_letter_show_first_page ------------//</span>
01554 
01555 <span class="keywordtype">int</span> Letter::eval_letter_show_first_page(<span class="keywordtype">int</span> generateText) {
01556 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01557 <span class="preprocessor"></span>    <span class="keywordflow">if</span>( info.prerun_year )
01558         <span class="keywordflow">return</span> 0;
01559 <span class="preprocessor">#endif</span>
01560 <span class="preprocessor"></span>
01561     <span class="keywordflow">if</span>( generateText ) {                            <span class="comment">// only set the text when the letter is being generated.</span>
01562         eval_page_1 = <span class="stringliteral">"To      :    "</span>;
01563         eval_page_1 += player_school.player_first_name;
01564         eval_page_1 += <span class="stringliteral">" "</span>;
01565         eval_page_1 += player_school.player_last_name;
01566         eval_page_1 += <span class="stringliteral">"\n"</span>;
01567 
01568         eval_page_1 += <span class="stringliteral">"              President, "</span>;
01569         eval_page_1 += player_school.school_name;
01570         eval_page_1 += <span class="stringliteral">"\n"</span>;
01571 
01572         eval_page_1 += <span class="stringliteral">"From  :    "</span>;
01573         eval_page_1 += name_res.get_name_str(name_id1,name_id2,name_id3);
01574         eval_page_1 += <span class="stringliteral">"\n"</span>;
01575 
01576         eval_page_1 += <span class="stringliteral">"              Chair, Board of Trustees"</span>,
01577             eval_page_1 += <span class="stringliteral">"\n"</span>;
01578 
01579 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01580 <span class="preprocessor"></span>        eval_page_1 += <span class="stringliteral">"Date   :    "</span>;
01581         eval_page_1 += info.date_str_julian(letter_date);
01582 <span class="preprocessor">#else</span>
01583 <span class="preprocessor"></span>        eval_page_1 += <span class="stringliteral">"Date   :    September 1, "</span>;
01584         eval_page_1 += m.format(info.game_year,16);
01585         eval_page_1 += <span class="stringliteral">"\n"</span>;
01586 <span class="preprocessor">#endif</span>
01587 <span class="preprocessor"></span>        eval_page_1 += <span class="stringliteral">"\n"</span>;
01588 
01589         eval_page_1 +=<span class="stringliteral">"Dear President "</span>;
01590         eval_page_1 +=player_school.player_last_name;
01591         eval_page_1 += <span class="stringliteral">" :\n"</span>;
01592 
01593         eval_page_1 +=<span class="stringliteral">"        The Compensation Committee of the Board has completed your performance evaluation for year "</span>;
01594 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01595 <span class="preprocessor"></span>        <span class="comment">// eval_page_1 += info.date_str_julian(letter_date, INFO_DATE_DEFAULT|INFO_DATE_NO_DAY|INFO_DATE_NO_MONTH);</span>
01596         <span class="comment">// no need to add Yr. because previous word is year</span>
01597         eval_page_1 += info.date_str_julian(letter_date, <a class="code" href="Oinfo_8h.html#a114a96">INFO_DATE_DEFAULT</a>&amp;~<a class="code" href="Oinfo_8h.html#a114a95">INFO_DATE_ADD_YR</a>|<a class="code" href="Oinfo_8h.html#a114a90">INFO_DATE_NO_DAY</a>|<a class="code" href="Oinfo_8h.html#a114a91">INFO_DATE_NO_MONTH</a>);
01598 <span class="preprocessor">#else</span>
01599 <span class="preprocessor"></span>        <span class="keywordflow">if</span>(info.game_month&lt;8)
01600             eval_page_1 += m.format(info.game_year-2,16);
01601         <span class="keywordflow">else</span>
01602             eval_page_1 += m.format(info.game_year-1,16);
01603 <span class="preprocessor">#endif</span>
01604 <span class="preprocessor"></span>
01605         eval_page_1 +=<span class="stringliteral">". The Committee believes your performance has been "</span>;
01606 
01607         <span class="comment">//----- description word for "your performance" ------//</span>
01608 
01609 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01610 <span class="preprocessor"></span>        <span class="comment">// Item 15b)</span>
01611         <span class="comment">// ####### begin Gilbert 09/11/2001 ######//</span>
01612         <span class="comment">//int result = player_school.think_protagonist_event( player_school.cur_game_score, player_school.game_score_history[35],</span>
01613         <span class="comment">//                                                                                                                                              player_school.init_game_score, player_school.get_protagonist_info(1),-1);</span>
01614         <span class="keywordtype">int</span> result = player_school.think_protagonist_event( player_school.cur_game_score, player_school.game_score_history[THIS_MONTH-12],
01615                                                             player_school.init_game_score, player_school.get_protagonist_info(1),-1, 1);
01616         <span class="comment">// ####### end Gilbert 09/11/2001 ######//</span>
01617 
01618         <span class="keywordflow">switch</span> (result) {
01619         <span class="keywordflow">case</span> 1: eval_page_1 += <span class="stringliteral">"outstanding. "</span>; <span class="keywordflow">break</span>;
01620         <span class="keywordflow">case</span> 2: eval_page_1 += <span class="stringliteral">"strong. "</span>;      <span class="keywordflow">break</span>;
01621         <span class="keywordflow">case</span> 3: eval_page_1 += <span class="stringliteral">"weak. "</span>;      <span class="keywordflow">break</span>;
01622         <span class="keywordflow">case</span> 4:                                     <span class="comment">// case 4 and case 7</span>
01623         <span class="keywordflow">case</span> 7: eval_page_1 += <span class="stringliteral">"unacceptable. "</span>;  <span class="keywordflow">break</span>;
01624         <span class="keywordflow">case</span> 5:
01625         <span class="keywordflow">case</span> 6: eval_page_1 += <span class="stringliteral">"mixed. "</span>;     <span class="keywordflow">break</span>;
01626         <span class="keywordflow">default</span>:  eval_page_1 += <span class="stringliteral">"satisfactory. "</span>;  <span class="keywordflow">break</span>;
01627         }
01628 
01629         <span class="keywordflow">if</span> ( result == 4 || result == 7 ) {           <span class="comment">// unacceptable</span>
01630             <span class="comment">// second consecutive "unacceptable"</span>
01631             <span class="keywordflow">if</span> ( player_school.is_unacceptable_at_year_end ) {
01632                 <span class="comment">// Fired screen</span>
01633                 should_end_game = 1;
01634             }
01635             <span class="keywordflow">else</span>
01636                 player_school.is_unacceptable_at_year_end = 1;
01637         }
01638         <span class="keywordflow">else</span>
01639             player_school.is_unacceptable_at_year_end = 0;
01640 
01641         <span class="comment">// Second Paragraph</span>
01642         eval_page_1_p2 = <span class="stringliteral">"          This evaluation considers both the change during the last year and the cumulative change since the start of the game. "</span>;
01643         <span class="keywordflow">if</span> ( player_school.scenario_id &gt; 0 )          <span class="comment">// if it is a scenario game</span>
01644             eval_page_1_p2 += <span class="stringliteral">"It does not take progress toward the scenario goal into account."</span>;
01645         eval_page_1_p2 += <span class="stringliteral">"\n"</span>;
01646 
01647         <span class="comment">// Third Paragraph</span>
01648         <span class="keywordflow">if</span> ( result == 4 || result == 7 )
01649             eval_page_1_p2 += <span class="stringliteral">"       The Board wishes to inform you that failure to improve your performance during the next year will result in termination."</span>;
01650 
01651 <span class="preprocessor">#else</span>
01652 <span class="preprocessor"></span>        <span class="keywordtype">float</span> x = 100.0f * (float) finance.this_year.surplus_deficit / (float) finance.projected_total_expense.this_year.total;
01653 
01654         <span class="keywordflow">if</span>( x &lt;= -1.5f ) {
01655             eval_page_1 += <span class="stringliteral">"weak"</span>;
01656         }
01657         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( x &lt; 0 ) {
01658             <span class="keywordflow">if</span>( player_school.cur_game_score &lt; 40 )
01659                 eval_page_1 += <span class="stringliteral">"weak"</span>;
01660             <span class="keywordflow">else</span>
01661                 eval_page_1 += <span class="stringliteral">"strong"</span>;
01662         }
01663         <span class="keywordflow">else</span> {                                        <span class="comment">// x &gt;= 0</span>
01664             <span class="keywordflow">if</span>( player_school.cur_game_score &lt; 40 )
01665                 eval_page_1 += <span class="stringliteral">"weak"</span>;
01666             <span class="keywordflow">else</span> <span class="keywordflow">if</span>( player_school.cur_game_score &gt;= 40 &amp;&amp; player_school.cur_game_score &lt;= 60 )
01667                 eval_page_1 += <span class="stringliteral">"acceptable"</span>;
01668             <span class="keywordflow">else</span>                                        <span class="comment">// &gt; 60</span>
01669                 eval_page_1 += <span class="stringliteral">"strong"</span>;
01670         }
01671 
01672         eval_page_1 +=<span class="stringliteral">". This will be reflected in your salary for next year. \n"</span>;
01673 
01674         <span class="comment">//--------------------------------------------//</span>
01675 
01676         <span class="keywordflow">if</span>(finance_last_year_asset_array_AC_OPERATING_RESERVE &lt; 0) {
01677             eval_page_1+=<span class="stringliteral">"        Last year the University's operating reserve was in the red by "</span>;
01678             eval_page_1+=m.format(-finance_last_year_asset_array_AC_OPERATING_RESERVE,2);
01679             eval_page_1+=<span class="stringliteral">" thousand."</span>;
01680         }
01681         <span class="keywordflow">if</span>(finance_last_year_asset_array_AC_OPERATING_RESERVE &gt; 0) {
01682             eval_page_1+=<span class="stringliteral">"        Last year the University's operating reserve was in the blue by "</span>;
01683             eval_page_1+=m.format(finance_last_year_asset_array_AC_OPERATING_RESERVE,2);
01684             eval_page_1+=<span class="stringliteral">" thousand."</span>;
01685         }
01686 <span class="preprocessor">#endif</span>
01687 <span class="preprocessor"></span>    }
01688     <span class="keywordflow">else</span> {
01689         font_letter.put_paragraph(175,120,670,420,eval_page_1.<a class="code" href="classString.html#m0">str_buf</a>);
01690 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01691 <span class="preprocessor"></span>        font_letter.put_paragraph(175,320,670,520, eval_page_1_p2.str_buf);
01692 <span class="preprocessor">#endif</span>
01693 <span class="preprocessor"></span>    }
01694     <span class="keywordflow">return</span> 1;
01695 }
01696 
01697 <span class="comment">//---------- End of function Letter::eval_letter_show_first_page ------------//</span>
01698 
01699 <span class="comment">//---------- End of function Letter::eval_letter_show_poor_area ------------//</span>
01700 <span class="comment">//</span>
01701 <span class="comment">// [int] justCalc  - whether this function is called just for calculation.</span>
01702 <span class="comment">//                                                      (default: 0)</span>
01703 <span class="comment">// [int] generateText - whether this is the first time showing this letter or repeated showing</span>
01704 <span class="comment">//                                                 (this only matters when justCalc is 0. Default: 0)</span>
01705 <span class="comment">//</span>
01706 <span class="keywordtype">int</span> Letter::eval_letter_show_poor_area(<span class="keywordtype">int</span> justCalc, <span class="keywordtype">int</span> generateText) {
01707     <span class="comment">//------ set the performance value of individual areas and then sort them ----//</span>
01708 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01709 <span class="preprocessor"></span>    <span class="keywordflow">if</span>( info.prerun_year )
01710         <span class="keywordflow">return</span> 0;
01711 
01712     <span class="keywordtype">int</span> i;
01713 
01714     get_variables_score(1);                         <span class="comment">// 1 -- sort it into acscending order</span>
01715 
01716     <span class="keywordtype">float</span> s5, s6, s7;
01717 
01718     s5 = sort_data[4].strength;
01719     s6 = sort_data[5].strength;
01720     s7 = sort_data[6].strength;
01721 
01722     <span class="keywordtype">int</span> displayNumber;
01723 
01724     <span class="keywordflow">if</span> ( (abs(s5-s6) &gt; abs(s6-s7)) &amp;&amp; (abs(s6-s7) &lt; abs(1.05*s6)) )
01725         displayNumber = 7;
01726     <span class="keywordflow">else</span>
01727         <span class="keywordflow">if</span> ( (abs(s5-s6) &lt; abs(s6-s7)) &amp;&amp; (abs(s5-s6) &lt; abs(1.05*s6)) )
01728             displayNumber = 5;
01729         <span class="keywordflow">else</span>
01730             displayNumber = 6;
01731 
01732     <span class="keywordflow">if</span>( justCalc )
01733         <span class="keywordflow">return</span> 1;
01734 
01735 <span class="preprocessor">#else</span>
01736 <span class="preprocessor"></span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;SCORE_VAR_COUNT;i++) {
01737         sort_data[i].<a class="code" href="structSortData.html#m0">idx</a>=i;
01738 
01739         <span class="keywordflow">if</span>((i!=<a class="code" href="Opschool_8h.html#a65a38">S_SPONSORED_RESEARCH_ACTIVITY</a>) || player_school.sponsored_research_intensity!=0 || ( player_school.scenario_id!=0 ))
01740             sort_data[i].<a class="code" href="structSortData.html#m1">data</a>=player_school.sub_score[i][HISTORY_MONTH_COUNT-1];
01741         <span class="keywordflow">else</span>
01742             sort_data[i].<a class="code" href="structSortData.html#m1">data</a>=-1;
01743         sort_data[i].<a class="code" href="structSortData.html#m2">tag</a>=0;
01744     }
01745 
01746     <span class="comment">//--------------------------------------------------------------------//</span>
01747     <span class="comment">// Then: If any components of the trustee score are &lt; 40:</span>
01748     <span class="comment">// "The Board believes the following areas need improvement:" and list the areas.</span>
01749     <span class="comment">//--------------------------------------------------------------------//</span>
01750 
01751     <span class="keywordtype">int</span> showEliminateBudgetDeficit = finance.this_year.surplus_deficit &lt; finance.total_operating_expense.total*0.0025;
01752 
01753     <span class="keywordflow">for</span>(i=0;i&lt;SCORE_VAR_COUNT;i++) {
01754         <span class="keywordflow">if</span>( sort_data[i].<a class="code" href="structSortData.html#m1">data</a> &lt; 40 &amp;&amp; sort_data[i].<a class="code" href="structSortData.html#m1">data</a> != -1 )
01755             <span class="keywordflow">break</span>;
01756     }
01757 
01758     <span class="keywordflow">if</span>( i==SCORE_VAR_COUNT )                        <span class="comment">// no areas' values are &lt; 40</span>
01759         <span class="keywordflow">return</span> 0;
01760 
01761     <span class="keywordflow">if</span>( justCalc )
01762         <span class="keywordflow">return</span> 1;
01763 
01764     <span class="comment">//---------- sort the areas by their extends -----------//</span>
01765 
01766     qsort(sort_data,(size_t)SCORE_VAR_COUNT,<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structSortData.html">SortData</a>),<a class="code" href="Oletter_8cpp.html#a43">compare_ascend</a>);
01767 
01768     <span class="comment">//---------------------------------------------//</span>
01769 <span class="preprocessor">#endif</span>
01770 <span class="preprocessor"></span>
01771     <span class="keywordflow">if</span>( generateText ) {
01772         <span class="comment">// reset the sort_data</span>
01773         <span class="keywordflow">for</span> ( i=0; i&lt;SCORE_VAR_COUNT; i++ )
01774             sort_data[i].<a class="code" href="structSortData.html#m2">tag</a> = 0;
01775 
01776         <span class="keywordtype">int</span> addedCount=0;
01777 
01778 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01779 <span class="preprocessor"></span>        eval_poor_areas=<span class="stringliteral">"        The Board believes the following areas are most in need of improvement. Entries near the top of the list need the most attention.\n\n"</span>;
01780 
01781         <span class="comment">// display poor items</span>
01782         <span class="keywordflow">for</span> ( i=0; i&lt;displayNumber; i++ ) {
01783             eval_poor_areas+=<span class="stringliteral">"         -  "</span>;
01784             eval_poor_areas+=area_str[sort_data[i].<a class="code" href="structSortData.html#m0">idx</a>];
01785             sort_data[i].<a class="code" href="structSortData.html#m2">tag</a> = 1;
01786             eval_poor_areas+=<span class="stringliteral">"\n"</span>;
01787         }
01788 
01789 <span class="preprocessor">#else</span>
01790 <span class="preprocessor"></span>        eval_poor_areas=<span class="stringliteral">"    The Board believes the following areas need improvement: \n\n"</span>;
01791 
01792         <span class="keywordflow">for</span>(i=0;i&lt;SCORE_VAR_COUNT;i++) {
01793             <span class="keywordflow">if</span>( sort_data[i].<a class="code" href="structSortData.html#m1">data</a> &lt; 40 ) {
01794                 eval_poor_areas+=<span class="stringliteral">"         -  "</span>;
01795                 eval_poor_areas+=area_str[sort_data[i].<a class="code" href="structSortData.html#m0">idx</a>];
01796 
01797                 <span class="keywordflow">if</span>(sort_data[i].<a class="code" href="structSortData.html#m0">idx</a>==<a class="code" href="Opschool_8h.html#a65a48">S_CURRENT_SURPLUS_DEFICIT_PERCENT</a>)
01798                     showEliminateBudgetDeficit=0;
01799                 <span class="keywordflow">if</span>(sort_data[i].<a class="code" href="structSortData.html#m0">idx</a>==<a class="code" href="Opschool_8h.html#a65a49">S_SMOOTHED_SURPLUS_DEFICIT_PERCENT</a>)
01800                     showEliminateBudgetDeficit=0;
01801 
01802                 eval_poor_areas+=<span class="stringliteral">"\n"</span>;
01803 
01804                 <span class="keywordflow">if</span>( ++addedCount == 6 )                   <span class="comment">// maximum 10 areas each time</span>
01805                     <span class="keywordflow">break</span>;
01806             }
01807         }
01808 
01809         <span class="comment">//------ show eliminate budget deficit ---------//</span>
01810 
01811         <span class="keywordflow">if</span>(showEliminateBudgetDeficit) {
01812             eval_poor_areas+=<span class="stringliteral">"         -  "</span>;
01813             eval_poor_areas+=<span class="stringliteral">"Eliminate budget deficit \n"</span>;
01814         }
01815 <span class="preprocessor">#endif</span>
01816 <span class="preprocessor"></span>    }
01817     <span class="keywordflow">else</span> {
01818         font_letter.put_paragraph(185,150,670,420,eval_poor_areas.<a class="code" href="classString.html#m0">str_buf</a>);
01819     }
01820 
01821     <span class="keywordflow">return</span> 1;
01822 }
01823 
01824 <span class="comment">//---------- End of function Letter::eval_letter_show_poor_area ------------//</span>
01825 
01826 <span class="comment">//---------- End of function Letter::eval_letter_show_good_area ------------//</span>
01827 <span class="comment">//</span>
01828 <span class="comment">// [int] justCalc  - whether this function is called just for calculation.</span>
01829 <span class="comment">//                                                      (default: 0)</span>
01830 <span class="comment">// [int] generateText - whether this is the first time showing this letter or repeated showing</span>
01831 <span class="comment">//                                                 (this only matters when justCalc is 0. Default: 0)</span>
01832 <span class="comment">//</span>
01833 <span class="keywordtype">int</span> Letter::eval_letter_show_good_area(<span class="keywordtype">int</span> justCalc, <span class="keywordtype">int</span> generateText) {
01834     <span class="comment">//------ set the performance value of individual areas and then sort them ----//</span>
01835 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01836 <span class="preprocessor"></span>    <span class="keywordflow">if</span>( info.prerun_year )
01837         <span class="keywordflow">return</span> 1;
01838 
01839     qsort(sort_data,(size_t)SCORE_VAR_COUNT,<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structSortData.html">SortData</a>),<a class="code" href="Oletter_8cpp.html#a44">compare_descend</a>);
01840 
01841     <span class="keywordtype">int</span> i;
01842 
01843     <span class="keywordtype">float</span> s5, s6, s7;
01844     <span class="keywordtype">int</span> displayNumber;
01845 
01846     s5 = sort_data[4].strength;
01847     s6 = sort_data[5].strength;
01848     s7 = sort_data[6].strength;
01849 
01850     <span class="keywordflow">if</span> ( (abs(s5-s6) &gt; abs(s6-s7)) &amp;&amp; (abs(s6-s7) &lt; abs(1.05*s6)) )
01851         displayNumber = 7;
01852     <span class="keywordflow">else</span>
01853         <span class="keywordflow">if</span> ( (abs(s5-s6) &lt; abs(s6-s7)) &amp;&amp; (abs(s5-s6) &lt; abs(1.05*s6)) )
01854             displayNumber = 5;
01855         <span class="keywordflow">else</span>
01856             displayNumber = 6;
01857 
01858     <span class="keywordflow">if</span>( justCalc )
01859         <span class="keywordflow">return</span> 1;
01860 
01861 <span class="preprocessor">#else</span>
01862 <span class="preprocessor"></span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;SCORE_VAR_COUNT;i++) {
01863         sort_data[i].<a class="code" href="structSortData.html#m0">idx</a>=i;
01864 
01865         <span class="keywordflow">if</span>((i!=<a class="code" href="Opschool_8h.html#a65a38">S_SPONSORED_RESEARCH_ACTIVITY</a>) || player_school.sponsored_research_intensity!=0 || ( player_school.scenario_id!=0 ))
01866             sort_data[i].<a class="code" href="structSortData.html#m1">data</a>=player_school.sub_score[i][HISTORY_MONTH_COUNT-1];
01867         <span class="keywordflow">else</span>
01868             sort_data[i].<a class="code" href="structSortData.html#m1">data</a>=-1;
01869         sort_data[i].<a class="code" href="structSortData.html#m2">tag</a>=0;
01870     }
01871 
01872     <span class="comment">//--------------------------------------------------------------------//</span>
01873     <span class="comment">// And: If any components of the trustee score are &gt; 60:</span>
01874     <span class="comment">// "The Board is pleased with your work in these areas:" and list the areas.</span>
01875     <span class="comment">//--------------------------------------------------------------------//</span>
01876 
01877     <span class="keywordflow">for</span>(i=0;i&lt;SCORE_VAR_COUNT;i++) {
01878         <span class="keywordflow">if</span>( sort_data[i].<a class="code" href="structSortData.html#m1">data</a> &gt;= 60 )
01879             <span class="keywordflow">break</span>;
01880     }
01881 
01882     <span class="keywordflow">if</span>( i==SCORE_VAR_COUNT )                        <span class="comment">// no areas' values are &gt; 60</span>
01883         <span class="keywordflow">return</span> 0;
01884 
01885     <span class="keywordflow">if</span>( justCalc )
01886         <span class="keywordflow">return</span> 1;
01887 <span class="preprocessor">#endif</span>
01888 <span class="preprocessor"></span>    <span class="comment">//--------------------------------------------//</span>
01889 
01890     <span class="keywordflow">if</span>( generateText ) {
01891 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01892 <span class="preprocessor"></span>        eval_good_areas=<span class="stringliteral">"        The Board is pleased with your performance in these areas. Entries at the top of the list represent the best performance.\n\n"</span>;
01893 
01894         <span class="keywordflow">for</span> ( i=0; i&lt;displayNumber; i++ ) {
01895             eval_good_areas+=<span class="stringliteral">"         -  "</span>;
01896             eval_good_areas+=area_str[sort_data[i].<a class="code" href="structSortData.html#m0">idx</a>];
01897             sort_data[i].<a class="code" href="structSortData.html#m2">tag</a> = 1;
01898             eval_good_areas+=<span class="stringliteral">"\n"</span>;
01899         }
01900 <span class="preprocessor">#else</span>
01901 <span class="preprocessor"></span>        eval_good_areas=<span class="stringliteral">"    The Board is pleased with your work in these areas:\n\n"</span>;
01902 
01903         <span class="comment">//---------- sort the areas by their extends -----------//</span>
01904 
01905         qsort(sort_data,(size_t)SCORE_VAR_COUNT,<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structSortData.html">SortData</a>),<a class="code" href="Oletter_8cpp.html#a44">compare_descend</a>);
01906 
01907         <span class="comment">//---------------------------------------------//</span>
01908 
01909         <span class="keywordtype">int</span> addedCount=0;
01910 
01911         <span class="keywordflow">for</span>(i=0;i&lt;SCORE_VAR_COUNT;i++) {
01912             <span class="keywordflow">if</span>( sort_data[i].<a class="code" href="structSortData.html#m1">data</a> &gt;= 60 ) {
01913                 eval_good_areas+=<span class="stringliteral">"         -  "</span>;
01914                 eval_good_areas+=area_str[sort_data[i].<a class="code" href="structSortData.html#m0">idx</a>];
01915                 eval_good_areas+=<span class="stringliteral">"\n"</span>;
01916 
01917                 <span class="keywordflow">if</span>( ++addedCount == 6 )                   <span class="comment">// maximum 10 areas each time</span>
01918                     <span class="keywordflow">break</span>;
01919             }
01920         }
01921 <span class="preprocessor">#endif</span>
01922 <span class="preprocessor"></span>    }
01923     <span class="keywordflow">else</span> {
01924         font_letter.put_paragraph(185,150,670,420,eval_good_areas.<a class="code" href="classString.html#m0">str_buf</a>);
01925     }
01926     <span class="keywordflow">return</span> 1;
01927 }
01928 
01929 <span class="comment">//---------- End of function Letter::eval_letter_show_good_area ------------//</span>
01930 
01931 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01932 <span class="preprocessor"></span><span class="comment">// --- Begin of function Letter::eval_letter_show_mixed_area --- //</span>
01933 <span class="comment">//</span>
01934 <span class="comment">// Version 2.0 Item 15f)</span>
01935 <span class="keywordtype">int</span> Letter::eval_letter_show_mixed_area(<span class="keywordtype">int</span> justCalc, <span class="keywordtype">int</span> generateText) {
01936     <span class="keywordflow">if</span> ( justCalc )
01937         <span class="keywordflow">return</span> 1;
01938 
01939     <span class="keywordflow">if</span>( info.prerun_year )
01940         <span class="keywordflow">return</span> 1;
01941 
01942     <span class="comment">// Item 15f ii)</span>
01943     <span class="comment">// first get the items which have not yet displayed</span>
01944     <span class="keywordtype">int</span> i;
01945     <a class="code" href="structSortData.html">SortData</a> tempSortData[SCORE_VAR_COUNT];
01946     <span class="keywordtype">int</span> count = 0;
01947     <span class="keywordflow">for</span> ( i=0; i&lt;SCORE_VAR_COUNT; i++ ) {
01948         <span class="keywordflow">if</span> ( sort_data[i].<a class="code" href="structSortData.html#m2">tag</a> == 0 ) {                <span class="comment">// has not yet displayed</span>
01949             tempSortData[count].<a class="code" href="structSortData.html#m0">idx</a> = sort_data[i].<a class="code" href="structSortData.html#m0">idx</a>;
01950             tempSortData[count].consistency = sort_data[i].consistency;
01951             tempSortData[count].k1 = sort_data[i].k1;
01952             tempSortData[count].<a class="code" href="structSortData.html#m2">tag</a> = 1;
01953             count++;
01954         }
01955     }
01956 
01957     <span class="comment">// sort the tempSortData by consistency (descending)</span>
01958     qsort(tempSortData,count,<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structSortData.html">SortData</a>),sort_consistency);
01959 
01960     <span class="keywordflow">if</span> ( generateText ) {
01961         eval_mixed_areas=<span class="stringliteral">"        The Board believes your performance in these areas to be mixed.\n\n"</span>;
01962         <span class="comment">// Item 15f iii)</span>
01963         <span class="keywordtype">int</span> printedNumber1=0;
01964         <span class="keywordflow">for</span> ( i=0; i&lt;count; i++ ) {
01965             <span class="keywordflow">if</span> ( tempSortData[i].consistency &gt;= tempSortData[i].k1 )
01966                 printedNumber1++;
01967         }
01968 
01969         <span class="comment">// If have something to display</span>
01970         <span class="keywordflow">if</span> ( printedNumber1 &gt; 0 )
01971             eval_mixed_areas+=<span class="stringliteral">"        Trend is up but cumulative performance remains negative:\n"</span>;
01972 
01973         printedNumber1=0;
01974         <span class="keywordflow">for</span> ( i=0; i&lt;count; i++ ) {
01975             <span class="keywordflow">if</span> ( printedNumber1 == 3 )
01976                 <span class="keywordflow">break</span>;
01977             <span class="keywordflow">if</span> ( tempSortData[i].consistency &gt;= tempSortData[i].k1 ) {
01978                 eval_mixed_areas+=<span class="stringliteral">"         -  "</span>;
01979                 eval_mixed_areas += area_str[tempSortData[i].<a class="code" href="structSortData.html#m0">idx</a>];
01980                 eval_mixed_areas += <span class="stringliteral">"\n"</span>;
01981                 printedNumber1++;
01982             }
01983         }
01984 
01985         <span class="comment">// Item 15f iv)</span>
01986         <span class="keywordtype">int</span> printedNumber2 = 0;
01987         <span class="keywordflow">for</span> ( i=count-1; i&gt;=0; i-- ) {
01988             <span class="keywordflow">if</span> ( tempSortData[i].consistency &lt;= -tempSortData[i].k1 )
01989                 printedNumber2++;
01990         }
01991 
01992         <span class="comment">// if have something to print</span>
01993         <span class="keywordflow">if</span> ( printedNumber2 &gt; 0 )
01994             eval_mixed_areas+=<span class="stringliteral">"\n        Trend is down but cumulative performance remains positive:\n"</span>;
01995 
01996         printedNumber2=0;
01997         <span class="keywordflow">for</span> ( i=count-1; i&gt;=0; i-- ) {
01998             <span class="keywordflow">if</span> ( printedNumber2 == 3 )
01999                 <span class="keywordflow">break</span>;
02000             <span class="keywordflow">if</span> ( tempSortData[i].consistency &lt;= -tempSortData[i].k1 ) {
02001                 eval_mixed_areas+=<span class="stringliteral">"         -  "</span>;
02002                 eval_mixed_areas += area_str[tempSortData[i].<a class="code" href="structSortData.html#m0">idx</a>];
02003                 eval_mixed_areas += <span class="stringliteral">"\n"</span>;
02004                 printedNumber2++;
02005             }
02006         }
02007 
02008         <span class="comment">// if nothing has printed out</span>
02009         <span class="keywordflow">if</span> ( (printedNumber1 + printedNumber2) == 0 )
02010             eval_mixed_areas += <span class="stringliteral">"        No items meet this criterion."</span>;
02011 
02012     }
02013     <span class="keywordflow">else</span> {
02014         font_letter.put_paragraph(185,150,670,420,eval_mixed_areas.str_buf);
02015     }
02016     <span class="keywordflow">return</span> 1;
02017 
02018 }
02019 
02020 <span class="comment">//</span>
02021 <span class="comment">// --- End of function Letter::eval_letter_show_mixed_area --- //</span>
02022 <span class="preprocessor">#endif</span>
02023 <span class="preprocessor"></span>
02024 <span class="comment">//---------- Begin of function Letter::eval_letter_detect ------------//</span>
<a name="l02025"></a><a class="code" href="classLetter.html#a11">02025</a> <span class="keywordtype">int</span> <a class="code" href="classLetter.html#a11">Letter::eval_letter_detect</a>() {
02026     <span class="keywordflow">if</span> (!letter_report_init_flag)
02027         <span class="keywordflow">return</span> 0;
02028     vga.use_front();
02029 
02030     <span class="comment">//--- recalculate the number of pages it has ----//</span>
02031 
02032 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
02033 <span class="preprocessor"></span>    max_eval_page_number = 1 + eval_letter_show_poor_area(1) + eval_letter_show_good_area(1) + eval_letter_show_mixed_area(1);
02034 <span class="preprocessor">#else</span>
02035 <span class="preprocessor"></span>    max_eval_page_number = 1 + eval_letter_show_poor_area(1) + eval_letter_show_good_area(1);
02036 <span class="preprocessor">#endif</span>
02037 <span class="preprocessor"></span>
02038     <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m0">eval_page_number</a>&lt;max_eval_page_number)
02039         <span class="keywordflow">if</span>(button_pgdn.<a class="code" href="classButton.html#a21">detect</a>()) {
02040             <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m0">eval_page_number</a>&lt;max_eval_page_number)
02041                 <a class="code" href="classLetter.html#m0">eval_page_number</a>++;
02042             sys.redraw_all_flag=1;
02043         };
02044 
02045     <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m0">eval_page_number</a>&gt;1)
02046         <span class="keywordflow">if</span>(button_pgup.<a class="code" href="classButton.html#a21">detect</a>()) {
02047             <span class="keywordflow">if</span>(<a class="code" href="classLetter.html#m0">eval_page_number</a>&gt;1)
02048                 <a class="code" href="classLetter.html#m0">eval_page_number</a>--;
02049             sys.redraw_all_flag=1;
02050         };
02051 
02052     <span class="comment">// for mail button</span>
02053     <span class="keywordflow">if</span>(button_back.<a class="code" href="classButton.html#a21">detect</a>()) {
02054         <a class="code" href="classLetter.html#m0">eval_page_number</a>=1;
02055         old_eval_page_number=-1;
02056         <a class="code" href="classLetter.html#m1">welcome_page_number</a>=1;
02057         old_welcome_page_number=-1;
02058 
02059 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
02060 <span class="preprocessor"></span>        <span class="keywordflow">if</span> ( should_end_game ) {                      <span class="comment">// lose game by consecutive unacceptable performance</span>
02061             lose_game.set_reason( LOSE_REASON_UNACCEPTABLE );
02062             sys.set_staying_view_mode(<a class="code" href="Osys_8h.html#a45a24">MODE_LOSE_GAME</a>);
02063         }
02064         <span class="keywordflow">else</span> {
02065             <span class="keywordflow">if</span> ( player_school.is_public() ) {
02066                 <span class="keywordflow">if</span> ( (sys.save_view_mode != <a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a>) &amp;&amp; (sys.save_view_mode != MODE_STATE_REPORT) )
02067 
02068 <span class="preprocessor">#else</span>
02069 <span class="preprocessor"></span>                    <span class="keywordflow">if</span>(sys.save_view_mode!=<a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a>)
02070 <span class="preprocessor">#endif</span>
02071 <span class="preprocessor"></span>                    {
02072 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
02073 <span class="preprocessor"></span>                        <span class="comment">//                                      player_school.is_year_end_report = 1;</span>
02074                         <span class="comment">//                                      player_school.current_report_type = 3;          // (REPORT_TYPE_TURNOVER)</span>
02075 <span class="preprocessor">#endif</span>
02076 <span class="preprocessor"></span>                        sys.set_staying_view_mode(0);
02077                         sys.set_speed(sys.save_speed);
02078                         sys.set_view_mode(<a class="code" href="Osys_8h.html#a45a9">MODE_NORMAL</a>);
02079                         sys.save_view_mode=<a class="code" href="Osys_8h.html#a45a9">MODE_NORMAL</a>;
02080                     }
02081                     <span class="keywordflow">else</span> {
02082 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
02083 <span class="preprocessor"></span>                        <span class="keywordflow">if</span> ( player_school.is_public() )
02084                             sys.set_view_mode( MODE_STATE_REPORT );
02085                         <span class="keywordflow">else</span>
02086                             sys.set_view_mode( <a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a> );
02087 
02088                         player_school.is_year_end_report = 1;
02089                         player_school.current_report_type = 3;  <span class="comment">// (REPORT_TYPE_TURNOVER)</span>
02090 <span class="preprocessor">#endif</span>
02091 <span class="preprocessor"></span>
02092 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
02093 <span class="preprocessor"></span><span class="preprocessor">#else</span>
02094 <span class="preprocessor"></span>                        sys.set_staying_view_mode(<a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a>);
02095 <span class="preprocessor">#endif</span>
02096 <span class="preprocessor"></span>                    }
02097 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
02098 <span class="preprocessor"></span>            }
02099             <span class="keywordflow">else</span> {
02100                 <span class="keywordflow">if</span> ( sys.save_view_mode!=<a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a>) {
02101                     sys.set_staying_view_mode(0);
02102                     sys.set_speed(sys.save_speed);
02103                     sys.set_view_mode(<a class="code" href="Osys_8h.html#a45a9">MODE_NORMAL</a>);
02104                     sys.save_view_mode=<a class="code" href="Osys_8h.html#a45a9">MODE_NORMAL</a>;
02105                 }
02106                 <span class="keywordflow">else</span> {
02107                     sys.set_view_mode( <a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a> );
02108                     sys.staying_view_mode = <a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a> ;
02109                     player_school.is_year_end_report = 1;
02110                     player_school.current_report_type = 3;  <span class="comment">// (REPORT_TYPE_TURNOVER)</span>
02111                 }
02112             }
02113             <span class="keywordflow">return</span> 2;
02114         }
02115 <span class="preprocessor">#endif</span>
02116 <span class="preprocessor"></span>        <span class="keywordflow">return</span> 1;
02117     }
02118 
02119     <span class="keywordflow">if</span>(m.upper(mouse.is_key(mouse.scan_code, mouse.event_skey_state, (<a class="code" href="OCOLTBL_8H.html#a2">WORD</a>) 0, <a class="code" href="OMOUSE2_8H.html#a15a14">K_UNIQUE_KEY</a>))==<span class="charliteral">'W'</span>) {
02120         <a class="code" href="classLetter.html#m1">welcome_page_number</a>=1;
02121         old_welcome_page_number=-1;
02122         <span class="keywordflow">if</span>(sys.save_view_mode!=<a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a>) {
02123             sys.set_staying_view_mode(0);
02124             sys.view_mode=<a class="code" href="Osys_8h.html#a45a34">MODE_EVALUATION_LETTER</a>;
02125             sys.save_view_mode=<a class="code" href="Osys_8h.html#a45a9">MODE_NORMAL</a>;
02126         }
02127         <span class="keywordflow">else</span>
02128             sys.set_staying_view_mode(<a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a>);
02129         <span class="keywordflow">return</span> 1;
02130     }
02131 
02132     <span class="keywordflow">return</span> 0;
02133 }
02134 
02135 <span class="comment">//---------- End of function Letter::eval_letter_detect ------------//</span>
02136 
02137 <span class="comment">//--------- Begin of function Letter::init_eval_letter -----------//</span>
<a name="l02138"></a><a class="code" href="classLetter.html#a14">02138</a> <span class="keywordtype">void</span> <a class="code" href="classLetter.html#a14">Letter::init_eval_letter</a>() {
02139 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
02140 <span class="preprocessor"></span>    letter_date = info.game_date;
02141 <span class="preprocessor">#endif</span>
02142 <span class="preprocessor"></span>
02143     eval_letter_show_first_page(1);                 <span class="comment">// 1=generate text</span>
02144     eval_letter_show_poor_area(0, 1);
02145     eval_letter_show_good_area(0, 1);
02146 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
02147 <span class="preprocessor"></span>    eval_letter_show_mixed_area(0,1);
02148 <span class="preprocessor">#endif</span>
02149 <span class="preprocessor"></span>}
02150 
02151 <span class="comment">//--------- End of function Letter::init_eval_letter -----------//</span>
02152 
02153 <span class="comment">//--------- Begin of function Letter::init_welcome_letter -----------//</span>
<a name="l02154"></a><a class="code" href="classLetter.html#a13">02154</a> <span class="keywordtype">void</span> <a class="code" href="classLetter.html#a13">Letter::init_welcome_letter</a>() {
02155 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
02156 <span class="preprocessor"></span>    letter_date = info.game_date;
02157 <span class="preprocessor">#endif</span>
02158 <span class="preprocessor"></span>
02159     <span class="comment">// page 1,2</span>
02160     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;=department_array.size();i++) {
02161         <span class="keywordflow">if</span>(!department_array.is_deleted(i)) {
02162             <span class="comment">// fix in ver 2</span>
02163             <span class="comment">//department_array_faculty_array_faculty_count[i]=department_array[i]-&gt;faculty_array.faculty_count;</span>
02164             <span class="comment">//department_array_student_array_student_count[i]=department_array[i]-&gt;student_array.student_count;</span>
02165             <span class="comment">//## chea 221199</span>
02166             <span class="comment">//                  department_array_total_research_dollar[i]=department_array[i]-&gt;total_research_dollar;</span>
02167             <span class="comment">//department_array_total_research_dollar[i]=department_array[i]-&gt;total_research_dollar/1000;</span>
02168 
02169             department_array_faculty_array_faculty_count[i-1]=department_array[i]-&gt;faculty_array.faculty_count;
02170             department_array_student_array_student_count[i-1]=department_array[i]-&gt;student_array.student_count;
02171             department_array_total_research_dollar[i-1]=department_array[i]-&gt;total_research_dollar/1000;
02172         }
02173     }
02174     department_array_faculty_level_history_FT=department_array.faculty_level_history[<a class="code" href="Ofaculty_8h.html#a26a8">FACULTY_RANK_LEVEL_COUNT</a>][THIS_YEAR];
02175     department_res_general_dept_student_level_historyMT=department_res.general_dept.student_level_history[<a class="code" href="Ostudent_8h.html#a0">MAX_STUDENT_LEVEL</a>][THIS_YEAR];
02176     enroll_res_total_student_count=enroll_res.total_student_count;
02177 
02178     <span class="comment">// page 3</span>
02179     student_office_percent_demanding_places_sl1=student_office.percent_demanding_places_sl1;
02180     school_res_player_peer_school_percent_get_bacc_in_5_year=school_res.player_peer_school-&gt;percent_get_bacc_in_5_year;
02181     enroll_res_applications_rate_UG_TRADITION=enroll_res.applications_rate[<a class="code" href="Ostudent_8h.html#a32a3">UG_TRADITION</a>];
02182     enroll_res_student_count_UG_TRADITION=enroll_res.student_count[<a class="code" href="Ostudent_8h.html#a32a3">UG_TRADITION</a>];
02183     enroll_res_student_count_UG_NONTRADITION=enroll_res.student_count[<a class="code" href="Ostudent_8h.html#a32a4">UG_NONTRADITION</a>];
02184     enroll_res_student_count_DISTANCE_LEARN=enroll_res.student_count[<a class="code" href="Ostudent_8h.html#a32a7">DISTANCE_LEARN</a>];
02185     enroll_res_student_count_MASTER=enroll_res.student_count[<a class="code" href="Ostudent_8h.html#a32a5">MASTER</a>];
02186     enroll_res_student_count_DOCTOR=enroll_res.student_count[<a class="code" href="Ostudent_8h.html#a32a6">DOCTOR</a>];
02187     department_res_general_dept_student_array_student_count=department_res.general_dept.student_array.student_count;
02188     enroll_res_overall_percent_minority=enroll_res.overall_percent_minority;
02189     enroll_res_overall_percent_female=enroll_res.overall_percent_female;
02190 
02191     <span class="comment">// page 4,5</span>
02192     department_array_faculty_count_on_tenure_line=department_array.faculty_count_on_tenure_line;
02193     department_array_faculty_count_tenured=department_array.faculty_count_tenured;
02194 
02195     department_array_faculty_gender_history_MINORITY_MALE_HISTORY_YEAR_COUNT_1
02196         =department_array.faculty_gender_history[<a class="code" href="Gamedef_8h.html#a75a29">MINORITY_MALE</a>][HISTORY_YEAR_COUNT-1];
02197 
02198     department_array_faculty_gender_history_MINORITY_FEMALE_HISTORY_YEAR_COUNT_1
02199         =department_array.faculty_gender_history[<a class="code" href="Gamedef_8h.html#a75a30">MINORITY_FEMALE</a>][HISTORY_YEAR_COUNT-1];
02200 
02201     department_array_faculty_gender_history_GENDER_ETHNIC_TYPE_COUNT_N_TOTAL_1_HISTORY_YEAR_COUNT_1
02202         =department_array.faculty_gender_history[<a class="code" href="Gamedef_8h.html#a77a33">GENDER_ETHNIC_TYPE_COUNT_N_TOTAL</a>-1][HISTORY_YEAR_COUNT-1];
02203 
02204     department_array_faculty_gender_history_NONMINORITY_FEMALE_HISTORY_YEAR_COUNT_1
02205         =department_array.faculty_gender_history[<a class="code" href="Gamedef_8h.html#a75a28">NONMINORITY_FEMALE</a>][HISTORY_YEAR_COUNT-1];
02206 
02207     department_array_faculty_gender_history_GENDER_ETHNIC_TYPE_COUNT_N_TOTAL_1_HISTORY_YEAR_COUNT_1
02208         =department_array.faculty_gender_history[<a class="code" href="Gamedef_8h.html#a77a33">GENDER_ETHNIC_TYPE_COUNT_N_TOTAL</a>-1][HISTORY_YEAR_COUNT-1];
02209 
02210     player_school_athletic_program_intensity
02211         =player_school.athletic_program_intensity;
02212 
02213     <a class="code" href="classAthletics.html">Athletics</a> *off = &amp;athletics_office;
02214     off_basketball_probability_win=off-&gt;<a class="code" href="classAthletics.html#m15">basketball_probability_win</a>;
02215     off_basketball_game_count_off_ncaa_level_input=off-&gt;<a class="code" href="classAthletics.html#m17">basketball_game_count</a>[off-&gt;<a class="code" href="classAthletics.html#m2">ncaa_level_input</a>];
02216     off_football_probability_win=off-&gt;<a class="code" href="classAthletics.html#m14">football_probability_win</a>;
02217     off_football_game_count_off_ncaa_level_input=off-&gt;<a class="code" href="classAthletics.html#m16">football_game_count</a>[off-&gt;<a class="code" href="classAthletics.html#m2">ncaa_level_input</a>];
02218     finance_total_expense_total=finance.total_expense.total;
02219     finance_last_year_surplus_deficit=finance.last_year.surplus_deficit;
02220     <span class="comment">//finance_last_year_surplus_deficit=finance.this_year.surplus_deficit;  //## chea 160899 show this year surplus</span>
02221 }
02222 
02223 <span class="comment">//--------- End of function Letter::init_welcome_letter -----------//</span>
02224 
02225 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
02226 <span class="preprocessor"></span><span class="comment">// --- Begin of function Letter::init_state_report --- //</span>
02227 <span class="comment">//</span>
02228 <span class="keywordtype">void</span> Letter::init_state_report() {
02229     <span class="keywordflow">if</span> ( finance.revenue_policy_array[0].upper_bound == 5 )
02230         max_state_page_number = 2;
02231     <span class="keywordflow">else</span>
02232         max_state_page_number = 3;
02233 }
02234 
02235 <span class="comment">// --- End of function Letter::init_state_report --- //</span>
02236 
02237 <span class="comment">// --- Begin of function Letter::state_report --- //</span>
02238 <span class="comment">//</span>
02239 <span class="keywordtype">void</span> Letter::state_report(<span class="keywordtype">int</span> refreshFlag) {
02240     <span class="keywordtype">int</span> tab1=<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>,tab2=<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>+70,
02241         tab3=<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>+100,tab4=<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>+700;
02242     <span class="keywordtype">int</span> vtab1=<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>+20,vtab2=<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>+70,
02243         vtab3=<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>+100,vtab4=<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>+350;
02244 
02245     <span class="keywordtype">int</span> list_tab1=185;
02246     <span class="keywordtype">int</span> list_tab2=230;
02247     <span class="keywordtype">int</span> list_tab3=240;
02248     <span class="keywordtype">int</span> list_tab4=250;
02249     <span class="keywordtype">int</span> list_tab5=580;
02250     <span class="keywordtype">int</span> list_tab6=660;
02251     <span class="keywordtype">int</span> list_start_y=230;
02252     <span class="keywordtype">int</span> list_line_space=25;
02253 
02254     vga.use_back();
02255 
02256     init_state_report();
02257 
02258     <span class="keywordflow">if</span> (refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>) {
02259         <span class="keywordflow">if</span>(letter_report_init_flag )
02260             <a class="code" href="classLetter.html#a5">deinit</a>();
02261 
02262         <span class="comment">//------------- paint the background ----------------//</span>
02263         <span class="keywordflow">if</span> (!letter_report_init_flag) {
02264             sys.set_speed(0);
02265             user_interface.bg_img(<a class="code" href="Oletter_8cpp.html#a48a37">BG_PIC_ID</a>, &amp;vga_back);
02266 
02267             font_letter.center_put(<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>+50,<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>,<a class="code" href="Oletter_8cpp.html#a45a24">REPORT_X1</a>+680,<a class="code" href="Oletter_8cpp.html#a45a25">REPORT_Y1</a>+20,<span class="stringliteral">"State Appropriation Report"</span>);
02268 
02269             letter_report_init_flag = 1;
02270 
02271             button_return.<a class="code" href="classButton.html#a10">create_text</a>( 180, vtab4+7,280,vtab4+28,<span class="stringliteral">"Back"</span> );
02272             button_back.<a class="code" href="classButton.html#a10">create_text</a>(350,vtab4+7,450,vtab4+28,<span class="stringliteral">"Proceed"</span>);
02273             button_pgup.<a class="code" href="classButton.html#a10">create_text</a>(570,vtab4-10,660,vtab4+13,<span class="stringliteral">"Prev. page"</span>);
02274             button_pgdn.<a class="code" href="classButton.html#a10">create_text</a>(570,vtab4+15,660,vtab4+38,<span class="stringliteral">"Next page"</span>);
02275         }
02276     }
02277     <span class="keywordflow">else</span> {
02278         vga.use_back();
02279     }
02280 
02281     <span class="keywordflow">if</span>((state_page_number!=old_state_page_number)||(refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>)) {
02282         old_state_page_number=state_page_number;
02283         <a class="code" href="classString.html">String</a> context;
02284 
02285         <span class="keywordtype">short</span> x1 = list_tab1;
02286         <span class="keywordtype">short</span> x2 = list_tab2;
02287         <span class="keywordtype">short</span> x3 = list_tab3;
02288         <span class="keywordtype">short</span> x4 = list_tab4;
02289         <span class="keywordtype">short</span> x5 = list_tab5;
02290         <span class="keywordtype">short</span> x6 = list_tab6;
02291         <span class="keywordtype">short</span> y = list_start_y;
02292 
02293         <span class="keywordflow">if</span>(state_page_number==1) {
02294             context  = <span class="stringliteral">"To      :      President "</span>;
02295             context += player_school.player_last_name;
02296             context += <span class="stringliteral">"\n"</span>;
02297 
02298             context += <span class="stringliteral">"From   :        "</span>;
02299             context += <span class="stringliteral">"State Higher Education Coordinating Board"</span>;
02300             context += <span class="stringliteral">"\n"</span>;
02301 
02302             context += <span class="stringliteral">"\n"</span>;
02303             context += <span class="stringliteral">"The Coordinating Board is pleased to inform  you of its funding decisions for the coming year."</span>;
02304             context += <span class="stringliteral">"\n"</span>;
02305 
02306             font_letter.put_paragraph(185,120,670,420,context);
02307 
02308             font_letter.right_put(x5,y,<span class="stringliteral">"Current"</span>);
02309             font_letter.right_put(x6,y,<span class="stringliteral">"Coming"</span>);
02310 
02311             y += 15;
02312 
02313             font_letter.right_put(x5,y,<span class="stringliteral">"year"</span>);
02314             <a class="code" href="classVga.html#p0">Vga::active_buf</a>-&gt;<a class="code" href="classVgaBuf.html#a34">line</a>(x5-26,y+17,x5,y+17,<a class="code" href="COLOR_8H.html#a15">V_BLACK</a>);
02315             font_letter.right_put(x6,y,<span class="stringliteral">"year"</span>);
02316             <a class="code" href="classVga.html#p0">Vga::active_buf</a>-&gt;<a class="code" href="classVgaBuf.html#a34">line</a>(x6-26,y+17,x6,y+17,<a class="code" href="COLOR_8H.html#a15">V_BLACK</a>);
02317 
02318             y += list_line_space;
02319 
02320             font_letter.put(x1,y,<span class="stringliteral">"Operating Funds"</span>);
02321 
02322             y += list_line_space;
02323 
02324             font_letter.put(x2,y,<span class="stringliteral">"Base appropriation"</span>);
02325             font_letter.right_put(x5,y,m.format(<span class="keywordtype">int</span>(finance.base_appropriation[0])));
02326             font_letter.right_put(x6,y,m.format(<span class="keywordtype">int</span>(finance.base_appropriation[1])));
02327 
02328             y += list_line_space+12;
02329 
02330             font_letter.put(x2,y,<span class="stringliteral">"Performance funding based on:"</span>);
02331 
02332             y += list_line_space;
02333 
02334             font_letter.put(x3,y,<span class="stringliteral">"Enrollment"</span>);
02335             font_letter.right_put(x5,y,m.format(<span class="keywordtype">int</span>(finance.enroll_appropriation[0])));
02336             font_letter.right_put(x6,y,m.format(<span class="keywordtype">int</span>(finance.enroll_appropriation[1])));
02337         }
02338         <span class="keywordflow">else</span>
02339             <span class="keywordflow">if</span> ( state_page_number == 2 ) {
02340                 <span class="comment">// Page 2</span>
02341                 y = 140;
02342                 font_letter.put(x3,y,<span class="stringliteral">"Performance indicators"</span>);
02343                 font_letter.right_put(x5,y,m.format(<span class="keywordtype">int</span>(finance.performance_appropriation[0])));
02344                 font_letter.right_put(x6,y,m.format(<span class="keywordtype">int</span>(finance.performance_appropriation[1])));
02345 
02346                 y += list_line_space;
02347 
02348                 font_letter.put(x4,y,<span class="stringliteral">"(degrees granted, student diversity,"</span>);
02349                 y += list_line_space;
02350                 font_letter.put(x4,y,<span class="stringliteral">" course denials, and class size)"</span>);
02351 
02352                 y += list_line_space;
02353 
02354                 font_letter.put(x3,y,<span class="stringliteral">"Education Quality Audit*"</span>);
02355                 font_letter.right_put(x5,y,m.format(<span class="keywordtype">int</span>(finance.education_quality_appropriation[0])));
02356                 font_letter.right_put(x6,y,m.format(<span class="keywordtype">int</span>(finance.education_quality_appropriation[1])));
02357 
02358                 y += list_line_space+8;
02359 
02360                 font_letter.put(x2,y,<span class="stringliteral">"Total state appropriation"</span>);
02361                 font_letter.right_put(x5,y,m.format(<span class="keywordtype">int</span>(finance.total_appropriation[0])));
02362                 font_letter.right_put(x6,y,m.format(<span class="keywordtype">int</span>(finance.total_appropriation[1])));
02363 
02364                 y += list_line_space;
02365 
02366                 context = <span class="stringliteral">"*The Education Quality Audit gives you a grade of "</span>;
02367                 <span class="keywordtype">int</span> result = player_school.think_protagonist_event(
02368                     player_school.sub_score[<a class="code" href="Opschool_8h.html#a65a40">S_EDUCATIONAL_QUALITY</a>][HISTORY_MONTH_COUNT-1],
02369                     player_school.sub_score[<a class="code" href="Opschool_8h.html#a65a40">S_EDUCATIONAL_QUALITY</a>][HISTORY_MONTH_COUNT-1-12],
02370                     player_school.sub_score_start[<a class="code" href="Opschool_8h.html#a65a40">S_EDUCATIONAL_QUALITY</a>],
02371                     player_school.get_protagonist_info(5),
02372                     -1, 1 );
02373 
02374                 <span class="keywordflow">switch</span>(result) {
02375                 <span class="keywordflow">case</span> 1:   context+=<span class="stringliteral">"Outstanding"</span>; <span class="keywordflow">break</span>;
02376                 <span class="keywordflow">case</span> 2:   context+=<span class="stringliteral">"Strong"</span>;    <span class="keywordflow">break</span>;
02377                 <span class="keywordflow">case</span> 3:   context+=<span class="stringliteral">"Weak"</span>;      <span class="keywordflow">break</span>;
02378                 <span class="keywordflow">case</span> 4:   context+=<span class="stringliteral">"Unacceptable"</span>;<span class="keywordflow">break</span>;
02379                 <span class="keywordflow">case</span> 5:
02380                 <span class="keywordflow">case</span> 6:   context+=<span class="stringliteral">"Mixed"</span>;     <span class="keywordflow">break</span>;
02381                 <span class="keywordflow">default</span>:    context+=<span class="stringliteral">"Satisfactory"</span>;
02382                 }
02383 
02384                 context += <span class="stringliteral">"."</span>;
02385                 font_letter.put(x1,y,context);
02386 
02387                 y += list_line_space+10;
02388 
02389                 font_letter.put(x1,y,<span class="stringliteral">"Supplementary Capital Funds"</span>);
02390 
02391                 y += list_line_space;
02392 
02393                 font_letter.put(x2,y,<span class="stringliteral">"Additions to the Facilities Reserve"</span>);
02394                 font_letter.right_put(x5,y,m.format(<span class="keywordtype">int</span>(finance.facility_reserve_appropriation[0]),3));
02395                 font_letter.right_put(x6,y,m.format(<span class="keywordtype">int</span>(finance.facility_reserve_appropriation[1]),3));
02396             }
02397             <span class="keywordflow">else</span> {
02398                 <span class="comment">// Page 3 ( Just show if there is Tuition Rate Limit )</span>
02399 
02400                 y = 140;
02401 
02402                 font_letter.put(x1,y,<span class="stringliteral">"Tuition rate limits"</span>);
02403 
02404                 y += list_line_space;
02405 
02406                 context = <span class="stringliteral">"In addition, we wish to inform you that the State Legislature has limited tuition growth for the coming year to "</span>;
02407                 context += m.format(finance.revenue_policy_array[0].upper_bound);
02408                 context += <span class="stringliteral">" percent. Your university's tuition increase will not be allowed to exceed this figure."</span>;
02409 
02410                 font_letter.put_paragraph(x1,y,x6,y+100,context);
02411             }
02412 
02413         <a class="code" href="classString.html">String</a> pagestr;
02414         pagestr = state_page_number;
02415         pagestr += <span class="stringliteral">"/"</span>;
02416         pagestr += max_state_page_number;
02417         font_letter.put(680,vtab4+20,pagestr.<a class="code" href="classString.html#m0">str_buf</a>);
02418 
02419         button_back.<a class="code" href="classButton.html#a20">paint</a>();
02420         button_return.<a class="code" href="classButton.html#a20">paint</a>();
02421         <span class="keywordflow">if</span>(state_page_number&lt;=1)button_pgup.<a class="code" href="classButton.html#a26">disable</a>();
02422         <span class="keywordflow">if</span>(state_page_number&gt;=max_state_page_number)button_pgdn.<a class="code" href="classButton.html#a26">disable</a>();
02423 
02424         button_pgup.<a class="code" href="classButton.html#a20">paint</a>();
02425         button_pgdn.<a class="code" href="classButton.html#a20">paint</a>();
02426 
02427         <span class="keywordflow">if</span>(refreshFlag != <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>)
02428             vga.blt_buf(185,140,670,420);
02429     }
02430     <span class="comment">//------- blt the back buffer to front buffer -------//</span>
02431 
02432     <span class="keywordflow">if</span>(refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>)
02433         vga.blt_buf(<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>, <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>);
02434 
02435     vga.use_front();
02436 }
02437 
02438 <span class="comment">//</span>
02439 <span class="comment">// --- End of function Letter::state_report --- //</span>
02440 
02441 <span class="comment">// --- Begin of function Letter::state_report_detect --- //</span>
02442 <span class="comment">//</span>
02443 <span class="keywordtype">int</span> Letter::state_report_detect() {
02444     <span class="keywordflow">if</span> (!letter_report_init_flag)
02445         <span class="keywordflow">return</span> 0;
02446     vga.use_front();
02447 
02448     <span class="comment">//--- recalculate the number of pages it has ----//</span>
02449 
02450     <span class="keywordflow">if</span>(state_page_number&lt;max_state_page_number)
02451         <span class="keywordflow">if</span>(button_pgdn.<a class="code" href="classButton.html#a21">detect</a>()) {
02452             <span class="keywordflow">if</span>(state_page_number&lt;max_state_page_number)
02453                 state_page_number++;
02454             sys.redraw_all_flag=1;
02455         };
02456 
02457     <span class="keywordflow">if</span>(state_page_number&gt;1)
02458         <span class="keywordflow">if</span>(button_pgup.<a class="code" href="classButton.html#a21">detect</a>()) {
02459             <span class="keywordflow">if</span>(state_page_number&gt;1)
02460                 state_page_number--;
02461             sys.redraw_all_flag=1;
02462         };
02463 
02464     <span class="comment">// for mail button</span>
02465     <span class="keywordflow">if</span>(button_back.<a class="code" href="classButton.html#a21">detect</a>()) {
02466         state_page_number=1;
02467         old_state_page_number=-1;
02468         <a class="code" href="classLetter.html#m1">welcome_page_number</a>=1;
02469         old_welcome_page_number=-1;
02470         <span class="keywordflow">if</span>(sys.save_view_mode!=<a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a>) {
02471             player_school.is_year_end_report = 1;
02472             player_school.current_report_type = 3;      <span class="comment">// (REPORT_TYPE_TURNOVER)</span>
02473             sys.set_staying_view_mode(0);
02474             sys.set_speed(sys.save_speed);
02475             sys.set_view_mode(<a class="code" href="Osys_8h.html#a45a9">MODE_NORMAL</a>);
02476             sys.save_view_mode=<a class="code" href="Osys_8h.html#a45a9">MODE_NORMAL</a>;
02477         }
02478         <span class="keywordflow">else</span> {
02479             player_school.is_year_end_report = 1;
02480             player_school.current_report_type = 3;      <span class="comment">// (REPORT_TYPE_TURNOVER)</span>
02481             sys.set_view_mode(<a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a>);
02482             <span class="comment">//                  sys.set_staying_view_mode(MODE_YEAR_END_REPORT);</span>
02483         }
02484         <span class="keywordflow">return</span> 2;
02485     }
02486 
02487 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
02488 <span class="preprocessor"></span>    <span class="keywordflow">if</span> ( button_return.<a class="code" href="classButton.html#a21">detect</a>() ) {
02489         sys.set_view_mode( <a class="code" href="Osys_8h.html#a45a34">MODE_EVALUATION_LETTER</a> );
02490         <span class="comment">//              sys.save_view_mode = MODE_YEAR_END_REPORT;</span>
02491         <span class="keywordflow">return</span> 1;
02492     }
02493 <span class="preprocessor">#endif</span>
02494 <span class="preprocessor"></span>
02495     <span class="keywordflow">if</span>(m.upper(mouse.is_key(mouse.scan_code, mouse.event_skey_state, (<a class="code" href="OCOLTBL_8H.html#a2">WORD</a>) 0, <a class="code" href="OMOUSE2_8H.html#a15a14">K_UNIQUE_KEY</a>))==<span class="charliteral">'W'</span>) {
02496         state_page_number=1;
02497         old_state_page_number=-1;
02498         <span class="keywordflow">if</span>(sys.save_view_mode!=<a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a>) {
02499             sys.set_staying_view_mode(0);
02500             sys.view_mode=<a class="code" href="Osys_8h.html#a45a34">MODE_EVALUATION_LETTER</a>;
02501             sys.save_view_mode=<a class="code" href="Osys_8h.html#a45a9">MODE_NORMAL</a>;
02502         }
02503         <span class="keywordflow">else</span>
02504             sys.set_staying_view_mode(<a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a>);
02505         <span class="keywordflow">return</span> 0;
02506     }
02507 
02508     <span class="keywordflow">return</span> 0;
02509 }
02510 
02511 <span class="comment">//</span>
02512 <span class="comment">// --- End of function Letter::state_report_detect --- //</span>
02513 <span class="preprocessor">#endif</span>
02514 <span class="preprocessor"></span>
02515 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
02516 <span class="preprocessor"></span><span class="comment">// --- Begin of function Letter::get_variable_score --- //</span>
02517 <span class="comment">//</span>
02518 <span class="keywordtype">void</span> Letter::get_variables_score(<span class="keywordtype">char</span> ascend) {
02519 
02520     <span class="keywordtype">float</span> strength;
02521     <span class="keywordtype">float</span> consistency;
02522     <span class="keywordtype">float</span> k1;
02523 
02524     <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> subScoreType=0; subScoreType&lt;SCORE_VAR_COUNT; subScoreType++ ) {
02525         <span class="keywordtype">float</span> curValue = player_school.sub_score[subScoreType][HISTORY_MONTH_COUNT-1];
02526         <span class="keywordtype">float</span> lastYearValue = player_school.sub_score[subScoreType][HISTORY_MONTH_COUNT-13];
02527         <span class="keywordtype">float</span> initialValue = player_school.sub_score_start[subScoreType];
02528 
02529         player_school.calc_strength_consistency_k1(curValue, lastYearValue,initialValue,
02530                                                    player_school.get_protagonist_info(2+subScoreType),strength, consistency, k1);
02531 
02532         sort_data[subScoreType].<a class="code" href="structSortData.html#m0">idx</a> = subScoreType;
02533         sort_data[subScoreType].strength = strength;
02534         sort_data[subScoreType].consistency = consistency;
02535         sort_data[subScoreType].k1 = k1;
02536 
02537         <span class="comment">//              sort_data[subScoreType].tag = 0;</span>
02538     }
02539 
02540     <span class="keywordflow">if</span> ( ascend )
02541         qsort(sort_data,(size_t)SCORE_VAR_COUNT,<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structSortData.html">SortData</a>),<a class="code" href="Oletter_8cpp.html#a43">compare_ascend</a>);
02542     <span class="keywordflow">else</span>
02543         qsort(sort_data,(size_t)SCORE_VAR_COUNT,<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structSortData.html">SortData</a>),<a class="code" href="Oletter_8cpp.html#a44">compare_descend</a>);
02544 }
02545 
02546 <span class="comment">//</span>
02547 <span class="comment">// --- End of function Letter::get_variable_score --- //</span>
02548 <span class="preprocessor">#endif</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:38:01 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
