<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Oprtmen1.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Oprtmen1.cpp</h1><a href="Oprtmen1_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : OPRTMENU1.CPP</span>
00002 <span class="comment">//Description : Printing Menu Class Implementation</span>
00003 <span class="comment">//Owner           : Kevin(ho)</span>
00004 
00005 <span class="preprocessor">#include &lt;OPRINT.H&gt;</span>
00006 <span class="preprocessor">#include &lt;<a class="code" href="OVGALOCK_8H.html">OVGALOCK.H</a>&gt;</span>
00007 <span class="preprocessor">#include &lt;<a class="code" href="OPRTMENU_8H.html">OPRTMENU.H</a>&gt;</span>
00008 <span class="preprocessor">#include &lt;OWORLDMT.H&gt;</span>
00009 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00010 <span class="preprocessor">#include &lt;<a class="code" href="OBOX_8H.html">OBOX.H</a>&gt;</span>
00011 <span class="preprocessor">#include &lt;<a class="code" href="OVGA_8H.html">OVGA.H</a>&gt;</span>
00012 <span class="preprocessor">#include &lt;OFONT.H&gt;</span>
00013 <span class="preprocessor">#include &lt;OGAMESTR.H&gt;</span>
00014 <span class="preprocessor">#include &lt;OMOUSE.H&gt;</span>
00015 <span class="preprocessor">#include &lt;<a class="code" href="OMOUSE2_8H.html">OMOUSE2.H</a>&gt;</span>
00016 <span class="preprocessor">#include &lt;OIFACE.H&gt;</span>
00017 <span class="preprocessor">#include &lt;OINFO.H&gt;</span>
00018 <span class="preprocessor">#include &lt;OPSCHOOL.H&gt;</span>
00019 <span class="preprocessor">#include &lt;ODEPT.H&gt;</span>
00020 <span class="preprocessor">#include &lt;<a class="code" href="ODATE_8H.html">ODATE.H</a>&gt;</span>
00021 
00022 <span class="keyword">enum</span> {                                            <span class="comment">// screen coordinates</span>
00023   <a class="code" href="Oprtmen1_8cpp.html#a10a2">REPORT_X1</a> = <a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>+15,
00024   <a class="code" href="Oprtmen1_8cpp.html#a10a3">REPORT_Y1</a> = <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>+25,
00025   <a class="code" href="Oprtmen1_8cpp.html#a10a4">REPORT_X2</a> = <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-15,
00026   <a class="code" href="Oprtmen1_8cpp.html#a10a5">REPORT_Y2</a> = <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-55
00027 };
00028 
00029 <span class="keyword">enum</span> {
00030   <a class="code" href="Oprtmen1_8cpp.html#a11a6">PRINT_OPT1</a>=1,
00031   <a class="code" href="Oprtmen1_8cpp.html#a11a7">PRINT_OPT2</a>=2,
00032   <a class="code" href="Oprtmen1_8cpp.html#a11a8">PRINT_OPT3</a>=3,
00033   <a class="code" href="Oprtmen1_8cpp.html#a11a9">PRINT_OPT4</a>=4,
00034 };
00035 
00036 <span class="comment">//-------- Define scenario name for printing ----------//</span>
00037 
00038 <span class="keywordtype">char</span>* PrintMenu::scn_name[<a class="code" href="Opschool_8h.html#a63a32">SCENARIO_COUNT</a>] = {
00039   <span class="stringliteral">"Scenario 1.  -- PAY BETTER"</span>,
00040   <span class="stringliteral">"Scenario 2.  -- ALLOCATE NEW MONEY"</span>,
00041   <span class="stringliteral">"Scenario 3.  -- TEACH BETTER"</span>,
00042   <span class="stringliteral">"Scenario 4.  -- IMPROVE RESEARCH PERFORMANCE"</span>,
00043   <span class="stringliteral">"Scenario 5.  -- WIN GAMES"</span>,
00044   <span class="stringliteral">"Scenario 6   -- REDUCE TUITION"</span>,
00045   <span class="stringliteral">"Scenario 7.  -- RESPOND TO ENROLLMENT SHIFTS"</span>,
00046   <span class="stringliteral">"Scenario 8.  -- ENROLL MORE MINORITY STUDENTS"</span>,
00047   <span class="stringliteral">"Scenario 9.  -- HIRE MORE MINORITY FACULTY MEMBERS"</span>,
00048   <span class="stringliteral">"Scenario 10. -- BALANCE THE BUDGET"</span>,
00049 };
00050 
00051 <span class="comment">//------- Define static vars -----------//</span>
00052 
00053 <span class="keyword">static</span> <span class="keywordtype">int</span> filename_count=0;
00054 <span class="keyword">static</span> <a class="code" href="classString.html">String</a> fn;
00055 
00056 <span class="comment">//------- Begin of function PrintMenu::printing1 ------//</span>
00057 
<a name="l00058"></a><a class="code" href="classPrintMenu.html#a6">00058</a> <span class="keywordtype">void</span> <a class="code" href="classPrintMenu.html#a6">PrintMenu::printing1</a>() {
00059   box.tell(<span class="stringliteral">"Now printing. \nPlease wait..."</span>);
00060   sys.no_true_output_flag=1;
00061   box.close();
00062   sys.no_true_output_flag=0;
00063 
00067   <span class="keywordflow">if</span>(<a class="code" href="classPrintMenu.html#m0">print_view_mode</a>==<a class="code" href="Osys_8h.html#a45a11">MODE_STUDENT_REPORT</a>) {
00068     <span class="keyword">enum</span> {
00069       REPORT_TYPE_DEPARTMENT_PROFILE1, REPORT_TYPE_DEPARTMENT_PROFILE2,
00070       REPORT_TYPE_DEPARTMENT_ACTIVITIES,
00071 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00072 <span class="preprocessor"></span>      REPORT_TYPE_TURNOVER,
00073 <span class="preprocessor">#endif</span>
00074 <span class="preprocessor"></span>      REPORT_TYPE_INSTITUTION_PROFILE1, REPORT_TYPE_INSTITUTION_PROFILE2,
00075       REPORT_TYPE_INSTITUTION_ACTIVITIES, REPORT_TYPE_INSTITUTION_UNDERGRADUATE,
00076       REPORT_TYPE_FINANCE,
00077       REPORT_TYPE_RESIDENCE_HALL,
00078     };
00079     <span class="keyword">enum</span> { REPORT_MODE_INSTITUTION, REPORT_MODE_DEPARTMENT}; {
00080       <a class="code" href="classMouseDispCount.html">MouseDispCount</a> mdc;
00081       print.start_print(sys.main_hwnd,sys.app_hinstance);
00082       print.open_page();
00083 
00084       print.dfont(18,<span class="keyword">false</span>,<span class="keyword">false</span>,700);
00085       print.put_text(<span class="stringliteral">"Virtual U Department Student Report"</span>,17,1);
00086       print.dfont(10,<span class="keyword">false</span>,<span class="keyword">false</span>,0);
00087 
00088       print.put_text(<span class="stringliteral">"Insitution : "</span>,30,4);
00089                                                   <span class="comment">//Player Institution</span>
00090       print.put_text(player_school.school_name,44,4);
00091       print.put_text(<span class="stringliteral">"President : "</span>,30,5);
00092       <a class="code" href="classString.html">String</a> str;
00093       str =  player_school.player_first_name;
00094       str += <span class="stringliteral">" "</span>;
00095       str += player_school.player_last_name;
00096       print.put_text(str.<a class="code" href="classString.html#m0">str_buf</a>,44,5);           <span class="comment">//President</span>
00097       print.put_text(<span class="stringliteral">"Date : "</span>,99,5);
00098       <span class="comment">// print.put_text(date.date_str(info.game_date),107,5);                   //date</span>
00099                                                   <span class="comment">//date</span>
00100       print.put_text(info.date_str_julian(info.game_date),107,5);
00101 
00102       <span class="keywordflow">if</span>(player_school.scenario_id&gt;0) {
00103         print.dfont(10,<span class="keyword">false</span>,<span class="keyword">false</span>,700);
00104         print.put_text(scn_name[player_school.scenario_id-1],50,6);
00105       }
00106 
00107       <span class="keywordflow">if</span>(<a class="code" href="classPrintMenu.html#m1">print_option</a>==1) {
00108         <span class="keywordtype">int</span> deptRecno = department_array.selected_recno;
00109         <a class="code" href="classDepartment.html">Department</a>* cur_dept_ptr = department_array[deptRecno];
00110         <a class="code" href="classString.html">String</a> str1;
00111         str1 =<span class="stringliteral">"Department : "</span>;
00112         str1 +=cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a3">name</a>();
00113         str1 +=<span class="stringliteral">"                                                                                                                              "</span>;
00114         print.dfont(12,<span class="keyword">false</span>,<span class="keyword">false</span>,0);
00115         print.put_text(<span class="stringliteral">"________________________________________________________________________________________________________________________________________________________________________________________________"</span>,20,6);
00116         print.dfont(12,<span class="keyword">false</span>,<span class="keyword">true</span>,0);
00117         print.put_text(str1.<a class="code" href="classString.html#m0">str_buf</a>,20,7);
00118 
00119         user_interface.backgd_flag=0;
00120         sys.no_true_output_flag=1;
00121         sys.view_mode=<a class="code" href="Osys_8h.html#a45a11">MODE_STUDENT_REPORT</a>;
00122         player_school.summary_student_report_deinit();
00123         player_school.summary_student_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00124 
00125         <span class="comment">// ##### begin Gilbert 07/07/2001 #####//</span>
00126         <span class="comment">//First page printing</span>
00127         <span class="comment">//*********************start printing********************</span>
00128 
00129         <span class="comment">//this will print the bmp in the center of the paper and 1/7 down the page</span>
00130         print.put_vga_back_center(<span class="stringliteral">"prn001.bmp"</span>,
00131           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-63,
00132           0.2,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00133         <span class="comment">/*upper left cor. of bitmap*/</span>
00134           );
00135         <span class="comment">// ##### end Gilbert 07/07/2001 #####//</span>
00136 
00137         <span class="comment">// ####### begin Gilbert 27/04/2001 #####//</span>
00138         <span class="comment">// save memory</span>
00139         player_school.summary_student_report_deinit();
00140         <span class="comment">// ####### end Gilbert 27/04/2001 #####//</span>
00141 
00142         sys.no_true_output_flag=0;
00143         user_interface.backgd_flag=1;
00144       }
00145 
00146       <span class="keywordflow">if</span>(<a class="code" href="classPrintMenu.html#m1">print_option</a>==2) {
00147         <span class="keywordtype">int</span> deptRecno = department_array.selected_recno;
00148         <a class="code" href="classDepartment.html">Department</a>* cur_dept_ptr = department_array[deptRecno];
00149         <a class="code" href="classString.html">String</a> str1;
00150         str1 =<span class="stringliteral">"Department : "</span>;
00151         str1 +=cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a3">name</a>();
00152         str1 +=<span class="stringliteral">"                                                                                                                              "</span>;
00153         print.dfont(12,<span class="keyword">false</span>,<span class="keyword">false</span>,0);
00154         print.put_text(<span class="stringliteral">"________________________________________________________________________________________________________________________________________________________________________________________________"</span>,20,6);
00155         print.dfont(12,<span class="keyword">false</span>,<span class="keyword">true</span>,0);
00156         print.put_text(str1.<a class="code" href="classString.html#m0">str_buf</a>,20,7);
00157 
00158         user_interface.backgd_flag=0;
00159         sys.no_true_output_flag=1;
00160 
00161         sys.view_mode=<a class="code" href="Osys_8h.html#a45a11">MODE_STUDENT_REPORT</a>;
00162 
00163         <span class="keywordtype">int</span> report_type_backup=player_school.current_report_type;
00164         <span class="keywordtype">int</span> report_mode_backup=player_school.current_report_mode;
00165         player_school.current_report_mode=REPORT_MODE_DEPARTMENT;
00166 
00167         player_school.summary_student_report_deinit();
00168         player_school.current_report_type=REPORT_TYPE_DEPARTMENT_PROFILE1;
00169         player_school.summary_student_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00170         print.put_vga_back_center(<span class="stringliteral">"prn001.bmp"</span>,
00171           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-70,
00172           0.15,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00173           );
00174 
00175         player_school.summary_student_report_deinit();
00176         player_school.current_report_type=REPORT_TYPE_DEPARTMENT_PROFILE2;
00177         player_school.summary_student_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00178         print.put_vga_back_center(<span class="stringliteral">"prn002.bmp"</span>,
00179           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-70,
00180           0.4,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00181           );
00182 
00183         player_school.summary_student_report_deinit();
00184         player_school.current_report_type=REPORT_TYPE_DEPARTMENT_ACTIVITIES;
00185         player_school.summary_student_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00186         print.put_vga_back_center(<span class="stringliteral">"prn003.bmp"</span>,
00187           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00188           0.65,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00189           );
00190 
00191         <span class="comment">// ####### begin Gilbert 27/04/2001 #####//</span>
00192         <span class="comment">// save memory</span>
00193         player_school.summary_student_report_deinit();
00194         <span class="comment">// ####### end Gilbert 27/04/2001 #####//</span>
00195 
00196         player_school.current_report_type=report_type_backup;
00197         player_school.current_report_mode=report_mode_backup;
00198         sys.no_true_output_flag=0;
00199         user_interface.backgd_flag=1;
00200         <span class="comment">// ####### begin Gilbert 27/04/2001 #####//</span>
00201         <span class="comment">// save memory</span>
00202         <span class="comment">// player_school.summary_student_report(INFO_REPAINT);</span>
00203         <span class="comment">// ####### end Gilbert 27/04/2001 #####//</span>
00204       }
00205 
00206       <span class="keywordflow">if</span>(<a class="code" href="classPrintMenu.html#m1">print_option</a>==3) {
00207         user_interface.backgd_flag=0;
00208         sys.no_true_output_flag=1;
00209 
00210         sys.view_mode=<a class="code" href="Osys_8h.html#a45a11">MODE_STUDENT_REPORT</a>;
00211         <span class="keywordtype">int</span> report_type_backup=player_school.current_report_type;
00212         <span class="keywordtype">int</span> report_mode_backup=player_school.current_report_mode;
00213         <span class="keywordtype">int</span> report_dept_backup=department_array.selected_recno;
00214         player_school.current_report_mode=REPORT_MODE_DEPARTMENT;
00215 
00216         filename_count=0;
00217         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> deptRecno=1;deptRecno &lt;= department_array.size();deptRecno++) {
00218           <span class="keywordflow">if</span>( department_array.is_deleted(deptRecno))
00219             <span class="keywordflow">continue</span>;
00220 
00221           <a class="code" href="classDepartment.html">Department</a>* cur_dept_ptr = department_array[deptRecno];
00222           <a class="code" href="classString.html">String</a> str1;
00223           str1 =<span class="stringliteral">"Department : "</span>;
00224           str1 +=cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a3">name</a>();
00225           str1 +=<span class="stringliteral">"                                                                                                                              "</span>;
00226           print.dfont(12,<span class="keyword">false</span>,<span class="keyword">false</span>,0);
00227           print.put_text(<span class="stringliteral">"________________________________________________________________________________________________________________________________________________________________________________________________"</span>,20,6);
00228           print.dfont(12,<span class="keyword">false</span>,<span class="keyword">true</span>,0);
00229           print.put_text(str1.<a class="code" href="classString.html#m0">str_buf</a>,20,7);
00230 
00231           player_school.summary_student_report_deinit();
00232           department_array.selected_recno=deptRecno;
00233           player_school.<a class="code" href="classDepartment.html#m51">current_report_type</a>=REPORT_TYPE_DEPARTMENT_PROFILE1;
00234           player_school.summary_student_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00235 
00236           <span class="comment">//                                    fn="prn";</span>
00237           <span class="comment">//                                    fn+=++filename_count;</span>
00238           <span class="comment">//                                    fn+=".bmp";</span>
00239           <span class="comment">//                                    print.put_vga_back_center(fn.str_buf,</span>
00240           print.put_vga_back_center(<span class="stringliteral">"prn001.bmp"</span>,
00241             <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-70,
00242             0.15,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00243             );
00244 
00245           player_school.summary_student_report_deinit();
00246           department_array.selected_recno=deptRecno;
00247           player_school.<a class="code" href="classDepartment.html#m51">current_report_type</a>=REPORT_TYPE_DEPARTMENT_PROFILE2;
00248           player_school.summary_student_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00249 
00250           <span class="comment">/*                                    fn="prn";</span>
00251 <span class="comment">                    fn+=++filename_count;</span>
00252 <span class="comment">                    fn+=".bmp";</span>
00253 <span class="comment">                    print.put_vga_back_center(fn.str_buf,</span>
00254 <span class="comment">          */</span>
00255           print.put_vga_back_center(<span class="stringliteral">"prn002.bmp"</span>,
00256             <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-70,
00257             0.4,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00258             );
00259 
00260           player_school.summary_student_report_deinit();
00261           department_array.selected_recno=deptRecno;
00262           player_school.<a class="code" href="classDepartment.html#m51">current_report_type</a>=REPORT_TYPE_DEPARTMENT_ACTIVITIES;
00263           player_school.summary_student_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00264 
00265           <span class="comment">/*                                    fn="prn";</span>
00266 <span class="comment">                    fn+=++filename_count;</span>
00267 <span class="comment">                    fn+=".bmp";</span>
00268 <span class="comment">                    print.put_vga_back_center(fn.str_buf,</span>
00269 <span class="comment">          */</span>
00270           print.put_vga_back_center(<span class="stringliteral">"prn003.bmp"</span>,
00271             <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00272             0.65,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00273             );
00274           <span class="keywordflow">if</span>(deptRecno &lt; department_array.size()) {
00275             print.end_page();
00276             print.open_page();
00277           }
00278         }
00279 
00280         <span class="comment">// ####### begin Gilbert 27/04/2001 #####//</span>
00281         <span class="comment">// save memory</span>
00282         player_school.summary_student_report_deinit();
00283         <span class="comment">// ####### end Gilbert 27/04/2001 #####//</span>
00284 
00285         player_school.current_report_type=report_type_backup;
00286         player_school.current_report_mode=report_mode_backup;
00287         department_array.selected_recno=report_dept_backup;
00288         sys.no_true_output_flag=0;
00289         user_interface.backgd_flag=1;
00290         <span class="comment">// ####### begin Gilbert 27/04/2001 #####//</span>
00291         <span class="comment">// save memory</span>
00292         <span class="comment">// player_school.summary_student_report(INFO_REPAINT);</span>
00293         <span class="comment">// ####### end Gilbert 27/04/2001 #####//</span>
00294       }
00295 
00296       <span class="keywordflow">if</span>(<a class="code" href="classPrintMenu.html#m1">print_option</a>==4) {
00297         <span class="keywordtype">int</span> deptRecno = department_array.selected_recno;
00298         <a class="code" href="classDepartment.html">Department</a>* cur_dept_ptr = department_array[deptRecno];
00299         <a class="code" href="classString.html">String</a> str1;
00300         <span class="comment">//                              str1 ="Department : ";</span>
00301         <span class="comment">//                              str1 +=cur_dept_ptr-&gt;name();</span>
00302         <span class="comment">//                              str1 +="                                                                                                                              ";</span>
00303         <span class="comment">//                              print.dfont(12,false,false,0);</span>
00304         <span class="comment">//                              print.put_text("________________________________________________________________________________________________________________________________________________________________________________________________",20,6);</span>
00305         <span class="comment">//                              print.dfont(12,false,true,0);</span>
00306         <span class="comment">//                              print.put_text(str1.str_buf,20,7);</span>
00307 
00308         user_interface.backgd_flag=0;
00309         sys.no_true_output_flag=1;
00310 
00311         sys.view_mode=<a class="code" href="Osys_8h.html#a45a11">MODE_STUDENT_REPORT</a>;
00312         <span class="keywordtype">int</span> report_type_backup=player_school.current_report_type;
00313 
00314         player_school.summary_student_report_deinit();
00315         player_school.current_report_type=REPORT_TYPE_INSTITUTION_PROFILE1;
00316         player_school.summary_student_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00317         print.put_vga_back_center(<span class="stringliteral">"prn001.bmp"</span>,
00318           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-70,
00319           0.15,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00320           );
00321 
00322         player_school.summary_student_report_deinit();
00323         player_school.current_report_type=REPORT_TYPE_INSTITUTION_PROFILE2;
00324         player_school.summary_student_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00325         print.put_vga_back_center(<span class="stringliteral">"prn002.bmp"</span>,
00326           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-70,
00327           0.4,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00328           );
00329 
00330         player_school.summary_student_report_deinit();
00331         player_school.current_report_type=REPORT_TYPE_INSTITUTION_ACTIVITIES;
00332         player_school.summary_student_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00333         print.put_vga_back_center(<span class="stringliteral">"prn003.bmp"</span>,
00334           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00335           0.65,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00336           );
00337 
00338         print.end_page();
00339         print.open_page();
00340 
00341         player_school.summary_student_report_deinit();
00342         player_school.current_report_type=REPORT_TYPE_INSTITUTION_UNDERGRADUATE;
00343         player_school.summary_student_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00344         print.put_vga_back_center(<span class="stringliteral">"prn004.bmp"</span>,
00345           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-70,
00346           0.05,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00347           );
00348 
00349         player_school.summary_student_report_deinit();
00350         player_school.current_report_type=REPORT_TYPE_FINANCE;
00351         player_school.summary_student_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00352         print.put_vga_back_center(<span class="stringliteral">"prn005.bmp"</span>,
00353           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00354           0.3,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00355           );
00356 
00357         player_school.summary_student_report_deinit();
00358         player_school.current_report_type=REPORT_TYPE_RESIDENCE_HALL;
00359         player_school.summary_student_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00360         print.put_vga_back_center(<span class="stringliteral">"prn006.bmp"</span>,
00361           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00362           0.55,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00363           );
00364 
00365 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00366 <span class="preprocessor"></span>        print.end_page();
00367         print.open_page();
00368 
00369         player_school.summary_student_report_deinit();
00370         player_school.current_report_type=REPORT_TYPE_TURNOVER;
00371         player_school.summary_student_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00372         print.put_vga_back_center(<span class="stringliteral">"prn007.bmp"</span>,
00373           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00374           0.05,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00375           );
00376 <span class="preprocessor">#endif</span>
00377 <span class="preprocessor"></span>
00378         <span class="comment">// ####### begin Gilbert 27/04/2001 #####//</span>
00379         <span class="comment">// save memory</span>
00380         player_school.summary_student_report_deinit();
00381         <span class="comment">// ####### end Gilbert 27/04/2001 #####//</span>
00382 
00383         player_school.current_report_type=report_type_backup;
00384         sys.no_true_output_flag=0;
00385         user_interface.backgd_flag=1;
00386 
00387         <span class="comment">// ####### begin Gilbert 27/04/2001 #####//</span>
00388         <span class="comment">// save memory</span>
00389         <span class="comment">// player_school.summary_student_report(INFO_REPAINT);</span>
00390         <span class="comment">// ####### end Gilbert 27/04/2001 #####//</span>
00391       }
00392 
00393       print.end_page();
00394       print.endprint(sys.main_hwnd);
00395     }
00396   }
00398 
00402   <span class="keywordflow">if</span>(<a class="code" href="classPrintMenu.html#m0">print_view_mode</a>==<a class="code" href="Osys_8h.html#a45a10">MODE_FACULTY_SUMMARY</a>) {
00403 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00404 <span class="preprocessor"></span>    <span class="keyword">enum</span> {
00405       REPORT_TYPE_DEPARTMENT_PROFILE1,
00406       REPORT_TYPE_DEPARTMENT_PROFILE2,
00407       REPORT_TYPE_DEPARTMENT_ACTIVITIES,
00408       REPORT_TYPE_DEPARTMENT_RESEARCH,
00409       REPORT_TYPE_DEPARTMENT_HIRING,
00410       REPORT_TYPE_DEPARTMENT_DIRECTORY,
00411       REPORT_TYPE_DEPARTMENT_TURNOVER,
00412       REPORT_TYPE_INSTITUTION_PROFILE1,
00413       REPORT_TYPE_INSTITUTION_PROFILE2,
00414       REPORT_TYPE_INSTITUTION_ACTIVITIES,
00415       REPORT_TYPE_INSTITUTION_RESEARCH,
00416       REPORT_TYPE_INSTITUTION_SALARY,
00417       REPORT_TYPE_INSTITUTION_PROMOTION,
00418       REPORT_TYPE_INSTITUTION_TURNOVER,
00419       REPORT_TYPE_DEPARTMENT_TURNOVER_DETAIL,
00420     };
00421 <span class="preprocessor">#else</span>
00422 <span class="preprocessor"></span>    <span class="keyword">enum</span> {
00423       REPORT_TYPE_DEPARTMENT_PROFILE1,
00424       REPORT_TYPE_DEPARTMENT_PROFILE2,
00425       REPORT_TYPE_DEPARTMENT_ACTIVITIES,
00426       REPORT_TYPE_DEPARTMENT_RESEARCH,
00427       REPORT_TYPE_DEPARTMENT_DIRECTORY,
00428       REPORT_TYPE_DEPARTMENT_HIRING,
00429       REPORT_TYPE_INSTITUTION_PROFILE1,
00430       REPORT_TYPE_INSTITUTION_PROFILE2,
00431       REPORT_TYPE_INSTITUTION_ACTIVITIES,
00432       REPORT_TYPE_INSTITUTION_RESEARCH,
00433       REPORT_TYPE_INSTITUTION_SALARY,
00434       REPORT_TYPE_INSTITUTION_PROMOTION,
00435     };
00436 <span class="preprocessor">#endif</span>
00437 <span class="preprocessor"></span>        {
00438       <a class="code" href="classMouseDispCount.html">MouseDispCount</a> mdc;
00439       print.start_print(sys.main_hwnd,sys.app_hinstance);
00440       print.open_page();
00441 
00442       print.dfont(18,<span class="keyword">false</span>,<span class="keyword">false</span>,700);
00443       print.put_text(<span class="stringliteral">"Virtual U Department Faculty Report"</span>,17,1);
00444       print.dfont(10,<span class="keyword">false</span>,<span class="keyword">false</span>,0);
00445 
00446       print.put_text(<span class="stringliteral">"Insitution : "</span>,30,4);
00447                                                   <span class="comment">//Player Institution</span>
00448       print.put_text(player_school.school_name,44,4);
00449       print.put_text(<span class="stringliteral">"President : "</span>,30,5);
00450       <a class="code" href="classString.html">String</a> str;
00451       str =  player_school.player_first_name;
00452       str += <span class="stringliteral">" "</span>;
00453       str += player_school.player_last_name;
00454       print.put_text(str.<a class="code" href="classString.html#m0">str_buf</a>,44,5);           <span class="comment">//President</span>
00455       print.put_text(<span class="stringliteral">"Date : "</span>,99,5);
00456       <span class="comment">// print.put_text(date.date_str(info.game_date),107,5);                   //date</span>
00457       print.put_text(info.date_str_julian(info.game_date), 107,5);
00458 
00459       <span class="keywordflow">if</span>(player_school.scenario_id&gt;0) {
00460         print.dfont(10,<span class="keyword">false</span>,<span class="keyword">false</span>,700);
00461         print.put_text(scn_name[player_school.scenario_id-1],50,6);
00462       }
00463 
00464       <span class="keywordflow">if</span>(<a class="code" href="classPrintMenu.html#m1">print_option</a>==1) {
00465         <span class="keywordtype">int</span> deptRecno = department_array.selected_recno;
00466         <a class="code" href="classDepartment.html">Department</a>* cur_dept_ptr = department_array[deptRecno];
00467         <a class="code" href="classString.html">String</a> str1;
00468         str1 =<span class="stringliteral">"Department : "</span>;
00469         str1 +=cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a3">name</a>();
00470         str1 +=<span class="stringliteral">"                                                                                                                              "</span>;
00471         print.dfont(12,<span class="keyword">false</span>,<span class="keyword">false</span>,0);
00472         print.put_text(<span class="stringliteral">"________________________________________________________________________________________________________________________________________________________________________________________________"</span>,20,6);
00473         print.dfont(12,<span class="keyword">false</span>,<span class="keyword">true</span>,0);
00474         print.put_text(str1.<a class="code" href="classString.html#m0">str_buf</a>,20,7);
00475 
00476         user_interface.backgd_flag=0;
00477         sys.no_true_output_flag=1;
00478         sys.view_mode=<a class="code" href="Osys_8h.html#a45a10">MODE_FACULTY_SUMMARY</a>;
00479         faculty_res.summary_report_deinit();
00480         faculty_res.summary_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00481 
00482         <span class="comment">//First page printing</span>
00483         <span class="comment">//*********************start printing********************</span>
00484         <span class="comment">//this will print the bmp in the center of the paper and 1/7 down the page</span>
00485         print.put_vga_back_center(<span class="stringliteral">"prn001.bmp"</span>,
00486           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-63,
00487           0.2,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00488         <span class="comment">/*upper left cor. of bitmap*/</span>
00489           );
00490 
00491         <span class="comment">// ##### begin Gilbert 27/04/2001 ######//</span>
00492         <span class="comment">// have memory not freed, call summary_report_deinit instead</span>
00493         faculty_res.summary_report_deinit();
00494         <span class="comment">// ##### end Gilbert 27/04/2001 ######//</span>
00495 
00496         sys.no_true_output_flag=0;
00497         user_interface.backgd_flag=1;
00498       }
00499 
00500       <span class="keywordflow">if</span>(<a class="code" href="classPrintMenu.html#m1">print_option</a>==2) {
00501         <span class="keywordtype">int</span> deptRecno = department_array.selected_recno;
00502         <a class="code" href="classDepartment.html">Department</a>* cur_dept_ptr = department_array[deptRecno];
00503         <a class="code" href="classString.html">String</a> str1;
00504         str1 =<span class="stringliteral">"Department : "</span>;
00505         str1 +=cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a3">name</a>();
00506         str1 +=<span class="stringliteral">"                                                                                                                              "</span>;
00507         print.dfont(12,<span class="keyword">false</span>,<span class="keyword">false</span>,0);
00508         print.put_text(<span class="stringliteral">"________________________________________________________________________________________________________________________________________________________________________________________________"</span>,20,6);
00509         print.dfont(12,<span class="keyword">false</span>,<span class="keyword">true</span>,0);
00510         print.put_text(str1.<a class="code" href="classString.html#m0">str_buf</a>,20,7);
00511 
00512         user_interface.backgd_flag=0;
00513         sys.no_true_output_flag=1;
00514 
00515         sys.view_mode=<a class="code" href="Osys_8h.html#a45a10">MODE_FACULTY_SUMMARY</a>;
00516         <span class="keywordtype">int</span> report_type_backup=faculty_res.current_report_type;
00517 
00518         faculty_res.summary_report_deinit();
00519         faculty_res.current_report_type=REPORT_TYPE_DEPARTMENT_PROFILE1;
00520         faculty_res.summary_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00521         print.put_vga_back_center(<span class="stringliteral">"prn002.bmp"</span>,
00522           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-70,
00523           0.15,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00524           );
00525 
00526         faculty_res.summary_report_deinit();
00527         faculty_res.current_report_type=REPORT_TYPE_DEPARTMENT_PROFILE2;
00528         faculty_res.summary_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00529         print.put_vga_back_center(<span class="stringliteral">"prn002.bmp"</span>,
00530           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-70,
00531           0.4,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00532           );
00533 
00534         faculty_res.summary_report_deinit();
00535         faculty_res.current_report_type=REPORT_TYPE_DEPARTMENT_ACTIVITIES;
00536         faculty_res.summary_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00537         print.put_vga_back_center(<span class="stringliteral">"prn003.bmp"</span>,
00538           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00539           0.65,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00540           );
00541 
00542         print.end_page();
00543         print.open_page();
00544 
00545         faculty_res.summary_report_deinit();
00546         faculty_res.current_report_type=REPORT_TYPE_DEPARTMENT_RESEARCH;
00547         faculty_res.summary_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00548         print.put_vga_back_center(<span class="stringliteral">"prn004.bmp"</span>,
00549           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00550           0.15,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00551           );
00552 
00553         faculty_res.summary_report_deinit();
00554         faculty_res.current_report_type=REPORT_TYPE_DEPARTMENT_HIRING;
00555         faculty_res.summary_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00556         print.put_vga_back_center(<span class="stringliteral">"prn005.bmp"</span>,
00557           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00558           0.45,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00559           );
00560 
00561 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00562 <span class="preprocessor"></span>        faculty_res.summary_report_deinit();
00563         faculty_res.current_report_type=REPORT_TYPE_DEPARTMENT_TURNOVER;
00564         faculty_res.summary_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00565         print.put_vga_back_center(<span class="stringliteral">"prn006.bmp"</span>,
00566           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00567           0.7,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00568           );
00569 <span class="preprocessor">#endif</span>
00570 <span class="preprocessor"></span>
00571         <span class="comment">// ##### begin Gilbert 27/04/2001 ######//</span>
00572         <span class="comment">// have memory not freed, call summary_report_deinit instead</span>
00573         faculty_res.summary_report_deinit();
00574         <span class="comment">// ##### end Gilbert 27/04/2001 ######//</span>
00575 
00576         faculty_res.current_report_type=report_type_backup;
00577         sys.no_true_output_flag=0;
00578         user_interface.backgd_flag=1;
00579         <span class="comment">// ##### begin Gilbert 20/04/2001 ######//</span>
00580         <span class="comment">// have memory not freed, call summary_report_deinit instead</span>
00581         <span class="comment">// faculty_res.summary_report(INFO_REPAINT);</span>
00582         <span class="comment">// ##### end Gilbert 20/04/2001 ######//</span>
00583       }
00584 
00585       <span class="keywordflow">if</span>(<a class="code" href="classPrintMenu.html#m1">print_option</a>==3) {
00586         user_interface.backgd_flag=0;
00587         sys.no_true_output_flag=1;
00588 
00589         sys.view_mode=<a class="code" href="Osys_8h.html#a45a10">MODE_FACULTY_SUMMARY</a>;
00590         <span class="keywordtype">int</span> report_type_backup=faculty_res.current_report_type;
00591         <span class="keywordtype">int</span> report_dept_backup=department_array.selected_recno;
00592         filename_count=1;
00593         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> deptRecno=1;deptRecno &lt;= department_array.size();deptRecno++) {
00594           <span class="keywordflow">if</span>( department_array.is_deleted(deptRecno))
00595             <span class="keywordflow">continue</span>;
00596 
00597           department_array.selected_recno = deptRecno;
00598           <a class="code" href="classDepartment.html">Department</a>* cur_dept_ptr = department_array[deptRecno];
00599           <a class="code" href="classString.html">String</a> str1;
00600           str1 =<span class="stringliteral">"Department : "</span>;
00601           str1 +=cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a3">name</a>();
00602           str1 +=<span class="stringliteral">"                                                                                                                              "</span>;
00603           print.dfont(12,<span class="keyword">false</span>,<span class="keyword">false</span>,0);
00604           print.put_text(<span class="stringliteral">"________________________________________________________________________________________________________________________________________________________________________________________________"</span>,20,6);
00605           print.dfont(12,<span class="keyword">false</span>,<span class="keyword">true</span>,0);
00606           print.put_text(str1.<a class="code" href="classString.html#m0">str_buf</a>,20,7);
00607 
00608           faculty_res.summary_report_deinit();
00609           faculty_res.current_report_type=REPORT_TYPE_DEPARTMENT_PROFILE1;
00610           faculty_res.summary_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00611           fn=<span class="stringliteral">"prn"</span>;
00612           fn+=++filename_count;
00613           fn+=<span class="stringliteral">".bmp"</span>;
00614           print.put_vga_back_center(fn.<a class="code" href="classString.html#m0">str_buf</a>,
00615             <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-70,
00616             0.15,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00617             );
00618 
00619           faculty_res.summary_report_deinit();
00620           faculty_res.current_report_type=REPORT_TYPE_DEPARTMENT_PROFILE2;
00621           faculty_res.summary_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00622           fn=<span class="stringliteral">"prn"</span>;
00623           fn+=++filename_count;
00624           fn+=<span class="stringliteral">".bmp"</span>;
00625           print.put_vga_back_center(fn.<a class="code" href="classString.html#m0">str_buf</a>,
00626             <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-70,
00627             0.4,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00628             );
00629 
00630           faculty_res.summary_report_deinit();
00631           faculty_res.current_report_type=REPORT_TYPE_DEPARTMENT_ACTIVITIES;
00632           faculty_res.summary_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00633           fn=<span class="stringliteral">"prn"</span>;
00634           fn+=++filename_count;
00635           fn+=<span class="stringliteral">".bmp"</span>;
00636           print.put_vga_back_center(fn.<a class="code" href="classString.html#m0">str_buf</a>,
00637             <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00638             0.65,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00639             );
00640 
00641           print.end_page();
00642           print.open_page();
00643 
00644           faculty_res.summary_report_deinit();
00645           faculty_res.current_report_type=REPORT_TYPE_DEPARTMENT_RESEARCH;
00646           faculty_res.summary_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00647           fn=<span class="stringliteral">"prn"</span>;
00648           fn+=++filename_count;
00649           fn+=<span class="stringliteral">".bmp"</span>;
00650           print.put_vga_back_center(fn.<a class="code" href="classString.html#m0">str_buf</a>,
00651             <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00652             0.15,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00653             );
00654 
00655           faculty_res.summary_report_deinit();
00656           faculty_res.current_report_type=REPORT_TYPE_DEPARTMENT_HIRING;
00657           faculty_res.summary_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00658           fn=<span class="stringliteral">"prn"</span>;
00659           fn+=++filename_count;
00660           fn+=<span class="stringliteral">".bmp"</span>;
00661           print.put_vga_back_center(fn.<a class="code" href="classString.html#m0">str_buf</a>,
00662             <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00663             0.45,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00664             );
00665 
00666 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00667 <span class="preprocessor"></span>          faculty_res.summary_report_deinit();
00668           faculty_res.current_report_type=REPORT_TYPE_DEPARTMENT_TURNOVER;
00669           faculty_res.summary_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00670           fn=<span class="stringliteral">"prn"</span>;
00671           fn+=++filename_count;
00672           fn+=<span class="stringliteral">".bmp"</span>;
00673           print.put_vga_back_center(fn.<a class="code" href="classString.html#m0">str_buf</a>,
00674             <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00675             0.7,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00676             );
00677 <span class="preprocessor">#endif</span>
00678 <span class="preprocessor"></span>
00679           <span class="keywordflow">if</span>(deptRecno &lt; department_array.size()) {
00680             print.end_page();
00681             print.open_page();
00682           }
00683         }
00684 
00685         <span class="comment">// ##### begin Gilbert 27/04/2001 ######//</span>
00686         <span class="comment">// have memory not freed, call summary_report_deinit instead</span>
00687         faculty_res.summary_report_deinit();
00688         <span class="comment">// ##### end Gilbert 27/04/2001 ######//</span>
00689 
00690         faculty_res.current_report_type=report_type_backup;
00691         department_array.selected_recno=report_dept_backup;
00692         sys.no_true_output_flag=0;
00693         user_interface.backgd_flag=1;
00694         <span class="comment">// ##### begin Gilbert 20/04/2001 ######//</span>
00695         <span class="comment">// have memory not freed, call summary_report_deinit instead</span>
00696         <span class="comment">// faculty_res.summary_report(INFO_REPAINT);</span>
00697         <span class="comment">// ##### end Gilbert 20/04/2001 ######//</span>
00698       }
00699 
00700       <span class="keywordflow">if</span>(<a class="code" href="classPrintMenu.html#m1">print_option</a>==4) {
00701         <span class="keywordtype">int</span> deptRecno = department_array.selected_recno;
00702         <a class="code" href="classDepartment.html">Department</a>* cur_dept_ptr = department_array[deptRecno];
00703         <a class="code" href="classString.html">String</a> str1;
00704         <span class="comment">// ###### begin Gilbert 25/04/2001 #######//</span>
00705         <span class="comment">// no department name for instituion report</span>
00706         <span class="comment">//str1 ="Department : ";</span>
00707         <span class="comment">//str1 +=cur_dept_ptr-&gt;name();</span>
00708         <span class="comment">//str1 +="                                                                                                                              ";</span>
00709         <span class="comment">//print.dfont(12,false,false,0);</span>
00710         <span class="comment">//print.put_text("________________________________________________________________________________________________________________________________________________________________________________________________",20,6);</span>
00711         <span class="comment">//print.dfont(12,false,true,0);</span>
00712         <span class="comment">//print.put_text(str1.str_buf,20,7);</span>
00713         <span class="comment">// ###### end Gilbert 25/04/2001 #######//</span>
00714 
00715         user_interface.backgd_flag=0;
00716         sys.no_true_output_flag=1;
00717 
00718         sys.view_mode=<a class="code" href="Osys_8h.html#a45a10">MODE_FACULTY_SUMMARY</a>;
00719         <span class="keywordtype">int</span> report_type_backup=faculty_res.current_report_type;
00720 
00721         faculty_res.summary_report_deinit();
00722         faculty_res.current_report_type=REPORT_TYPE_INSTITUTION_PROFILE1;
00723         faculty_res.summary_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00724         print.put_vga_back_center(<span class="stringliteral">"prn001.bmp"</span>,
00725           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-70,
00726           0.15,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00727           );
00728 
00729         faculty_res.summary_report_deinit();
00730         faculty_res.current_report_type=REPORT_TYPE_INSTITUTION_PROFILE2;
00731         faculty_res.summary_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00732         print.put_vga_back_center(<span class="stringliteral">"prn002.bmp"</span>,
00733           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-70,
00734           0.4,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00735           );
00736 
00737         faculty_res.summary_report_deinit();
00738         faculty_res.current_report_type=REPORT_TYPE_INSTITUTION_ACTIVITIES;
00739         faculty_res.summary_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00740         print.put_vga_back_center(<span class="stringliteral">"prn003.bmp"</span>,
00741           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00742           0.65,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00743           );
00744 
00745         print.end_page();
00746         print.open_page();
00747 
00748         faculty_res.summary_report_deinit();
00749         faculty_res.current_report_type=REPORT_TYPE_INSTITUTION_RESEARCH;
00750         faculty_res.summary_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00751         print.put_vga_back_center(<span class="stringliteral">"prn004.bmp"</span>,
00752           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00753           0.15,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00754           );
00755 
00756         faculty_res.summary_report_deinit();
00757         faculty_res.current_report_type=REPORT_TYPE_INSTITUTION_SALARY;
00758         faculty_res.summary_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00759         print.put_vga_back_center(<span class="stringliteral">"prn005.bmp"</span>,
00760           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00761           0.4,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00762           );
00763 
00764         faculty_res.summary_report_deinit();
00765         faculty_res.current_report_type=REPORT_TYPE_INSTITUTION_PROMOTION;
00766         faculty_res.summary_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00767         print.put_vga_back_center(<span class="stringliteral">"prn006.bmp"</span>,
00768           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00769           0.65,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00770           );
00771 
00772 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00773 <span class="preprocessor"></span>        print.end_page();
00774         print.open_page();
00775 
00776         faculty_res.summary_report_deinit();
00777         faculty_res.current_report_type=REPORT_TYPE_INSTITUTION_TURNOVER;
00778         faculty_res.summary_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00779         print.put_vga_back_center(<span class="stringliteral">"prn007.bmp"</span>,
00780           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00781           0.05,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00782           );
00783 <span class="preprocessor">#endif</span>
00784 <span class="preprocessor"></span>
00785         <span class="comment">// ##### begin Gilbert 27/04/2001 ######//</span>
00786         <span class="comment">// have memory not freed, call summary_report_deinit instead</span>
00787         faculty_res.summary_report_deinit();
00788         <span class="comment">// ##### end Gilbert 27/04/2001 ######//</span>
00789 
00790         faculty_res.current_report_type=report_type_backup;
00791         sys.no_true_output_flag=0;
00792         user_interface.backgd_flag=1;
00793         <span class="comment">// ##### begin Gilbert 27/04/2001 ######//</span>
00794         <span class="comment">// have memory not freed, call summary_report_deinit instead</span>
00795         <span class="comment">// faculty_res.summary_report(INFO_REPAINT);</span>
00796         <span class="comment">// ##### end Gilbert 27/04/2001 ######//</span>
00797       }
00798 
00799       print.end_page();
00800       print.endprint(sys.main_hwnd);
00801     }
00802   }
00804 
00808   <span class="keywordflow">if</span>(<a class="code" href="classPrintMenu.html#m0">print_view_mode</a>==<a class="code" href="Osys_8h.html#a45a12">MODE_COURSE_REPORT</a>) {
00809     <span class="keyword">enum</span> {
00810       <a class="code" href="Ocour__if_8cpp.html#a62a43">REPORT_TYPE_DEPARTMENT_OVERVIEW</a>, <a class="code" href="Ocour__if_8cpp.html#a62a44">REPORT_TYPE_DEPARTMENT_CLASSTYPES</a>,
00811 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00812 <span class="preprocessor"></span>      REPORT_TYPE_DEPARTMENT_TECHNOLOGY,
00813 <span class="preprocessor">#endif</span>
00814 <span class="preprocessor"></span>      <a class="code" href="Ocour__if_8cpp.html#a62a45">REPORT_TYPE_INSTITUTION_OVERVIEW</a>, <a class="code" href="Ocour__if_8cpp.html#a62a46">REPORT_TYPE_INSTITUTION_SUMMERTEACHING</a>,
00815 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00816 <span class="preprocessor"></span>      REPORT_TYPE_INSTITUTION_TECHNOLOGY,
00817 <span class="preprocessor">#endif</span>
00818 <span class="preprocessor"></span>        };
00819     
00820         {
00821       <a class="code" href="classMouseDispCount.html">MouseDispCount</a> mdc;
00822 
00823       <span class="comment">//                        print_header();</span>
00824 
00825       <span class="keywordflow">if</span>(<a class="code" href="classPrintMenu.html#m1">print_option</a>==1) {
00826         print.dfont(18,<span class="keyword">false</span>,<span class="keyword">false</span>,700);
00827         print.put_text(<span class="stringliteral">"Virtual U Department Course Report"</span>,17,1);
00828         print.dfont(10,<span class="keyword">false</span>,<span class="keyword">false</span>,0);
00829 
00830         <span class="keywordtype">int</span> deptRecno = department_array.selected_recno;
00831         <a class="code" href="classDepartment.html">Department</a>* cur_dept_ptr = department_array[deptRecno];
00832         <a class="code" href="classString.html">String</a> str1;
00833         str1 =<span class="stringliteral">"Department : "</span>;
00834         str1 +=cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a3">name</a>();
00835         str1 +=<span class="stringliteral">"                                                                                                                              "</span>;
00836         print.dfont(12,<span class="keyword">false</span>,<span class="keyword">false</span>,0);
00837         print.put_text(<span class="stringliteral">"________________________________________________________________________________________________________________________________________________________________________________________________"</span>,20,6);
00838         print.dfont(12,<span class="keyword">false</span>,<span class="keyword">true</span>,0);
00839         print.put_text(str1.<a class="code" href="classString.html#m0">str_buf</a>,20,7);
00840 
00841         user_interface.backgd_flag=0;
00842         sys.no_true_output_flag=1;
00843 
00844         sys.view_mode=<a class="code" href="Osys_8h.html#a45a12">MODE_COURSE_REPORT</a>;
00845 
00846         cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a12">course_report_deinit</a>();
00847         cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a7">course_report</a>(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00848 
00849         <span class="comment">//First page printing</span>
00850         <span class="comment">//*********************start printing********************</span>
00851 
00852         <span class="comment">//this will print the bmp in the center of the paper and 1/7 down the page</span>
00853         print.put_vga_back_center(<span class="stringliteral">"prn001.bmp"</span>,
00854           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00855           0.2,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00856         <span class="comment">/*upper left cor. of bitmap*/</span>
00857           );
00858 
00859         <span class="comment">// ##### begin Gilbert 27/04/2001 ######//</span>
00860         <span class="comment">// have memory not freed, call course_report_deinit instead</span>
00861         cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a12">course_report_deinit</a>();
00862         <span class="comment">// ##### end Gilbert 27/04/2001 ######//</span>
00863 
00864         sys.no_true_output_flag=0;
00865         user_interface.backgd_flag=1;
00866       }
00867 
00868       <span class="keywordflow">if</span>(<a class="code" href="classPrintMenu.html#m1">print_option</a>==2) {
00869         print.dfont(18,<span class="keyword">false</span>,<span class="keyword">false</span>,700);
00870         print.put_text(<span class="stringliteral">"Virtual U Department Course Report"</span>,17,1);
00871         print.dfont(10,<span class="keyword">false</span>,<span class="keyword">false</span>,0);
00872 
00873         <span class="keywordtype">int</span> deptRecno = department_array.selected_recno;
00874         <a class="code" href="classDepartment.html">Department</a>* cur_dept_ptr = department_array[deptRecno];
00875         <a class="code" href="classString.html">String</a> str1;
00876         str1 =<span class="stringliteral">"Department : "</span>;
00877         str1 +=cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a3">name</a>();
00878         str1 +=<span class="stringliteral">"                                                                                                                              "</span>;
00879         print.dfont(12,<span class="keyword">false</span>,<span class="keyword">false</span>,0);
00880         print.put_text(<span class="stringliteral">"________________________________________________________________________________________________________________________________________________________________________________________________"</span>,20,6);
00881         print.dfont(12,<span class="keyword">false</span>,<span class="keyword">true</span>,0);
00882         print.put_text(str1.<a class="code" href="classString.html#m0">str_buf</a>,20,7);
00883 
00884         user_interface.backgd_flag=0;
00885         sys.no_true_output_flag=1;
00886 
00887         sys.view_mode=<a class="code" href="Osys_8h.html#a45a12">MODE_COURSE_REPORT</a>;
00888         <span class="keywordtype">int</span> report_type_backup=department_array.<a class="code" href="classDepartment.html#m51">current_report_type</a>;
00889 
00890         cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a12">course_report_deinit</a>();
00891         department_array.<a class="code" href="classDepartment.html#m51">current_report_type</a>=<a class="code" href="Ocour__if_8cpp.html#a62a43">REPORT_TYPE_DEPARTMENT_OVERVIEW</a>;
00892         cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a7">course_report</a>(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00893         print.put_vga_back_center(<span class="stringliteral">"prn002.bmp"</span>,
00894           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00895           0.2,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00896           );
00897 
00898         cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a12">course_report_deinit</a>();
00899         department_array.<a class="code" href="classDepartment.html#m51">current_report_type</a>=<a class="code" href="Ocour__if_8cpp.html#a62a44">REPORT_TYPE_DEPARTMENT_CLASSTYPES</a>;
00900         cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a7">course_report</a>(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00901         print.put_vga_back_center(<span class="stringliteral">"prn002.bmp"</span>,
00902           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00903           0.65,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00904           );
00905 
00906 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00907 <span class="preprocessor"></span>        print.end_page();
00908         print.open_page();
00909 
00910         cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a12">course_report_deinit</a>();
00911         department_array.<a class="code" href="classDepartment.html#m51">current_report_type</a>=REPORT_TYPE_DEPARTMENT_TECHNOLOGY;
00912         cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a7">course_report</a>(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00913         print.put_vga_back_center(<span class="stringliteral">"prn003.bmp"</span>,
00914           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00915           0.05,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00916           );
00917 <span class="preprocessor">#endif</span>
00918 <span class="preprocessor"></span>
00919         <span class="comment">// ##### begin Gilbert 27/04/2001 ######//</span>
00920         <span class="comment">// have memory not freed, call course_report_deinit instead</span>
00921         cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a12">course_report_deinit</a>();
00922         <span class="comment">// ##### end Gilbert 27/04/2001 ######//</span>
00923 
00924         department_array.<a class="code" href="classDepartment.html#m51">current_report_type</a>=report_type_backup;
00925         sys.no_true_output_flag=0;
00926         user_interface.backgd_flag=1;
00927         <span class="comment">// ##### begin Gilbert 27/04/2001 ######//</span>
00928         <span class="comment">// have memory not freed, call course_report_deinit instead</span>
00929         <span class="comment">// cur_dept_ptr-&gt;course_report(INFO_REPAINT);</span>
00930         <span class="comment">// ##### end Gilbert 27/04/2001 ######//</span>
00931       }
00932 
00933       <span class="keywordflow">if</span>(<a class="code" href="classPrintMenu.html#m1">print_option</a>==3) {
00934         user_interface.backgd_flag=0;
00935         sys.no_true_output_flag=1;
00936 
00937         print.dfont(18,<span class="keyword">false</span>,<span class="keyword">false</span>,700);
00938         print.put_text(<span class="stringliteral">"Virtual U Department Course Report"</span>,17,1);
00939         print.dfont(10,<span class="keyword">false</span>,<span class="keyword">false</span>,0);
00940 
00941         <span class="keywordtype">int</span> deptRecno = department_array.selected_recno;
00942         <a class="code" href="classDepartment.html">Department</a>* cur_dept_ptr = department_array[deptRecno];
00943         sys.view_mode=<a class="code" href="Osys_8h.html#a45a12">MODE_COURSE_REPORT</a>;
00944         <span class="keywordtype">int</span> report_type_backup=department_array.<a class="code" href="classDepartment.html#m51">current_report_type</a>;
00945         <span class="keywordtype">int</span> report_dept_backup=department_array.selected_recno;
00946 
00947         filename_count=1;
00948 
00949         <span class="keywordflow">for</span>(deptRecno=1;deptRecno &lt;= department_array.size();deptRecno++) {
00950           <span class="keywordflow">if</span>( department_array.is_deleted(deptRecno))
00951             <span class="keywordflow">continue</span>;
00952 
00953           department_array.selected_recno=deptRecno;
00954           cur_dept_ptr = department_array[deptRecno];
00955           <a class="code" href="classString.html">String</a> str1;
00956           str1 =<span class="stringliteral">"Department : "</span>;
00957           str1 +=cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a3">name</a>();
00958           str1 +=<span class="stringliteral">"                                                                                                                              "</span>;
00959           print.dfont(12,<span class="keyword">false</span>,<span class="keyword">false</span>,0);
00960           print.put_text(<span class="stringliteral">"________________________________________________________________________________________________________________________________________________________________________________________________"</span>,20,6);
00961           print.dfont(12,<span class="keyword">false</span>,<span class="keyword">true</span>,0);
00962           print.put_text(str1.<a class="code" href="classString.html#m0">str_buf</a>,20,7);
00963 
00964           cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a12">course_report_deinit</a>();
00965           department_array.<a class="code" href="classDepartment.html#m51">current_report_type</a>=<a class="code" href="Ocour__if_8cpp.html#a62a43">REPORT_TYPE_DEPARTMENT_OVERVIEW</a>;
00966           cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a7">course_report</a>(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00967           <span class="comment">/*                                    fn="prn";</span>
00968 <span class="comment">                    fn+=++filename_count;</span>
00969 <span class="comment">                    fn+=".bmp";</span>
00970 <span class="comment">                    print.put_vga_back_center(fn.str_buf,</span>
00971 <span class="comment">          */</span>
00972           print.put_vga_back_center(<span class="stringliteral">"prn001.bmp"</span>,
00973             <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00974             0.2,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00975             );
00976 
00977           cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a12">course_report_deinit</a>();
00978           department_array.<a class="code" href="classDepartment.html#m51">current_report_type</a>=<a class="code" href="Ocour__if_8cpp.html#a62a44">REPORT_TYPE_DEPARTMENT_CLASSTYPES</a>;
00979           cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a7">course_report</a>(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00980           <span class="comment">/*                                    fn="prn";</span>
00981 <span class="comment">                    fn+=++filename_count;</span>
00982 <span class="comment">                    fn+=".bmp";</span>
00983 <span class="comment">          */</span>
00984           print.put_vga_back_center(<span class="stringliteral">"prn002.bmp"</span>,
00985             <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00986             0.65,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00987             );
00988 
00989 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00990 <span class="preprocessor"></span>          print.end_page();
00991           print.open_page();
00992 
00993           cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a12">course_report_deinit</a>();
00994           department_array.<a class="code" href="classDepartment.html#m51">current_report_type</a>=REPORT_TYPE_DEPARTMENT_TECHNOLOGY;
00995           cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a7">course_report</a>(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00996 
00997           print.put_vga_back_center(<span class="stringliteral">"prn003.bmp"</span>,
00998             <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
00999             0.05,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
01000             );
01001 <span class="preprocessor">#endif</span>
01002 <span class="preprocessor"></span>
01003           <span class="keywordflow">if</span>(deptRecno &lt; department_array.size()) {
01004             print.end_page();
01005             print.open_page();
01006           }
01007         }
01008 
01009         <span class="comment">// ##### begin Gilbert 27/04/2001 ######//</span>
01010         <span class="comment">// have memory not freed, call course_report_deinit instead</span>
01011         cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a12">course_report_deinit</a>();
01012         <span class="comment">// ##### end Gilbert 27/04/2001 ######//</span>
01013 
01014         cur_dept_ptr = department_array[department_array.selected_recno];
01015         department_array.<a class="code" href="classDepartment.html#m51">current_report_type</a>=report_type_backup;
01016         department_array.selected_recno=report_dept_backup;
01017         sys.no_true_output_flag=0;
01018         user_interface.backgd_flag=1;
01019         <span class="comment">// ##### begin Gilbert 27/04/2001 ######//</span>
01020         <span class="comment">// have memory not freed, call course_report_deinit instead</span>
01021         <span class="comment">// cur_dept_ptr-&gt;course_report(INFO_REPAINT);</span>
01022         <span class="comment">// ##### end Gilbert 27/04/2001 ######//</span>
01023       }
01024 
01025       <span class="keywordflow">if</span>(<a class="code" href="classPrintMenu.html#m1">print_option</a>==4) {
01026         print.dfont(18,<span class="keyword">false</span>,<span class="keyword">false</span>,700);
01027         print.put_text(<span class="stringliteral">"Virtual U Institutional Course Report"</span>,17,1);
01028         print.dfont(10,<span class="keyword">false</span>,<span class="keyword">false</span>,0);
01029 
01030         <span class="keywordtype">int</span> deptRecno = department_array.selected_recno;
01031         <a class="code" href="classDepartment.html">Department</a>* cur_dept_ptr = department_array[deptRecno];
01032         <span class="comment">/*                              String str1;</span>
01033 <span class="comment">                str1 ="Department : ";</span>
01034 <span class="comment">                str1 +=cur_dept_ptr-&gt;name();</span>
01035 <span class="comment">                str1 +="                                                                                                                              ";</span>
01036 <span class="comment">                print.dfont(12,false,false,0);</span>
01037 <span class="comment">                print.put_text("________________________________________________________________________________________________________________________________________________________________________________________________",20,6);</span>
01038 <span class="comment">                print.dfont(12,false,true,0);</span>
01039 <span class="comment">                print.put_text(str1.str_buf,20,7);</span>
01040 <span class="comment">        */</span>
01041         user_interface.backgd_flag=0;
01042         sys.no_true_output_flag=1;
01043 
01044         sys.view_mode=<a class="code" href="Osys_8h.html#a45a12">MODE_COURSE_REPORT</a>;
01045         <span class="keywordtype">int</span> report_type_backup=department_array.<a class="code" href="classDepartment.html#m51">current_report_type</a>;
01046 
01047         cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a12">course_report_deinit</a>();
01048         department_array.<a class="code" href="classDepartment.html#m51">current_report_type</a>=<a class="code" href="Ocour__if_8cpp.html#a62a45">REPORT_TYPE_INSTITUTION_OVERVIEW</a>;
01049         cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a7">course_report</a>(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
01050         print.put_vga_back_center(<span class="stringliteral">"prn003.bmp"</span>,
01051           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
01052           0.2,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
01053           );
01054 
01055         cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a12">course_report_deinit</a>();
01056         department_array.<a class="code" href="classDepartment.html#m51">current_report_type</a>=<a class="code" href="Ocour__if_8cpp.html#a62a46">REPORT_TYPE_INSTITUTION_SUMMERTEACHING</a>;
01057         cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a7">course_report</a>(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
01058 
01059         print.put_vga_back_center(<span class="stringliteral">"prn004.bmp"</span>,
01060           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
01061           0.65,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
01062           );
01063 
01064 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01065 <span class="preprocessor"></span>        print.end_page();
01066         print.open_page();
01067 
01068         cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a12">course_report_deinit</a>();
01069         department_array.<a class="code" href="classDepartment.html#m51">current_report_type</a>=REPORT_TYPE_INSTITUTION_TECHNOLOGY;
01070         cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a7">course_report</a>(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
01071 
01072         print.put_vga_back_center(<span class="stringliteral">"prn005.bmp"</span>,
01073           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-60,
01074           0.05,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
01075           );
01076 <span class="preprocessor">#endif</span>
01077 <span class="preprocessor"></span>
01078         <span class="comment">// ##### begin Gilbert 27/04/2001 ######//</span>
01079         <span class="comment">// have memory not freed, call course_report_deinit instead</span>
01080         cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a12">course_report_deinit</a>();
01081         <span class="comment">// ##### end Gilbert 27/04/2001 ######//</span>
01082 
01083         department_array.<a class="code" href="classDepartment.html#m51">current_report_type</a>=report_type_backup;
01084         sys.no_true_output_flag=0;
01085         user_interface.backgd_flag=1;
01086         <span class="comment">// ##### begin Gilbert 27/04/2001 ######//</span>
01087         <span class="comment">// have memory not freed, call course_report_deinit instead</span>
01088         <span class="comment">// cur_dept_ptr-&gt;course_report(INFO_REPAINT);</span>
01089         <span class="comment">// ##### end Gilbert 27/04/2001 ######//</span>
01090       }
01091       print.end_page();
01092       print.endprint(sys.main_hwnd);
01093     }
01094   }
01096 }
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:38:12 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
