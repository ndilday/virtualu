<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ORADIO.CPP Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>ORADIO.CPP</h1><a href="ORADIO_8CPP.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : ORADIO.CPP</span>
00002 <span class="comment">//Description : Object RadioButton</span>
00003 
00004 <span class="preprocessor">#include &lt;<a class="code" href="ALL_8H.html">ALL.H</a>&gt;</span>
00005 <span class="preprocessor">#include &lt;OINFO.H&gt;</span>
00006 <span class="preprocessor">#include &lt;<a class="code" href="OVGA_8H.html">OVGA.H</a>&gt;</span>
00007 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00008 <span class="preprocessor">#include &lt;OFONT.H&gt;</span>
00009 <span class="preprocessor">#include &lt;OMOUSE.H&gt;</span>
00010 <span class="preprocessor">#include &lt;<a class="code" href="ORADIO_8H.html">ORADIO.H</a>&gt;</span>
00011 <span class="preprocessor">#include &lt;OAUDIO.H&gt;</span>
00012 <span class="preprocessor">#include &lt;OCONFIG.H&gt;</span>
00013 <span class="comment">//--------- Define macro constant -----------//</span>
00014 
00015 <span class="keyword">enum</span> {  <a class="code" href="ORADIO_8CPP.html#a3a1">BUTTON_DESC_DISTANCE</a> = 8  };
00016 <span class="keyword">enum</span> {  <a class="code" href="ORADIO_8CPP.html#a4a2">BUTTON_RADIUS</a> = 6       };
00017 
00018 <span class="comment">//-------------- Define static vars ------------//</span>
00019 
00020 <span class="keyword">static</span> <span class="keywordtype">char</span> paint_flag = 0;
00021 
00022 <span class="comment">//-------- Begin of function RadioButton::RadioButton ----//</span>
<a name="l00024"></a><a class="code" href="classRadioButton.html#a0">00024</a> <span class="comment">RadioButton::RadioButton() {</span>
00025 }
00026 
00027 <span class="comment">//---------- End of function RadioButton::RadioButton ----//</span>
00028 
00029 <span class="comment">//-------- Begin of function RadioButton::~RadioButton ---//</span>
<a name="l00031"></a><a class="code" href="classRadioButton.html#a1">00031</a> <span class="comment">RadioButton::~RadioButton() {</span>
00032     deinit();
00033 }
00034 
00035 <span class="comment">//---------- End of function RadioButton::~RadioButton ---//</span>
00036 
00037 <span class="comment">//-------- Begin of function RadioButton::init --------//</span>
<a name="l00046"></a><a class="code" href="classRadioButton.html#a2">00046</a> <span class="comment">void RadioButton::init( int x1, int y1, int x2, int y2,</span>
00047                         <span class="keywordtype">int</span> optionNum, <span class="keywordtype">int</span> *selNum, <span class="keywordtype">char</span> **optionDesc, <span class="keywordtype">int</span> buttonColor ) {
00048     <a class="code" href="ALL_8H.html#a0">err_when</a>(optionNum &lt;= 0);
00049 
00050     font_ptr = &amp;font_chartsm;
00051 
00052     radio_button_x1 = x1;
00053     radio_button_y1 = (y1 + y2 - font_ptr-&gt;font_height) / 2;
00054     radio_button_x2 = x2;
00055     radio_button_y2 = (y1 + y2 + font_ptr-&gt;font_height) / 2;
00056     radio_button_width = (x2 - x1) / optionNum;
00057     radio_button_height = y2 - y1;
00058     option_num = optionNum;
00059     sel_num = selNum;
00060     option_desc = optionDesc;
00061     button_color = buttonColor;
00062 
00063     radio_button_y = (radio_button_y1 + radio_button_y2) / 2;
00064 
00065     desc_x = <span class="keyword">new</span> <span class="keywordtype">short</span>[optionNum];
00066     radio_button_bitmap = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00067 
00068     init_flag = 1;
00069 
00070     paint();
00071 }
00072 
00073 <span class="comment">//------------- End of function RadioButton::init -----------//</span>
00074 
00075 <span class="comment">//-------- Begin of function RadioButton::deinit ------------//</span>
<a name="l00077"></a><a class="code" href="classRadioButton.html#a3">00077</a> <span class="comment">void RadioButton::deinit() {</span>
00078     <span class="keywordflow">if</span> (init_flag) {
00079         <span class="keyword">delete</span> [] desc_x;
00080 
00081         <span class="keywordflow">if</span> (radio_button_bitmap) {
00082             <a class="code" href="ALL_8H.html#a8">mem_del</a>(radio_button_bitmap);
00083             radio_button_bitmap = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00084         }
00085 
00086         init_flag = 0;
00087     }
00088 }
00089 
00090 <span class="comment">//------------- End of function RadioButton::deinit ---------//</span>
00091 
00092 <span class="comment">//----------- Begin of function RadioButton::paint ----------//</span>
<a name="l00094"></a><a class="code" href="classRadioButton.html#a4">00094</a> <span class="comment">void RadioButton::paint() {</span>
00095     <a class="code" href="ALL_8H.html#a0">err_when</a>(*sel_num &gt; option_num || *sel_num &lt; 0);
00096 
00097     <span class="comment">//  vga.use_back();</span>
00098 
00099     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; option_num; i++) {
00100         <span class="keywordtype">short</span> x = radio_button_x1 + i * radio_button_width;
00101 
00102         desc_x[i] = font_ptr-&gt;put( x+2*<a class="code" href="ORADIO_8CPP.html#a4a2">BUTTON_RADIUS</a>+<a class="code" href="ORADIO_8CPP.html#a3a1">BUTTON_DESC_DISTANCE</a>,
00103                                    radio_button_y-font_ptr-&gt;font_height/2, option_desc[i] );
00104     }
00105 
00106     radio_button_bitmap = vga_back.save_area(radio_button_x1, radio_button_y1,
00107                                              radio_button_x2, radio_button_y2, radio_button_bitmap);
00108 
00109     paint_flag = 1;
00110     refresh();
00111 }
00112 
00113 <span class="comment">//------------- End of function RadioButton::paint ----------//</span>
00114 
00115 <span class="comment">//----------- Begin of function RadioButton::refresh --------//</span>
<a name="l00117"></a><a class="code" href="classRadioButton.html#a5">00117</a> <span class="comment">void RadioButton::refresh() {</span>
00118     <a class="code" href="ALL_8H.html#a0">err_when</a>(*sel_num &gt; option_num || *sel_num &lt; 0);
00119 
00120     vga_back.rest_area(radio_button_bitmap, 0, 0);
00121 
00122     <span class="comment">//  vga.use_back();</span>
00123 
00124     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; option_num; i++) {
00125         <span class="keywordtype">short</span> x = radio_button_x1 + i * radio_button_width;
00126 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00127 <span class="preprocessor"></span>        image_interface.put_back(x+<a class="code" href="ORADIO_8CPP.html#a4a2">BUTTON_RADIUS</a>-7, radio_button_y-10,<span class="stringliteral">"RRED"</span>);
00128 <span class="preprocessor">#else</span>
00129 <span class="preprocessor"></span>        image_interface.put_back(x+<a class="code" href="ORADIO_8CPP.html#a4a2">BUTTON_RADIUS</a>-7, radio_button_y-10,<span class="stringliteral">"RGOLD"</span>);
00130 <span class="preprocessor">#endif</span>
00131 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (i == *sel_num)
00132 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00133 <span class="preprocessor"></span>            image_interface.put_back(x+<a class="code" href="ORADIO_8CPP.html#a4a2">BUTTON_RADIUS</a>-7, radio_button_y-10,<span class="stringliteral">"RGOLD"</span>);
00134 <span class="preprocessor">#else</span>
00135 <span class="preprocessor"></span>        image_interface.put_back(x+<a class="code" href="ORADIO_8CPP.html#a4a2">BUTTON_RADIUS</a>-7, radio_button_y-10,<span class="stringliteral">"RRED"</span>);
00136 <span class="preprocessor">#endif</span>
00137 <span class="preprocessor"></span>        <span class="comment">//              circle(x+BUTTON_RADIUS, radio_button_y, BUTTON_RADIUS, button_color, 0);</span>
00138         <span class="comment">//                      circle(x+BUTTON_RADIUS, radio_button_y, BUTTON_RADIUS-2, button_color, 1);</span>
00139     }
00140 
00141     <span class="comment">//  vga.use_front();</span>
00142     <span class="keywordflow">if</span> (!paint_flag)
00143         vga.blt_buf(radio_button_x1, radio_button_y1, radio_button_x2, radio_button_y2,0);
00144     <span class="keywordflow">else</span>
00145         paint_flag = 0;
00146 }
00147 
00148 <span class="comment">//------------- End of function RadioButton::refresh ---------//</span>
00149 
00150 <span class="comment">//----------- Begin of function RadioButton::fill --------------//</span>
00155 <span class="comment">void RadioButton::fill(short x, short y, int color) {</span>
00156     <a class="code" href="ALL_8H.html#a0">err_when</a>(x &gt; <a class="code" href="OVGA_8H.html#a0">VGA_WIDTH</a> || y &gt; <a class="code" href="OVGA_8H.html#a1">VGA_HEIGHT</a> || x &lt; 0 || y &lt; 0);
00157 
00158     vga_back.draw_pixel( x, y, color );
00159 
00160     <span class="comment">//----- recursively fill neighbouring pixels -----//</span>
00161 
00162     <span class="keywordflow">if</span> (x &gt; 0 &amp;&amp; *vga_back.buf_ptr(x-1, y) != vga_back.translate_color(color)) {
00163         fill(x-1, y, color);
00164     }
00165 
00166     <span class="keywordflow">if</span> (x &lt; <a class="code" href="OVGA_8H.html#a0">VGA_WIDTH</a> &amp;&amp; *vga_back.buf_ptr(x+1, y) != vga_back.translate_color(color)) {
00167         fill(x+1, y, color);
00168     }
00169 
00170     <span class="keywordflow">if</span> (y &gt; 0 &amp;&amp; *vga_back.buf_ptr(x, y-1) != vga_back.translate_color(color)) {
00171         fill(x, y-1, color);
00172     }
00173 
00174     <span class="keywordflow">if</span> (y &lt; <a class="code" href="OVGA_8H.html#a1">VGA_HEIGHT</a> &amp;&amp; *vga_back.buf_ptr(x, y+1) != vga_back.translate_color(color)) {
00175         fill(x, y+1, color);
00176     }
00177 }
00178 
00179 <span class="comment">//------------- End of function RadioButton::fill --------------//</span>
00180 
00181 <span class="comment">//----------- Begin of function RadioButton::circle ------------//</span>
00188 <span class="comment">void RadioButton::circle(short x, short y, int radius, int color, char fill_flag) {</span>
00189     <span class="keywordtype">int</span> d = 3 - 2 * radius;
00190     <span class="keywordtype">int</span> a = 0;
00191     <span class="keywordtype">int</span> b = radius;
00192 
00193     <span class="keywordflow">while</span> (a != b) {
00194         vga_back.draw_pixel( x+a, y+b, color );
00195         vga_back.draw_pixel( x-a, y+b, color );
00196         vga_back.draw_pixel( x+a, y-b, color );
00197         vga_back.draw_pixel( x-a, y-b, color );
00198         vga_back.draw_pixel( x+b, y+a, color );
00199         vga_back.draw_pixel( x-b, y+a, color );
00200         vga_back.draw_pixel( x+b, y-a, color );
00201         vga_back.draw_pixel( x-b, y-a, color );
00202 
00203         <span class="keywordflow">if</span> (d &lt; 0)
00204             d += 4 * a + 6;
00205         <span class="keywordflow">else</span>
00206             d += 4 * (a - b--) + 10;
00207 
00208         ++a;
00209     }
00210     vga_back.draw_pixel( x+a, y+a, color );
00211     vga_back.draw_pixel( x+a, y-a, color );
00212     vga_back.draw_pixel( x-a, y+a, color );
00213     vga_back.draw_pixel( x-a, y-a, color );
00214 
00215     <span class="keywordflow">if</span> (fill_flag) {
00216         fill(x, y, color);
00217     }
00218 }
00219 
00220 <span class="comment">//------------- End of function RadioButton::circle ------------//</span>
00221 
00222 <span class="comment">//----------- Begin of function RadioButton::detect ------------//</span>
<a name="l00227"></a><a class="code" href="classRadioButton.html#a6">00227</a> <span class="comment">int RadioButton::detect() {</span>
00228     <span class="keywordflow">if</span> (!init_flag)
00229         <span class="keywordflow">return</span> 0;
00230 
00231     <span class="comment">//---- Variable update? ----//</span>
00232 
00233     <span class="keywordflow">if</span> (mouse.single_click( radio_button_x1, radio_button_y1,
00234                             radio_button_x2, radio_button_y2 )) {
00235         <span class="keywordtype">short</span> x, y = (radio_button_y1 + radio_button_y2) / 2;
00236         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; option_num; i++) {
00237             x = radio_button_x1 + i * radio_button_width;
00238             <span class="keywordflow">if</span> (mouse.single_click( x, y-<a class="code" href="ORADIO_8CPP.html#a4a2">BUTTON_RADIUS</a>, desc_x[i], y+<a class="code" href="ORADIO_8CPP.html#a4a2">BUTTON_RADIUS</a> )) {
00239                 *sel_num = i;
00240                 audio.play_wav(<span class="stringliteral">"BEEPS-1"</span>,audio.int_to_DsVolume(config.sound_effect_volume));
00241                 <span class="keywordflow">return</span> 1;
00242             }
00243         }
00244     }
00245 
00246     <span class="keywordflow">return</span> 0;
00247 }
00248 
00249 <span class="comment">//------------- End of function RadioButton::detect ------------//</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:38:17 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
