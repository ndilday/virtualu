<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>CHOLESKY.CPP Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>CHOLESKY.CPP</h1><a href="CHOLESKY_8CPP.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Owner: Fred</span>
00002 <span class="comment">//$$ cholesky.cpp                     cholesky decomposition</span>
00003 
00004 <span class="comment">// Copyright (C) 1991,2,3,4: R B Davies</span>
00005 
<a name="l00006"></a><a class="code" href="CHOLESKY_8CPP.html#a0">00006</a> <span class="preprocessor">#define WANT_MATH</span>
00007 <span class="preprocessor"></span>
00008 <span class="preprocessor">#include "include.h"</span>
00009 
00010 <span class="preprocessor">#include "newmat.h"</span>
00011 
00012 <span class="preprocessor">#ifdef use_namespace</span>
00013 <span class="preprocessor"></span><span class="keyword">namespace </span>NEWMAT {
00014 <span class="preprocessor">#endif</span>
00015 <span class="preprocessor"></span>
00016     <span class="comment">/********* Cholesky decomposition of a positive definite matrix *************/</span>
00017 
00018     <span class="comment">// Suppose S is symmetrix and positive definite. Then there exists a unique</span>
00019     <span class="comment">// lower triangular matrix L such that L L.t() = S;</span>
00020 
00021     <span class="keyword">inline</span> <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> <a class="code" href="namespaceNEWMAT.html#a1">square</a>(<a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> x) { <span class="keywordflow">return</span> x*x; }
00022 
<a name="l00023"></a><a class="code" href="namespaceNEWMAT.html#a2">00023</a>     <a class="code" href="Newmat_8h.html#a1">ReturnMatrix</a> <a class="code" href="namespaceNEWMAT.html#a2">Cholesky</a>(<span class="keyword">const</span> <a class="code" href="classNEWMAT_1_1SymmetricMatrix.html">SymmetricMatrix</a>&amp; S) {
00024         <a class="code" href="classTracer.html">Tracer</a> trace(<span class="stringliteral">"Cholesky"</span>);
00025         <span class="keywordtype">int</span> nr = S.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a2">Nrows</a>();
00026         <a class="code" href="classNEWMAT_1_1LowerTriangularMatrix.html">LowerTriangularMatrix</a> T(nr);
00027         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = S.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a5">Store</a>(); <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* t = T.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a5">Store</a>(); <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* ti = t;
00028         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nr; i++) {
00029             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* tj = t; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum; <span class="keywordtype">int</span> k;
00030             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;i; j++) {
00031                 <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* tk = ti; sum = 0.0; k = j;
00032                 <span class="keywordflow">while</span> (k--) { sum += *tj++ * *tk++; }
00033                 *tk = (*s++ - sum) / *tj++;
00034             }
00035             sum = 0.0; k = i;
00036             <span class="keywordflow">while</span> (k--) { sum += <a class="code" href="namespaceNEWMAT.html#a1">square</a>(*ti++); }
00037             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> d = *s++ - sum;
00038             <span class="keywordflow">if</span> (d&lt;=0.0) Throw(<a class="code" href="classNEWMAT_1_1NPDException.html">NPDException</a>(S));
00039             *ti++ = sqrt(d);
00040         }
00041         T.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a12">Release</a>(); <span class="keywordflow">return</span> T.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a49">ForReturn</a>();
00042     }
00043 
<a name="l00044"></a><a class="code" href="CHOLESKY_8CPP.html#a3">00044</a>     <a class="code" href="Newmat_8h.html#a1">ReturnMatrix</a> <a class="code" href="namespaceNEWMAT.html#a2">Cholesky</a>(<span class="keyword">const</span> SymmetricBandMatrix&amp; S) {
00045         <a class="code" href="classTracer.html">Tracer</a> trace(<span class="stringliteral">"Band-Cholesky"</span>);
00046         <span class="keywordtype">int</span> nr = S.Nrows(); <span class="keywordtype">int</span> m = S.lower;
00047         LowerBandMatrix T(nr,m);
00048         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = S.Store(); <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* t = T.Store(); <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* ti = t;
00049 
00050         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nr; i++) {
00051             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* tj = t; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum; <span class="keywordtype">int</span> l;
00052             <span class="keywordflow">if</span> (i&lt;m) { l = m-i; s += l; ti += l; l = i; }
00053             <span class="keywordflow">else</span> { t += (m+1); l = m; }
00054 
00055             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;l; j++) {
00056                 <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* tk = ti; sum = 0.0; <span class="keywordtype">int</span> k = j; tj += (m-j);
00057                 <span class="keywordflow">while</span> (k--) { sum += *tj++ * *tk++; }
00058                 *tk = (*s++ - sum) / *tj++;
00059             }
00060             sum = 0.0;
00061             <span class="keywordflow">while</span> (l--) { sum += <a class="code" href="namespaceNEWMAT.html#a1">square</a>(*ti++); }
00062             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> d = *s++ - sum;
00063             <span class="keywordflow">if</span> (d&lt;=0.0)  Throw(NPDException(S));
00064             *ti++ = sqrt(d);
00065         }
00066 
00067         T.Release(); <span class="keywordflow">return</span> T.ForReturn();
00068     }
00069 
00070 <span class="preprocessor">#ifdef use_namespace</span>
00071 <span class="preprocessor"></span>}
00072 <span class="preprocessor">#endif</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:37:01 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
