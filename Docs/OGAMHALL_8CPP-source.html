<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>OGAMHALL.CPP Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>OGAMHALL.CPP</h1><a href="OGAMHALL_8CPP.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : OGAMHALL.CPP</span>
00002 <span class="comment">//Description : Hall of Fame</span>
00003 
00004 <span class="preprocessor">#include &lt;<a class="code" href="OVGA_8H.html">OVGA.H</a>&gt;</span>
00005 <span class="preprocessor">#include &lt;<a class="code" href="OVGALOCK_8H.html">OVGALOCK.H</a>&gt;</span>
00006 <span class="preprocessor">#include &lt;<a class="code" href="ODATE_8H.html">ODATE.H</a>&gt;</span>
00007 <span class="preprocessor">#include &lt;<a class="code" href="OSTR_8H.html">OSTR.H</a>&gt;</span>
00008 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00009 <span class="preprocessor">#include &lt;OFONT.H&gt;</span>
00010 <span class="preprocessor">#include &lt;OMOUSE.H&gt;</span>
00011 <span class="preprocessor">#include &lt;<a class="code" href="OIMGRES_8H.html">OIMGRES.H</a>&gt;</span>
00012 <span class="preprocessor">#include &lt;<a class="code" href="OGAME_8H.html">OGAME.H</a>&gt;</span>
00013 <span class="preprocessor">#include &lt;OGFILE.H&gt;</span>
00014 
00015 <span class="comment">//------ Begin of function GameFileArray::disp_hall_of_fame -----//</span>
00018 <span class="comment">/*</span>
00019   <span class="keywordtype">void</span> GameFileArray::disp_hall_of_fame()
00020   {
00021   vga.disp_image_file(<span class="stringliteral">"HALLFAME"</span>);
00022 
00023   <span class="comment">//---------- display hall of fame records ------------//</span>
00024 
00025   <span class="keywordtype">int</span> i;
00026   <span class="keywordtype">int</span> x=120, y=116;
00027 
00028   <span class="keywordflow">for</span>( i=0 ; i&lt;<a class="code" href="Ogfile_8h.html#a4a3">HALL_FAME_NUM</a> ; i++, y+=76 )
00029   {
00030   hall_fame_array[i].disp_info( x, y, i+1 );
00031   }
00032 
00033   mouse.wait_press(60);         <span class="comment">// 60 seconds to time out</span>
00034 
00035   vga.finish_disp_image_file();
00036   }
00037 */
00038 <span class="comment">//------- End of function GameFileArray::disp_hall_of_fame -----//</span>
00039 
00040 <span class="comment">//------ Begin of function HallFame::disp_info -------//</span>
<a name="l00047"></a><a class="code" href="structHallFame.html#a0">00047</a> <span class="comment">void HallFame::disp_info(int x, int y, int pos) {</span>
00048     <span class="keywordflow">if</span>( !start_year )                               <span class="comment">// no information</span>
00049         <span class="keywordflow">return</span>;
00050 
00051     <span class="comment">//------------------------------------------------------//</span>
00052     <span class="comment">//</span>
00053     <span class="comment">// e.g. 1. [Image] King T Chan</span>
00054     <span class="comment">//            [     ] Score : 150    Population : 1000    Period : 1001-1030</span>
00055     <span class="comment">//</span>
00056     <span class="comment">//------------------------------------------------------//</span>
00057 
00058     <a class="code" href="classFont.html">Font</a>* fontPtr;
00059 
00060 <span class="preprocessor">#if( defined(GERMAN) || defined(FRENCH) || defined(SPANISH) )</span>
00061 <span class="preprocessor"></span>    fontPtr = &amp;font_hall;
00062 <span class="preprocessor">#else</span>
00063 <span class="preprocessor"></span>    fontPtr = &amp;font_std;
00064 <span class="preprocessor">#endif</span>
00065 <span class="preprocessor"></span>
00066     <a class="code" href="classString.html">String</a> str;
00067     <span class="keywordtype">int</span>    y2 = y+17;
00068 
00069     <span class="comment">//----------------------------------------//</span>
00070 
00071     str  = pos;
00072     str += <span class="stringliteral">"."</span>;
00073 
00074     fontPtr-&gt;<a class="code" href="classFont.html#a10">put</a>( x, y, str );
00075 
00076     x += 16;
00077 
00078     <span class="comment">//----------------------------------------//</span>
00079 
00080     str  = translate.process(<span class="stringliteral">"King "</span>);
00081     str += player_first_name;
00082     str += player_last_name;
00083 
00084     fontPtr-&gt;<a class="code" href="classFont.html#a10">put</a>( x, y, str );
00085 
00086     <span class="comment">//----------------------------------------//</span>
00087 
00088     str  = translate.process(<span class="stringliteral">"Score : "</span>);
00089     str += score;
00090 
00091     fontPtr-&gt;<a class="code" href="classFont.html#a10">put</a>( x, y2, str );
00092 
00093     <span class="comment">//----------------------------------------//</span>
00094 
00095     <span class="comment">//str  = translate.process("Population : ");</span>
00096     <span class="comment">//str += population;</span>
00097 
00098     <span class="comment">//fontPtr-&gt;put( x+110, y2, str );</span>
00099 
00100     <span class="comment">//----------------------------------------//</span>
00101 
00102 <span class="preprocessor">#if( defined(GERMAN) || defined(FRENCH) || defined(SPANISH) )</span>
00103 <span class="preprocessor"></span>    x-=10;                                          <span class="comment">// position adjustment for the German version</span>
00104 <span class="preprocessor">#endif</span>
00105 <span class="preprocessor"></span>
00106     str  = translate.process(<span class="stringliteral">"Period : "</span>);
00107     str += m.num_to_str(start_year);                <span class="comment">// without adding comma separators</span>
00108     str += <span class="stringliteral">"-"</span>;
00109     str += m.num_to_str(end_year);
00110 
00111     fontPtr-&gt;<a class="code" href="classFont.html#a10">put</a>( x+260, y2, str );
00112 
00113     <span class="comment">//----------------------------------------//</span>
00114 
00115     <span class="comment">//str  = translate.process("Difficulty : ");</span>
00116     <span class="comment">//str += difficulty_rating;</span>
00117 
00118     fontPtr-&gt;<a class="code" href="classFont.html#a10">put</a>( x+420, y2, str );
00119 }
00120 
00121 <span class="comment">//------- End of function HallFame::disp_info -------//</span>
00122 
00123 <span class="comment">//--------- Begin of function HallFame::record_data --------//</span>
<a name="l00127"></a><a class="code" href="structHallFame.html#a1">00127</a> <span class="comment">void HallFame::record_data(int totalScore) {</span>
00128 
00129     strncpy( school_name, player_school.school_name, <a class="code" href="classPlayerSchool.html#s3s0">PlayerSchool::SCHOOL_NAME_LEN</a>);
00130     school_name[<a class="code" href="classPlayerSchool.html#s3s0">PlayerSchool::SCHOOL_NAME_LEN</a>] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00131 
00132     strncpy( player_first_name, player_school.player_first_name, <a class="code" href="classPlayerSchool.html#s3s1">PlayerSchool::FIRST_NAME_LEN</a> );
00133     player_first_name[<a class="code" href="classPlayerSchool.html#s3s1">PlayerSchool::FIRST_NAME_LEN</a>] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00134 
00135     strncpy( player_last_name, player_school.player_last_name, <a class="code" href="classPlayerSchool.html#s3s2">PlayerSchool::LAST_NAME_LEN</a> );
00136     player_last_name[<a class="code" href="classPlayerSchool.html#s3s2">PlayerSchool::LAST_NAME_LEN</a>] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00137 
00138     start_year = date.year(info.game_start_date);
00139     end_year   = info.game_year;
00140 
00141     score     = totalScore;                         <span class="comment">// ultimate_game_score</span>
00142     trust_score = (int) player_school.cur_game_score;
00143 
00144     scenario_id = player_school.scenario_id;
00145 }
00146 
00147 <span class="comment">//----------- End of function HallFame::record_data ---------//</span>
00148 
00149 <span class="comment">//------ Begin of function GameFileArray::add_hall_of_fame -----//</span>
<a name="l00160"></a><a class="code" href="classGameFileArray.html#a8">00160</a> <span class="comment">int GameFileArray::add_hall_of_fame(int totalScore) {</span>
00161     <span class="comment">//-------- insert the record -----------//</span>
00162 
00163     <span class="keywordflow">if</span> (totalScore &lt;=0)
00164         <span class="keywordflow">return</span> 0;
00165 
00166     <span class="comment">//0301</span>
00167     <span class="keywordflow">if</span>( !has_read_hall_of_fame ) {                  <span class="comment">// only read once, GameFileArray::init() is called every time the load/save game menu is brought up.</span>
00168         read_hall_of_fame();
00169         has_read_hall_of_fame = 1;
00170     }
00171 
00172     <span class="keywordtype">int</span> i;
00173 
00174     <span class="keywordflow">for</span>( i=0 ; i&lt;<a class="code" href="Ogfile_8h.html#a4a3">HALL_FAME_NUM</a> ; i++ ) {
00175         <span class="keywordflow">if</span>( totalScore &gt; hall_fame_array[i].score ) {
00176             <span class="comment">//---------- move and insert the data --------//</span>
00177 
00178             <span class="keywordflow">if</span>( i &lt; <a class="code" href="Ogfile_8h.html#a4a3">HALL_FAME_NUM</a>-1 ) {                 <span class="comment">// it is not the last record</span>
00179                 memmove( hall_fame_array+i+1, hall_fame_array+i,
00180                          <span class="keyword">sizeof</span>(<a class="code" href="structHallFame.html">HallFame</a>) * (<a class="code" href="Ogfile_8h.html#a4a3">HALL_FAME_NUM</a>-i-1) );
00181             }
00182 
00183             <span class="comment">//-------- record the hall of fame rcord ------//</span>
00184 
00185             hall_fame_array[i].record_data(totalScore);
00186 
00187             <span class="comment">//--------- display the hall of fame ----------//</span>
00188 
00189             write_hall_of_fame();                       <span class="comment">// must write hall of fame, because it also write the last saved game slot no.</span>
00190 
00191             <a class="code" href="ALL_8H.html#a0">err_when</a>(hall_fame_array[i].scenario_id  != player_school.scenario_id );
00192             game.hall_of_fame();
00193             <span class="keywordflow">return</span> 1;
00194         }
00195     }
00196 
00197     <span class="keywordflow">return</span> 0;
00198 }
00199 
00200 <span class="comment">//------- End of function GameFileArray::add_hall_of_fame -----//</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:37:43 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
