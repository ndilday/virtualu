<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ALL.H Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>ALL.H</h1><a href="ALL_8H.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : ALL.H</span>
00002 <span class="comment">//Description : General-purpose header file, include Mem &amp; Error</span>
00003 
00004 <span class="preprocessor">#ifndef __ALL_H</span>
00005 <span class="preprocessor"></span><span class="preprocessor">#define __ALL_H</span>
00006 <span class="preprocessor"></span>
00007 <span class="comment">//--------- Include other headers -------//</span>
00008 
00009 <span class="preprocessor">#ifndef __WINDOWS_</span>
00010 <span class="preprocessor"></span><span class="preprocessor">#include &lt;windows.h&gt;</span>
00011 <span class="preprocessor">#endif</span>
00012 <span class="preprocessor"></span>
00013 <span class="preprocessor">#ifndef __OMISC_H</span>
00014 <span class="preprocessor"></span><span class="preprocessor">#include &lt;OMISC.H&gt;</span>
00015 <span class="preprocessor">#endif</span>
00016 <span class="preprocessor"></span>
00017 <span class="preprocessor">#ifndef __OSTR_H</span>
00018 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="OSTR_8H.html">OSTR.H</a>&gt;</span>
00019 <span class="preprocessor">#endif</span>
00020 <span class="preprocessor"></span>
00021 <span class="preprocessor">#ifndef __OFILE_H</span>
00022 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="OFILE_8H.html">OFILE.H</a>&gt;</span>
00023 <span class="preprocessor">#endif</span>
00024 <span class="preprocessor"></span>
00025 <span class="preprocessor">#ifndef __GAMEDEF_H</span>
00026 <span class="preprocessor"></span><span class="preprocessor">#include &lt;GAMEDEF.H&gt;</span>
00027 <span class="preprocessor">#endif</span>
00028 <span class="preprocessor"></span>
00029 <span class="comment">//---------- Debug functions -------//</span>
00030 
00031 <span class="preprocessor">#ifdef DEBUG</span>
00032 <span class="preprocessor"></span><span class="keywordtype">void</span> __cdecl debug_msg( <span class="keywordtype">char</span>* fmt, ... );
00033 <span class="preprocessor">#endif</span>
00034 <span class="preprocessor"></span>
00035 <span class="comment">//---------- define class Mem ----------//</span>
00036 
00037 <span class="keyword">struct </span><a class="code" href="structMemInfo.html">MemInfo</a>;
00038 
<a name="l00040"></a><a class="code" href="classMem.html">00040</a> <span class="keyword">class </span><a class="code" href="classMem.html">Mem</a> {
00041 <span class="keyword">public</span> :
<a name="l00042"></a><a class="code" href="classMem.html#m0">00042</a>     <a class="code" href="structMemInfo.html">MemInfo</a>* <a class="code" href="classMem.html#m0">info_array</a>;
<a name="l00043"></a><a class="code" href="classMem.html#m1">00043</a>     <span class="keywordtype">short</span>    <a class="code" href="classMem.html#m1">ptr_num</a>;
<a name="l00044"></a><a class="code" href="classMem.html#m2">00044</a>     <span class="keywordtype">short</span>    <a class="code" href="classMem.html#m2">ptr_used</a>;
00045 
00046 <span class="keyword">public</span> :
00047     <a class="code" href="classMem.html#a0">Mem</a>();
00048     <a class="code" href="classMem.html#a1">~Mem</a>();
00049 
00050     <span class="keywordtype">char</span>*  <a class="code" href="classMem.html#a2">add</a>(<span class="keywordtype">unsigned</span>,<span class="keywordtype">char</span>*,<span class="keywordtype">int</span>);
00051     <span class="keywordtype">char</span>*  <a class="code" href="classMem.html#a3">add_clear</a>(<span class="keywordtype">unsigned</span>,<span class="keywordtype">char</span>*,<span class="keywordtype">int</span>);
00052 
00053     <span class="keywordtype">char</span>*  <a class="code" href="classMem.html#a4">resize</a>(<span class="keywordtype">void</span>*,<span class="keywordtype">unsigned</span>,<span class="keywordtype">char</span>*,<span class="keywordtype">int</span>);
00054     <span class="keywordtype">char</span>*  <a class="code" href="classMem.html#a5">resize_keep_data</a>(<span class="keywordtype">void</span> *orgPtr, <span class="keywordtype">unsigned</span> orgSize, <span class="keywordtype">unsigned</span> newSize, <span class="keywordtype">char</span>* fileName, <span class="keywordtype">int</span> fileLine);
00055 
00056     <span class="keywordtype">void</span>   <a class="code" href="classMem.html#a6">del</a>(<span class="keywordtype">void</span>*,<span class="keywordtype">char</span>*,<span class="keywordtype">int</span>);
00057 
00058     <span class="keywordtype">int</span>   <a class="code" href="classMem.html#a7">get_mem_size</a>(<span class="keywordtype">void</span> *memPtr);
00059 };
00060 
00061 <span class="comment">// called when DEBUG mode is off</span>
00062 <span class="keywordtype">char</span>* <a class="code" href="ALL_8H.html#a9">mem_resize_keep_data</a>(<span class="keywordtype">void</span>*,<span class="keywordtype">unsigned</span>,<span class="keywordtype">unsigned</span>);
00063 
<a name="l00064"></a><a class="code" href="ALL_8H.html#a10">00064</a> <span class="keyword">extern</span> <a class="code" href="classMem.html">Mem</a> <a class="code" href="ALL_8H.html#a10">mem</a>;
00065 
00066 <span class="comment">//------- Define Class Error ------------//</span>
00067 
<a name="l00068"></a><a class="code" href="ALL_8H.html#a11">00068</a> <span class="keyword">typedef</span> void (*<a class="code" href="ALL_8H.html#a11">ExtraHandler</a>)();
00069 
<a name="l00071"></a><a class="code" href="classError.html">00071</a> <span class="keyword">class </span><a class="code" href="classError.html">Error</a> {
00072 <span class="keyword">private</span>:
00073     <a class="code" href="ALL_8H.html#a11">ExtraHandler</a> extra_handler;                   <span class="comment">// extra error handler</span>
00074 
00075 <span class="keyword">public</span>:
00076     <a class="code" href="classError.html#a0">Error</a>();
00077 
00078     <span class="keywordtype">void</span> <a class="code" href="classError.html#a1">internal</a>(<span class="keywordtype">char</span>*,<span class="keywordtype">char</span>*,<span class="keywordtype">int</span>);
00079     <span class="keywordtype">void</span> <a class="code" href="classError.html#a2">mem</a>();
00080     <span class="keywordtype">void</span> <a class="code" href="classError.html#a3">msg</a>(<span class="keywordtype">char</span>*,...);
00081     <span class="keywordtype">void</span> <a class="code" href="classError.html#a4">run</a>(<span class="keywordtype">char</span>*,...);
00082 
<a name="l00083"></a><a class="code" href="classError.html#a5">00083</a>     <span class="keywordtype">void</span> <a class="code" href="classError.html#a5">set_extra_handler</a>(<a class="code" href="ALL_8H.html#a11">ExtraHandler</a> extraHandler) { extra_handler = extraHandler; }
00084 };
00085 
<a name="l00086"></a><a class="code" href="ALL_8H.html#a12">00086</a> <span class="keyword">extern</span> <a class="code" href="classError.html">Error</a> <a class="code" href="ALL_8H.html#a12">err</a>;
00087 
00088 <span class="comment">//-------- error handling functions ----------//</span>
00089 
00090 <span class="preprocessor">#ifdef DEBUG</span>
00091 <span class="preprocessor"></span><span class="comment">// 0 for null</span>
00092 <span class="preprocessor">#define err_when(cond)   if(cond) err.internal(0,__FILE__, __LINE__)</span>
00093 <span class="preprocessor"></span><span class="comment">// 0 for null</span>
00094 <span class="preprocessor">#define err_here()       err.internal(0,__FILE__, __LINE__)</span>
00095 <span class="preprocessor"></span><span class="preprocessor">#define err_if(cond)     if(cond)</span>
00096 <span class="preprocessor"></span><span class="preprocessor">#define err_else         else</span>
00097 <span class="preprocessor"></span><span class="preprocessor">#define err_now(msg)     err.run(msg)             // internal error</span>
00098 <span class="preprocessor"></span>
00099 <span class="comment">// always use err_if(cond) together with err_now(), so when debug is turn off, these two statement will turn off</span>
00100 <span class="preprocessor">#else</span>
<a name="l00101"></a><a class="code" href="ALL_8H.html#a0">00101</a> <span class="preprocessor"></span><span class="preprocessor">#define err_when(cond)</span>
<a name="l00102"></a><a class="code" href="ALL_8H.html#a1">00102</a> <span class="preprocessor"></span><span class="preprocessor">#define err_here()</span>
<a name="l00103"></a><a class="code" href="ALL_8H.html#a2">00103</a> <span class="preprocessor"></span><span class="preprocessor">#define err_if(cond)</span>
<a name="l00104"></a><a class="code" href="ALL_8H.html#a3">00104</a> <span class="preprocessor"></span><span class="preprocessor">#define err_else</span>
<a name="l00105"></a><a class="code" href="ALL_8H.html#a4">00105</a> <span class="preprocessor"></span><span class="preprocessor">#define err_now(msg)</span>
00106 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00107 <span class="preprocessor"></span>
00108 <span class="comment">//------ memory allocation functions --------//</span>
00109 
00110 <span class="preprocessor">#ifndef NO_MEM_CLASS</span>
00111 <span class="preprocessor"></span>
<a name="l00112"></a><a class="code" href="ALL_8H.html#a5">00112</a> <span class="preprocessor">#define mem_add(memSize)             mem.add(memSize, __FILE__, __LINE__)</span>
<a name="l00113"></a><a class="code" href="ALL_8H.html#a6">00113</a> <span class="preprocessor"></span><span class="preprocessor">#define mem_add_clear(memSize)       mem.add_clear(memSize, __FILE__, __LINE__)</span>
<a name="l00114"></a><a class="code" href="ALL_8H.html#a7">00114</a> <span class="preprocessor"></span><span class="preprocessor">#define mem_resize(orgPtr,newSize)   mem.resize(orgPtr, newSize, __FILE__, __LINE__)</span>
<a name="l00115"></a><a class="code" href="ALL_8H.html#a8">00115</a> <span class="preprocessor"></span><span class="preprocessor">#define mem_del(memPtr)              mem.del(memPtr, __FILE__, __LINE__)</span>
00116 <span class="preprocessor"></span>
<a name="l00117"></a><a class="code" href="ALL_8H.html#a9">00117</a> <span class="preprocessor">#define mem_resize_keep_data(orgPtr, orgSize, newSize) \</span>
00118 <span class="preprocessor">  mem.resize_keep_data(orgPtr, orgSize, newSize, __FILE__, __LINE__)</span>
00119 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00120 <span class="preprocessor"></span>
00121 <span class="preprocessor">#define mem_add(memSize)            ((char*)malloc(memSize))</span>
00122 <span class="preprocessor"></span><span class="preprocessor">#define mem_add_clear(memSize)      ((char*)calloc(1,memSize))</span>
00123 <span class="preprocessor"></span><span class="preprocessor">#define mem_resize(orgPtr, newSize) ((char*)realloc(orgPtr,newSize))</span>
00124 <span class="preprocessor"></span><span class="preprocessor">#define mem_del(memPtr)             free(memPtr)</span>
00125 <span class="preprocessor"></span>
00126 <span class="comment">// mem_resize_keep_data() will be called directly when not in DEBUG mode</span>
00127 <span class="preprocessor">#endif</span>
00128 <span class="preprocessor"></span>
00129 <span class="comment">//--------------------------------------------//</span>
00130 <span class="preprocessor">#endif</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:37:00 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
