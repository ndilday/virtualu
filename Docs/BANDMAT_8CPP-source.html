<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>BANDMAT.CPP Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>BANDMAT.CPP</h1><a href="BANDMAT_8CPP.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Owner: Fred</span>
00002 <span class="comment">//$$ bandmat.cpp                     Band matrix definitions</span>
00003 
00004 <span class="comment">// Copyright (C) 1991,2,3,4: R B Davies</span>
00005 
<a name="l00006"></a><a class="code" href="BANDMAT_8CPP.html#a0">00006</a> <span class="preprocessor">#define WANT_MATH                                 // include.h will get math fns</span>
00007 <span class="preprocessor"></span>
00008 <span class="preprocessor">#include "include.h"</span>
00009 
00010 <span class="preprocessor">#include "newmat.h"</span>
00011 <span class="preprocessor">#include "newmatrc.h"</span>
00012 
00013 <span class="preprocessor">#ifdef use_namespace</span>
<a name="l00014"></a><a class="code" href="namespaceNEWMAT.html">00014</a> <span class="preprocessor"></span><span class="keyword">namespace </span>NEWMAT {
00015 <span class="preprocessor">#endif</span>
00016 <span class="preprocessor"></span>
00017 <span class="preprocessor">#ifdef DO_REPORT</span>
00018 <span class="preprocessor"></span><span class="preprocessor">#define REPORT { static ExeCounter ExeCount(__LINE__,10); ++ExeCount; }</span>
00019 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00020"></a><a class="code" href="BANDMAT_8CPP.html#a1">00020</a> <span class="preprocessor"></span><span class="preprocessor">#define REPORT {}</span>
00021 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00022 <span class="preprocessor"></span>
<a name="l00023"></a><a class="code" href="classNEWMAT_1_1BandMatrix.html#a2">00023</a>     BandMatrix::BandMatrix(<span class="keyword">const</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp; M) {
00024         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>                                        <span class="comment">// CheckConversion(M);</span>
00025             <a class="code" href="classNEWMAT_1_1MatrixConversionCheck.html">MatrixConversionCheck</a> mcc;
00026         <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gmx=((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp;)M).Evaluate(MatrixType::BM);
00027         <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#b15">GetMatrix</a>(gmx); <a class="code" href="classNEWMAT_1_1BandMatrix.html#b0">CornerClear</a>();
00028     }
00029 
<a name="l00030"></a><a class="code" href="classNEWMAT_1_1BandMatrix.html#a26">00030</a>     <span class="keywordtype">void</span> BandMatrix::SetParameters(<span class="keyword">const</span> <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gmx) {
00031         <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html">MatrixBandWidth</a> bw = gmx-&gt;<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a35">BandWidth</a>();
00032         <a class="code" href="classNEWMAT_1_1BandMatrix.html#m0">lower</a> = bw.<a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#m0">lower</a>; <a class="code" href="classNEWMAT_1_1BandMatrix.html#m1">upper</a> = bw.<a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#m1">upper</a>;
00033     }
00034 
<a name="l00035"></a><a class="code" href="classNEWMAT_1_1BandMatrix.html#a24">00035</a>     <span class="keywordtype">void</span> BandMatrix::ReSize(<span class="keywordtype">int</span> n, <span class="keywordtype">int</span> lb, <span class="keywordtype">int</span> ub) {
00036         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>
00037             <a class="code" href="classTracer.html">Tracer</a> tr(<span class="stringliteral">"BandMatrix::ReSize"</span>);
00038         <span class="keywordflow">if</span> (lb&lt;0 || ub&lt;0) Throw(<a class="code" href="classNEWMAT_1_1ProgramException.html">ProgramException</a>(<span class="stringliteral">"Undefined bandwidth"</span>));
00039         <a class="code" href="classNEWMAT_1_1BandMatrix.html#m0">lower</a> = (lb&lt;=n) ? lb : n-1; <a class="code" href="classNEWMAT_1_1BandMatrix.html#m1">upper</a> = (ub&lt;=n) ? ub : n-1;
00040         GeneralMatrix::ReSize(n,n,n*(<a class="code" href="classNEWMAT_1_1BandMatrix.html#m0">lower</a>+1+<a class="code" href="classNEWMAT_1_1BandMatrix.html#m1">upper</a>)); <a class="code" href="classNEWMAT_1_1BandMatrix.html#b0">CornerClear</a>();
00041     }
00042 
<a name="l00043"></a><a class="code" href="classNEWMAT_1_1BandMatrix.html#a3">00043</a>     <span class="keywordtype">void</span> BandMatrix::operator=(<span class="keyword">const</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp; X) {
00044         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>                                        <span class="comment">// CheckConversion(X);</span>
00045             <a class="code" href="classNEWMAT_1_1MatrixConversionCheck.html">MatrixConversionCheck</a> mcc;
00046         <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#b16">Eq</a>(X,MatrixType::BM); <a class="code" href="classNEWMAT_1_1BandMatrix.html#b0">CornerClear</a>();
00047     }
00048 
<a name="l00049"></a><a class="code" href="classNEWMAT_1_1BandMatrix.html#b0">00049</a>     <span class="keywordtype">void</span> BandMatrix::CornerClear()<span class="keyword"> const </span>{
00050         <span class="comment">// set unused parts of BandMatrix to zero</span>
00051         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>
00052             <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1BandMatrix.html#m0">lower</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>; <span class="keywordtype">int</span> bw = <a class="code" href="classNEWMAT_1_1BandMatrix.html#m0">lower</a> + 1 + <a class="code" href="classNEWMAT_1_1BandMatrix.html#m1">upper</a>;
00053             <span class="keywordflow">while</span> (i)
00054             { <span class="keywordtype">int</span> j = <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* sj = s; s += bw; <span class="keywordflow">while</span> (j--) *sj++ = 0.0; }
00055             <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1BandMatrix.html#m1">upper</a>; s = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a> + <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n3">storage</a>;
00056             <span class="keywordflow">while</span> (i)
00057             { <span class="keywordtype">int</span> j = <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* sj = s; s -= bw; <span class="keywordflow">while</span> (j--) *(--sj) = 0.0; }
00058     }
00059 
<a name="l00060"></a><a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#a2">00060</a>     <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html">MatrixBandWidth</a> MatrixBandWidth::operator+(<span class="keyword">const</span> <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html">MatrixBandWidth</a>&amp; bw)<span class="keyword"> const </span>{
00061         <span class="keywordtype">int</span> l = bw.<a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#m0">lower</a>; <span class="keywordtype">int</span> u = bw.<a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#m1">upper</a>;
00062         l = (<a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#m0">lower</a> &lt; 0 || l &lt; 0) ? -1 : (<a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#m0">lower</a> &gt; l) ? <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#m0">lower</a> : l;
00063         u = (<a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#m1">upper</a> &lt; 0 || u &lt; 0) ? -1 : (<a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#m1">upper</a> &gt; u) ? <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#m1">upper</a> : u;
00064         <span class="keywordflow">return</span> <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#a0">MatrixBandWidth</a>(l,u);
00065     }
00066 
<a name="l00067"></a><a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#a3">00067</a>     <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html">MatrixBandWidth</a> MatrixBandWidth::operator*(<span class="keyword">const</span> <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html">MatrixBandWidth</a>&amp; bw)<span class="keyword"> const </span>{
00068         <span class="keywordtype">int</span> l = bw.<a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#m0">lower</a>; <span class="keywordtype">int</span> u = bw.<a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#m1">upper</a>;
00069         l = (<a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#m0">lower</a> &lt; 0 || l &lt; 0) ? -1 : <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#m0">lower</a>+l;
00070         u = (<a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#m1">upper</a> &lt; 0 || u &lt; 0) ? -1 : <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#m1">upper</a>+u;
00071         <span class="keywordflow">return</span> <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#a0">MatrixBandWidth</a>(l,u);
00072     }
00073 
<a name="l00074"></a><a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#a4">00074</a>     <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html">MatrixBandWidth</a> MatrixBandWidth::minimum(<span class="keyword">const</span> <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html">MatrixBandWidth</a>&amp; bw)<span class="keyword"> const </span>{
00075         <span class="keywordtype">int</span> l = bw.<a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#m0">lower</a>; <span class="keywordtype">int</span> u = bw.<a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#m1">upper</a>;
00076         <span class="keywordflow">if</span> ((<a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#m0">lower</a> &gt;= 0) &amp;&amp; ( (l &lt; 0) || (l &gt; <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#m0">lower</a>) )) l = <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#m0">lower</a>;
00077         <span class="keywordflow">if</span> ((<a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#m1">upper</a> &gt;= 0) &amp;&amp; ( (u &lt; 0) || (u &gt; <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#m1">upper</a>) )) u = <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#m1">upper</a>;
00078         <span class="keywordflow">return</span> <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#a0">MatrixBandWidth</a>(l,u);
00079     }
00080 
<a name="l00081"></a><a class="code" href="classNEWMAT_1_1UpperBandMatrix.html#a2">00081</a>     UpperBandMatrix::UpperBandMatrix(<span class="keyword">const</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp; M) {
00082         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>                                        <span class="comment">// CheckConversion(M);</span>
00083             <a class="code" href="classNEWMAT_1_1MatrixConversionCheck.html">MatrixConversionCheck</a> mcc;
00084         <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gmx=((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp;)M).Evaluate(MatrixType::UB);
00085         <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#b15">GetMatrix</a>(gmx); <a class="code" href="classNEWMAT_1_1BandMatrix.html#b0">CornerClear</a>();
00086     }
00087 
<a name="l00088"></a><a class="code" href="classNEWMAT_1_1UpperBandMatrix.html#a3">00088</a>     <span class="keywordtype">void</span> UpperBandMatrix::operator=(<span class="keyword">const</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp; X) {
00089         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>                                        <span class="comment">// CheckConversion(X);</span>
00090             <a class="code" href="classNEWMAT_1_1MatrixConversionCheck.html">MatrixConversionCheck</a> mcc;
00091         <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#b16">Eq</a>(X,MatrixType::UB); <a class="code" href="classNEWMAT_1_1BandMatrix.html#b0">CornerClear</a>();
00092     }
00093 
<a name="l00094"></a><a class="code" href="classNEWMAT_1_1LowerBandMatrix.html#a2">00094</a>     LowerBandMatrix::LowerBandMatrix(<span class="keyword">const</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp; M) {
00095         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>                                        <span class="comment">// CheckConversion(M);</span>
00096             <a class="code" href="classNEWMAT_1_1MatrixConversionCheck.html">MatrixConversionCheck</a> mcc;
00097         <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gmx=((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp;)M).Evaluate(MatrixType::LB);
00098         <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#b15">GetMatrix</a>(gmx); <a class="code" href="classNEWMAT_1_1BandMatrix.html#b0">CornerClear</a>();
00099     }
00100 
<a name="l00101"></a><a class="code" href="classNEWMAT_1_1LowerBandMatrix.html#a3">00101</a>     <span class="keywordtype">void</span> LowerBandMatrix::operator=(<span class="keyword">const</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp; X) {
00102         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>                                        <span class="comment">// CheckConversion(X);</span>
00103             <a class="code" href="classNEWMAT_1_1MatrixConversionCheck.html">MatrixConversionCheck</a> mcc;
00104         <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#b16">Eq</a>(X,MatrixType::LB); <a class="code" href="classNEWMAT_1_1BandMatrix.html#b0">CornerClear</a>();
00105     }
00106 
<a name="l00107"></a><a class="code" href="classNEWMAT_1_1BandLUMatrix.html#a0">00107</a>     BandLUMatrix::BandLUMatrix(<span class="keyword">const</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp; m) {
00108         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>
00109             <a class="code" href="classTracer.html">Tracer</a> tr(<span class="stringliteral">"BandLUMatrix"</span>);
00110         <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gm = ((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp;)m).Evaluate(MatrixType::BM);
00111         m1 = ((<a class="code" href="classNEWMAT_1_1BandMatrix.html">BandMatrix</a>*)gm)-&gt;lower; m2 = ((<a class="code" href="classNEWMAT_1_1BandMatrix.html">BandMatrix</a>*)gm)-&gt;upper;
00112         <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#b15">GetMatrix</a>(gm);
00113         <span class="keywordflow">if</span> (<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>!=<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n2">ncols</a>) Throw(<a class="code" href="classNEWMAT_1_1NotSquareException.html">NotSquareException</a>(*<span class="keyword">this</span>));
00114         d = <span class="keyword">true</span>; sing = <span class="keyword">false</span>;
00115         indx = <span class="keyword">new</span> <span class="keywordtype">int</span> [<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>]; <a class="code" href="namespaceNEWMAT.html#a19">MatrixErrorNoSpace</a>(indx);
00116         <a class="code" href="MYEXCEPT_8H.html#a2">MONITOR_INT_NEW</a>(<span class="stringliteral">"Index (BndLUMat)"</span>,<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>,indx)
00117             storage2 = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a> * m1;
00118         store2 = <span class="keyword">new</span> <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> [storage2]; <a class="code" href="namespaceNEWMAT.html#a19">MatrixErrorNoSpace</a>(store2);
00119         <a class="code" href="MYEXCEPT_8H.html#a1">MONITOR_REAL_NEW</a>(<span class="stringliteral">"Make (BandLUMat)"</span>,storage2,store2)
00120             ludcmp();
00121     }
00122 
<a name="l00123"></a><a class="code" href="classNEWMAT_1_1BandLUMatrix.html#a3">00123</a>     BandLUMatrix::~BandLUMatrix() {
00124         <a class="code" href="MYEXCEPT_8H.html#a4">MONITOR_INT_DELETE</a>(<span class="stringliteral">"Index (BndLUMat)"</span>,<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>,indx)
00125             <a class="code" href="MYEXCEPT_8H.html#a3">MONITOR_REAL_DELETE</a>(<span class="stringliteral">"Delete (BndLUMt)"</span>,storage2,store2)
00126             <span class="keyword">delete</span> [] indx; <span class="keyword">delete</span> [] store2;
00127     }
00128 
<a name="l00129"></a><a class="code" href="classNEWMAT_1_1BandLUMatrix.html#a1">00129</a>     <a class="code" href="classNEWMAT_1_1MatrixType.html">MatrixType</a> BandLUMatrix::Type()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> MatrixType::BC; }
00130 
<a name="l00131"></a><a class="code" href="classNEWMAT_1_1BandLUMatrix.html#a5">00131</a>     <a class="code" href="classNEWMAT_1_1LogAndSign.html">LogAndSign</a> BandLUMatrix::LogDeterminant()<span class="keyword"> const </span>{
00132         <span class="keywordflow">if</span> (sing) <span class="keywordflow">return</span> 0.0;
00133         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* a = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>; <span class="keywordtype">int</span> w = m1+1+m2; <a class="code" href="classNEWMAT_1_1LogAndSign.html">LogAndSign</a> sum; <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>;
00134         <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) { sum *= *a; a += w; }
00135         <span class="keywordflow">if</span> (!d) sum.<a class="code" href="classNEWMAT_1_1LogAndSign.html#a3">ChangeSign</a>(); <span class="keywordflow">return</span> sum;
00136     }
00137 
<a name="l00138"></a><a class="code" href="classNEWMAT_1_1BandMatrix.html#a12">00138</a>     <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* BandMatrix::MakeSolver() {
00139         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>
00140             <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gm = <span class="keyword">new</span> <a class="code" href="classNEWMAT_1_1BandLUMatrix.html">BandLUMatrix</a>(*<span class="keyword">this</span>);
00141         <a class="code" href="namespaceNEWMAT.html#a19">MatrixErrorNoSpace</a>(gm); gm-&gt;ReleaseAndDelete(); <span class="keywordflow">return</span> gm;
00142     }
00143 
00144     <span class="keywordtype">void</span> BandLUMatrix::ludcmp() {
00145         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>
00146             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* a = store2; <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = storage2;
00147         <span class="comment">// clear store2 - so unused locations are always zero -</span>
00148         <span class="comment">// required by operator==</span>
00149         <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) *a++ = 0.0;
00150         a = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>;
00151         <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = m1; <span class="keywordtype">int</span> j = m2; <span class="keywordtype">int</span> k; <span class="keywordtype">int</span> n = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>; <span class="keywordtype">int</span> w = m1 + 1 + m2;
00152         <span class="keywordflow">while</span> (i) {
00153             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* ai = a + <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>;
00154             k = ++j; <span class="keywordflow">while</span> (k--) *a++ = *ai++;
00155             k = <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--; <span class="keywordflow">while</span> (k--) *a++ = 0.0;
00156         }
00157 
00158         a = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>; <span class="keywordtype">int</span> l = m1;
00159         <span class="keywordflow">for</span> (k=0; k&lt;n; k++) {
00160             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> x = *a; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = k; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* aj = a;
00161             <span class="keywordflow">if</span> (l &lt; n) l++;
00162             <span class="keywordflow">for</span> (j=k+1; j&lt;l; j++) {
00163                 aj += w; <span class="keywordflow">if</span> (<a class="code" href="OLINALG_8CPP.html#a2">fabs</a>(x) &lt; <a class="code" href="OLINALG_8CPP.html#a2">fabs</a>(*aj)) {
00164                     x = *aj; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = j;
00165                 }
00166             }
00167             indx[k] = <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>;
00168             <span class="keywordflow">if</span> (x==0) { sing = <span class="keyword">true</span>; <span class="keywordflow">return</span>; }
00169             <span class="keywordflow">if</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>!=k) {
00170                 d = !d; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* ak = a; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* ai = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a> + <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> * w; j = w;
00171                 <span class="keywordflow">while</span> (j--) { x = *ak; *ak++ = *ai; *ai++ = x; }
00172             }
00173             aj = a + w; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* m = store2 + m1 * k;
00174             <span class="keywordflow">for</span> (j=k+1; j&lt;l; j++) {
00175                 *m++ = x = *aj / *a; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = w; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* ak = a;
00176                 <span class="keywordflow">while</span> (--<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>) { <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* aj1 = aj++; *aj1 = *aj - x * *(++ak); }
00177                 *aj++ = 0.0;
00178             }
00179             a += w;
00180         }
00181     }
00182 
<a name="l00183"></a><a class="code" href="classNEWMAT_1_1BandLUMatrix.html#a2">00183</a>     <span class="keywordtype">void</span> BandLUMatrix::lubksb(<a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* B, <span class="keywordtype">int</span> mini) {
00184         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>
00185             <a class="code" href="classTracer.html">Tracer</a> tr(<span class="stringliteral">"BandLUMatrix::lubksb"</span>);
00186         <span class="keywordflow">if</span> (sing) Throw(<a class="code" href="classNEWMAT_1_1SingularException.html">SingularException</a>(*<span class="keyword">this</span>));
00187         <span class="keywordtype">int</span> n = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>; <span class="keywordtype">int</span> l = m1; <span class="keywordtype">int</span> w = m1 + 1 + m2;
00188 
00189         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;n; k++) {
00190             <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = indx[k];
00191             <span class="keywordflow">if</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>!=k) { <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> x=B[k]; B[k]=B[<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>]; B[<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>]=x; }
00192             <span class="keywordflow">if</span> (l&lt;n) l++;
00193             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* m = store2 + k*m1; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* b = B+k; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* bi = b;
00194             <span class="keywordflow">for</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>=k+1; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>&lt;l; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>++)  *(++bi) -= *m++ * *b;
00195         }
00196 
00197         l = -m1;
00198         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = n-1; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>&gt;=mini; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) {
00199             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* b = B + <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* bk = b; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> x = *bk;
00200             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* a = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a> + w*<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> y = *a;
00201             <span class="keywordtype">int</span> k = l+m1; <span class="keywordflow">while</span> (k--) x -=  *(++a) * *(++bk);
00202             *b = x / y;
00203             <span class="keywordflow">if</span> (l &lt; m2) l++;
00204         }
00205     }
00206 
<a name="l00207"></a><a class="code" href="classNEWMAT_1_1BandLUMatrix.html#a6">00207</a>     <span class="keywordtype">void</span> BandLUMatrix::Solver(<a class="code" href="classMatrixColX.html">MatrixColX</a>&amp; mcout, <span class="keyword">const</span> <a class="code" href="classMatrixColX.html">MatrixColX</a>&amp; mcin) {
00208         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>
00209             <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = mcin.<a class="code" href="classMatrixRowCol.html#m1">skip</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* el = mcin.<a class="code" href="classMatrixRowCol.html#m5">data</a>-<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* el1=el;
00210             <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) *el++ = 0.0;
00211             el += mcin.<a class="code" href="classMatrixRowCol.html#m2">storage</a>; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a> - mcin.<a class="code" href="classMatrixRowCol.html#m1">skip</a> - mcin.<a class="code" href="classMatrixRowCol.html#m2">storage</a>;
00212             <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) *el++ = 0.0;
00213             <a class="code" href="classNEWMAT_1_1BandLUMatrix.html#a2">lubksb</a>(el1, mcout.<a class="code" href="classMatrixRowCol.html#m1">skip</a>);
00214     }
00215 
00216     <span class="comment">// Do we need check for entirely zero output?</span>
00217 
<a name="l00218"></a><a class="code" href="classNEWMAT_1_1UpperBandMatrix.html#a9">00218</a>     <span class="keywordtype">void</span> UpperBandMatrix::Solver(<a class="code" href="classMatrixColX.html">MatrixColX</a>&amp; mcout,
00219                                  <span class="keyword">const</span> <a class="code" href="classMatrixColX.html">MatrixColX</a>&amp; mcin) {
00220         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>
00221             <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = mcin.<a class="code" href="classMatrixRowCol.html#m1">skip</a>-mcout.<a class="code" href="classMatrixRowCol.html#m1">skip</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* elx = mcin.<a class="code" href="classMatrixRowCol.html#m5">data</a>-<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>;
00222         <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>-- &gt; 0) *elx++ = 0.0;
00223         <span class="keywordtype">int</span> nr = mcin.<a class="code" href="classMatrixRowCol.html#m1">skip</a>+mcin.<a class="code" href="classMatrixRowCol.html#m2">storage</a>;
00224         elx = mcin.<a class="code" href="classMatrixRowCol.html#m5">data</a>+mcin.<a class="code" href="classMatrixRowCol.html#m2">storage</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* el = elx;
00225         <span class="keywordtype">int</span> j = mcout.<a class="code" href="classMatrixRowCol.html#m1">skip</a>+mcout.<a class="code" href="classMatrixRowCol.html#m2">storage</a>-nr; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = nr-mcout.<a class="code" href="classMatrixRowCol.html#m1">skip</a>;
00226         <span class="keywordflow">while</span> (j-- &gt; 0) *elx++ = 0.0;
00227 
00228         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* Ael = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a> + (<a class="code" href="classNEWMAT_1_1BandMatrix.html#m1">upper</a>+1)*(<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>-1)+1; j = 0;
00229         <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>-- &gt; 0) {
00230             elx = el; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum = 0.0; <span class="keywordtype">int</span> jx = j;
00231             <span class="keywordflow">while</span> (jx--) sum += *(--Ael) * *(--elx);
00232             elx--; *elx = (*elx - sum) / *(--Ael);
00233             <span class="keywordflow">if</span> (j&lt;<a class="code" href="classNEWMAT_1_1BandMatrix.html#m1">upper</a>) Ael -= <a class="code" href="classNEWMAT_1_1BandMatrix.html#m1">upper</a> - (++j); <span class="keywordflow">else</span> el--;
00234         }
00235     }
00236 
<a name="l00237"></a><a class="code" href="classNEWMAT_1_1LowerBandMatrix.html#a9">00237</a>     <span class="keywordtype">void</span> LowerBandMatrix::Solver(<a class="code" href="classMatrixColX.html">MatrixColX</a>&amp; mcout,
00238                                  <span class="keyword">const</span> <a class="code" href="classMatrixColX.html">MatrixColX</a>&amp; mcin) {
00239         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>
00240             <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = mcin.<a class="code" href="classMatrixRowCol.html#m1">skip</a>-mcout.<a class="code" href="classMatrixRowCol.html#m1">skip</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* elx = mcin.<a class="code" href="classMatrixRowCol.html#m5">data</a>-<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>;
00241         <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>-- &gt; 0) *elx++ = 0.0;
00242         <span class="keywordtype">int</span> nc = mcin.<a class="code" href="classMatrixRowCol.html#m1">skip</a>; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = nc+mcin.<a class="code" href="classMatrixRowCol.html#m2">storage</a>; elx = mcin.<a class="code" href="classMatrixRowCol.html#m5">data</a>+mcin.<a class="code" href="classMatrixRowCol.html#m2">storage</a>;
00243         <span class="keywordtype">int</span> nr = mcout.<a class="code" href="classMatrixRowCol.html#m1">skip</a>+mcout.<a class="code" href="classMatrixRowCol.html#m2">storage</a>; <span class="keywordtype">int</span> j = nr-<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = nr-nc;
00244         <span class="keywordflow">while</span> (j-- &gt; 0) *elx++ = 0.0;
00245 
00246         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* el = mcin.<a class="code" href="classMatrixRowCol.html#m5">data</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* Ael = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a> + (<a class="code" href="classNEWMAT_1_1BandMatrix.html#m0">lower</a>+1)*nc + <a class="code" href="classNEWMAT_1_1BandMatrix.html#m0">lower</a>; j = 0;
00247         <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>-- &gt; 0) {
00248             elx = el; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum = 0.0; <span class="keywordtype">int</span> jx = j;
00249             <span class="keywordflow">while</span> (jx--) sum += *Ael++ * *elx++;
00250             *elx = (*elx - sum) / *Ael++;
00251             <span class="keywordflow">if</span> (j&lt;<a class="code" href="classNEWMAT_1_1BandMatrix.html#m0">lower</a>) Ael += <a class="code" href="classNEWMAT_1_1BandMatrix.html#m0">lower</a> - (++j); <span class="keywordflow">else</span> el++;
00252         }
00253     }
00254 
<a name="l00255"></a><a class="code" href="classNEWMAT_1_1BandMatrix.html#a11">00255</a>     <a class="code" href="classNEWMAT_1_1LogAndSign.html">LogAndSign</a> BandMatrix::LogDeterminant()<span class="keyword"> const </span>{
00256         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>
00257             <a class="code" href="classNEWMAT_1_1BandLUMatrix.html">BandLUMatrix</a> C(*<span class="keyword">this</span>); <span class="keywordflow">return</span> C.LogDeterminant();
00258     }
00259 
<a name="l00260"></a><a class="code" href="classNEWMAT_1_1LowerBandMatrix.html#a10">00260</a>     <a class="code" href="classNEWMAT_1_1LogAndSign.html">LogAndSign</a> LowerBandMatrix::LogDeterminant()<span class="keyword"> const </span>{
00261         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>
00262             <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>; <a class="code" href="classNEWMAT_1_1LogAndSign.html">LogAndSign</a> sum; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a> + <a class="code" href="classNEWMAT_1_1BandMatrix.html#m0">lower</a>; <span class="keywordtype">int</span> j = <a class="code" href="classNEWMAT_1_1BandMatrix.html#m0">lower</a> + 1;
00263             <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) { sum *= *s; s += j; }
00264             ((<a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp;)*<span class="keyword">this</span>).tDelete(); <span class="keywordflow">return</span> sum;
00265     }
00266 
<a name="l00267"></a><a class="code" href="classNEWMAT_1_1UpperBandMatrix.html#a10">00267</a>     <a class="code" href="classNEWMAT_1_1LogAndSign.html">LogAndSign</a> UpperBandMatrix::LogDeterminant()<span class="keyword"> const </span>{
00268         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>
00269             <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>; <a class="code" href="classNEWMAT_1_1LogAndSign.html">LogAndSign</a> sum; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>; <span class="keywordtype">int</span> j = <a class="code" href="classNEWMAT_1_1BandMatrix.html#m1">upper</a> + 1;
00270             <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) { sum *= *s; s += j; }
00271             ((<a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp;)*<span class="keyword">this</span>).tDelete(); <span class="keywordflow">return</span> sum;
00272     }
00273 
<a name="l00274"></a><a class="code" href="classNEWMAT_1_1SymmetricBandMatrix.html#a11">00274</a>     <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* SymmetricBandMatrix::MakeSolver() {
00275         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>
00276             <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gm = <span class="keyword">new</span> <a class="code" href="classNEWMAT_1_1BandLUMatrix.html">BandLUMatrix</a>(*<span class="keyword">this</span>);
00277         <a class="code" href="namespaceNEWMAT.html#a19">MatrixErrorNoSpace</a>(gm); gm-&gt;ReleaseAndDelete(); <span class="keywordflow">return</span> gm;
00278     }
00279 
<a name="l00280"></a><a class="code" href="classNEWMAT_1_1SymmetricBandMatrix.html#a2">00280</a>     SymmetricBandMatrix::SymmetricBandMatrix(<span class="keyword">const</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp; M) {
00281         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>                                        <span class="comment">// CheckConversion(M);</span>
00282             <a class="code" href="classNEWMAT_1_1MatrixConversionCheck.html">MatrixConversionCheck</a> mcc;
00283         <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gmx=((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp;)M).Evaluate(MatrixType::SB);
00284         <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#b15">GetMatrix</a>(gmx);
00285     }
00286 
<a name="l00287"></a><a class="code" href="classNEWMAT_1_1SymmetricBandMatrix.html#a23">00287</a>     <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* SymmetricBandMatrix::Transpose(<a class="code" href="classNEWMAT_1_1TransposedMatrix.html">TransposedMatrix</a>*, <a class="code" href="classNEWMAT_1_1MatrixType.html">MatrixType</a> mt)
00288     { <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>  <span class="keywordflow">return</span> <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a0">Evaluate</a>(mt); }
00289 
<a name="l00290"></a><a class="code" href="classNEWMAT_1_1SymmetricBandMatrix.html#a17">00290</a>     <a class="code" href="classNEWMAT_1_1LogAndSign.html">LogAndSign</a> SymmetricBandMatrix::LogDeterminant()<span class="keyword"> const </span>{
00291         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>
00292             <a class="code" href="classNEWMAT_1_1BandLUMatrix.html">BandLUMatrix</a> C(*<span class="keyword">this</span>); <span class="keywordflow">return</span> C.LogDeterminant();
00293     }
00294 
<a name="l00295"></a><a class="code" href="classNEWMAT_1_1SymmetricBandMatrix.html#a26">00295</a>     <span class="keywordtype">void</span> SymmetricBandMatrix::SetParameters(<span class="keyword">const</span> <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gmx)
00296     { <a class="code" href="classNEWMAT_1_1SymmetricBandMatrix.html#m0">lower</a> = gmx-&gt;<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a35">BandWidth</a>().<a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#m0">lower</a>; }
00297 
<a name="l00298"></a><a class="code" href="classNEWMAT_1_1SymmetricBandMatrix.html#a24">00298</a>     <span class="keywordtype">void</span> SymmetricBandMatrix::ReSize(<span class="keywordtype">int</span> n, <span class="keywordtype">int</span> lb) {
00299         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>
00300             <a class="code" href="classTracer.html">Tracer</a> tr(<span class="stringliteral">"SymmetricBandMatrix::ReSize"</span>);
00301         <span class="keywordflow">if</span> (lb&lt;0) Throw(<a class="code" href="classNEWMAT_1_1ProgramException.html">ProgramException</a>(<span class="stringliteral">"Undefined bandwidth"</span>));
00302         <a class="code" href="classNEWMAT_1_1SymmetricBandMatrix.html#m0">lower</a> = (lb&lt;=n) ? lb : n-1;
00303         GeneralMatrix::ReSize(n,n,n*(<a class="code" href="classNEWMAT_1_1SymmetricBandMatrix.html#m0">lower</a>+1));
00304     }
00305 
<a name="l00306"></a><a class="code" href="classNEWMAT_1_1SymmetricBandMatrix.html#a3">00306</a>     <span class="keywordtype">void</span> SymmetricBandMatrix::operator=(<span class="keyword">const</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp; X) {
00307         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>                                        <span class="comment">// CheckConversion(X);</span>
00308             <a class="code" href="classNEWMAT_1_1MatrixConversionCheck.html">MatrixConversionCheck</a> mcc;
00309         <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#b16">Eq</a>(X,MatrixType::SB);
00310     }
00311 
00312     <span class="keywordtype">void</span> SymmetricBandMatrix::CornerClear()<span class="keyword"> const </span>{
00313         <span class="comment">// set unused parts of BandMatrix to zero</span>
00314         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>
00315             <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1SymmetricBandMatrix.html#m0">lower</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>; <span class="keywordtype">int</span> bw = <a class="code" href="classNEWMAT_1_1SymmetricBandMatrix.html#m0">lower</a> + 1;
00316             <span class="keywordflow">while</span> (i)
00317             { <span class="keywordtype">int</span> j = <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* sj = s; s += bw; <span class="keywordflow">while</span> (j--) *sj++ = 0.0; }
00318     }
00319 
<a name="l00320"></a><a class="code" href="classNEWMAT_1_1SymmetricBandMatrix.html#a25">00320</a>     <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html">MatrixBandWidth</a> SymmetricBandMatrix::BandWidth()<span class="keyword"> const</span>
00321 <span class="keyword">    </span>{ <span class="keywordflow">return</span> <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html">MatrixBandWidth</a>(<a class="code" href="classNEWMAT_1_1SymmetricBandMatrix.html#m0">lower</a>,<a class="code" href="classNEWMAT_1_1SymmetricBandMatrix.html#m0">lower</a>); }
00322 
<a name="l00323"></a><a class="code" href="namespaceNEWMAT.html#a1">00323</a>     <span class="keyword">inline</span> <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> <a class="code" href="namespaceNEWMAT.html#a1">square</a>(<a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> x) { <span class="keywordflow">return</span> x*x; }
00324 
<a name="l00325"></a><a class="code" href="classNEWMAT_1_1SymmetricBandMatrix.html#a12">00325</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> SymmetricBandMatrix::SumSquare()<span class="keyword"> const </span>{
00326         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>
00327             CornerClear();
00328         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum1=0.0; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum2=0.0; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s=<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>; <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>=<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>; <span class="keywordtype">int</span> l=<a class="code" href="classNEWMAT_1_1SymmetricBandMatrix.html#m0">lower</a>;
00329         <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--)
00330         { <span class="keywordtype">int</span> j = l; <span class="keywordflow">while</span> (j--) sum2 += <a class="code" href="NEWMATRM_8H.html#a1">square</a>(*s++); sum1 += <a class="code" href="NEWMATRM_8H.html#a1">square</a>(*s++); }
00331         ((<a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp;)*<span class="keyword">this</span>).tDelete(); <span class="keywordflow">return</span> sum1 + 2.0 * sum2;
00332     }
00333 
<a name="l00334"></a><a class="code" href="classNEWMAT_1_1SymmetricBandMatrix.html#a13">00334</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> SymmetricBandMatrix::SumAbsoluteValue()<span class="keyword"> const </span>{
00335         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>
00336             CornerClear();
00337         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum1=0.0; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum2=0.0; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s=<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>; <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>=<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>; <span class="keywordtype">int</span> l=<a class="code" href="classNEWMAT_1_1SymmetricBandMatrix.html#m0">lower</a>;
00338         <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--)
00339         { <span class="keywordtype">int</span> j = l; <span class="keywordflow">while</span> (j--) sum2 += <a class="code" href="OLINALG_8CPP.html#a2">fabs</a>(*s++); sum1 += <a class="code" href="OLINALG_8CPP.html#a2">fabs</a>(*s++); }
00340         ((<a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp;)*<span class="keyword">this</span>).tDelete(); <span class="keywordflow">return</span> sum1 + 2.0 * sum2;
00341     }
00342 
<a name="l00343"></a><a class="code" href="classNEWMAT_1_1SymmetricBandMatrix.html#a14">00343</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> SymmetricBandMatrix::Sum()<span class="keyword"> const </span>{
00344         <a class="code" href="BANDMAT_8CPP.html#a1">REPORT</a>
00345             CornerClear();
00346         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum1=0.0; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum2=0.0; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s=<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>; <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>=<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>; <span class="keywordtype">int</span> l=<a class="code" href="classNEWMAT_1_1SymmetricBandMatrix.html#m0">lower</a>;
00347         <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--)
00348         { <span class="keywordtype">int</span> j = l; <span class="keywordflow">while</span> (j--) sum2 += *s++; sum1 += *s++; }
00349         ((<a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp;)*<span class="keyword">this</span>).tDelete(); <span class="keywordflow">return</span> sum1 + 2.0 * sum2;
00350     }
00351 
00352 <span class="preprocessor">#ifdef use_namespace</span>
00353 <span class="preprocessor"></span>}
00354 <span class="preprocessor">#endif</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:37:01 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
