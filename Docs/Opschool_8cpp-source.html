<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Opschool.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Opschool.cpp</h1><a href="Opschool_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : OPSCHOOL.CPP</span>
00002 <span class="comment">//Description : School class</span>
00003 <span class="comment">//Owner       : Fred</span>
00004 
00005 <span class="preprocessor">#include &lt;OCONFIG.H&gt;</span>
00006 <span class="preprocessor">#include &lt;OAUDIO.H&gt;</span>
00007 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00008 <span class="preprocessor">#include &lt;OMATH.H&gt;</span>
00009 <span class="preprocessor">#include &lt;OINFO.H&gt;</span>
00010 <span class="preprocessor">#include &lt;<a class="code" href="ODATE_8H.html">ODATE.H</a>&gt;</span>
00011 <span class="preprocessor">#include &lt;OGAMESTR.H&gt;</span>
00012 <span class="preprocessor">#include &lt;<a class="code" href="OMOUSECR_8H.html">OMOUSECR.H</a>&gt;</span>
00013 <span class="preprocessor">#include &lt;<a class="code" href="OGAMESET_8H.html">OGAMESET.H</a>&gt;</span>
00014 <span class="preprocessor">#include &lt;<a class="code" href="OSCHLRES_8H.html">OSCHLRES.H</a>&gt;</span>
00015 <span class="preprocessor">#include &lt;OSTUDENT.H&gt;</span>
00016 <span class="preprocessor">#include &lt;ODEPT.H&gt;</span>
00017 <span class="preprocessor">#include &lt;<a class="code" href="ODEPTRES_8H.html">ODEPTRES.H</a>&gt;</span>
00018 <span class="preprocessor">#include &lt;OFACULTY.H&gt;</span>
00019 <span class="preprocessor">#include &lt;OENROLL.H&gt;</span>
00020 <span class="preprocessor">#include &lt;OFINANCE.H&gt;</span>
00021 <span class="preprocessor">#include &lt;OCOURSE.H&gt;</span>
00022 <span class="preprocessor">#include &lt;OATHLETI.H&gt;</span>
00023 <span class="preprocessor">#include &lt;OPSCHOOL.H&gt;</span>
00024 <span class="preprocessor">#include &lt;ONEWS.H&gt;</span>
00025 
00026 <span class="comment">// ## begin chwg0408</span>
00027 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00028 <span class="preprocessor"></span><span class="keyword">enum</span> {
00029     <a class="code" href="Opschool_8cpp.html#a19a0">REPORT_TYPE_DEPARTMENT_PROFILE1</a>, <a class="code" href="Opschool_8cpp.html#a19a1">REPORT_TYPE_DEPARTMENT_PROFILE2</a>,
00030     <a class="code" href="Opschool_8cpp.html#a19a2">REPORT_TYPE_DEPARTMENT_ACTIVITIES</a>, REPORT_TYPE_TURNOVER,
00031     <a class="code" href="Opschool_8cpp.html#a19a3">REPORT_TYPE_INSTITUTION_PROFILE1</a>, <a class="code" href="Opschool_8cpp.html#a19a4">REPORT_TYPE_INSTITUTION_PROFILE2</a>,
00032     <a class="code" href="Opschool_8cpp.html#a19a5">REPORT_TYPE_INSTITUTION_ACTIVITIES</a>, <a class="code" href="Opschool_8cpp.html#a19a6">REPORT_TYPE_INSTITUTION_UNDERGRADUATE</a>,
00033     <a class="code" href="Opschool_8cpp.html#a19a7">REPORT_TYPE_FINANCE</a>,
00034     <a class="code" href="Opschool_8cpp.html#a19a8">REPORT_TYPE_RESIDENCE_HALL</a>,
00035 };
00036 <span class="preprocessor">#else</span>
00037 <span class="preprocessor"></span><span class="keyword">enum</span> {
00038     <a class="code" href="Opschool_8cpp.html#a19a0">REPORT_TYPE_DEPARTMENT_PROFILE1</a>, <a class="code" href="Opschool_8cpp.html#a19a1">REPORT_TYPE_DEPARTMENT_PROFILE2</a>,
00039     <a class="code" href="Opschool_8cpp.html#a19a2">REPORT_TYPE_DEPARTMENT_ACTIVITIES</a>,
00040     <a class="code" href="Opschool_8cpp.html#a19a3">REPORT_TYPE_INSTITUTION_PROFILE1</a>, <a class="code" href="Opschool_8cpp.html#a19a4">REPORT_TYPE_INSTITUTION_PROFILE2</a>,
00041     <a class="code" href="Opschool_8cpp.html#a19a5">REPORT_TYPE_INSTITUTION_ACTIVITIES</a>, <a class="code" href="Opschool_8cpp.html#a19a6">REPORT_TYPE_INSTITUTION_UNDERGRADUATE</a>,
00042     <a class="code" href="Opschool_8cpp.html#a19a7">REPORT_TYPE_FINANCE</a>,
00043     <a class="code" href="Opschool_8cpp.html#a19a8">REPORT_TYPE_RESIDENCE_HALL</a>,
00044 };
00045 <span class="preprocessor">#endif</span>
00046 <span class="preprocessor"></span><span class="keyword">enum</span> { <a class="code" href="Opschool_8cpp.html#a20a9">REPORT_MODE_INSTITUTION</a>, <a class="code" href="Opschool_8cpp.html#a20a10">REPORT_MODE_DEPARTMENT</a>};
00047 <span class="keyword">enum</span> {
00048     <a class="code" href="Opschool_8cpp.html#a21a11">MODE_OVERALL</a>=0,
00049     <a class="code" href="Opschool_8cpp.html#a21a12">MODE_RANK</a>=1,
00050     <a class="code" href="Opschool_8cpp.html#a21a13">MODE_OUTPUTS</a>=2,
00051     <a class="code" href="Opschool_8cpp.html#a21a14">MODE_GENERAL_INSTITUTIONAL_PERFORMANCE</a>=3,
00052     <a class="code" href="Opschool_8cpp.html#a21a15">MODE_ATTITUDES_TOWARD_THE_INSTITUTION</a>=4,
00053     <a class="code" href="Opschool_8cpp.html#a21a16">MODE_FINANCE</a>=5,
00054     <a class="code" href="Opschool_8cpp.html#a21a17">MODE_MANAGEMENT</a>=6,
00055     <a class="code" href="Opschool_8cpp.html#a21a18">MODE_ADMISSION</a>=7,
00056 };
00057 
00058 <span class="comment">// ## end chwg0408</span>
00059 
00060 <span class="comment">//---------- Begin of function PlayerSchool::init -----------//</span>
<a name="l00062"></a><a class="code" href="classPlayerSchool.html#a9">00062</a> <span class="comment">void PlayerSchool::init() {</span>
00063     memset( <span class="keyword">this</span>, 0, <span class="keyword">sizeof</span>(<a class="code" href="classPlayerSchool.html">PlayerSchool</a>) );
00064 
00065     <span class="comment">//## chea 270999 make the student no. report update</span>
00066     memset( ins_student_level_history,0,<span class="keyword">sizeof</span>(ins_student_level_history));
00067 
00068     init_config();
00069     default_setting();
00070     <span class="comment">// ## begin chwg0408</span>
00071     current_score_report_type=<a class="code" href="Opschool_8cpp.html#a21a11">MODE_OVERALL</a>;
00072     current_report_type=<a class="code" href="Opschool_8cpp.html#a19a3">REPORT_TYPE_INSTITUTION_PROFILE1</a>;
00073     current_report_mode=<a class="code" href="Opschool_8cpp.html#a20a9">REPORT_MODE_INSTITUTION</a>;
00074 
00075     <span class="comment">// ## end chwg0408</span>
00076 }
00077 
00078 <span class="comment">//---------- End of function PlayerSchool::init -----------//</span>
00079 
00080 <span class="comment">//---------- Begin of function PlayerSchool::deinit -----------//</span>
<a name="l00082"></a><a class="code" href="classPlayerSchool.html#a10">00082</a> <span class="comment">void PlayerSchool::deinit() {</span>
00083     <span class="comment">//student_array.deinit();</span>
00084 }
00085 
00086 <span class="comment">//---------- End of function PlayerSchool::deinit -----------//</span>
00087 
00088 <span class="comment">//---------- Begin of function PlayerSchool::init_config -----------//</span>
00090 <span class="comment">void PlayerSchool::init_config() {</span>
00091     memset( <span class="keyword">this</span>, 0, <span class="keyword">sizeof</span>(<a class="code" href="classPlayerSchool.html">PlayerSchool</a>) );
00092 
00093     <span class="comment">//------ initialize teaching_method_pref -----//</span>
00094 
00095     teaching_method_pref[<a class="code" href="Ocourse_8h.html#a40a31">SEMINAR</a>]           = 25;
00096     teaching_method_pref[<a class="code" href="Ocourse_8h.html#a40a32">DISTANCE_LEARN_COURSE</a>] = 5;<span class="comment">// class without breakout and class with breakout are classified as one group in selecting teaching method</span>
00097     teaching_method_pref[<a class="code" href="Ocourse_8h.html#a40a33">CLASS_WITH_BREAKOUT</a>]   = 30;
00098     teaching_method_pref[<a class="code" href="Ocourse_8h.html#a40a34">BREAKOUT_LAB</a>]        = 0;
00099     teaching_method_pref[<a class="code" href="Ocourse_8h.html#a40a35">GENERAL</a>]           = 40;
00100 
00101     <span class="comment">//------ initialize course_match_order -------//</span>
00102 
00103     course_match_order[0] = <a class="code" href="Ostudent_8h.html#a32a6">DOCTOR</a>;
00104     course_match_order[1] = <a class="code" href="Ostudent_8h.html#a32a5">MASTER</a>;
00105     course_match_order[2] = <a class="code" href="Ostudent_8h.html#a32a3">UG_TRADITION</a>;
00106     course_match_order[3] = <a class="code" href="Ostudent_8h.html#a32a4">UG_NONTRADITION</a>;
00107     course_match_order[4] = <a class="code" href="Ostudent_8h.html#a32a7">DISTANCE_LEARN</a>;
00108 
00109     <span class="comment">//------ initialize trimester -------//</span>
00110     <span class="comment">//##### begin fred 0805 #####//</span>
00111     <span class="comment">//BUGHERE0 the holidays among the trimesters may introduce semantic BUG</span>
00112     <span class="comment">// should define one more constant besides SUMMER,...</span>
00113     <span class="comment">//##### end fred 0805 #####//</span>
00114 
00115     trimester_array[<a class="code" href="Gamedef_8h.html#a79a36">AUTUMN</a>].start_month = 9;        <span class="comment">// 1 Sep</span>
00116     trimester_array[<a class="code" href="Gamedef_8h.html#a79a36">AUTUMN</a>].start_day   = 1;
00117     trimester_array[<a class="code" href="Gamedef_8h.html#a79a36">AUTUMN</a>].end_month   = 12;       <span class="comment">// 26 Dec</span>
00118     trimester_array[<a class="code" href="Gamedef_8h.html#a79a36">AUTUMN</a>].end_day     = 26;
00119 
00120     trimester_array[<a class="code" href="Gamedef_8h.html#a79a37">WINTER</a>].start_month = 1;        <span class="comment">// 14 Jan</span>
00121     trimester_array[<a class="code" href="Gamedef_8h.html#a79a37">WINTER</a>].start_day   = 14;
00122     trimester_array[<a class="code" href="Gamedef_8h.html#a79a37">WINTER</a>].end_month   = 5;        <span class="comment">// 9 May</span>
00123     trimester_array[<a class="code" href="Gamedef_8h.html#a79a37">WINTER</a>].end_day     = 9;
00124 
00125     trimester_array[<a class="code" href="Gamedef_8h.html#a79a38">SUMMER</a>].start_month = 5;        <span class="comment">// 20 May</span>
00126     trimester_array[<a class="code" href="Gamedef_8h.html#a79a38">SUMMER</a>].start_day   = 20;
00127     trimester_array[<a class="code" href="Gamedef_8h.html#a79a38">SUMMER</a>].end_month   = 8;        <span class="comment">// 31 Aug</span>
00128     trimester_array[<a class="code" href="Gamedef_8h.html#a79a38">SUMMER</a>].end_day     = 30;       <span class="comment">// game_day is limited to 1-30; see info.next_day()</span>
00129 
00130     <span class="comment">//--- calculate the total number of days in each trimester ---//</span>
00131 
00132     trimester_array[<a class="code" href="Gamedef_8h.html#a79a36">AUTUMN</a>].calc_total_days();
00133     trimester_array[<a class="code" href="Gamedef_8h.html#a79a37">WINTER</a>].calc_total_days();
00134     trimester_array[<a class="code" href="Gamedef_8h.html#a79a38">SUMMER</a>].calc_total_days();
00135 }
00136 
00137 <span class="comment">//---------- End of function PlayerSchool::init_config -----------//</span>
00138 
00139 <span class="comment">//---------- Begin of function PlayerSchool::default_setting ----------//</span>
00141 <span class="comment">void PlayerSchool::default_setting() {</span>
00142     cur_trimester=<a class="code" href="Gamedef_8h.html#a80a39">FIRST_TRIMESTER</a>;
00143     <span class="comment">//  new_trimester(AUTUMN);</span>
00144 
00145     <span class="comment">//--- for testing only, set to private research school ---//</span>
00146 
00147     control      = <a class="code" href="Opschool_8h.html#a61a15">PRIVATE</a>;
00148     school_type = <a class="code" href="Gamedef_8h.html#a81a41">PRIVATE_SCHOOL</a>;
00149 
00150     mascot = 1;                                     <span class="comment">// not used yet</span>
00151     <span class="keywordflow">while</span>( player_school.is_hidden_mascot(player_school.mascot) ) {
00152         mascot++;
00153     }
00154 
00155     strcpy( school_name,       <span class="stringliteral">"Player University"</span> );
00156     strcpy( player_first_name, <span class="stringliteral">"Player"</span>     );
00157     strcpy( player_last_name,  <span class="stringliteral">"Name"</span>     );
00158 
00159     scenario_id = 0;                                <span class="comment">// not a scenario</span>
00160 
00161     student_market = <a class="code" href="Opschool_8h.html#a58a4">REGIONAL</a>;
00162 
00163     location =  <a class="code" href="Opschool_8h.html#a59a11">PACIFIC</a>;
00164 
00165     prestige    = <a class="code" href="Gamedef_8h.html#a73a23">INPUT_MEDIUM</a>;
00166     student_count = <a class="code" href="Gamedef_8h.html#a73a23">INPUT_MEDIUM</a>;
00167     sl5_student_percent = <a class="code" href="Gamedef_8h.html#a73a23">INPUT_MEDIUM</a>;
00168 
00169     parttime_undergrad_percent = <a class="code" href="Gamedef_8h.html#a73a23">INPUT_MEDIUM</a>;
00170     ug_get_degree_in_5year_percent = <a class="code" href="Gamedef_8h.html#a73a23">INPUT_MEDIUM</a>;
00171 
00172     fulltime_ug_in_housing_percent = <a class="code" href="Gamedef_8h.html#a73a23">INPUT_MEDIUM</a>;
00173     athletic_program_intensity     = <a class="code" href="Gamedef_8h.html#a73a23">INPUT_MEDIUM</a>;
00174 
00175     graduate_student_percent  = <a class="code" href="Gamedef_8h.html#a73a23">INPUT_MEDIUM</a>;
00176     nondegree_student_percent = 30;
00177 
00178     doctoral_program_intensity    = <a class="code" href="Gamedef_8h.html#a73a23">INPUT_MEDIUM</a>;
00179     sponsored_research_intensity  = <a class="code" href="Gamedef_8h.html#a73a23">INPUT_MEDIUM</a>;   <span class="comment">// ## useless parameter</span>
00180 
00181     relative_wealth     = <a class="code" href="Opschool_8h.html#a60a13">WEALTH_IN_BETWEEN</a>;        <span class="comment">//WEALTH_STRUGGLING,WEALTH_RICH</span>
00182 
00183     control         = <a class="code" href="Opschool_8h.html#a61a15">PRIVATE</a>;
00184     campus_environment  = <a class="code" href="Opschool_8h.html#a62a18">SUBURBAN</a>;
00185 
00186     difficulty_multiplier = 1.0f;
00187 
00188     chance_event_frequency = <a class="code" href="Gamedef_8h.html#a73a23">INPUT_MEDIUM</a>;          <span class="comment">// INPUT_LOW, INPUT_MEDIUM</span>
00189     chance_objective_frequency = <a class="code" href="Gamedef_8h.html#a73a23">INPUT_MEDIUM</a>;
00190 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00191 <span class="preprocessor"></span>    chance_perturbations = <a class="code" href="Gamedef_8h.html#a73a23">INPUT_MEDIUM</a>;
00192     behavioral_response_speed = <a class="code" href="Gamedef_8h.html#a73a22">INPUT_LOW</a>;          <span class="comment">// INPUT_LOW=Normal,INPUT_MEDIUM=faster,INPUT_HIGH=light-speed</span>
00193     threshold_event_flag = 1;
00194 <span class="preprocessor">#endif</span>
00195 <span class="preprocessor"></span>
00196     summer_emphasis = <a class="code" href="Gamedef_8h.html#a73a22">INPUT_LOW</a>;
00197     summer_emphasis_last = <a class="code" href="Gamedef_8h.html#a73a22">INPUT_LOW</a>;
00198     percent_summer_teaching_load = 0;
00199 
00200     <a class="code" href="ALL_8H.html#a0">err_when</a>(<a class="code" href="Gamedef_8h.html#a73a22">INPUT_LOW</a> != 0);
00201 
00202     calc_setting_vars();
00203 }
00204 
00205 <span class="comment">//----------- End of function PlayerSchool::default_setting -----------//</span>
00206 
00207 <span class="comment">//---------- Begin of function PlayerSchool::init_setting_non_scenario ----------//</span>
<a name="l00209"></a><a class="code" href="classPlayerSchool.html#a12">00209</a> <span class="comment">void PlayerSchool::init_setting_non_scenario() {</span>
00210     <span class="keywordtype">char</span> pPrestige[]    = {                         <span class="comment">//## chea 170899 larger range between med &amp; high org. {1,5,10}</span>
00211         1,3,10
00212     };
00213 
00214     <span class="comment">//  char pDistanceL[]               = {0,10,30}; //## chea 0ringal idea</span>
00215     <span class="keywordtype">char</span> pDistanceL[]   = {                         <span class="comment">//## chea 170999 I find out there are too much sl5 so I lower it.</span>
00216         0,5,20
00217     };
00218 
00219     <span class="keywordtype">char</span> pUgPt[]      = {0,20,50};
00220 
00221     <span class="comment">//char pDegFiveYear[]       = {50,70,90};  //## chea org.</span>
00222     <span class="keywordtype">char</span> pDegFiveYear[] = {                         <span class="comment">//## chea 130899 useed in oschlres.cpp ln 225</span>
00223         50,70,100
00224     };
00225 
00226     <span class="keywordtype">char</span> pUgInHousing[] = {30,60,90};
00227 
00228     <span class="keywordtype">char</span> pGradStu[]   = {5,20,35};
00229     <span class="keywordtype">char</span> docIntense[]   = {0,5,10};
00230     <span class="keywordtype">char</span> researchIntense[]  = {                     <span class="comment">//## chea the org. setting</span>
00231         0,5,10
00232     };
00233 
00234     prestige        = pPrestige[prestige];
00235     sl5_student_percent = pDistanceL[sl5_student_percent];
00236     parttime_undergrad_percent = pUgPt[parttime_undergrad_percent];
00237     ug_get_degree_in_5year_percent = pDegFiveYear[ug_get_degree_in_5year_percent];
00238     fulltime_ug_in_housing_percent = pUgInHousing[fulltime_ug_in_housing_percent];
00239 
00240     graduate_student_percent    = pGradStu[graduate_student_percent];
00241     doctoral_program_intensity    = docIntense[doctoral_program_intensity];
00242     sponsored_research_intensity  = researchIntense[sponsored_research_intensity];
00243     <span class="comment">/*</span>
00244 <span class="comment">      //BUGHERE</span>
00245 <span class="comment">      student_market = NATIONAL;</span>
00246 <span class="comment">      prestige          = 8;</span>
00247 <span class="comment">      student_count     = INPUT_MEDIUM;</span>
00248 <span class="comment">      sl5_student_percent       = 1;</span>
00249 <span class="comment">      parttime_undergrad_percent = 1;</span>
00250 <span class="comment">      fulltime_ug_in_housing_percent = 60;</span>
00251 <span class="comment">      athletic_program_intensity        = INPUT_MEDIUM;</span>
00252 <span class="comment">      graduate_student_percent  = 30;</span>
00253 <span class="comment">      doctoral_program_intensity = 7;</span>
00254 <span class="comment">      sponsored_research_intensity =7;</span>
00255 <span class="comment">      control = PRIVATE;</span>
00256 <span class="comment">      campus_environment = SUBURBAN;    // (m.random(2) == 0)?URBAN:SUBURBAN;</span>
00257 <span class="comment">    */</span>
00258 }
00259 
00260 <span class="comment">//----------- End of function PlayerSchool::init_setting_non_scenario -----------//</span>
00261 
00262 <span class="comment">//---------- Begin of function PlayerSchool::calc_setting_vars ----------//</span>
<a name="l00266"></a><a class="code" href="classPlayerSchool.html#a41">00266</a> <span class="comment">void PlayerSchool::calc_setting_vars() {</span>
00267     <span class="comment">//----- set percent_student_in_state -----//</span>
00268 
00269     <span class="keywordflow">switch</span>(student_market) {
00270     <span class="keywordflow">case</span> <a class="code" href="Opschool_8h.html#a58a5">NATIONAL</a>:
00271         percent_student_in_state = 30;
00272         <span class="keywordflow">break</span>;
00273 
00274     <span class="keywordflow">case</span> <a class="code" href="Opschool_8h.html#a58a4">REGIONAL</a>:
00275         percent_student_in_state = 50;
00276         <span class="keywordflow">break</span>;
00277 
00278     <span class="keywordflow">case</span> <a class="code" href="Opschool_8h.html#a58a3">LOCAL</a>:
00279         percent_student_in_state = 70;
00280         <span class="keywordflow">break</span>;
00281     }
00282 
00283     <span class="comment">//----- set relative_wealth_value -------//</span>
00284 
00285     <span class="keywordflow">switch</span>(relative_wealth) {
00286     <span class="keywordflow">case</span> <a class="code" href="Opschool_8h.html#a60a12">WEALTH_RICH</a>:
00287         relative_wealth_value = 2;                  <span class="comment">// if we set it to 3, for some unknown reasons, we will get very low sponsored research amounts for all departments.</span>
00288         <span class="keywordflow">break</span>;
00289 
00290     <span class="keywordflow">case</span> <a class="code" href="Opschool_8h.html#a60a13">WEALTH_IN_BETWEEN</a>:
00291         relative_wealth_value = 2;
00292         <span class="keywordflow">break</span>;
00293 
00294     <span class="keywordflow">case</span> <a class="code" href="Opschool_8h.html#a60a14">WEALTH_STRUGGLING</a>:
00295         relative_wealth_value = 1;
00296         <span class="keywordflow">break</span>;
00297     }
00298 }
00299 
00300 <span class="comment">//----------- End of function PlayerSchool::calc_setting_vars -----------//</span>
00301 
00302 <span class="comment">//---------- Begin of function PlayerSchool::next_day ----------//</span>
<a name="l00304"></a><a class="code" href="classPlayerSchool.html#a33">00304</a> <span class="comment">void PlayerSchool::next_day() {</span>
00305 
00306     <span class="comment">//--- if now it is at the end of a trimester, close the current trimester and open a new trimester ---//</span>
00307 
00308     <span class="keywordflow">if</span>( trimester_array[cur_trimester].end_month == info.game_month &amp;&amp;
00309         trimester_array[cur_trimester].end_day == info.game_day ) {
00310         is_trimester_off  = 1;                        <span class="comment">// it is now in a trimester break</span>
00311         trimester_off_day = 1;                        <span class="comment">// the nth day since the trimester is off</span>
00312 
00313         <span class="comment">//--- if the current trimester is the last trimester, proceeds to the first trimester in the new school year ---//</span>
00314 
00315         <span class="keywordflow">if</span>( ++cur_trimester &gt;= <a class="code" href="Gamedef_8h.html#a78a35">TRIMESTER_PER_YEAR</a> ) {
00316             cur_trimester = 0;
00317         }
00318 
00319         new_trimester(cur_trimester);
00320 
00321         <span class="comment">// new_trimester() above includes graduate() and dropout()</span>
00322 
00323         enroll_res.calc_student_count();
00324 
00325         <span class="comment">// faculty hiring can be added here</span>
00326 
00327         <span class="comment">//---------------------------------------//</span>
00328     }
00329 
00330     <span class="comment">//------- if the trimester is off -------//</span>
00331 
00332     <span class="keywordflow">if</span>( is_trimester_off ) {
00333         <span class="comment">//--- the trimester break ends when the time reaches the beginning of the new trimester ---//</span>
00334 
00335         <span class="keywordflow">if</span>( trimester_array[cur_trimester].start_month == info.game_month &amp;&amp;
00336             trimester_array[cur_trimester].start_day == info.game_day ) {
00337             is_trimester_off = 0;
00338             <span class="comment">//#### begin fred 0911 ####//</span>
00339             info.graph_trimester_passed = min(info.graph_trimester_passed+1, HISTORY_TRIMESTER_COUNT);
00340             <span class="comment">//#### begin fred 0915 ####//</span>
00341             info.graph_trimester = min(info.graph_trimester+1, HISTORY_TRIMESTER_COUNT);
00342         }
00343         <span class="keywordflow">else</span> {
00344             trimester_off_day++;                        <span class="comment">// for various function's uses like student selecting courses.</span>
00345         }
00346     }
00347 }
00348 
00349 <span class="comment">//----------- End of function PlayerSchool::next_day -----------//</span>
00350 
00351 <span class="comment">//---------- Begin of function PlayerSchool::new_trimester ----------//</span>
<a name="l00353"></a><a class="code" href="classPlayerSchool.html#a36">00353</a> <span class="comment">void PlayerSchool::new_trimester(int trimesterId) {</span>
00354     <span class="keywordtype">int</span> oldCursor = mouse_cursor.get_icon();
00355 
00356     mouse_cursor.set_icon(<a class="code" href="OMOUSECR_8H.html#a6a5">CURSOR_WAITING</a>);
00357 
00358     <span class="comment">//------------------------------------//</span>
00359 
00360     cur_trimester = trimesterId;
00361 
00362     cur_trimester_start_date = date.julian( info.game_year,
00363                                             trimester_array[cur_trimester].start_month,
00364                                             trimester_array[cur_trimester].start_day );
00365 
00366     <span class="comment">//----- call next_trimester() of other classes -----//</span>
00367     <span class="comment">//#### begin fred 0922 ####//</span>
00368     next_trimester();                               <span class="comment">// recalc adjusted_student_major_pref for change major</span>
00369     <span class="comment">//#### end fred 0922 ####//</span>
00370 
00371     department_array.calc_course_pref();            <span class="comment">// for select course</span>
00372 
00373     sys.yield();
00374 
00375     <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=department_array.size() ; i&gt;0 ; i--) {
00376         <span class="keywordflow">if</span>( department_array.is_deleted(i) )
00377             <span class="keywordflow">continue</span>;
00378 
00379         <a class="code" href="classDepartment.html">Department</a>* deptPtr = department_array[i];
00380 
00381         deptPtr-&gt;<a class="code" href="classDepartment.html#m0">faculty_array</a>.<a class="code" href="classFacultyArray.html#a8">next_trimester</a>();      <span class="comment">// will think_departure, promotion</span>
00382 
00383         sys.yield();
00384 
00385         deptPtr-&gt;<a class="code" href="classGeneralDepartment.html#m0">student_array</a>.<a class="code" href="classStudentArray.html#a7">next_trimester</a>();      <span class="comment">// will think_graduate, dropout</span>
00386 
00387         sys.yield();
00388     }
00389 
00390     department_res.general_dept.student_array.next_trimester();
00391 
00392     sys.yield();
00393 
00394     mouse_cursor.restore_icon(oldCursor);
00395 
00396     <span class="comment">//------ the start of a new academic year -------//</span>
00397 
00398     <span class="keywordflow">if</span>( cur_trimester == <a class="code" href="Gamedef_8h.html#a80a39">FIRST_TRIMESTER</a> )          <span class="comment">// RESOURCE ALLOCATION HERE!</span>
00399         finance.new_fiscal_year();                    <span class="comment">// assume called after faculty departure</span>
00400     <span class="comment">// and graduation, dropout</span>
00401 
00402     <span class="comment">//---------------------------------------//</span>
00403 
00404 }
00405 
00406 <span class="comment">//----------- End of function PlayerSchool::new_trimester -----------//</span>
00407 
00408 <span class="comment">//---------- Begin of function PlayerSchool::trimester_str ----------//</span>
<a name="l00410"></a><a class="code" href="classPlayerSchool.html#a6">00410</a> <span class="comment">char* PlayerSchool::trimester_str() {</span>
00411     <span class="keyword">static</span> <a class="code" href="classString.html">String</a> str;
00412 
00413     str  = game_str_res.trimester_str(cur_trimester);
00414     str += <span class="stringliteral">" \'"</span>;
00415 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00416 <span class="preprocessor"></span>    str += info.financial_year();
00417 <span class="preprocessor">#else</span>
00418 <span class="preprocessor"></span>    str += info.game_year;
00419 <span class="preprocessor">#endif</span>
00420 <span class="preprocessor"></span>
00421     <span class="keywordflow">return</span> str;
00422 }
00423 
00424 <span class="comment">//----------- End of function PlayerSchool::trimester_str -----------//</span>
00425 
00426 <span class="comment">//---------- Begin of function Trimester::calc_total_days ----------//</span>
<a name="l00428"></a><a class="code" href="structTrimester.html#a0">00428</a> <span class="comment">void Trimester::calc_total_days() {</span>
00429     <span class="keywordtype">int</span> startDate = date.julian( 1990, start_month, start_day );
00430     <span class="keywordtype">int</span> endDate;
00431 
00432     <span class="keywordflow">if</span>( end_month &gt; start_month )                   <span class="comment">// in the same year</span>
00433         endDate = date.julian( 1990, end_month, end_day );
00434     <span class="keywordflow">else</span>
00435         <span class="comment">// in the next year</span>
00436         endDate = date.julian( 1991, end_month, end_day );
00437 
00438     total_days = endDate - startDate + 1;
00439 }
00440 
00441 <span class="comment">//----------- End of function Trimester::calc_total_days -----------//</span>
00442 
00443 <span class="comment">//## chea 270999 for update stu_sum only</span>
00444 <span class="comment">//---------- Begin of function PlayerSchool::update_stu_sum ----------//</span>
<a name="l00446"></a><a class="code" href="classPlayerSchool.html#a39">00446</a> <span class="comment">void PlayerSchool::update_stu_sum() {</span>
00447     <span class="keywordtype">int</span> i,j,k,l,m;
00448     <span class="keywordtype">int</span> test_course_count=0;
00449     <span class="keywordtype">int</span> stdnotest1 = 0;                             <span class="comment">//## chea 270899</span>
00450     <span class="keywordtype">int</span> stdnotest2 = 0;                             <span class="comment">//## chea 270899</span>
00451     <span class="keywordtype">int</span> underno = 0;
00452     <span class="keywordtype">int</span> nontrno =0;
00453     <span class="keywordtype">int</span> masterno = 0;
00454     <span class="keywordtype">int</span> docno =0;
00455     <span class="keywordtype">int</span> dlno =0;
00456     <span class="keywordtype">int</span> is_gen_dept =0;
00457     <span class="keywordtype">int</span> not_h_course = 0;
00458     <span class="keywordtype">int</span> not_h_course1 = 0;
00459     <span class="keywordtype">int</span> not_h_course2 = 0;
00460     <span class="keywordtype">int</span> not_h_course3 = 0;
00461     <span class="keywordtype">int</span> coures_less_40 =0 ;
00462     <span class="keywordtype">int</span> coures_less_41 =0 ;
00463     <span class="keywordtype">int</span> coures_less_42 =0 ;
00464     <span class="keywordtype">int</span> coures_less_43 =0 ;
00465     <span class="keywordtype">int</span> coures_less_44 =0 ;
00466     <span class="keywordtype">int</span> count = 0;
00467 
00468     <a class="code" href="classStudentArray.html">StudentArray</a>* stuArr;
00469     <a class="code" href="classStudent.html">Student</a> *stuPtr;
00470     <a class="code" href="classDepartment.html">Department</a>*  cur_dept_ptr;
00471 
00472     <span class="comment">//reset all variable</span>
00473     <span class="comment">// zero it out</span>
00474     memset(ins_student_level_no, 0, <span class="keyword">sizeof</span>(ins_student_level_no));
00475 
00476     <span class="keywordflow">for</span> ( l=department_array.size(); l&gt;=0; l-- ) {
00477         <span class="keywordflow">if</span> (l) {
00478             <span class="keywordflow">if</span> ( department_array.is_deleted(l) )
00479                 <span class="keywordflow">continue</span>;
00480             cur_dept_ptr = department_array[l];
00481 
00482             <span class="keywordflow">for</span>(m=0; m&lt;<a class="code" href="Ostudent_8h.html#a0">MAX_STUDENT_LEVEL</a>+1; m++) {
00483                 cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m47">dept_student_level_no</a>[m] = 0;
00484                 <span class="keywordflow">if</span>(info.prerun_year == 1 &amp;&amp; info.game_month == 9 &amp;&amp; info.game_day == 1) {
00485                     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b=0; b&lt;HISTORY_TRIMESTER_COUNT; b++)
00486                         cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m48">dept_student_level_history</a>[m][b] = 0;
00487                 }
00488             }
00489         }
00490         <span class="keywordflow">else</span> {
00491             <span class="keywordflow">for</span>(m=0; m&lt;<a class="code" href="Ostudent_8h.html#a0">MAX_STUDENT_LEVEL</a>+1; m++)
00492                 department_res.general_dept.dept_student_level_no[m] = 0;
00493         }
00494     }
00495 
00496     <span class="comment">//dept_student_level_no</span>
00497     <a class="code" href="ALL_8H.html#a0">err_when</a>( department_array.size() == 0 );
00498     <span class="keywordflow">for</span> ( i=department_array.size(); i&gt;=0; i-- ) {
00499         is_gen_dept =0;
00500         <span class="keywordflow">if</span> (i) {
00501             <span class="keywordflow">if</span> ( department_array.is_deleted(i) )
00502                 <span class="keywordflow">continue</span>;
00503             stuArr = &amp;(department_array[i]-&gt;student_array);
00504             cur_dept_ptr = department_array[i];
00505 
00506         }
00507         <span class="keywordflow">else</span> {
00508             stuArr = &amp;(department_res.general_dept.student_array);
00509             is_gen_dept =1;
00510         }
00511         <span class="comment">// loop student</span>
00512 
00513         <span class="keywordflow">for</span> (j=stuArr-&gt;<a class="code" href="classDynArray.html#a28">size</a>(); j&gt;0; j--) {
00514             <span class="keywordflow">if</span> ( stuArr-&gt;<a class="code" href="classStudentArray.html#a9">is_deleted</a>(j) )
00515                 <span class="keywordflow">continue</span>;
00516             stdnotest1++;
00517             sys.yield();
00518             stuPtr = stuArr-&gt;operator[](j);
00519 
00520             <span class="comment">// student_level{ UG_TRADITION, UG_NONTRADITION, MASTER, DOCTOR, DISTANCE_LEARN }</span>
00521             <span class="keywordflow">if</span>(stuPtr-&gt;<a class="code" href="classStudent.html#m2">student_level</a> == <a class="code" href="Ostudent_8h.html#a32a3">UG_TRADITION</a>) {
00522                 <span class="keywordflow">if</span>(is_gen_dept == 0) {
00523                     underno++;
00524                     cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m47">dept_student_level_no</a>[<a class="code" href="Ostudent_8h.html#a32a3">UG_TRADITION</a>]++;
00525                 }
00526                 <span class="keywordflow">else</span>
00527                     department_res.general_dept.dept_student_level_no[<a class="code" href="Ostudent_8h.html#a32a3">UG_TRADITION</a>]++;
00528             }
00529             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(stuPtr-&gt;<a class="code" href="classStudent.html#m2">student_level</a> == <a class="code" href="Ostudent_8h.html#a32a4">UG_NONTRADITION</a>) {
00530                 <span class="keywordflow">if</span>(is_gen_dept == 0) {
00531                     nontrno++;
00532                     cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m47">dept_student_level_no</a>[<a class="code" href="Ostudent_8h.html#a32a4">UG_NONTRADITION</a>]++;
00533                 }
00534                 <span class="keywordflow">else</span>
00535                     department_res.general_dept.dept_student_level_no[<a class="code" href="Ostudent_8h.html#a32a4">UG_NONTRADITION</a>]++;
00536             }
00537             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(stuPtr-&gt;<a class="code" href="classStudent.html#m2">student_level</a> == <a class="code" href="Ostudent_8h.html#a32a5">MASTER</a>) {
00538                 <span class="keywordflow">if</span>(is_gen_dept == 0) {
00539                     masterno++;
00540                     cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m47">dept_student_level_no</a>[<a class="code" href="Ostudent_8h.html#a32a5">MASTER</a>]++;
00541                 }
00542                 <span class="keywordflow">else</span>
00543                     department_res.general_dept.dept_student_level_no[<a class="code" href="Ostudent_8h.html#a32a5">MASTER</a>]++;
00544             }
00545             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(stuPtr-&gt;<a class="code" href="classStudent.html#m2">student_level</a> == <a class="code" href="Ostudent_8h.html#a32a6">DOCTOR</a>) {
00546                 <span class="keywordflow">if</span>(is_gen_dept == 0) {
00547                     docno++;
00548                     cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m47">dept_student_level_no</a>[<a class="code" href="Ostudent_8h.html#a32a6">DOCTOR</a>]++;
00549                 }
00550                 <span class="keywordflow">else</span>
00551                     department_res.general_dept.dept_student_level_no[<a class="code" href="Ostudent_8h.html#a32a6">DOCTOR</a>]++;
00552             }
00553             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(stuPtr-&gt;<a class="code" href="classStudent.html#m2">student_level</a> == <a class="code" href="Ostudent_8h.html#a32a7">DISTANCE_LEARN</a>) {
00554                 <span class="keywordflow">if</span>(is_gen_dept == 0) {
00555                     dlno++;
00556                     cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m47">dept_student_level_no</a>[<a class="code" href="Ostudent_8h.html#a32a7">DISTANCE_LEARN</a>]++;
00557                 }
00558                 <span class="keywordflow">else</span>
00559                     department_res.general_dept.dept_student_level_no[<a class="code" href="Ostudent_8h.html#a32a7">DISTANCE_LEARN</a>]++;
00560             }
00561 
00562         }                                             <span class="comment">// end for j</span>
00563 
00564         <span class="comment">// fix in version 2</span>
00565         <span class="keywordflow">if</span>(is_gen_dept == 0) {
00566             <span class="keywordflow">for</span>(k=0; k&lt;<a class="code" href="Ostudent_8h.html#a0">MAX_STUDENT_LEVEL</a>; k++)
00567                 cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m47">dept_student_level_no</a>[<a class="code" href="Ostudent_8h.html#a0">MAX_STUDENT_LEVEL</a>] += cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m47">dept_student_level_no</a>[k];
00568         }
00569         <span class="keywordflow">else</span> {
00570             <span class="keywordflow">for</span>(k=0; k&lt;<a class="code" href="Ostudent_8h.html#a0">MAX_STUDENT_LEVEL</a>; k++)
00571                 department_res.general_dept.dept_student_level_no[<a class="code" href="Ostudent_8h.html#a0">MAX_STUDENT_LEVEL</a>] += department_res.general_dept.dept_student_level_no[k];
00572         }
00573 
00574     }
00575 
00576     ins_student_level_no[<a class="code" href="Ostudent_8h.html#a32a3">UG_TRADITION</a>] = underno;
00577     ins_student_level_no[<a class="code" href="Ostudent_8h.html#a32a4">UG_NONTRADITION</a>] = nontrno;
00578     ins_student_level_no[<a class="code" href="Ostudent_8h.html#a32a5">MASTER</a>] = masterno;
00579     ins_student_level_no[<a class="code" href="Ostudent_8h.html#a32a6">DOCTOR</a>] = docno;
00580     ins_student_level_no[<a class="code" href="Ostudent_8h.html#a32a7">DISTANCE_LEARN</a>] = dlno;
00581     ins_student_level_no[<a class="code" href="Ostudent_8h.html#a0">MAX_STUDENT_LEVEL</a>] = underno + nontrno + masterno +docno +dlno;
00582 
00583     <span class="keywordflow">for</span>(k=0; k&lt;<a class="code" href="Ostudent_8h.html#a0">MAX_STUDENT_LEVEL</a>+1; k++)
00584         player_school.ins_student_level_history[k][HISTORY_TRIMESTER_COUNT-1] = ins_student_level_no[k];
00585 
00586     <span class="comment">//## chea 300999 create a history for those graphs in student no. report</span>
00587     <span class="keywordflow">for</span> ( i=department_array.size(); i&gt;=0; i-- ) {
00588         <span class="keywordflow">if</span> ( department_array.is_deleted(i) )
00589             <span class="keywordflow">continue</span>;
00590         cur_dept_ptr = department_array[i];
00591         <span class="comment">//shift history</span>
00592         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> count1=0;count1&lt;<a class="code" href="Ostudent_8h.html#a34a12">MAX_STUDENT_LEVEL_N_TOTAL</a>;count1++)
00593             <a class="code" href="Gamedef_8h.html#a14">shift_history</a>(cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m48">dept_student_level_history</a>[count1], HISTORY_TRIMESTER_COUNT);
00594 
00595         <span class="comment">//-- department wide --//</span>
00596         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> count=0;count&lt;<a class="code" href="Ostudent_8h.html#a34a12">MAX_STUDENT_LEVEL_N_TOTAL</a>;count++) {
00597             cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m48">dept_student_level_history</a>[count][HISTORY_TRIMESTER_COUNT-1] = cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m47">dept_student_level_no</a>[count];
00598         }
00599     }
00600 
00601 }
00602 
00603 <span class="comment">//----------- End of function PlayerSchool::update_stu_sum -----------//</span>
00604 
00605 <span class="comment">//## chea 290999 for update stu_sum only</span>
00606 <span class="comment">//---------- Begin of function PlayerSchool::update_gender ----------//</span>
<a name="l00608"></a><a class="code" href="classPlayerSchool.html#a40">00608</a> <span class="comment">void PlayerSchool::update_gender() {</span>
00609     <span class="keywordtype">int</span> i,j,k,l,m;
00610 
00611     <span class="keywordtype">int</span> gender1 = 0;
00612     <span class="keywordtype">int</span> gender2 = 0;
00613     <span class="keywordtype">int</span> gender3 = 0;
00614     <span class="keywordtype">int</span> gender4 = 0;
00615 
00616     <span class="keywordtype">int</span> is_gen_dept = 0;
00617     <span class="keywordtype">int</span> not_h_course = 0;
00618     <span class="keywordtype">int</span> not_h_course1 = 0;
00619     <span class="keywordtype">int</span> not_h_course2 = 0;
00620     <span class="keywordtype">int</span> not_h_course3 = 0;
00621     <span class="keywordtype">int</span> coures_less_40 = 0 ;
00622     <span class="keywordtype">int</span> coures_less_41 = 0 ;
00623     <span class="keywordtype">int</span> coures_less_42 = 0 ;
00624     <span class="keywordtype">int</span> coures_less_43 = 0 ;
00625     <span class="keywordtype">int</span> coures_less_44 = 0 ;
00626     <span class="keywordtype">int</span> count = 0;
00627 
00628     <a class="code" href="classStudentArray.html">StudentArray</a>* stuArr;
00629     <a class="code" href="classStudent.html">Student</a> *stuPtr;
00630     <a class="code" href="classDepartment.html">Department</a>*  cur_dept_ptr;
00631 
00632     <span class="comment">//reset all variable</span>
00633     <span class="comment">// zero it out</span>
00634     memset(ins_gender_student_level_no, 0, <span class="keyword">sizeof</span>(ins_gender_student_level_no));
00635 
00636     <span class="keywordflow">for</span> ( l=department_array.size(); l&gt;=0; l-- ) {
00637         <span class="keywordflow">if</span> (l) {
00638             <span class="keywordflow">if</span> ( department_array.is_deleted(l) )
00639                 <span class="keywordflow">continue</span>;
00640             cur_dept_ptr = department_array[l];
00641 
00642             <span class="keywordflow">for</span>(m=0; m&lt;<a class="code" href="Gamedef_8h.html#a77a33">GENDER_ETHNIC_TYPE_COUNT_N_TOTAL</a>; m++) {
00643                 cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m49">dept_gender_student_level_no</a>[m] = 0;
00644                 <span class="keywordflow">if</span>(info.prerun_year == 1 &amp;&amp; info.game_month == 9 &amp;&amp; info.game_day == 1) {
00645                     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b=0; b&lt;HISTORY_TRIMESTER_COUNT; b++)
00646                         cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m50">dept_gender_student_level_history</a>[m][b] = 0;
00647                 }
00648             }
00649         }
00650         <span class="keywordflow">else</span> {
00651             <span class="keywordflow">for</span>(m=0; m&lt;<a class="code" href="Gamedef_8h.html#a77a33">GENDER_ETHNIC_TYPE_COUNT_N_TOTAL</a>; m++)
00652                 department_res.general_dept.dept_gender_student_level_no[m] = 0;
00653         }
00654     }
00655 
00656     <span class="comment">//dept_gender_student_level_no</span>
00657     <a class="code" href="ALL_8H.html#a0">err_when</a>( department_array.size() == 0 );
00658     <span class="keywordflow">for</span> ( i=department_array.size(); i&gt;=0; i-- ) {
00659         is_gen_dept =0;
00660         <span class="keywordflow">if</span> (i) {
00661             <span class="keywordflow">if</span> ( department_array.is_deleted(i) )
00662                 <span class="keywordflow">continue</span>;
00663             stuArr = &amp;(department_array[i]-&gt;student_array);
00664             cur_dept_ptr = department_array[i];
00665 
00666         }
00667         <span class="keywordflow">else</span> {
00668             stuArr = &amp;(department_res.general_dept.student_array);
00669             is_gen_dept =1;
00670         }
00671         <span class="comment">// loop student</span>
00672 
00673         <span class="keywordflow">for</span> (j=stuArr-&gt;<a class="code" href="classDynArray.html#a28">size</a>(); j&gt;0; j--) {
00674             <span class="keywordflow">if</span> ( stuArr-&gt;<a class="code" href="classStudentArray.html#a9">is_deleted</a>(j) )
00675                 <span class="keywordflow">continue</span>;
00676 
00677             sys.yield();
00678             stuPtr = stuArr-&gt;operator[](j);
00679 
00680 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00681 <span class="preprocessor"></span>            <span class="keywordflow">if</span> ( stuPtr-&gt;<a class="code" href="classStudent.html#m2">student_level</a> == <a class="code" href="Ostudent_8h.html#a32a7">DISTANCE_LEARN</a> )
00682                 <span class="keywordflow">continue</span>;
00683 <span class="preprocessor">#endif</span>
00684 <span class="preprocessor"></span>
00685             <span class="comment">// gender_level  { NONMINORITY_MALE, NONMINORITY_FEMALE, MINORITY_MALE, MINORITY_FEMALE };</span>
00686             <span class="keywordflow">if</span>(stuPtr-&gt;<a class="code" href="classStudent.html#m3">gender_ethnic_group</a> == <a class="code" href="Gamedef_8h.html#a75a27">NONMINORITY_MALE</a>) {
00687                 <span class="keywordflow">if</span>(is_gen_dept == 0) {
00688                     gender1++;
00689                     cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m49">dept_gender_student_level_no</a>[<a class="code" href="Gamedef_8h.html#a75a27">NONMINORITY_MALE</a>]++;
00690                 }
00691                 <span class="keywordflow">else</span>
00692                     department_res.general_dept.dept_gender_student_level_no[<a class="code" href="Gamedef_8h.html#a75a27">NONMINORITY_MALE</a>]++;
00693             }
00694             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(stuPtr-&gt;<a class="code" href="classStudent.html#m3">gender_ethnic_group</a> == <a class="code" href="Gamedef_8h.html#a75a28">NONMINORITY_FEMALE</a>) {
00695                 <span class="keywordflow">if</span>(is_gen_dept == 0) {
00696                     gender2++;
00697                     cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m49">dept_gender_student_level_no</a>[<a class="code" href="Gamedef_8h.html#a75a28">NONMINORITY_FEMALE</a>]++;
00698                 }
00699                 <span class="keywordflow">else</span>
00700                     department_res.general_dept.dept_gender_student_level_no[<a class="code" href="Gamedef_8h.html#a75a28">NONMINORITY_FEMALE</a>]++;
00701             }
00702             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(stuPtr-&gt;<a class="code" href="classStudent.html#m3">gender_ethnic_group</a> == <a class="code" href="Gamedef_8h.html#a75a29">MINORITY_MALE</a>) {
00703                 <span class="keywordflow">if</span>(is_gen_dept == 0) {
00704                     gender3++;
00705                     cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m49">dept_gender_student_level_no</a>[<a class="code" href="Gamedef_8h.html#a75a29">MINORITY_MALE</a>]++;
00706                 }
00707                 <span class="keywordflow">else</span>
00708                     department_res.general_dept.dept_gender_student_level_no[<a class="code" href="Gamedef_8h.html#a75a29">MINORITY_MALE</a>]++;
00709             }
00710             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(stuPtr-&gt;<a class="code" href="classStudent.html#m3">gender_ethnic_group</a> == <a class="code" href="Gamedef_8h.html#a75a30">MINORITY_FEMALE</a>) {
00711                 <span class="keywordflow">if</span>(is_gen_dept == 0) {
00712                     gender4++;
00713                     cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m49">dept_gender_student_level_no</a>[<a class="code" href="Gamedef_8h.html#a75a30">MINORITY_FEMALE</a>]++;
00714                 }
00715                 <span class="keywordflow">else</span>
00716                     department_res.general_dept.dept_gender_student_level_no[<a class="code" href="Gamedef_8h.html#a75a30">MINORITY_FEMALE</a>]++;
00717             }
00718 
00719         }                                             <span class="comment">// end for j</span>
00720 
00721         <span class="keywordflow">for</span>(k=0; k&lt;<a class="code" href="Gamedef_8h.html#a77a33">GENDER_ETHNIC_TYPE_COUNT_N_TOTAL</a>-1; k++)
00722             cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m49">dept_gender_student_level_no</a>[<a class="code" href="Gamedef_8h.html#a77a33">GENDER_ETHNIC_TYPE_COUNT_N_TOTAL</a>-1] += cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m49">dept_gender_student_level_no</a>[k];
00723     }
00724 
00725     <span class="comment">//I add the general department student as well</span>
00726     ins_gender_student_level_no[<a class="code" href="Gamedef_8h.html#a75a27">NONMINORITY_MALE</a>] = gender1 + department_res.general_dept.dept_gender_student_level_no[<a class="code" href="Gamedef_8h.html#a75a27">NONMINORITY_MALE</a>];
00727     ins_gender_student_level_no[<a class="code" href="Gamedef_8h.html#a75a28">NONMINORITY_FEMALE</a>] = gender2+ department_res.general_dept.dept_gender_student_level_no[<a class="code" href="Gamedef_8h.html#a75a28">NONMINORITY_FEMALE</a>];
00728     ins_gender_student_level_no[<a class="code" href="Gamedef_8h.html#a75a29">MINORITY_MALE</a>] = gender3+ department_res.general_dept.dept_gender_student_level_no[<a class="code" href="Gamedef_8h.html#a75a29">MINORITY_MALE</a>];
00729     ins_gender_student_level_no[<a class="code" href="Gamedef_8h.html#a75a30">MINORITY_FEMALE</a>] = gender4+ department_res.general_dept.dept_gender_student_level_no[<a class="code" href="Gamedef_8h.html#a75a30">MINORITY_FEMALE</a>];
00730     ins_gender_student_level_no[<a class="code" href="Gamedef_8h.html#a74a26">GENDER_ETHNIC_TYPE_COUNT</a>] = gender1+gender2+gender3+gender4;
00731 
00732     <span class="keywordflow">for</span>(k=0; k&lt;<a class="code" href="Gamedef_8h.html#a77a33">GENDER_ETHNIC_TYPE_COUNT_N_TOTAL</a>; k++)
00733         player_school.ins_gender_student_level_history[k][HISTORY_TRIMESTER_COUNT-1] = ins_gender_student_level_no[k];
00734 
00735     <span class="comment">//## chea 300999 create a history for those graphs in student no. report</span>
00736     <span class="keywordflow">for</span> ( i=department_array.size(); i&gt;=0; i-- ) {
00737         <span class="keywordflow">if</span> ( department_array.is_deleted(i) )
00738             <span class="keywordflow">continue</span>;
00739         cur_dept_ptr = department_array[i];
00740         <span class="comment">//shift history</span>
00741         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> count1=0;count1&lt;<a class="code" href="Gamedef_8h.html#a77a33">GENDER_ETHNIC_TYPE_COUNT_N_TOTAL</a>;count1++)
00742             <a class="code" href="Gamedef_8h.html#a14">shift_history</a>(cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m50">dept_gender_student_level_history</a>[count1], HISTORY_TRIMESTER_COUNT);
00743 
00744         <span class="comment">//-- department wide --//</span>
00745         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> count=0;count&lt;<a class="code" href="Gamedef_8h.html#a77a33">GENDER_ETHNIC_TYPE_COUNT_N_TOTAL</a>;count++) {
00746             cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m50">dept_gender_student_level_history</a>[count][HISTORY_TRIMESTER_COUNT-1] = cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m49">dept_gender_student_level_no</a>[count];
00747         }
00748     }
00749 
00750 }
00751 
00752 <span class="comment">//----------- End of function PlayerSchool::update_gender -----------//</span>
00753 
00754 <span class="comment">//----------- Begin of function PlayerSchool::latency_func -----------//</span>
<a name="l00758"></a><a class="code" href="classPlayerSchool.html#a42">00758</a> <span class="comment">float PlayerSchool::latency_func(float latencyPara, float curValue, float inputValue) {</span>
00759 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00760 <span class="preprocessor"></span>    <span class="keywordflow">if</span>(behavioral_response_speed==<a class="code" href="Gamedef_8h.html#a73a23">INPUT_MEDIUM</a>)     <span class="comment">// faster</span>
00761         <span class="comment">// may be similar to gamma function</span>
00762         <span class="keywordflow">return</span> math.latency_func(latencyPara*0.5f, curValue, inputValue);
00763     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(behavioral_response_speed==<a class="code" href="Gamedef_8h.html#a73a24">INPUT_HIGH</a>)  <span class="comment">// light-speed</span>
00764         <span class="comment">// or 1.0f or just return inputValue?</span>
00765         <span class="keywordflow">return</span> math.latency_func(0.0f, curValue, inputValue);
00766     <span class="keywordflow">else</span>
00767         <span class="comment">// INPUT_LOW</span>
00768         <span class="keywordflow">return</span> math.latency_func(latencyPara, curValue, inputValue);
00769 <span class="preprocessor">#else</span>
00770 <span class="preprocessor"></span>    <span class="keywordflow">return</span> math.latency_func(latencyPara, curValue, inputValue);
00771 <span class="preprocessor">#endif</span>
00772 <span class="preprocessor"></span>}
00773 
00774 <span class="comment">//----------- End of function PlayerSchool::latency_func -----------//</span>
00775 
00776 <span class="comment">//----------- Begin of function PlayerSchool::is_hidden_mascot -----------//</span>
00780 <span class="comment">int PlayerSchool::is_hidden_mascot(int mascotId) {</span>
00781 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00782 <span class="preprocessor"></span>    <span class="keywordflow">if</span>( mascot==5 )                                 <span class="comment">// hide indian mascot in version 2</span>
00783         <span class="keywordflow">return</span> 1;
00784 <span class="preprocessor">#endif</span>
00785 <span class="preprocessor"></span>    <span class="keywordflow">return</span> 0;
00786 }
00787 
00788 <span class="comment">//----------- End of function PlayerSchool::is_hidden_mascot -----------//</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:38:16 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
