<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ofin_rep.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>ofin_rep.cpp</h1><a href="ofin__rep_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : OFINDISP.cpp</span>
00002 <span class="comment">//Description : Finance Class display method definition</span>
00003 <span class="comment">//Owner       : Ho</span>
00004 
00005 <span class="preprocessor">#include &lt;OBUTTON.H&gt;</span>                              <span class="comment">// for this's disp_main</span>
00006 <span class="preprocessor">#include &lt;OFONT.H&gt;</span>
00007 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>                                 <span class="comment">// sys.redraw_all_flag</span>
00008 <span class="preprocessor">#include &lt;OWORLDMT.H&gt;</span>                             <span class="comment">// ZOOM_??</span>
00009 <span class="preprocessor">#include &lt;<a class="code" href="KEY_8H.html">KEY.H</a>&gt;</span>                                  <span class="comment">// KEY_*</span>
00010 <span class="preprocessor">#include &lt;OGAMESTR.H&gt;</span>                             <span class="comment">// report_str()</span>
00011 <span class="preprocessor">#include &lt;OFINANCE.H&gt;</span>
00012 <span class="preprocessor">#include &lt;<a class="code" href="OVGA_8H.html">OVGA.H</a>&gt;</span>                                 <span class="comment">// for this's disp_main</span>
00013 <span class="preprocessor">#include &lt;OIFACE.H&gt;</span>
00014 <span class="preprocessor">#include &lt;OINFO.H&gt;</span>
00015 <span class="preprocessor">#include &lt;<a class="code" href="OSTR_8H.html">OSTR.H</a>&gt;</span>
00016 <span class="preprocessor">#include &lt;<a class="code" href="OVBROW98_8H.html">OVBROW98.H</a>&gt;</span>
00017 <span class="preprocessor">#include &lt;OOPT.H&gt;</span>
00018 
00019 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00020 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="OVGALOCK_8H.html">OVGALOCK.H</a>&gt;</span>
00021 <span class="preprocessor">#include &lt;OMATH.H&gt;</span>
00022 <span class="preprocessor">#endif</span>
00023 <span class="preprocessor"></span>
00024 <span class="comment">//----- define constants for report -----//</span>
00025 
<a name="l00026"></a><a class="code" href="ofin__rep_8cpp.html#a0">00026</a> <span class="preprocessor">#define FIN_REP_SHEET_COLOR   Vga::active_buf-&gt;color_down</span>
00027 <span class="preprocessor"></span>
00028 <span class="keyword">enum</span> {
00029     <a class="code" href="ofin__rep_8cpp.html#a32a9">REPORT_X1</a> = <a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>+2,
00030     <a class="code" href="ofin__rep_8cpp.html#a32a10">REPORT_Y1</a> = <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>+15,
00031     <a class="code" href="ofin__rep_8cpp.html#a32a11">REPORT_X2</a> = <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-2,
00032     <a class="code" href="ofin__rep_8cpp.html#a32a12">REPORT_Y2</a> = <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-50,
00033 };
00034 
00035 <span class="keyword">enum</span> { <a class="code" href="ofin__rep_8cpp.html#a33a13">BG_PIC_ID</a>  = 12};
00036 <span class="keyword">enum</span> { <a class="code" href="ofin__rep_8cpp.html#a34a14">BUTTON_Y1</a> = <a class="code" href="ofin__rep_8cpp.html#a32a12">REPORT_Y2</a>+10 };
00037 <span class="keyword">enum</span> { <a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a> = 105, <a class="code" href="ofin__rep_8cpp.html#a35a16">BUTTON_HEIGHT</a> = 21 };
00038 <span class="keyword">enum</span> { <a class="code" href="ofin__rep_8cpp.html#a36a17">FINANCIAL_REC_HEIGHT</a> = 18 };
00039 <span class="keyword">enum</span> { <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a> = 220, <a class="code" href="ofin__rep_8cpp.html#a37a19">BS_TAB2</a> = 550,<a class="code" href="ofin__rep_8cpp.html#a37a20">BS_TAB3</a> = 600 };
00040 
00041 <span class="comment">//----- define variables for report -----//</span>
00042 
00043 <span class="keyword">static</span> <a class="code" href="classButtonGroup.html">ButtonGroup</a>  button_type(REPORT_TYPE_COUNT);
00044 <span class="keyword">static</span> <a class="code" href="classButtonGroup.html">ButtonGroup</a>  button_year(<a class="code" href="Ofinance_8h.html#a90a2">REPORT_YEAR_COUNT</a>);
00045 <span class="keyword">static</span> <a class="code" href="classButtonGroup.html">ButtonGroup</a>  button_opt(<a class="code" href="Ofinance_8h.html#a91a3">REPORT_OPT_COUNT</a>);
00046 <span class="keyword">static</span> <a class="code" href="classButton.html">Button</a>     button_expand;
00047 <span class="keyword">static</span> <a class="code" href="classButton.html">Button</a>     button_prev, button_next;
00048 <span class="keyword">static</span> <a class="code" href="classVBrowse98.html">VBrowse98</a>    browse_financial;
00049 <span class="keyword">static</span> <span class="keywordtype">int</span>        report_year = 1;                <span class="comment">//temp</span>
00050 <span class="keyword">static</span> <span class="keywordtype">void</span>       disp_fin_rep_row(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>);
00051 <span class="keyword">static</span> <span class="keywordtype">void</span>       fin_rep_case1(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>);
00052 <span class="keyword">static</span> <span class="keywordtype">void</span>       fin_rep_case2(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>);
00053 <span class="keyword">static</span> <span class="keywordtype">void</span>       fin_rep_case3(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>);
00054 <span class="keyword">static</span> <span class="keywordtype">void</span>       fin_rep_case4(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>);
00055 <span class="keyword">static</span> <span class="keywordtype">void</span>       fin_rep_case8(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>);
00056 <span class="keyword">static</span> <span class="keywordtype">void</span>       fin_rep_case9(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>);
00057 
00058 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00059 <span class="preprocessor"></span>
00060 <span class="comment">// constant, macro, and function to exporting text file for import to spreadsheet</span>
00061 <span class="keyword">const</span> <a class="code" href="ogfile5_8cpp.html#a5">RECORD_SEPARATOR_LEN</a> = 2;
00062 <span class="keyword">static</span> <span class="keywordtype">char</span> *RECORD_SEPARATOR = <span class="stringliteral">"\r\n"</span>;
00063 <span class="keyword">const</span> <a class="code" href="ogfile5_8cpp.html#a7">FIELD_SEPARATOR_LEN</a> = 1;
00064 <span class="keyword">static</span> <span class="keywordtype">char</span> *FIELD_SEPARATOR = <span class="stringliteral">"\t"</span>;
00065 
00066 <span class="keyword">static</span> <span class="keywordtype">char</span> *export_num(<span class="keywordtype">int</span> value) {
00067     <span class="keyword">static</span> <span class="keywordtype">char</span> num_str[20];
00068     <span class="keywordflow">return</span> itoa( value, num_str, 10 );              <span class="comment">// 10 is radix</span>
00069 }
00070 
00071 <span class="keyword">static</span> <span class="keywordtype">char</span> *export_num(<span class="keywordtype">double</span> value) {
00072     <span class="keyword">static</span> <span class="keywordtype">char</span> num_str[20];
00073     <span class="keywordflow">return</span> gcvt( value, 7, num_str );               <span class="comment">// a few more more than 7, for negative sign, decimal point and exponent</span>
00074 }
00075 
00076 <span class="preprocessor">#define WRITE_FIELD_SEPARATOR(f)      f-&gt;file_write(FIELD_SEPARATOR, FIELD_SEPARATOR_LEN)</span>
00077 <span class="preprocessor"></span><span class="preprocessor">#define WRITE_STR_FIELD(f,s)          { f-&gt;file_write(s, strlen(s)); }</span>
00078 <span class="preprocessor"></span><span class="preprocessor">#define WRITE_NUM_FIELD(f,n)          { char *s=export_num(n); f-&gt;file_write(s, strlen(s)); }</span>
00079 <span class="preprocessor"></span><span class="preprocessor">#define WRITE_RECORD_SEPARATOR(f)     f-&gt;file_write(RECORD_SEPARATOR, RECORD_SEPARATOR_LEN)</span>
00080 <span class="preprocessor"></span>
00081 <span class="comment">// function to export finance report to text file</span>
00082 <span class="keyword">static</span> <span class="keywordtype">void</span> export_fin_rep_case1(<a class="code" href="classFile.html">File</a> *);
00083 <span class="keyword">static</span> <span class="keywordtype">void</span> export_fin_rep_case2(<a class="code" href="classFile.html">File</a> *);
00084 <span class="keyword">static</span> <span class="keywordtype">void</span> export_fin_rep_case3(<a class="code" href="classFile.html">File</a> *);
00085 <span class="keyword">static</span> <span class="keywordtype">void</span> export_fin_rep_case4(<a class="code" href="classFile.html">File</a> *);
00086 <span class="keyword">static</span> <span class="keywordtype">void</span> export_fin_rep_case5(<a class="code" href="classFile.html">File</a> *);
00087 <span class="keyword">static</span> <span class="keywordtype">void</span> export_fin_rep_case6(<a class="code" href="classFile.html">File</a> *);
00088 <span class="keyword">static</span> <span class="keywordtype">void</span> export_fin_rep_case7(<a class="code" href="classFile.html">File</a> *);
00089 <span class="keyword">static</span> <span class="keywordtype">void</span> export_fin_rep_case8(<a class="code" href="classFile.html">File</a> *);
00090 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="ofin__rep_8cpp.html#a31">export_fin_rep_case9</a>(<a class="code" href="classFile.html">File</a> *);
00091 
00092 <span class="keyword">static</span> <a class="code" href="classButton.html">Button</a> button_export;                      <span class="comment">// button to export to (spread sheet) text file</span>
00093 <span class="preprocessor">#endif</span>
00094 <span class="preprocessor"></span>
00095 <span class="comment">//----- Begin of function Finance::report ------//</span>
<a name="l00104"></a><a class="code" href="classFinance.html#a18">00104</a> <span class="comment">void Finance::disp_report_main(int refreshFlag, int dispButton, char* reportTitle) {</span>
00105     <span class="keywordtype">int</span> x=<a class="code" href="ofin__rep_8cpp.html#a32a9">REPORT_X1</a>, y=<a class="code" href="ofin__rep_8cpp.html#a32a10">REPORT_Y1</a>;
00106     vga.use_back();
00107     sys.is_institution_report=1;
00108     <span class="keywordflow">if</span> (refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>) {
00109         <span class="comment">// ###### begin Gilbert 25/04/2001 ######//</span>
00110         report_deinit();
00111         <span class="comment">// ###### end Gilbert 25/04/2001 ######//</span>
00112 
00113         <span class="comment">//------------- paint the background ----------------//</span>
00114 
00115         user_interface.bg_img(<a class="code" href="ofin__rep_8cpp.html#a33a13">BG_PIC_ID</a>, &amp;vga_back);
00116 
00117         <span class="keywordflow">if</span>( dispButton )
00118             report_paint_button(refreshFlag);
00119 
00120         <span class="keywordtype">int</span> reportY1=<a class="code" href="ofin__rep_8cpp.html#a32a10">REPORT_Y1</a>, reportY2=<a class="code" href="ofin__rep_8cpp.html#a32a12">REPORT_Y2</a>;
00121 
00122         <span class="keywordflow">if</span>( reportTitle ) {
00123             reportY1 += 15;
00124             font_charts.center_put( <a class="code" href="ofin__rep_8cpp.html#a32a9">REPORT_X1</a>, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="ofin__rep_8cpp.html#a32a11">REPORT_X2</a>, reportY1-1, reportTitle );
00125         }
00126 
00127         <span class="keywordflow">if</span>( !dispButton )
00128             reportY2 += <a class="code" href="ofin__rep_8cpp.html#a35a16">BUTTON_HEIGHT</a>-8;
00129 
00130         <span class="comment">// OPTIMIZATION</span>
00131         <span class="keywordflow">if</span>(report_type==<a class="code" href="Ofinance_8h.html#a92a6">REPORT_TYPE_OPTIMIZATION</a>) {
00132             <span class="keywordflow">if</span>(finance.report_opt==<a class="code" href="Ofinance_8h.html#a93a9">REPORT_OPT_REVENUE</a>)
00133                 optimization.report_stage_1(refreshFlag);
00134             <span class="keywordflow">if</span>(finance.report_opt==<a class="code" href="Ofinance_8h.html#a93a10">REPORT_OPT_FUNCTION</a>)
00135                 optimization.report_stage_2(refreshFlag);
00136             <span class="keywordflow">if</span>(finance.report_opt==<a class="code" href="Ofinance_8h.html#a93a11">REPORT_OPT_FACULTY</a>)
00137                 optimization.report_stage_3(refreshFlag);
00138             <span class="comment">//                          opt_stage3.report(refreshFlag);</span>
00139         }
00140         <span class="keywordflow">else</span> {
00141             <span class="comment">//                  user_interface.bar( REPORT_X1, reportY1, REPORT_X2, reportY2,FIN_REP_SHEET_COLOR);</span>
00142 
00143             user_interface.brighten( <a class="code" href="ofin__rep_8cpp.html#a32a9">REPORT_X1</a>, reportY1, <a class="code" href="ofin__rep_8cpp.html#a32a11">REPORT_X2</a>, reportY2);
00144             user_interface.rect( <a class="code" href="ofin__rep_8cpp.html#a32a9">REPORT_X1</a>, reportY1, <a class="code" href="ofin__rep_8cpp.html#a32a11">REPORT_X2</a>, reportY2);
00145 
00146             <span class="comment">//-------- set the number of rows for th browser --------//</span>
00147 
00148             <span class="keywordtype">int</span> browseRecCount;
00149             <span class="keywordflow">if</span>(report_type==<a class="code" href="Ofinance_8h.html#a92a4">REPORT_TYPE_REVENUE</a>||report_type==<a class="code" href="Ofinance_8h.html#a92a8">REPORT_TYPE_BUDGET_VS_ACTUAL</a>) {
00150                 <span class="keywordflow">if</span>(report_year!=<a class="code" href="Ofinance_8h.html#a94a12">REPORT_YEAR_THREE_YEARS</a>) {
00151                     browseRecCount=<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+9;
00152                 }
00153                 <span class="keywordflow">else</span> {
00154                     <span class="keywordflow">if</span>( report_is_expanded )
00155                         browseRecCount=<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+4*<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+25;
00156                     <span class="keywordflow">else</span>
00157                         browseRecCount=<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+9;
00158                 }
00159             }
00160 
00161             <span class="keywordflow">if</span>(report_type==<a class="code" href="Ofinance_8h.html#a92a7">REPORT_TYPE_DETAIL_REN</a>)
00162                 browseRecCount=<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+4*<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+25;
00163 
00164             <span class="keywordflow">if</span>(report_type==<a class="code" href="Ofinance_8h.html#a92a5">REPORT_TYPE_BALANCE</a>) {
00165                 <span class="keywordflow">if</span>(report_year==<a class="code" href="Ofinance_8h.html#a94a12">REPORT_YEAR_THREE_YEARS</a>)
00166                     browseRecCount=<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>+8;
00167                 <span class="keywordflow">else</span>
00168                     browseRecCount=<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>+7;
00169             }
00170 
00171             <span class="comment">//-------------------------------------------//</span>
00172 
00173             browse_financial.<a class="code" href="classVBrowse98.html#a2">init</a>( <a class="code" href="ofin__rep_8cpp.html#a32a9">REPORT_X1</a>, reportY1, <a class="code" href="ofin__rep_8cpp.html#a32a11">REPORT_X2</a>, reportY2,
00174                                    0, <a class="code" href="ofin__rep_8cpp.html#a36a17">FINANCIAL_REC_HEIGHT</a>, browseRecCount,
00175                                    disp_fin_rep_row, <a class="code" href="OHELP_8H.html#a0">NULL</a> ,0);
00176 
00177             browse_financial.<a class="code" href="classVBrowse98.html#a4">open</a>(report_financial_recno);
00178         }
00179 
00180     }
00181     <span class="keywordflow">else</span> {                                          <span class="comment">// refreshFlag == INFO_REFRESH</span>
00182         <span class="keywordflow">if</span>(report_type==<a class="code" href="Ofinance_8h.html#a92a6">REPORT_TYPE_OPTIMIZATION</a>) {
00183             <span class="keywordflow">if</span>(finance.report_opt==<a class="code" href="Ofinance_8h.html#a93a9">REPORT_OPT_REVENUE</a>)
00184                 optimization.report_stage_1(refreshFlag);
00185             <span class="keywordflow">if</span>(finance.report_opt==<a class="code" href="Ofinance_8h.html#a93a10">REPORT_OPT_FUNCTION</a>)
00186                 optimization.report_stage_2(refreshFlag);
00187             <span class="keywordflow">if</span>(finance.report_opt==<a class="code" href="Ofinance_8h.html#a93a11">REPORT_OPT_FACULTY</a>)
00188                 optimization.report_stage_3(refreshFlag);
00189         }
00190         <span class="keywordflow">else</span> {
00191             <span class="comment">// update only</span>
00192             browse_financial.<a class="code" href="classVBrowse98.html#a11">update</a>();
00193 
00194             <span class="keywordflow">if</span>( dispButton )
00195                 report_paint_button(refreshFlag);
00196         }
00197     }
00198 
00199     <span class="comment">//---------------------------------------------//</span>
00200     <span class="keywordflow">if</span>(report_type==<a class="code" href="Ofinance_8h.html#a92a6">REPORT_TYPE_OPTIMIZATION</a>) {
00201     }
00202     <span class="keywordflow">else</span> {
00203         report_financial_recno=browse_financial.<a class="code" href="classVBrowse98.html#a6">recno</a>();
00204     }
00205     vga.blt_buf( <a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>, <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a> );
00206 }
00207 
00208 <span class="comment">//----- End of function Finance::report ------//</span>
00209 
<a name="l00210"></a><a class="code" href="classFinance.html#a20">00210</a> <span class="keywordtype">void</span> <a class="code" href="classFinance.html#a20">Finance::report_deinit</a>() {
00211     <span class="comment">/*          // OPTIMIZATION</span>
00212 <span class="comment">                if(finance.report_type==REPORT_TYPE_OPTIMIZATION)</span>
00213 <span class="comment">                {</span>
00214 <span class="comment">                if(finance.report_opt==REPORT_OPT_REVENUE)</span>
00215 <span class="comment">                optimization.deinit_stage_1(refreshFlag);</span>
00216 <span class="comment">                if(finance.report_opt==REPORT_OPT_FUNCTION)</span>
00217 <span class="comment">                optimization.deinit_stage_2(refreshFlag);</span>
00218 <span class="comment">                if(finance.report_opt==REPORT_OPT_FACULTY)</span>
00219 <span class="comment">                optimization.deinit_stage_3(refreshFlag);</span>
00220 <span class="comment">                }</span>
00221 <span class="comment">    */</span>
00222     <span class="comment">// ### begin Gilbert 25/04/2001 ######//</span>
00223     optimization.deinit();                          <span class="comment">// no need to check current stage, finance report didn't free memory properly</span>
00224 
00225     button_type.<a class="code" href="classButtonGroup.html#a2">deinit_buttons</a>();
00226     button_year.<a class="code" href="classButtonGroup.html#a2">deinit_buttons</a>();
00227     button_opt.<a class="code" href="classButtonGroup.html#a2">deinit_buttons</a>();
00228     button_expand.<a class="code" href="classButton.html#a2">deinit</a>();
00229     button_prev.<a class="code" href="classButton.html#a2">deinit</a>();
00230     button_next.<a class="code" href="classButton.html#a2">deinit</a>();
00231     browse_financial.<a class="code" href="classVBrowse98.html#a3">deinit</a>();
00232     <span class="comment">// ### end Gilbert 25/04/2001 ######//</span>
00233 
00234 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00235 <span class="preprocessor"></span>    button_export.<a class="code" href="classButton.html#a2">deinit</a>();
00236 <span class="preprocessor">#endif</span>
00237 <span class="preprocessor"></span>}
00238 
00239 <span class="comment">//------- Begin of function Finance::report_detect -------//</span>
<a name="l00244"></a><a class="code" href="classFinance.html#a19">00244</a> <span class="comment">void Finance::report_detect(int detectButton) {</span>
00245     <span class="keywordflow">if</span>( detectButton ) {
00246         <span class="comment">//------- detect type buttons --------//</span>
00247         <span class="keywordflow">if</span>( button_type.<a class="code" href="classButtonGroup.html#a4">detect</a>() &gt;= 0 ) {
00248             report_type = button_type.<a class="code" href="classButtonGroup.html#m1">button_pressed</a>;
00249             sys.redraw_all_flag = 1;
00250             report_financial_recno=1;
00251             report_is_expanded = 0;
00252         }
00253 
00254         <span class="keywordflow">if</span>(report_type==<a class="code" href="Ofinance_8h.html#a92a6">REPORT_TYPE_OPTIMIZATION</a>) {
00255             <span class="keywordflow">if</span>( button_opt.<a class="code" href="classButtonGroup.html#a4">detect</a>() &gt;= 0 ) {
00256                 report_opt = button_opt.<a class="code" href="classButtonGroup.html#m1">button_pressed</a>;
00257                 sys.redraw_all_flag = 1;
00258                 report_financial_recno=1;
00259                 report_is_expanded = 0;
00260             }
00261         }
00262         <span class="keywordflow">else</span> <span class="keywordflow">if</span>((report_type==<a class="code" href="Ofinance_8h.html#a92a4">REPORT_TYPE_REVENUE</a>)||(report_type==<a class="code" href="Ofinance_8h.html#a92a5">REPORT_TYPE_BALANCE</a>)) {
00263             <span class="keywordflow">if</span>( button_year.<a class="code" href="classButtonGroup.html#a4">detect</a>() &gt;= 0 ) {
00264                 report_year = button_year.<a class="code" href="classButtonGroup.html#m1">button_pressed</a>;
00265                 sys.redraw_all_flag = 1;
00266                 report_financial_recno=1;
00267                 report_is_expanded = 0;
00268             }
00269 
00270         }
00271 
00272 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00273 <span class="preprocessor"></span>        <span class="comment">// detect export button</span>
00274 
00275         <span class="keywordflow">if</span>((report_type==<a class="code" href="Ofinance_8h.html#a92a4">REPORT_TYPE_REVENUE</a>)||(report_type==<a class="code" href="Ofinance_8h.html#a92a5">REPORT_TYPE_BALANCE</a>)||(report_type==<a class="code" href="Ofinance_8h.html#a92a7">REPORT_TYPE_DETAIL_REN</a>)) {
00276             <span class="keywordflow">if</span>( button_export.<a class="code" href="classButton.html#a21">detect</a>() ) {
00277                 <span class="comment">// ask file name now</span>
00278 
00279                 <a class="code" href="classMouseDispCount.html">MouseDispCount</a> mouseDispCount;            <span class="comment">// redisplay windows cursor</span>
00280 
00281                 <span class="keywordtype">char</span> tempFilename[MAX_PATH];
00282 
00283                 tempFilename[0] = <span class="charliteral">'\0'</span>;                   <span class="comment">// strcpy(tempFilename, "finance.txt");</span>
00284 
00285                 <span class="comment">// ask filename now</span>
00286                 OPENFILENAME openFileName;
00287                 memset( &amp;openFileName, 0, <span class="keyword">sizeof</span>(openFileName) );
00288                 openFileName.lStructSize = <span class="keyword">sizeof</span>(openFileName);
00289                 openFileName.hwndOwner = sys.main_hwnd;
00290                 openFileName.hInstance = sys.app_hinstance;
00291                 <span class="comment">// two '\0' at the end</span>
00292                 openFileName.lpstrFilter = <span class="stringliteral">"Text file(*.txt)\0*.txt\0All Files(*.*)\0*.*\0"</span>;
00293                 openFileName.lpstrCustomFilter = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00294                 openFileName.nMaxCustFilter = 0;
00295                 openFileName.nFilterIndex = 0;
00296                 openFileName.lpstrFile =  tempFilename;   <span class="comment">// first char is already NULL</span>
00297                 openFileName.nMaxFile = <span class="keyword">sizeof</span>(tempFilename);
00298                 openFileName.lpstrFileTitle = <a class="code" href="OHELP_8H.html#a0">NULL</a>;       <span class="comment">// result filename, without path</span>
00299                 openFileName.nMaxFileTitle = 0;
00300                 openFileName.lpstrInitialDir = <span class="stringliteral">"."</span>;       <span class="comment">// current directory</span>
00301                 openFileName.lpstrTitle = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00302                 openFileName.Flags = OFN_OVERWRITEPROMPT | OFN_LONGNAMES | OFN_PATHMUSTEXIST | OFN_HIDEREADONLY;
00303                 openFileName.nFileOffset = 0;
00304                 openFileName.nFileExtension = 0;
00305                 openFileName.lpstrDefExt = <span class="stringliteral">"txt"</span>;
00306                 openFileName.lCustData = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00307                 openFileName.lpfnHook = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00308                 openFileName.lpTemplateName = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00309 
00310                 <span class="keywordflow">if</span>( GetSaveFileName(&amp;openFileName) ) {
00311                     <a class="code" href="classFile.html">File</a> exportFile;
00312                     exportFile.<a class="code" href="classFile.html#a3">file_create</a>( tempFilename );
00313                     <span class="keywordflow">if</span>( report_type==<a class="code" href="Ofinance_8h.html#a92a4">REPORT_TYPE_REVENUE</a>) {
00314                         <span class="keywordflow">switch</span>(report_year) {
00315                         <span class="keywordflow">case</span> 1: export_fin_rep_case1( &amp;exportFile ); <span class="keywordflow">break</span>;
00316                         <span class="keywordflow">case</span> 2: export_fin_rep_case2( &amp;exportFile ); <span class="keywordflow">break</span>;
00317                         <span class="keywordflow">case</span> 3: export_fin_rep_case3( &amp;exportFile ); <span class="keywordflow">break</span>;
00318                         <span class="keywordflow">case</span> 0:                             <span class="comment">// fall through</span>
00319                         <span class="keywordflow">default</span>: export_fin_rep_case4( &amp;exportFile );
00320                         }
00321                     }
00322                     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(report_type==<a class="code" href="Ofinance_8h.html#a92a5">REPORT_TYPE_BALANCE</a>) {
00323                         <span class="comment">// no matter which report_year, always print export_fin_rep_case8</span>
00324                         export_fin_rep_case8( &amp;exportFile );
00325                     }
00326                     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(report_type==<a class="code" href="Ofinance_8h.html#a92a7">REPORT_TYPE_DETAIL_REN</a>) {
00327                         <a class="code" href="ofin__rep_8cpp.html#a31">export_fin_rep_case9</a>( &amp;exportFile );
00328                     }
00329 
00330                     exportFile.<a class="code" href="classFile.html#a5">file_close</a>();
00331                 }
00332             }
00333         }
00334 <span class="preprocessor">#endif</span>
00335 <span class="preprocessor"></span>
00336         <span class="keywordflow">if</span>( button_expand.<a class="code" href="classButton.html#a21">detect</a>() ) {
00337             report_type = <a class="code" href="Ofinance_8h.html#a92a7">REPORT_TYPE_DETAIL_REN</a>;
00338             sys.redraw_all_flag = 1;
00339             report_financial_recno=1;
00340             <span class="comment">//                  report_is_expanded = !report_is_expanded;</span>
00341             <span class="comment">//                  sys.redraw_all_flag = 1;</span>
00342             <span class="comment">//                  report_financial_recno=1;</span>
00343         }
00344     }
00345     <span class="keywordflow">if</span>(report_type==<a class="code" href="Ofinance_8h.html#a92a6">REPORT_TYPE_OPTIMIZATION</a>) {
00346         <span class="keywordflow">if</span>(finance.report_opt==<a class="code" href="Ofinance_8h.html#a93a9">REPORT_OPT_REVENUE</a>)
00347             optimization.detect_stage_1();
00348         <span class="keywordflow">if</span>(finance.report_opt==<a class="code" href="Ofinance_8h.html#a93a10">REPORT_OPT_FUNCTION</a>)
00349             optimization.detect_stage_2();
00350         <span class="keywordflow">if</span>(finance.report_opt==<a class="code" href="Ofinance_8h.html#a93a11">REPORT_OPT_FACULTY</a>)
00351             optimization.detect_stage_3();
00352     }
00353     <span class="keywordflow">else</span>
00354         browse_financial.<a class="code" href="classVBrowse98.html#a8">detect</a>();
00355 }
00356 
00357 <span class="comment">//------- End of function Finance::report_detect -------//</span>
00358 
00359 <span class="comment">//------- Begin of function Finance::report_paint_button ------//</span>
00360 
<a name="l00361"></a><a class="code" href="classFinance.html#a24">00361</a> <span class="keywordtype">void</span> <a class="code" href="classFinance.html#a24">Finance::report_paint_button</a>(<span class="keywordtype">int</span> refreshFlag) {
00362     <span class="keywordflow">if</span>( refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a> ) {
00363         <span class="comment">//-------- paint type buttons ------------//</span>
00364 
00365         <span class="keywordtype">int</span> x=<a class="code" href="ofin__rep_8cpp.html#a32a9">REPORT_X1</a>+10, y=<a class="code" href="ofin__rep_8cpp.html#a34a14">BUTTON_Y1</a>-6;
00366 
00367         button_type[0].create_text( x, y, x+(<span class="keywordtype">int</span>)(2.7*<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>-1), y+<a class="code" href="ofin__rep_8cpp.html#a35a16">BUTTON_HEIGHT</a>-1, <span class="stringliteral">"Budget vs Actual"</span> );
00368         x+=(int)(2.7*<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>+15);
00369 
00370         button_type[1].create_text( x, y, x+(<span class="keywordtype">int</span>)(1.2*<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>-1), y+<a class="code" href="ofin__rep_8cpp.html#a35a16">BUTTON_HEIGHT</a>-1, <span class="stringliteral">"Balance sheet"</span> );
00371         x+=(int)(1.2*<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>+15);
00372 
00373         button_type[2].create_text( x, y, x+(<span class="keywordtype">int</span>)(1.5*<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>-1), y+<a class="code" href="ofin__rep_8cpp.html#a35a16">BUTTON_HEIGHT</a>-1, <span class="stringliteral">"Budget plan"</span> );
00374         x+=(int)(1.5*<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>+15);
00375 
00376         button_type[3].create_text( x, y, x+(<span class="keywordtype">int</span>)(0.8*<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>-1), y+<a class="code" href="ofin__rep_8cpp.html#a35a16">BUTTON_HEIGHT</a>-1, <span class="stringliteral">"Detail"</span>, 0 );
00377         x=<a class="code" href="ofin__rep_8cpp.html#a32a9">REPORT_X1</a>+25, y=<a class="code" href="ofin__rep_8cpp.html#a34a14">BUTTON_Y1</a>+18;
00378 
00379         <span class="comment">//---------show year buttons--------------------//</span>
00380 
00381         <span class="keywordflow">if</span>(<a class="code" href="classFinance.html#m68">report_type</a>==<a class="code" href="Ofinance_8h.html#a92a6">REPORT_TYPE_OPTIMIZATION</a>) {
00382             button_opt[0].create_text( x, y, x+(<span class="keywordtype">int</span>)(2*<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>-1), y+<a class="code" href="ofin__rep_8cpp.html#a35a16">BUTTON_HEIGHT</a>-1, <span class="stringliteral">"Revenue and expenditure"</span> );
00383 
00384             x+=(int)(2*<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>+20);
00385             button_opt[1].create_text( x, y, x+(<span class="keywordtype">int</span>)(2*<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>-1), y+<a class="code" href="ofin__rep_8cpp.html#a35a16">BUTTON_HEIGHT</a>-1, <span class="stringliteral">"Allocations"</span>);
00386 
00387             x+=(int)(2*<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>+20);
00388             button_opt[2].create_text( x, y, x+(<span class="keywordtype">int</span>)(2*<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>-1), y+<a class="code" href="ofin__rep_8cpp.html#a35a16">BUTTON_HEIGHT</a>-1, <span class="stringliteral">"Faculty hiring"</span>);
00389         }
00390 
00391         <span class="keywordflow">if</span>((<a class="code" href="classFinance.html#m68">report_type</a>==<a class="code" href="Ofinance_8h.html#a92a4">REPORT_TYPE_REVENUE</a>)
00392            ||(<a class="code" href="classFinance.html#m68">report_type</a>==<a class="code" href="Ofinance_8h.html#a92a5">REPORT_TYPE_BALANCE</a>)) {
00393             <a class="code" href="classString.html">String</a> s1;
00394 
00395             <span class="keywordtype">int</span> tyear=(int)(info.game_year+(info.game_month-9.0)/12);
00396 
00397             s1=<span class="stringliteral">"Standard"</span>;
00398             button_year[0].create_text( x, y, x+<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>+40-1, y+<a class="code" href="ofin__rep_8cpp.html#a35a16">BUTTON_HEIGHT</a>-1, s1.<a class="code" href="classString.html#m0">str_buf</a> );
00399 
00400 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00401 <span class="preprocessor"></span>            x+=<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>+65;
00402 <span class="preprocessor">#else</span>
00403 <span class="preprocessor"></span>            x+=<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>+105;
00404 <span class="preprocessor">#endif</span>
00405 <span class="preprocessor"></span>            s1=<span class="stringliteral">"Year "</span>;
00406             s1+=(m.format(tyear-1,4));
00407             button_year[1].create_text( x, y, x+<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>-1, y+<a class="code" href="ofin__rep_8cpp.html#a35a16">BUTTON_HEIGHT</a>-1, s1.<a class="code" href="classString.html#m0">str_buf</a> );
00408 
00409 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00410 <span class="preprocessor"></span>            x+=<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>+10;
00411 <span class="preprocessor">#else</span>
00412 <span class="preprocessor"></span>            x+=<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>+70;
00413 <span class="preprocessor">#endif</span>
00414 <span class="preprocessor"></span>            s1=<span class="stringliteral">"Year "</span>;
00415             s1+=(m.format(tyear,4));
00416             button_year[2].create_text( x, y, x+<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>-1, y+<a class="code" href="ofin__rep_8cpp.html#a35a16">BUTTON_HEIGHT</a>-1, s1.<a class="code" href="classString.html#m0">str_buf</a> );
00417 
00418 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00419 <span class="preprocessor"></span>            x+=<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>+10;
00420 <span class="preprocessor">#else</span>
00421 <span class="preprocessor"></span>            x+=<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>+75;
00422 <span class="preprocessor">#endif</span>
00423 <span class="preprocessor"></span>            s1=<span class="stringliteral">"Year "</span>;
00424             s1+=(m.format(tyear+1,4));
00425             button_year[3].create_text( x, y, x+<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>-1, y+<a class="code" href="ofin__rep_8cpp.html#a35a16">BUTTON_HEIGHT</a>-1, s1.<a class="code" href="classString.html#m0">str_buf</a> );
00426 
00427 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00428 <span class="preprocessor"></span>            x=<a class="code" href="ofin__rep_8cpp.html#a32a11">REPORT_X2</a>-<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>-25;
00429             button_export.<a class="code" href="classButton.html#a10">create_text</a>( x, y, x+<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>-1, y+<a class="code" href="ofin__rep_8cpp.html#a35a16">BUTTON_HEIGHT</a>-1, <span class="stringliteral">"Export"</span> );
00430 <span class="preprocessor">#endif</span>
00431 <span class="preprocessor"></span>        }
00432 
00433 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00434 <span class="preprocessor"></span>        <span class="keywordflow">if</span>(<a class="code" href="classFinance.html#m68">report_type</a>==<a class="code" href="Ofinance_8h.html#a92a7">REPORT_TYPE_DETAIL_REN</a>) {
00435             x=<a class="code" href="ofin__rep_8cpp.html#a32a11">REPORT_X2</a>-<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>-25;
00436             button_export.<a class="code" href="classButton.html#a10">create_text</a>( x, y, x+<a class="code" href="ofin__rep_8cpp.html#a35a15">BUTTON_WIDTH</a>-1, y+<a class="code" href="ofin__rep_8cpp.html#a35a16">BUTTON_HEIGHT</a>-1, <span class="stringliteral">"Export"</span> );
00437         }
00438 <span class="preprocessor">#endif</span>
00439 <span class="preprocessor"></span>
00440         button_type.<a class="code" href="classButtonGroup.html#a3">paint</a>(<a class="code" href="classFinance.html#m68">report_type</a>);
00441 
00442         <span class="keywordflow">if</span>( <a class="code" href="classFinance.html#m68">report_type</a>==<a class="code" href="Ofinance_8h.html#a92a5">REPORT_TYPE_BALANCE</a>) {
00443             <span class="comment">//                  for(int k=0;k&lt;4;k++)</span>
00444             <span class="comment">//                          button_year[k].paint();</span>
00445             <span class="comment">//                  button_year[report_year].disable();</span>
00446             button_year.<a class="code" href="classButtonGroup.html#a3">paint</a>(<a class="code" href="classFinance.html#m69">report_year</a>);
00447 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00448 <span class="preprocessor"></span>            button_export.<a class="code" href="classButton.html#a20">paint</a>();
00449 <span class="preprocessor">#endif</span>
00450 <span class="preprocessor"></span>        }
00451         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classFinance.html#m68">report_type</a>==<a class="code" href="Ofinance_8h.html#a92a6">REPORT_TYPE_OPTIMIZATION</a>) {
00452             <span class="keywordflow">if</span>((report_opt&lt;0)||(report_opt&gt;3))
00453                 <a class="code" href="classFinance.html#m70">report_opt</a>=<a class="code" href="Ofinance_8h.html#a93a9">REPORT_OPT_REVENUE</a>;
00454             button_opt.<a class="code" href="classButtonGroup.html#a3">paint</a>(<a class="code" href="classFinance.html#m70">report_opt</a>);
00455         }
00456         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classFinance.html#m68">report_type</a>==<a class="code" href="Ofinance_8h.html#a92a4">REPORT_TYPE_REVENUE</a>) {
00457             button_year.<a class="code" href="classButtonGroup.html#a3">paint</a>(<a class="code" href="classFinance.html#m69">report_year</a>);
00458 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00459 <span class="preprocessor"></span>            button_export.<a class="code" href="classButton.html#a20">paint</a>();
00460 <span class="preprocessor">#endif</span>
00461 <span class="preprocessor"></span>        }
00462         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classFinance.html#m68">report_type</a>==<a class="code" href="Ofinance_8h.html#a92a7">REPORT_TYPE_DETAIL_REN</a>) {
00463 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00464 <span class="preprocessor"></span>            button_export.<a class="code" href="classButton.html#a20">paint</a>();
00465 <span class="preprocessor">#endif</span>
00466 <span class="preprocessor"></span>        }
00467     }
00468 }
00469 
00470 <span class="comment">//------- End of function Finance::report_paint_button ------//</span>
00471 
00472 <span class="comment">//------ Begin of static function fin_rep_case1 --------//</span>
00473 <span class="comment">// Case 1: RENVENUE     and PREVIOUS YEAR</span>
00474 <span class="comment">// recNo -- record no. (row no.) to be displayed</span>
00475 <span class="comment">// x,y  -- left top position of the display region</span>
00476 <span class="comment">//</span>
00477 <span class="keyword">static</span> <span class="keywordtype">void</span> fin_rep_case1(<span class="keywordtype">int</span> recNo,<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y) {
00478     <span class="keywordtype">int</span> i;
00479     <span class="comment">//  int     xColumn1=x+305, xColumn2=440, xColumn3=510, xColumn4=590, xColumn5=680;</span>
00480     <span class="keywordtype">int</span> xColumn1=370, xColumn2=470, xColumn3=570, xColumn4=670, xColumn5=740;
00481 
00482     <span class="comment">// Show title //</span>
00483     <span class="keywordflow">if</span>(recNo==1) {
00484         <span class="comment">// change in verion 2</span>
00485         <span class="comment">// int tyear=(int)(info.game_year+(info.game_month-9.0)/12);</span>
00486         <span class="keywordtype">int</span> tyear = info.financial_year();
00488         <span class="keywordflow">if</span>(sys.view_mode==<a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a>)tyear++;
00489 
00490         <a class="code" href="classString.html">String</a> str;
00491         str=<span class="stringliteral">"Previous Year : Year "</span>;
00492         str+=m.format(tyear-1,4);
00493 
00494         font_charts.put(xColumn1-70,y+2,str.<a class="code" href="classString.html#m0">str_buf</a>);
00495         <span class="keywordflow">return</span>;
00496     }
00497     recNo--;
00498 
00499     <span class="keywordflow">if</span>(recNo==1) {
00500         font_chart_red_sm.disp( x, y, <span class="stringliteral">"Revenue"</span>, x+200 );
00501         font_chart_red_sm.right_put( xColumn2, y+2, <span class="stringliteral">"Direct"</span>);
00502         font_chart_red_sm.right_put( xColumn3, y+2, <span class="stringliteral">"Indirect"</span>);
00503         font_chart_red_sm.right_put( xColumn4, y+2, <span class="stringliteral">"Total"</span>);
00504         font_chart_red_sm.right_put( xColumn5, y+2, <span class="stringliteral">"% sources"</span>);
00505     }
00506     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;1) &amp;&amp; (recNo&lt;=<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+1)) {
00507         i=recNo-2;
00508         <span class="keywordflow">if</span>(recNo==5) {
00509             <span class="comment">//font_chartsm.disp( x, y, game_str_res.financial_report_str(i),  xColumn2);</span>
00510             <span class="comment">//font_chartsm.disp( xColumn2, y+2, finance.revenue_array[i].direct, 2, xColumn3);</span>
00511             <span class="comment">//font_chartsm.disp( xColumn3, y+2, finance.revenue_array[i].indirect, 2, xColumn4);</span>
00512             <span class="comment">//font_chartsm.disp( xColumn4, y+2, finance.revenue_array[i].total, 2, xColumn5 );</span>
00513             <span class="comment">//font_chartsm.disp( xColumn5, y+2, finance.revenue_array[i].percent, 3, xColumn6 );</span>
00514 
00515             font_chartsm.disp( x, y, game_str_res.financial_report_str(i),  xColumn2);
00516             font_chartsm.right_put( xColumn2, y+2, m.format(finance.revenue_array[i].direct, 2));
00517             font_chartsm.right_put( xColumn3, y+2, m.format(finance.revenue_array[i].indirect, 2));
00518             font_chartsm.right_put( xColumn4, y+2, m.format(finance.revenue_array[i].total, 2));
00519             font_chartsm.right_put( xColumn5, y+2, m.format(finance.revenue_array[i].percent, 24));
00520         }
00521         <span class="keywordflow">if</span>((recNo==2)||(recNo==3)) {
00522             font_chartsm.disp( x, y, game_str_res.financial_report_str(i),  xColumn2);
00523             <span class="comment">//                          font_chartsm.disp( xColumn4, y+2, finance.revenue_array[i].total, 2, xColumn5 );</span>
00524             font_chartsm.right_put( xColumn4, y+2, m.format(finance.revenue_array[i].total, 2));
00525         }
00526         <span class="keywordflow">else</span> {
00527             <span class="keywordflow">if</span>( recNo==4 )                              <span class="comment">// use blue font for Net tuition income</span>
00528                 font_chart_blue_sm.disp( x, y, game_str_res.financial_report_str(i),  xColumn2);
00529             <span class="keywordflow">else</span>
00530                 font_chartsm.disp( x, y, game_str_res.financial_report_str(i),  xColumn2);
00531 
00532             font_chartsm.right_put( xColumn4, y+2, m.format(finance.revenue_array[i].total, 2));
00533             font_chartsm.right_put( xColumn5, y+2, m.format(finance.revenue_array[i].percent, 24));
00534         }
00535     }
00536     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+2) {
00537         font_chart_blue_sm.disp( x, y,<span class="stringliteral">"  Total sources of funds"</span>, xColumn1);
00538         font_chart_blue_sm.right_put( xColumn4, y+2, m.format(finance.total_revenue.total, 2));
00539         font_chart_blue_sm.right_put( xColumn5, y+2, m.format(finance.total_revenue.percent, 24));
00540     }
00541     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+3) {
00542         font_chart_red_sm.right_put( xColumn1, y+2, <span class="stringliteral">"AY faculty"</span>);
00543         font_chart_red_sm.right_put( xColumn2, y+2, <span class="stringliteral">"Staff"</span>);
00544         font_chart_red_sm.right_put( xColumn3, y+2, <span class="stringliteral">"Other"</span>);
00545     }
00546     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+4) {
00547         font_chart_red_sm.disp( x, y, <span class="stringliteral">"Expenditures"</span>, x+200 );
00548         font_chart_red_sm.right_put( xColumn1, y+2, <span class="stringliteral">"compensation"</span>);
00549         font_chart_red_sm.right_put( xColumn2, y+2, <span class="stringliteral">"compensation"</span>);
00550         font_chart_red_sm.right_put( xColumn3, y+2, <span class="stringliteral">"expenditures"</span>);
00551         font_chart_red_sm.right_put( xColumn4, y+2, <span class="stringliteral">"Total"</span>);
00552         font_chart_red_sm.right_put( xColumn5, y+2, <span class="stringliteral">"% uses"</span>);
00553     }
00554     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;=<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+5) &amp;&amp; (recNo&lt;<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+3)) {
00555         i=recNo-5-<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>;
00556         <span class="keywordflow">if</span>((recNo&gt;=<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+7) &amp;&amp; (recNo&lt;<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+3)) {
00557             font_chartsm.disp( x, y,game_str_res.financial_report_str(i+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>),xColumn2);
00558             font_chartsm.right_put( xColumn2, y+2, m.format(finance.expense_array[i].staff, 2));
00559             font_chartsm.right_put( xColumn3, y+2, m.format(finance.expense_array[i].other, 2));
00560             font_chartsm.right_put( xColumn4, y+2, m.format(finance.expense_array[i].total, 2));
00561             font_chartsm.right_put( xColumn5, y+2, m.format(finance.expense_array[i].percent, 24));
00562         }
00563         <span class="keywordflow">else</span> {
00564             font_chartsm.disp( x, y,game_str_res.financial_report_str(i+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>),xColumn1);
00565             font_chartsm.right_put( xColumn1, y+2, m.format(finance.expense_array[i].faculty, 2));
00566             font_chartsm.right_put( xColumn2, y+2, m.format(finance.expense_array[i].staff, 2));
00567             font_chartsm.right_put( xColumn3, y+2, m.format(finance.expense_array[i].other, 2));
00568             font_chartsm.right_put( xColumn4, y+2, m.format(finance.expense_array[i].total, 2));
00569             font_chartsm.right_put( xColumn5, y+2, m.format(finance.expense_array[i].percent, 24));
00570         }
00571     }
00572     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+3) {
00573         font_chart_blue_sm.disp( x, y,<span class="stringliteral">"  Total operating expenditures"</span>, xColumn1);
00574         font_chart_blue_sm.right_put( xColumn1, y+2, m.format(finance.total_operating_expense.faculty, 2));
00575         font_chart_blue_sm.right_put( xColumn2, y+2, m.format(finance.total_operating_expense.staff, 2));
00576         font_chart_blue_sm.right_put( xColumn3, y+2, m.format(finance.total_operating_expense.other, 2));
00577         font_chart_blue_sm.right_put( xColumn4, y+2, m.format(finance.total_operating_expense.total, 2));
00578         font_chart_blue_sm.right_put( xColumn5, y+2, m.format(finance.total_operating_expense.percent, 24));
00579     }
00580     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+3) &amp;&amp; (recNo&lt;=<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+5)) {
00581         i=recNo-6-<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>;
00582         font_chartsm.disp( x, y,game_str_res.financial_report_str(i+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>),xColumn1);
00583         font_chartsm.right_put( xColumn3, y+2, m.format(finance.expense_array[i].other, 2));
00584         font_chartsm.right_put( xColumn4, y+2, m.format(finance.expense_array[i].total, 2));
00585         font_chartsm.right_put( xColumn5, y+2, m.format(finance.expense_array[i].percent, 24));
00586     }
00587     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+6) {
00588         font_chart_blue_sm.disp( x, y,<span class="stringliteral">"  Total uses of funds"</span>, xColumn1);
00589         font_chart_blue_sm.right_put( xColumn1, y+2, m.format(finance.total_expense.faculty, 2));
00590         font_chart_blue_sm.right_put( xColumn2, y+2, m.format(finance.total_expense.staff, 2));
00591         font_chart_blue_sm.right_put( xColumn3, y+2, m.format(finance.total_expense.other, 2));
00592         font_chart_blue_sm.right_put( xColumn4, y+2, m.format(finance.total_expense.total, 2));
00593         font_chart_blue_sm.right_put( xColumn5, y+2, m.format(finance.total_expense.percent, 24));
00594     }
00595     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+7) {
00596         <span class="keywordtype">double</span> percent1,percent2,percent3,percent4;
00597         percent1=100*finance.total_expense.faculty/finance.total_expense.total;
00598         percent2=100*finance.total_expense.staff/finance.total_expense.total;
00599         percent3=100*finance.total_expense.other/finance.total_expense.total;
00600         percent4=100;
00601 
00602         font_chartsm.disp( x, y, <span class="stringliteral">"\tPercent of total uses"</span>,  xColumn1);
00603         font_chartsm.right_put( xColumn1, y+2, m.format(percent1, 24));
00604         font_chartsm.right_put( xColumn2, y+2, m.format(percent2, 24));
00605         font_chartsm.right_put( xColumn3, y+2, m.format(percent3, 24));
00606         font_chartsm.right_put( xColumn4, y+2, m.format(percent4, 24));
00607         <span class="comment">//                      font_chartsm.disp( xColumn5, y+2, "% uses", xColumn6 );</span>
00608     }
00609     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+8) {
00610         font_chartsm.disp( x, y,<span class="stringliteral">"  Surplus (deficit)"</span>, xColumn1);
00611 
00612         <span class="keywordflow">if</span>(finance.last_year.surplus_deficit&gt;=0)
00613             font_chart_green_sm.right_put( xColumn4, y+2, m.format(finance.last_year.surplus_deficit, 2) );
00614         <span class="keywordflow">else</span>
00615             font_chart_red_sm.right_put( xColumn4, y+2, m.format(finance.last_year.surplus_deficit, 2));
00616     }
00617 
00618 }
00619 
00620 <span class="comment">//------ End of static function fin_rep_case1 --------//</span>
00621 
00622 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00623 <span class="preprocessor"></span><span class="comment">//------ Begin of static function export_fin_rep_case1 --------//</span>
00624 <span class="comment">//</span>
00625 <span class="comment">// write fin_rep_case1 to a text file</span>
00626 <span class="comment">//</span>
00627 <span class="keywordtype">void</span> export_fin_rep_case1( <a class="code" href="classFile.html">File</a> *filePtr ) {
00628     <span class="comment">// year no</span>
00629     <span class="keywordtype">int</span> tyear = info.financial_year();
00630     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Previous Year : "</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00631     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, tyear-1); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
00632     <span class="comment">// revenue label</span>
00633     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Revenue"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00634     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// blank field</span>
00635     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Direct"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00636     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Indirect"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00637     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Total"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00638     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"% sources"</span>); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
00639 
00640     <span class="comment">// revenue</span>
00641     <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>; ++i ) {
00642         <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, game_str_res.financial_report_str(i)); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00643         <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);               <span class="comment">// blank field</span>
00644         <span class="comment">// only AC_SPONSORED_RESEARCH_REVENUE display direct and indirect</span>
00645         <span class="keywordflow">if</span>( i == <a class="code" href="Ofinance_8h.html#a101a35">AC_SPONSORED_RESEARCH_REVENUE</a> ) {
00646             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.revenue_array[i].direct); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00647             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.revenue_array[i].indirect); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00648         }
00649         <span class="keywordflow">else</span> {
00650             <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00651             <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00652         }
00653         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.revenue_array[i].total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00654         <span class="comment">// don't show % sources AC_GROSS_TUITION_INCOME,AC_FINANCIAL_AID</span>
00655         <span class="keywordflow">if</span>( i==<a class="code" href="Ofinance_8h.html#a101a32">AC_GROSS_TUITION_INCOME</a>||i==<a class="code" href="Ofinance_8h.html#a101a33">AC_FINANCIAL_AID</a> ) {
00656             <span class="comment">// empty</span>
00657         }
00658         <span class="keywordflow">else</span> {
00659             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.revenue_array[i].percent);
00660         }
00661         <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
00662     }
00663     <span class="comment">// total revenue</span>
00664     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"  Total sources of funds"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00665     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// blank field</span>
00666     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// direct field</span>
00667     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// indirect field</span>
00668     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.total_revenue.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00669     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.total_revenue.percent); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
00670 
00671   <span class="comment">// expenditure label</span>
00672     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Expenditures"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00673     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"AY faculty compensation"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00674     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Staff compensation"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00675     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Other expenditures"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00676     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Total"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00677     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"% uses"</span>); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
00678 
00679   <span class="comment">// expenditure item</span>
00680     <span class="keywordflow">for</span>( i=0; i &lt; <a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>; ++i ) {
00681         <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, game_str_res.financial_report_str(i+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>)); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00682         <span class="keywordflow">if</span>( i==<a class="code" href="Ofinance_8h.html#a104a45">AC_ACADEMIC_DEPARTMENTS</a> || i==<a class="code" href="Ofinance_8h.html#a104a46">AC_SPONSORED_RESEARCH_EXPENSE</a> ) {
00683             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.expense_array[i].faculty);
00684         }
00685         <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00686         <span class="keywordflow">if</span>( i &lt; <a class="code" href="Ofinance_8h.html#a102a42">OPERATING_EXPENSE_ITEM_COUNT</a> ) {
00687             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.expense_array[i].staff);
00688         }
00689         <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00690         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.expense_array[i].other); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00691         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.expense_array[i].total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00692         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.expense_array[i].percent); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
00693 
00694         <span class="comment">// total operatring expenditure</span>
00695         <span class="keywordflow">if</span>( i==<a class="code" href="Ofinance_8h.html#a102a42">OPERATING_EXPENSE_ITEM_COUNT</a>-1 ) {
00696             <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"  Total operating expenditures"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00697             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.total_operating_expense.faculty); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00698             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.total_operating_expense.staff); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00699             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.total_operating_expense.other); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00700             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.total_operating_expense.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00701             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.total_operating_expense.percent); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
00702         }
00703     }
00704 
00705     <span class="comment">// total use of fund</span>
00706     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"  Total uses of funds"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00707     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.total_expense.faculty ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00708     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.total_expense.staff); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00709     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.total_expense.other); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00710     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.total_expense.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00711     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.total_expense.percent); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
00712 
00713   <span class="comment">// percentage of total uses</span>
00714     <span class="keywordtype">double</span> percent1,percent2,percent3,percent4;
00715     percent1=finance.total_expense.faculty/finance.total_expense.total;
00716     percent2=finance.total_expense.staff/finance.total_expense.total;
00717     percent3=finance.total_expense.other/finance.total_expense.total;
00718     percent4=1.0;
00719 
00720     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"    Percent of total uses"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00721     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent1); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00722     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent2); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00723     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent3); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00724     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent4); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00725     <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);                <span class="comment">// blank on % uses field</span>
00726 
00727     <span class="comment">// surplus</span>
00728     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"  Surplus (deficit)"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00729     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// AY faculty compensation field</span>
00730     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// staff compensation field</span>
00731     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// other expenditure field</span>
00732     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.last_year.surplus_deficit); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00733     <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);                <span class="comment">// blank on % uses field</span>
00734 }
00735 
00736 <span class="comment">//------ End of static function export_fin_rep_case1 --------//</span>
00737 <span class="preprocessor">#endif</span>
00738 <span class="preprocessor"></span>
00739 <span class="comment">//------ Begin of static function fin_rep_case2 --------//</span>
00740 <span class="comment">// Case 2: RENVENUE     and LAST YEAR</span>
00741 <span class="comment">// recNo -- record no. (row no.) to be displayed</span>
00742 <span class="comment">// x,y  -- left top position of the display region</span>
00743 <span class="comment">//</span>
00744 <span class="keyword">static</span> <span class="keywordtype">void</span> fin_rep_case2(<span class="keywordtype">int</span> recNo,<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y) {
00745     <span class="keywordtype">int</span> i;
00746     <span class="keywordtype">int</span> xColumn1=370, xColumn2=470, xColumn3=570, xColumn4=670, xColumn5=740;
00747 
00748     <span class="comment">// Show title //</span>
00749     <span class="keywordflow">if</span>(recNo==1) {
00750         <span class="comment">// change in version 2</span>
00751         <span class="comment">// int tyear=(int)(info.game_year+(info.game_month-9.0)/12);</span>
00752         <span class="keywordtype">int</span> tyear = info.financial_year();
00753 
00754         <a class="code" href="classString.html">String</a> str;
00755         str=<span class="stringliteral">"Present Year : Year "</span>;
00756         <span class="comment">//                      str+=m.format(tyear,16);    //## chea 061199 2.5.1</span>
00757         str+=m.format(tyear,4);
00758 
00759         <span class="comment">//                      str+="-";</span>
00760         <span class="comment">//                      str+=m.format(tyear+1,16);  //## chea 061199 2.5.1</span>
00761 
00762         font_charts.put(xColumn1-70,y+2,str.<a class="code" href="classString.html#m0">str_buf</a>);
00763         <span class="keywordflow">return</span>;
00764     }
00765     recNo--;
00766 
00767     <span class="keywordflow">if</span>(recNo==1) {
00768         font_chart_red_sm.disp( x, y, <span class="stringliteral">"Revenue"</span>, x+200 );
00769         font_chart_red_sm.right_put( xColumn2, y+2, <span class="stringliteral">"Direct"</span>);
00770         font_chart_red_sm.right_put( xColumn3, y+2, <span class="stringliteral">"Indirect"</span>);
00771         font_chart_red_sm.right_put( xColumn4, y+2, <span class="stringliteral">"Total"</span>);
00772         font_chart_red_sm.right_put( xColumn5, y+2, <span class="stringliteral">"% sources"</span>);
00773     }
00774     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;1) &amp;&amp; (recNo&lt;=<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+1)) {
00775         i=recNo-2;
00776         <span class="keywordflow">if</span>(recNo==5) {
00777             font_chartsm.disp( x, y, game_str_res.financial_report_str(i),  xColumn2);
00778             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_revenue_array[i].this_year.direct, 2));
00779             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_revenue_array[i].this_year.indirect, 2));
00780             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[i].this_year.total, 2));
00781             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_revenue_array[i].this_year.percent, 24));
00782         }
00783         <span class="keywordflow">if</span>((recNo==2)||(recNo==3)) {
00784             font_chartsm.disp( x, y, game_str_res.financial_report_str(i),  xColumn2);
00785             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[i].this_year.total, 2));
00786         }
00787         <span class="keywordflow">else</span> {
00788             font_chartsm.disp( x, y, game_str_res.financial_report_str(i),  xColumn2);
00789             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[i].this_year.total, 2));
00790             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_revenue_array[i].this_year.percent, 24));
00791         }
00792     }
00793     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+2) {
00794         font_chart_blue_sm.disp( x, y,<span class="stringliteral">"  Total sources of funds"</span>, xColumn1);
00795         font_chart_blue_sm.right_put( xColumn4, y+2, m.format(finance.projected_total_revenue.this_year.total, 2));
00796         font_chart_blue_sm.right_put( xColumn5, y+2, m.format(finance.projected_total_revenue.this_year.percent, 24));
00797     }
00798     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+3) {
00799         font_chart_red_sm.right_put( xColumn1, y+2, <span class="stringliteral">"AY faculty"</span>);
00800         font_chart_red_sm.right_put( xColumn2, y+2, <span class="stringliteral">"Staff"</span>);
00801         font_chart_red_sm.right_put( xColumn3, y+2, <span class="stringliteral">"Other"</span>);
00802     }
00803     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+4) {
00804         font_chart_red_sm.disp( x, y, <span class="stringliteral">"Expenditures"</span>, x+200 );
00805         font_chart_red_sm.right_put( xColumn1, y+2, <span class="stringliteral">"compensation"</span>);
00806         font_chart_red_sm.right_put( xColumn2, y+2, <span class="stringliteral">"compensation"</span>);
00807         font_chart_red_sm.right_put( xColumn3, y+2, <span class="stringliteral">"expenditures"</span>);
00808         font_chart_red_sm.right_put( xColumn4, y+2, <span class="stringliteral">"Total"</span>);
00809         font_chart_red_sm.right_put( xColumn5, y+2, <span class="stringliteral">"% uses"</span>);
00810     }
00811     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;=<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+5) &amp;&amp; (recNo&lt;<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+3)) {
00812         i=recNo-5-<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>;
00813         <span class="keywordflow">if</span>((recNo&gt;=<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+7) &amp;&amp; (recNo&lt;<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+3)) {
00814             font_chartsm.disp( x, y,game_str_res.financial_report_str(i+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>),xColumn2);
00815             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[i].this_year.staff, 2));
00816             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_expense_array[i].this_year.other, 2));
00817             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[i].this_year.total, 2));
00818             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[i].this_year.percent, 24));
00819         }
00820         <span class="keywordflow">else</span> {
00821             font_chartsm.disp( x, y,game_str_res.financial_report_str(i+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>),xColumn2);
00822             font_chartsm.right_put( xColumn1, y+2, m.format(finance.projected_expense_array[i].this_year.faculty, 2));
00823             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[i].this_year.staff, 2));
00824             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_expense_array[i].this_year.other, 2));
00825             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[i].this_year.total, 2));
00826             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[i].this_year.percent, 24));
00827         }
00828     }
00829     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+3) {
00830         font_chart_blue_sm.disp( x, y,<span class="stringliteral">"  Total operating expenditures"</span>, xColumn1);
00831         font_chart_blue_sm.right_put( xColumn1, y+2, m.format(finance.projected_total_operating_expense.this_year.faculty, 2));
00832         font_chart_blue_sm.right_put( xColumn2, y+2, m.format(finance.projected_total_operating_expense.this_year.staff, 2));
00833         font_chart_blue_sm.right_put( xColumn3, y+2, m.format(finance.projected_total_operating_expense.this_year.other, 2));
00834         font_chart_blue_sm.right_put( xColumn4, y+2, m.format(finance.projected_total_operating_expense.this_year.total, 2));
00835         font_chart_blue_sm.right_put( xColumn5, y+2, m.format(finance.projected_total_operating_expense.this_year.percent, 24));
00836     }
00837     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+3) &amp;&amp; (recNo&lt;=<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+5)) {
00838         i=recNo-6-<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>;
00839         font_chartsm.disp( x, y,game_str_res.financial_report_str(i+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>),xColumn2);
00840         font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_expense_array[i].this_year.other, 2));
00841         font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[i].this_year.total, 2));
00842         font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[i].this_year.percent, 24));
00843     }
00844     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+6) {
00845         font_chart_blue_sm.disp( x, y,<span class="stringliteral">"  Total uses of funds"</span>, xColumn1);
00846         font_chart_blue_sm.right_put( xColumn1, y+2, m.format(finance.projected_total_expense.this_year.faculty, 2));
00847         font_chart_blue_sm.right_put( xColumn2, y+2, m.format(finance.projected_total_expense.this_year.staff, 2));
00848         font_chart_blue_sm.right_put( xColumn3, y+2, m.format(finance.projected_total_expense.this_year.other, 2));
00849         font_chart_blue_sm.right_put( xColumn4, y+2, m.format(finance.projected_total_expense.this_year.total, 2));
00850         font_chart_blue_sm.right_put( xColumn5, y+2, m.format(finance.projected_total_expense.this_year.percent, 24));
00851     }
00852     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+7) {
00853         <span class="keywordtype">double</span> percent1,percent2,percent3,percent4;
00854         <span class="comment">// fix in version 2</span>
00855         <span class="comment">//percent1=100*finance.total_expense.faculty/finance.total_expense.total;</span>
00856         <span class="comment">//percent2=100*finance.total_expense.staff/finance.total_expense.total;</span>
00857         <span class="comment">//percent3=100*finance.total_expense.other/finance.total_expense.total;</span>
00858         percent1=100*finance.projected_total_expense.this_year.faculty/finance.projected_total_expense.this_year.total;
00859         percent2=100*finance.projected_total_expense.this_year.staff/finance.projected_total_expense.this_year.total;
00860         percent3=100*finance.projected_total_expense.this_year.other/finance.projected_total_expense.this_year.total;
00861         percent4=100;
00862 
00863         font_chartsm.disp( x, y, <span class="stringliteral">"\tPercent of total uses"</span>,  xColumn1);
00864         font_chartsm.right_put( xColumn1, y+2, m.format(percent1, 24));
00865         font_chartsm.right_put( xColumn2, y+2, m.format(percent2, 24));
00866         font_chartsm.right_put( xColumn3, y+2, m.format(percent3, 24));
00867         font_chartsm.right_put( xColumn4, y+2, m.format(percent4, 24));
00868         <span class="comment">//                      font_chartsm.disp( xColumn5, y+2, "% uses", xColumn6 );</span>
00869     }
00870     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+8) {
00871         font_chartsm.disp( x, y,<span class="stringliteral">"  Surplus (deficit)"</span>, xColumn1);
00872         <span class="keywordflow">if</span>(finance.this_year.surplus_deficit&gt;0)
00873             font_chart_green_sm.right_put( xColumn4, y+2, m.format(finance.this_year.surplus_deficit, 2));
00874         <span class="keywordflow">else</span>
00875             font_chart_red_sm.right_put( xColumn4, y+2, m.format(finance.this_year.surplus_deficit, 2));
00876     }
00877 }
00878 
00879 <span class="comment">//------ End of static function fin_rep_case2 --------//</span>
00880 
00881 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00882 <span class="preprocessor"></span><span class="comment">//------ Begin of static function export_fin_rep_case2 --------//</span>
00883 <span class="comment">//</span>
00884 <span class="comment">// write fin_rep_case2 to a text file</span>
00885 <span class="comment">//</span>
00886 <span class="keywordtype">void</span> export_fin_rep_case2( <a class="code" href="classFile.html">File</a> *filePtr ) {
00887     <span class="comment">// year no</span>
00888     <span class="keywordtype">int</span> tyear = info.financial_year();
00889     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Present Year : "</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00890     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, tyear); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
00891     <span class="comment">// revenue label</span>
00892     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Revenue"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00893     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// blank field</span>
00894     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Direct"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00895     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Indirect"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00896     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Total"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00897     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"% sources"</span>); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
00898 
00899     <span class="comment">// revenue</span>
00900     <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>; ++i ) {
00901         <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, game_str_res.financial_report_str(i)); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00902         <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);               <span class="comment">// blank field</span>
00903         <span class="comment">// only AC_SPONSORED_RESEARCH_REVENUE display direct and indirect</span>
00904         <span class="keywordflow">if</span>( i == <a class="code" href="Ofinance_8h.html#a101a35">AC_SPONSORED_RESEARCH_REVENUE</a> ) {
00905             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_revenue_array[i].this_year.direct); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00906             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_revenue_array[i].this_year.indirect); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00907         }
00908         <span class="keywordflow">else</span> {
00909             <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00910             <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00911         }
00912         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_revenue_array[i].this_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00913         <span class="comment">// don't show % sources AC_GROSS_TUITION_INCOME,AC_FINANCIAL_AID</span>
00914         <span class="keywordflow">if</span>( i==<a class="code" href="Ofinance_8h.html#a101a32">AC_GROSS_TUITION_INCOME</a>||i==<a class="code" href="Ofinance_8h.html#a101a33">AC_FINANCIAL_AID</a> ) {
00915             <span class="comment">// empty</span>
00916         }
00917         <span class="keywordflow">else</span> {
00918             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_revenue_array[i].this_year.percent);
00919         }
00920         <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
00921     }
00922     <span class="comment">// total revenue</span>
00923     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"  Total sources of funds"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00924     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// blank field</span>
00925     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// direct field</span>
00926     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// indirect field</span>
00927     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_revenue.this_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00928     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_revenue.this_year.percent); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
00929 
00930   <span class="comment">// expenditure label</span>
00931     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Expenditures"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00932     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"AY faculty compensation"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00933     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Staff compensation"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00934     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Other expenditures"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00935     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Total"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00936     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"% uses"</span>); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
00937 
00938   <span class="comment">// expenditure item</span>
00939     <span class="keywordflow">for</span>( i=0; i &lt; <a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>; ++i ) {
00940         <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, game_str_res.financial_report_str(i+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>)); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00941         <span class="keywordflow">if</span>( i==<a class="code" href="Ofinance_8h.html#a104a45">AC_ACADEMIC_DEPARTMENTS</a> || i==<a class="code" href="Ofinance_8h.html#a104a46">AC_SPONSORED_RESEARCH_EXPENSE</a> ) {
00942             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_expense_array[i].this_year.faculty);
00943         }
00944         <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00945         <span class="keywordflow">if</span>( i &lt; <a class="code" href="Ofinance_8h.html#a102a42">OPERATING_EXPENSE_ITEM_COUNT</a> ) {
00946             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_expense_array[i].this_year.staff);
00947         }
00948         <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00949         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_expense_array[i].this_year.other); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00950         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_expense_array[i].this_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00951         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_expense_array[i].this_year.percent); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
00952 
00953         <span class="keywordflow">if</span>( i==<a class="code" href="Ofinance_8h.html#a102a42">OPERATING_EXPENSE_ITEM_COUNT</a>-1 ) {
00954             <span class="comment">// total operatring expenditure</span>
00955             <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"  Total operating expenditures"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00956             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_operating_expense.this_year.faculty); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00957             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_operating_expense.this_year.staff); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00958             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_operating_expense.this_year.other); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00959             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_operating_expense.this_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00960             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_operating_expense.this_year.percent); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
00961         }
00962     }
00963 
00964     <span class="comment">// total use of fund</span>
00965     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"  Total uses of funds"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00966     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_expense.this_year.faculty ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00967     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_expense.this_year.staff); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00968     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_expense.this_year.other); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00969     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_expense.this_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00970     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_expense.this_year.percent); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
00971 
00972   <span class="comment">// percentage of total uses</span>
00973     <span class="keywordtype">double</span> percent1,percent2,percent3,percent4;
00974     percent1=finance.projected_total_expense.this_year.faculty/finance.projected_total_expense.this_year.total;
00975     percent2=finance.projected_total_expense.this_year.staff/finance.projected_total_expense.this_year.total;
00976     percent3=finance.projected_total_expense.this_year.other/finance.projected_total_expense.this_year.total;
00977     percent4=1.0;
00978 
00979     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"    Percent of total uses"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00980     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent1); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00981     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent2); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00982     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent3); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00983     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent4); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00984     <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);                <span class="comment">// blank on % uses field</span>
00985 
00986     <span class="comment">// surplus</span>
00987     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"  Surplus (deficit)"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00988     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// AY faculty compensation field</span>
00989     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// staff compensation field</span>
00990     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// other expenditure field</span>
00991     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.this_year.surplus_deficit); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
00992     <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);                <span class="comment">// blank on % uses field</span>
00993 }
00994 
00995 <span class="comment">//------ End of static function export_fin_rep_case2 --------//</span>
00996 <span class="preprocessor">#endif</span>
00997 <span class="preprocessor"></span>
00998 <span class="comment">//------ Begin of static function fin_rep_case3 --------//</span>
00999 <span class="comment">// Case 3: RENVENUE     and NEXT YEAR</span>
01000 <span class="comment">// recNo -- record no. (row no.) to be displayed</span>
01001 <span class="comment">// x,y  -- left top position of the display region</span>
01002 <span class="comment">//</span>
01003 <span class="keyword">static</span> <span class="keywordtype">void</span> fin_rep_case3(<span class="keywordtype">int</span> recNo,<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y) {
01004     <span class="keywordtype">int</span> i;
01005     <span class="comment">//  int     xColumn1=x+305, xColumn2=440, xColumn3=510, xColumn4=590, xColumn5=680;</span>
01006     <span class="keywordtype">int</span> xColumn1=370, xColumn2=470, xColumn3=570, xColumn4=670, xColumn5=740;
01007 
01008     <span class="comment">// Show title //</span>
01009     <span class="keywordflow">if</span>(recNo==1) {
01010         <span class="comment">// fix in version 2</span>
01011         <span class="comment">// int tyear=(int)(info.game_year+(info.game_month-9.0)/12);</span>
01012         <span class="keywordtype">int</span> tyear=info.financial_year();
01013 
01014         <a class="code" href="classString.html">String</a> str;
01015         str=<span class="stringliteral">"Next Year : Year "</span>;
01016         <span class="comment">//                      str+=m.format(tyear+1,16);     //## chea 061199 2.5.1</span>
01017         str+=m.format(tyear+1,4);
01018 
01019         <span class="comment">//                      str+="-";</span>
01020         <span class="comment">//                      str+=m.format(tyear+2,16);     //## chea 061199 2.5.1</span>
01021 
01022         font_charts.put(xColumn1-70,y+2,str.<a class="code" href="classString.html#m0">str_buf</a>);
01023         <span class="keywordflow">return</span>;
01024     }
01025     recNo--;
01026 
01027     <span class="keywordflow">if</span>(recNo==1) {
01028         font_chart_red_sm.disp( x, y, <span class="stringliteral">"Revenue"</span>, x+200 );
01029         font_chart_red_sm.right_put( xColumn2, y+2, <span class="stringliteral">"Direct"</span>);
01030         font_chart_red_sm.right_put( xColumn3, y+2, <span class="stringliteral">"Indirect"</span>);
01031         font_chart_red_sm.right_put( xColumn4, y+2, <span class="stringliteral">"Total"</span>);
01032         font_chart_red_sm.right_put( xColumn5, y+2, <span class="stringliteral">"% sources"</span>);
01033     }
01034     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;1) &amp;&amp; (recNo&lt;=<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+1)) {
01035         i=recNo-2;
01036         <span class="keywordflow">if</span>(recNo==5) {
01037             font_chartsm.disp( x, y, game_str_res.financial_report_str(i),  xColumn1);
01038             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_revenue_array[i].next_year.direct, 2));
01039             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_revenue_array[i].next_year.indirect, 2));
01040             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[i].next_year.total, 2));
01041             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_revenue_array[i].next_year.percent, 24));
01042         }
01043         <span class="keywordflow">if</span>((recNo==2)||(recNo==3)) {
01044             font_chartsm.disp( x, y, game_str_res.financial_report_str(i),  xColumn2);
01045             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[i].next_year.total, 2));
01046         }
01047         <span class="keywordflow">else</span> {
01048             font_chartsm.disp( x, y, game_str_res.financial_report_str(i),  xColumn2);
01049             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[i].next_year.total, 2));
01050             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_revenue_array[i].next_year.percent, 24));
01051         }
01052     }
01053     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+2) {
01054         font_chart_blue_sm.disp( x, y,<span class="stringliteral">"  Total sources of funds"</span>, xColumn1);
01055         font_chart_blue_sm.right_put( xColumn4, y+2, m.format(finance.projected_total_revenue.next_year.total, 2));
01056         font_chart_blue_sm.right_put( xColumn5, y+2, m.format(finance.projected_total_revenue.next_year.percent, 24));
01057     }
01058     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+3) {
01059         font_chart_red_sm.right_put( xColumn1, y+2, <span class="stringliteral">"AY faculty"</span>);
01060         font_chart_red_sm.right_put( xColumn2, y+2, <span class="stringliteral">"Staff"</span>);
01061         font_chart_red_sm.right_put( xColumn3, y+2, <span class="stringliteral">"Other"</span>);
01062     }
01063     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+4) {
01064         font_chart_red_sm.disp( x, y, <span class="stringliteral">"Expenditures"</span>, x+200 );
01065         font_chart_red_sm.right_put( xColumn1, y+2, <span class="stringliteral">"compensation"</span>);
01066         font_chart_red_sm.right_put( xColumn2, y+2, <span class="stringliteral">"compensation"</span>);
01067         font_chart_red_sm.right_put( xColumn3, y+2, <span class="stringliteral">"expenditures"</span>);
01068         font_chart_red_sm.right_put( xColumn4, y+2, <span class="stringliteral">"Total"</span>);
01069         font_chart_red_sm.right_put( xColumn5, y+2, <span class="stringliteral">"% uses"</span>);
01070     }
01071     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;=<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+5) &amp;&amp; (recNo&lt;<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+3)) {
01072         i=recNo-5-<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>;
01073         <span class="keywordflow">if</span>((recNo&gt;=<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+7) &amp;&amp; (recNo&lt;<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+3)) {
01074             font_chartsm.disp( x, y,game_str_res.financial_report_str(i+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>),xColumn1);
01075             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[i].next_year.staff, 2));
01076             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_expense_array[i].next_year.other, 2));
01077             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[i].next_year.total, 2));
01078             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[i].next_year.percent, 24));
01079         }
01080         <span class="keywordflow">else</span> {
01081             font_chartsm.disp( x, y,game_str_res.financial_report_str(i+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>),xColumn1);
01082             font_chartsm.right_put( xColumn1, y+2, m.format(finance.projected_expense_array[i].next_year.faculty, 2));
01083             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[i].next_year.staff, 2));
01084             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_expense_array[i].next_year.other, 2));
01085             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[i].next_year.total, 2));
01086             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[i].next_year.percent, 24));
01087         }
01088     }
01089     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+3) {
01090         font_chart_blue_sm.disp( x, y,<span class="stringliteral">"  Total operating expenditures"</span>, xColumn1);
01091         font_chart_blue_sm.right_put( xColumn1, y+2, m.format(finance.projected_total_operating_expense.next_year.faculty, 2));
01092         font_chart_blue_sm.right_put( xColumn2, y+2, m.format(finance.projected_total_operating_expense.next_year.staff, 2));
01093         font_chart_blue_sm.right_put( xColumn3, y+2, m.format(finance.projected_total_operating_expense.next_year.other, 2));
01094         font_chart_blue_sm.right_put( xColumn4, y+2, m.format(finance.projected_total_operating_expense.next_year.total, 2));
01095         font_chart_blue_sm.right_put( xColumn5, y+2, m.format(finance.projected_total_operating_expense.next_year.percent, 24));
01096     }
01097     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+3) &amp;&amp; (recNo&lt;=<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+5)) {
01098         i=recNo-6-<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>;
01099         font_chartsm.disp( x, y,game_str_res.financial_report_str(i+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>),xColumn1);
01100         font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_expense_array[i].next_year.other, 2));
01101         font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[i].next_year.total, 2));
01102         font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[i].next_year.percent, 24));
01103     }
01104     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+6) {
01105         font_chart_blue_sm.disp( x, y,<span class="stringliteral">"  Total uses of funds"</span>, xColumn1);
01106         font_chart_blue_sm.right_put( xColumn1, y+2, m.format(finance.projected_total_expense.next_year.faculty, 2));
01107         font_chart_blue_sm.right_put( xColumn2, y+2, m.format(finance.projected_total_expense.next_year.staff, 2));
01108         font_chart_blue_sm.right_put( xColumn3, y+2, m.format(finance.projected_total_expense.next_year.other, 2));
01109         font_chart_blue_sm.right_put( xColumn4, y+2, m.format(finance.projected_total_expense.next_year.total, 2));
01110         font_chart_blue_sm.right_put( xColumn5, y+2, m.format(finance.projected_total_expense.next_year.percent, 24));
01111     }
01112     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+7) {
01113         <span class="keywordtype">double</span> percent1,percent2,percent3,percent4;
01114         <span class="comment">// fix in version 2</span>
01115         <span class="comment">//percent1=100*finance.total_expense.faculty/finance.total_expense.total;</span>
01116         <span class="comment">//percent2=100*finance.total_expense.staff/finance.total_expense.total;</span>
01117         <span class="comment">//percent3=100*finance.total_expense.other/finance.total_expense.total;</span>
01118         percent1=100*finance.projected_total_expense.next_year.faculty/finance.projected_total_expense.next_year.total;
01119         percent2=100*finance.projected_total_expense.next_year.staff/finance.projected_total_expense.next_year.total;
01120         percent3=100*finance.projected_total_expense.next_year.other/finance.projected_total_expense.next_year.total;
01121         percent4=100;
01122 
01123         font_chartsm.disp( x, y, <span class="stringliteral">"\tPercent of total uses"</span>,  xColumn1);
01124         font_chartsm.right_put( xColumn1, y+2, m.format(percent1, 24));
01125         font_chartsm.right_put( xColumn2, y+2, m.format(percent2, 24));
01126         font_chartsm.right_put( xColumn3, y+2, m.format(percent3, 24));
01127         font_chartsm.right_put( xColumn4, y+2, m.format(percent4, 24));
01128         <span class="comment">//                      font_chartsm.disp( xColumn5, y+2, "% uses", xColumn6 );</span>
01129     }
01130     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+8) {
01131         font_chartsm.disp( x, y,<span class="stringliteral">"  Surplus (deficit)"</span>, xColumn1);
01132         <span class="keywordflow">if</span>(finance.next_year.surplus_deficit&gt;0)
01133             font_chart_green_sm.right_put( xColumn4, y+2, m.format(finance.next_year.surplus_deficit, 2));
01134         <span class="keywordflow">else</span>
01135             font_chart_red_sm.right_put( xColumn4, y+2, m.format(finance.next_year.surplus_deficit, 2) );
01136     }
01137 }
01138 
01139 <span class="comment">//------ End of static function fin_rep_case3 --------//</span>
01140 
01141 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01142 <span class="preprocessor"></span><span class="comment">//------ Begin of static function export_fin_rep_case3 --------//</span>
01143 <span class="comment">//</span>
01144 <span class="comment">// write fin_rep_case3 to a text file</span>
01145 <span class="comment">//</span>
01146 <span class="keywordtype">void</span> export_fin_rep_case3( <a class="code" href="classFile.html">File</a> *filePtr ) {
01147     <span class="comment">// year no</span>
01148     <span class="keywordtype">int</span> tyear = info.financial_year();
01149     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Next Year : "</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01150     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, tyear+1); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
01151     <span class="comment">// revenue label</span>
01152     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Revenue"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01153     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// blank field</span>
01154     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Direct"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01155     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Indirect"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01156     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Total"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01157     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"% sources"</span>); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
01158 
01159     <span class="comment">// revenue</span>
01160     <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>; ++i ) {
01161         <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, game_str_res.financial_report_str(i)); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01162         <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);               <span class="comment">// blank field</span>
01163         <span class="comment">// only AC_SPONSORED_RESEARCH_REVENUE display direct and indirect</span>
01164         <span class="keywordflow">if</span>( i == <a class="code" href="Ofinance_8h.html#a101a35">AC_SPONSORED_RESEARCH_REVENUE</a> ) {
01165             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_revenue_array[i].next_year.direct); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01166             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_revenue_array[i].next_year.indirect); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01167         }
01168         <span class="keywordflow">else</span> {
01169             <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01170             <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01171         }
01172         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_revenue_array[i].next_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01173         <span class="comment">// don't show % sources AC_GROSS_TUITION_INCOME,AC_FINANCIAL_AID</span>
01174         <span class="keywordflow">if</span>( i==<a class="code" href="Ofinance_8h.html#a101a32">AC_GROSS_TUITION_INCOME</a>||i==<a class="code" href="Ofinance_8h.html#a101a33">AC_FINANCIAL_AID</a> ) {
01175             <span class="comment">// empty</span>
01176         }
01177         <span class="keywordflow">else</span> {
01178             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_revenue_array[i].next_year.percent);
01179         }
01180         <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
01181     }
01182     <span class="comment">// total revenue</span>
01183     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"  Total sources of funds"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01184     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// blank field</span>
01185     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// direct field</span>
01186     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// indirect field</span>
01187     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_revenue.next_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01188     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_revenue.next_year.percent); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
01189 
01190   <span class="comment">// expenditure label</span>
01191     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Expenditures"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01192     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"AY faculty compensation"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01193     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Staff compensation"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01194     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Other expenditures"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01195     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Total"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01196     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"% uses"</span>); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
01197 
01198   <span class="comment">// expenditure item</span>
01199     <span class="keywordflow">for</span>( i=0; i &lt; <a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>; ++i ) {
01200         <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, game_str_res.financial_report_str(i+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>)); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01201         <span class="keywordflow">if</span>( i==<a class="code" href="Ofinance_8h.html#a104a45">AC_ACADEMIC_DEPARTMENTS</a> || i==<a class="code" href="Ofinance_8h.html#a104a46">AC_SPONSORED_RESEARCH_EXPENSE</a> ) {
01202             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_expense_array[i].next_year.faculty);
01203         }
01204         <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01205         <span class="keywordflow">if</span>( i &lt; <a class="code" href="Ofinance_8h.html#a102a42">OPERATING_EXPENSE_ITEM_COUNT</a> ) {
01206             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_expense_array[i].next_year.staff);
01207         }
01208         <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01209         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_expense_array[i].next_year.other); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01210         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_expense_array[i].next_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01211         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_expense_array[i].next_year.percent); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
01212 
01213         <span class="keywordflow">if</span>( i==<a class="code" href="Ofinance_8h.html#a102a42">OPERATING_EXPENSE_ITEM_COUNT</a>-1 ) {
01214             <span class="comment">// total operatring expenditure</span>
01215             <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"  Total operating expenditures"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01216             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_operating_expense.next_year.faculty); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01217             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_operating_expense.next_year.staff); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01218             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_operating_expense.next_year.other); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01219             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_operating_expense.next_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01220             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_operating_expense.next_year.percent); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
01221         }
01222     }
01223 
01224     <span class="comment">// total use of fund</span>
01225     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"  Total uses of funds"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01226     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_expense.next_year.faculty ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01227     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_expense.next_year.staff); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01228     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_expense.next_year.other); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01229     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_expense.next_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01230     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_expense.next_year.percent); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
01231 
01232   <span class="comment">// percentage of total uses</span>
01233     <span class="keywordtype">double</span> percent1,percent2,percent3,percent4;
01234     percent1=finance.projected_total_expense.next_year.faculty/finance.projected_total_expense.next_year.total;
01235     percent2=finance.projected_total_expense.next_year.staff/finance.projected_total_expense.next_year.total;
01236     percent3=finance.projected_total_expense.next_year.other/finance.projected_total_expense.next_year.total;
01237     percent4=1.0;
01238 
01239     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"    Percent of total uses"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01240     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent1); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01241     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent2); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01242     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent3); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01243     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent4); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01244     <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);                <span class="comment">// blank on % uses field</span>
01245 
01246     <span class="comment">// surplus</span>
01247     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"  Surplus (deficit)"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01248     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// AY faculty compensation field</span>
01249     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// staff compensation field</span>
01250     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// other expenditure field</span>
01251     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.next_year.surplus_deficit); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01252     <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);                <span class="comment">// blank on % uses field</span>
01253 }
01254 
01255 <span class="comment">//------ End of static function export_fin_rep_case3 --------//</span>
01256 <span class="preprocessor">#endif</span>
01257 <span class="preprocessor"></span>
01258 <span class="comment">//------ Begin of static function fin_rep_case4 --------//</span>
01259 <span class="comment">// Case 4: RENVENUE     and ACTUAL AND BUDGET</span>
01260 <span class="comment">// recNo -- record no. (row no.) to be displayed</span>
01261 <span class="comment">// x,y  -- left top position of the display region</span>
01262 <span class="comment">//</span>
01263 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01264 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">void</span> fin_rep_case4(<span class="keywordtype">int</span> recNo,<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y) {
01265     <span class="keywordtype">int</span> i;
01266     <span class="keywordtype">int</span> xColumn1=390, xColumn2=460, xColumn3=560, xColumn4=630, xColumn5=730, xColumn6=745;
01267 
01268     <span class="comment">// ##### Begin Marco ##### //</span>
01269     <span class="keywordtype">int</span> xColumn0 = 300;
01270     <span class="comment">// ##### End Marco ##### //</span>
01271 
01272     <span class="comment">// Show title //</span>
01273 
01274     <span class="keywordflow">if</span>(recNo==1) {
01275         font_charts.disp( xColumn1-40, y+2, <span class="stringliteral">"Budget vs Actual"</span>, xColumn4+140 );
01276         <span class="keywordflow">return</span>;
01277     }
01278     recNo--;
01279 
01280     <span class="keywordflow">if</span>(recNo==1) {
01281         font_chart_red_sm.disp( xColumn2-40, y+2, <span class="stringliteral">"Change"</span>, xColumn3 );
01282         font_chart_red_sm.disp( xColumn4-40, y+2, <span class="stringliteral">"Change"</span>, xColumn5 );
01283         <span class="keywordtype">int</span> tyear=(int)(info.game_year+((float)info.game_month-9.0)/12);
01284 
01285         <a class="code" href="classString.html">String</a> s1, s2 ,s3;
01286 
01287         s1 += m.format(tyear-1,16);
01288         s1 += <span class="stringliteral">" actual"</span>;
01289         font_chart_red_sm.disp( xColumn1-60, y+2, s1.<a class="code" href="classString.html#m0">str_buf</a>, xColumn2-10);
01290 
01291         s2 += m.format(tyear,16);
01292         s2 += <span class="stringliteral">" budget"</span>;
01293         font_chart_red_sm.disp( xColumn3-65, y+2, s2.<a class="code" href="classString.html#m0">str_buf</a>, xColumn4-10 );
01294 
01295         s3 = m.format(tyear,16);
01296         s3 += <span class="stringliteral">" actual"</span>;
01297         font_chart_red_sm.disp( xColumn5-60, y+2, s3.<a class="code" href="classString.html#m0">str_buf</a>, xColumn6 );
01298 
01299         <span class="comment">// ##### Begin Marco ##### //</span>
01300         <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
01301             font_chart_purple_sm.disp(xColumn0-30, y+2, <span class="stringliteral">"Initial"</span>, xColumn1-10);
01302         <span class="comment">// ##### End Marco ##### //</span>
01303     }
01304 
01305     <span class="keywordflow">if</span>(recNo==2) {
01306         font_chart_red_sm.disp( x, y, <span class="stringliteral">"Revenue"</span>, x+200 );
01307     }
01308 
01309     <span class="comment">//  else if((recNo&gt;2) &amp;&amp; (recNo&lt;=REVENUE_ITEM_COUNT+2))</span>
01310     <span class="comment">// Marco</span>
01311     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;2) &amp;&amp; (recNo&lt;=<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>)) {
01312         i=recNo-3;
01313 
01314         font_chartsm.disp( x, y, game_str_res.financial_report_str(i),  xColumn1);
01315 
01316         <span class="comment">// ##### Begin Marco ##### //</span>
01317         <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
01318             font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_revenue_array[i].total, 2));
01319         <span class="comment">// ##### End Marco ##### //</span>
01320 
01321         font_chartsm.right_put( xColumn1, y+2, m.format(finance.revenue_array[i].total, 2));
01322         <span class="comment">//              font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_revenue_array[i].change_budget_year.total, 3));</span>
01323         <span class="comment">//## chea 250899</span>
01324         font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_revenue_array[i].change_budget_year.total, 24));
01325 
01326         font_chartsm.right_put( xColumn3, y+2, m.format(finance.budget_revenue_array[i].total, 2));
01327         <span class="comment">//                      font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[i].change_last_year.total, 3));</span>
01328         <span class="comment">//## chea 250899</span>
01329         font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[i].change_last_year.total, 24));
01330 
01331         font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_revenue_array[i].this_year.total, 2));
01332 
01333     }
01334     <span class="comment">// ##### Begin Marco  ##### //</span>
01335     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+1)) {        <span class="comment">// Marco</span>
01336         i=recNo-3;
01337 
01338         font_chartsm.disp( x, y, <span class="stringliteral">"  Interest earned or paid on"</span>,  xColumn1);
01339 
01340         <span class="comment">// ##### Begin Marco ##### //</span>
01341         <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
01342             font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_revenue_array[i].total, 2));
01343         <span class="comment">// ##### End Marco ##### //</span>
01344 
01345         font_chartsm.right_put( xColumn1, y+2, m.format(finance.revenue_array[i].total, 2));
01346         <span class="comment">//              font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_revenue_array[i].change_budget_year.total, 3));</span>
01347         <span class="comment">//## chea 250899</span>
01348         font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_revenue_array[i].change_budget_year.total, 24));
01349 
01350         font_chartsm.right_put( xColumn3, y+2, m.format(finance.budget_revenue_array[i].total, 2));
01351         <span class="comment">//                      font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[i].change_last_year.total, 3));</span>
01352         <span class="comment">//## chea 250899</span>
01353         font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[i].change_last_year.total, 24));
01354 
01355         font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_revenue_array[i].this_year.total, 2));
01356 
01357     }
01358     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+2)) {        <span class="comment">// Marco</span>
01359         font_chartsm.disp( x + 30, y, <span class="stringliteral">"operating reserve"</span>,  xColumn1);
01360     }
01361     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+3) {
01362         i=recNo-4;
01363 
01364         font_chartsm.disp( x, y, game_str_res.financial_report_str(i),  xColumn1);
01365 
01366         <span class="comment">// ##### Begin Marco ##### //</span>
01367         <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
01368             font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_revenue_array[i].total, 2));
01369         <span class="comment">// ##### End Marco ##### //</span>
01370 
01371         font_chartsm.right_put( xColumn1, y+2, m.format(finance.revenue_array[i].total, 2));
01372         <span class="comment">//              font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_revenue_array[i].change_budget_year.total, 3));</span>
01373         <span class="comment">//## chea 250899</span>
01374         font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_revenue_array[i].change_budget_year.total, 24));
01375 
01376         font_chartsm.right_put( xColumn3, y+2, m.format(finance.budget_revenue_array[i].total, 2));
01377         <span class="comment">//                      font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[i].change_last_year.total, 3));</span>
01378         <span class="comment">//## chea 250899</span>
01379         font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[i].change_last_year.total, 24));
01380 
01381         font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_revenue_array[i].this_year.total, 2));
01382 
01383     }
01384     <span class="comment">// #### End Marco ##### //</span>
01385     <span class="comment">//  else if(recNo==REVENUE_ITEM_COUNT+3)</span>
01386     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+4) {          <span class="comment">//Marco</span>
01387         font_chart_blue_sm.disp( x, y, <span class="stringliteral">"  Total sources of funds"</span>,  xColumn1);
01388 
01389         <span class="comment">// ##### Begin Marco ##### //</span>
01390         <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
01391             <span class="comment">//                  font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_total_revenue.total, 2));</span>
01392             font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_total_revenue_total, 2));
01393         <span class="comment">// ##### End Marco ##### //</span>
01394 
01395         font_chart_blue_sm.right_put( xColumn1, y+2, m.format(finance.total_revenue.total, 2));
01396         <span class="comment">//                      font_chart_blue_sm.right_put( xColumn2, y+2, m.format(finance.projected_total_revenue.change_budget_year.total, 3));</span>
01397         <span class="comment">//## chea 250899</span>
01398         font_chart_blue_sm.right_put( xColumn2, y+2, m.format(finance.projected_total_revenue.change_budget_year.total, 24));
01399 
01400         font_chart_blue_sm.right_put( xColumn3, y+2, m.format(finance.budget_total_revenue.total, 2));
01401         <span class="comment">//                      font_chart_blue_sm.right_put( xColumn4, y+2, m.format(finance.projected_total_revenue.change_last_year.total, 3));</span>
01402         <span class="comment">//## chea 250899</span>
01403         font_chart_blue_sm.right_put( xColumn4, y+2, m.format(finance.projected_total_revenue.change_last_year.total, 24));
01404 
01405         font_chart_blue_sm.right_put( xColumn5, y+2, m.format(finance.projected_total_revenue.this_year.total, 2));
01406     }
01407 
01408     <span class="comment">// ##### End Marco ##### //</span>
01409 
01410     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+5) {
01411         font_chart_red_sm.disp( x, y, <span class="stringliteral">"Expenditures"</span>, x+200 );
01412     }
01413     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;=<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+6) &amp;&amp; (recNo&lt;<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+4)) {
01414         i=recNo-6-<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>;
01415         font_chartsm.disp( x, y, game_str_res.financial_report_str(i+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>),  xColumn1);
01416 
01417         <span class="comment">// ##### Begin Marco ##### //</span>
01418         <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
01419             font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_expense_array[i].total, 2));
01420         <span class="comment">// ##### End Marco ##### //</span>
01421 
01422         font_chartsm.right_put( xColumn1, y+2, m.format(finance.expense_array[i].total, 2));
01423         <span class="comment">//                      font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[i].change_budget_year.total, 3));</span>
01424         <span class="comment">//## chea 250899</span>
01425         font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[i].change_budget_year.total, 24));
01426 
01427         font_chartsm.right_put( xColumn3, y+2, m.format(finance.budget_expense_array[i].total, 2));
01428         <span class="comment">//                      font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[i].change_last_year.total, 3));  //## chea 250899</span>
01429         font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[i].change_last_year.total, 24));
01430 
01431         font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[i].this_year.total, 2));
01432     }
01433     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+4) {
01434         font_chart_blue_sm.disp( x, y,<span class="stringliteral">"  Total operating expenditures"</span>, xColumn1);
01435 
01436         <span class="comment">// ##### Begin Marco ##### //</span>
01437         <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
01438             font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_total_operating_expense.total, 2));
01439         <span class="comment">// ##### End Marco ##### //</span>
01440 
01441         font_chart_blue_sm.right_put( xColumn1, y+2, m.format(finance.total_operating_expense.total, 2));
01442         <span class="comment">//                      font_chart_blue_sm.right_put( xColumn2, y+2, m.format(finance.projected_total_operating_expense.change_budget_year.total, 3));</span>
01443         <span class="comment">//## chea 250899</span>
01444         font_chart_blue_sm.right_put( xColumn2, y+2, m.format(finance.projected_total_operating_expense.change_budget_year.total, 24));
01445 
01446         font_chart_blue_sm.right_put( xColumn3, y+2, m.format(finance.budget_total_operating_expense.total, 2));
01447         <span class="comment">//                      font_chart_blue_sm.right_put( xColumn4, y+2, m.format(finance.projected_total_operating_expense.change_last_year.total, 3));</span>
01448         <span class="comment">//## chea 250899</span>
01449         font_chart_blue_sm.right_put( xColumn4, y+2, m.format(finance.projected_total_operating_expense.change_last_year.total, 24));
01450 
01451         font_chart_blue_sm.right_put( xColumn5, y+2, m.format(finance.projected_total_operating_expense.this_year.total, 2));
01452     }
01453     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+5) {
01454         i=recNo-7-<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>;
01455         font_chartsm.disp( x, y, game_str_res.financial_report_str(i+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>),  xColumn1);
01456 
01457         <span class="comment">// ##### Begin Marco ##### //</span>
01458         <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
01459             font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_expense_array[i].total, 2));
01460         <span class="comment">// ##### End Marco ##### //</span>
01461 
01462         font_chartsm.right_put( xColumn1, y+2, m.format(finance.expense_array[i].total, 2));
01463         <span class="comment">//                      font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[i].change_budget_year.total, 3));</span>
01464         <span class="comment">//## chea 250899</span>
01465         font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[i].change_budget_year.total, 24));
01466 
01467         font_chartsm.right_put( xColumn3, y+2, m.format(finance.budget_expense_array[i].total, 2));
01468         <span class="comment">//                      font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[i].change_last_year.total, 3));</span>
01469         <span class="comment">//## chea 250899</span>
01470         font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[i].change_last_year.total, 24));
01471 
01472         font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[i].this_year.total, 2));
01473     }
01474     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+6) {
01475         i=recNo-7-<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>;
01476         font_chartsm.disp( x, y, game_str_res.financial_report_str(i+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>),  xColumn1);
01477 
01478         <span class="comment">// ##### Begin Marco ##### //</span>
01479         <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
01480             font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_expense_array[i].total, 2));
01481         <span class="comment">// ##### End Marco ##### //</span>
01482 
01483         font_chartsm.right_put( xColumn1, y+2, m.format(finance.expense_array[i].total, 2));
01484         <span class="comment">//                      font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[i].change_budget_year.total, 3));</span>
01485         font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[i].change_budget_year.total, 24));
01486 
01487         font_chartsm.right_put( xColumn3, y+2, m.format(finance.budget_expense_array[i].total, 2));
01488         <span class="comment">//                      font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[i].change_last_year.total, 3));</span>
01489         font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[i].change_last_year.total, 24));
01490 
01491         font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[i].this_year.total, 2));
01492     }
01493     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+7) {
01494         font_chart_blue_sm.disp( x, y,<span class="stringliteral">"  Total uses of funds"</span>, xColumn1);
01495 
01496         <span class="comment">// ##### Begin Marco ##### //</span>
01497         <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
01498             font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_total_expense.total, 2));
01499         <span class="comment">// ##### End Marco ##### //</span>
01500 
01501         font_chart_blue_sm.right_put( xColumn1, y+2, m.format(finance.total_expense.total, 2));
01502         <span class="comment">//                      font_chart_blue_sm.right_put( xColumn2, y+2, m.format(finance.projected_total_expense.change_budget_year.total, 3));</span>
01503         <span class="comment">//## chea 250899</span>
01504         font_chart_blue_sm.right_put( xColumn2, y+2, m.format(finance.projected_total_expense.change_budget_year.total, 24));
01505 
01506         font_chart_blue_sm.right_put( xColumn3, y+2, m.format(finance.budget_total_expense.total, 2));
01507         <span class="comment">//                      font_chart_blue_sm.right_put( xColumn4, y+2, m.format(finance.projected_total_expense.change_last_year.total, 3));</span>
01508         <span class="comment">//## chea 250899</span>
01509         font_chart_blue_sm.right_put( xColumn4, y+2, m.format(finance.projected_total_expense.change_last_year.total, 24));
01510 
01511         font_chart_blue_sm.right_put( xColumn5, y+2, m.format(finance.projected_total_expense.this_year.total, 2));
01512     }
01513     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+8) {
01514         font_chartsm.disp( x, y,<span class="stringliteral">"  Surplus (deficit)"</span>, xColumn2);
01515 
01516         <span class="comment">// ##### Begin Marco ##### //</span>
01517         <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
01518             font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_last_year.surplus_deficit, 2));
01519         <span class="comment">// ##### End Marco ##### //</span>
01520 
01521         <span class="keywordflow">if</span>(finance.last_year.surplus_deficit&gt;0)
01522             font_chart_green_sm.right_put( xColumn1, y+2, m.format(finance.last_year.surplus_deficit, 2));
01523         <span class="keywordflow">else</span>
01524             font_chart_red_sm.right_put( xColumn1, y+2, m.format(finance.last_year.surplus_deficit, 2));
01525 
01526         <span class="keywordflow">if</span>(finance.budget_year.surplus_deficit&gt;0)
01527             font_chart_green_sm.right_put( xColumn3, y+2, m.format(finance.budget_year.surplus_deficit, 2));
01528         <span class="keywordflow">else</span>
01529             font_chart_red_sm.right_put( xColumn3, y+2, m.format(finance.budget_year.surplus_deficit, 2));
01530 
01531         <span class="keywordflow">if</span>(finance.this_year.surplus_deficit&gt;0)
01532             font_chart_green_sm.right_put( xColumn5, y+2, m.format(finance.this_year.surplus_deficit, 2));
01533         <span class="keywordflow">else</span>
01534             font_chart_red_sm.right_put( xColumn5, y+2, m.format(finance.this_year.surplus_deficit, 2));
01535     }
01536     <span class="comment">//## fred 990519</span>
01537 }
01538 
01539 <span class="preprocessor">#else</span>
01540 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">void</span> fin_rep_case4(<span class="keywordtype">int</span> recNo,<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y) {
01541     <span class="keywordtype">int</span> i;
01542     <span class="keywordtype">int</span> xColumn1=390, xColumn2=460, xColumn3=560, xColumn4=630, xColumn5=730, xColumn6=745;
01543 
01544     <span class="comment">// Show title //</span>
01545 
01546     <span class="keywordflow">if</span>(recNo==1) {
01547         font_charts.disp( xColumn1-40, y+2, <span class="stringliteral">"Budget vs Actual"</span>, xColumn4+140 );
01548         <span class="keywordflow">return</span>;
01549     }
01550     recNo--;
01551 
01552     <span class="keywordflow">if</span>(recNo==1) {
01553         font_chart_red_sm.disp( xColumn2-40, y+2, <span class="stringliteral">"Change"</span>, xColumn3 );
01554         font_chart_red_sm.disp( xColumn4-40, y+2, <span class="stringliteral">"Change"</span>, xColumn5 );
01555         <span class="keywordtype">int</span> tyear=(int)(info.game_year+((float)info.game_month-9.0)/12);
01556 
01557         <a class="code" href="classString.html">String</a> s1, s2 ,s3;
01558 
01559         s1 += m.format(tyear-1,16);
01560         s1 += <span class="stringliteral">" actual"</span>;
01561         font_chart_red_sm.disp( xColumn1-60, y+2, s1.<a class="code" href="classString.html#m0">str_buf</a>, xColumn2-10);
01562 
01563         s2 += m.format(tyear,16);
01564         s2 += <span class="stringliteral">" budget"</span>;
01565         font_chart_red_sm.disp( xColumn3-65, y+2, s2.<a class="code" href="classString.html#m0">str_buf</a>, xColumn4-10 );
01566 
01567         s3 = m.format(tyear,16);
01568         s3 += <span class="stringliteral">" actual"</span>;
01569         font_chart_red_sm.disp( xColumn5-60, y+2, s3.<a class="code" href="classString.html#m0">str_buf</a>, xColumn6 );
01570     }
01571 
01572     <span class="keywordflow">if</span>(recNo==2) {
01573         font_chart_red_sm.disp( x, y, <span class="stringliteral">"Revenue"</span>, x+200 );
01574     }
01575     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;2) &amp;&amp; (recNo&lt;=<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+2)) {
01576         i=recNo-3;
01577         font_chartsm.disp( x, y, game_str_res.financial_report_str(i),  xColumn1);
01578         font_chartsm.right_put( xColumn1, y+2, m.format(finance.revenue_array[i].total, 2));
01579         <span class="comment">//                      font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_revenue_array[i].change_budget_year.total, 3));</span>
01580         <span class="comment">//## chea 250899</span>
01581         font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_revenue_array[i].change_budget_year.total, 24));
01582 
01583         font_chartsm.right_put( xColumn3, y+2, m.format(finance.budget_revenue_array[i].total, 2));
01584         <span class="comment">//                      font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[i].change_last_year.total, 3));</span>
01585         <span class="comment">//## chea 250899</span>
01586         font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[i].change_last_year.total, 24));
01587 
01588         font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_revenue_array[i].this_year.total, 2));
01589     }
01590     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+3) {
01591         font_chart_blue_sm.disp( x, y, <span class="stringliteral">"  Total sources of funds"</span>,  xColumn1);
01592         font_chart_blue_sm.right_put( xColumn1, y+2, m.format(finance.total_revenue.total, 2));
01593         <span class="comment">//                      font_chart_blue_sm.right_put( xColumn2, y+2, m.format(finance.projected_total_revenue.change_budget_year.total, 3));</span>
01594         <span class="comment">//## chea 250899</span>
01595         font_chart_blue_sm.right_put( xColumn2, y+2, m.format(finance.projected_total_revenue.change_budget_year.total, 24));
01596 
01597         font_chart_blue_sm.right_put( xColumn3, y+2, m.format(finance.budget_total_revenue.total, 2));
01598         <span class="comment">//                      font_chart_blue_sm.right_put( xColumn4, y+2, m.format(finance.projected_total_revenue.change_last_year.total, 3));</span>
01599         <span class="comment">//## chea 250899</span>
01600         font_chart_blue_sm.right_put( xColumn4, y+2, m.format(finance.projected_total_revenue.change_last_year.total, 24));
01601 
01602         font_chart_blue_sm.right_put( xColumn5, y+2, m.format(finance.projected_total_revenue.this_year.total, 2));
01603     }
01604     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+5) {
01605         font_chart_red_sm.disp( x, y, <span class="stringliteral">"Expenditures"</span>, x+200 );
01606     }
01607     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;=<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+6) &amp;&amp; (recNo&lt;<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+4)) {
01608         i=recNo-6-<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>;
01609         font_chartsm.disp( x, y, game_str_res.financial_report_str(i+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>),  xColumn1);
01610         font_chartsm.right_put( xColumn1, y+2, m.format(finance.expense_array[i].total, 2));
01611         <span class="comment">//                      font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[i].change_budget_year.total, 3));</span>
01612         <span class="comment">//## chea 250899</span>
01613         font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[i].change_budget_year.total, 24));
01614 
01615         font_chartsm.right_put( xColumn3, y+2, m.format(finance.budget_expense_array[i].total, 2));
01616         <span class="comment">//                      font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[i].change_last_year.total, 3));  //## chea 250899</span>
01617         font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[i].change_last_year.total, 24));
01618 
01619         font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[i].this_year.total, 2));
01620     }
01621     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+4) {
01622         font_chart_blue_sm.disp( x, y,<span class="stringliteral">"  Total operating expenditures"</span>, xColumn1);
01623         font_chart_blue_sm.right_put( xColumn1, y+2, m.format(finance.total_operating_expense.total, 2));
01624         <span class="comment">//                      font_chart_blue_sm.right_put( xColumn2, y+2, m.format(finance.projected_total_operating_expense.change_budget_year.total, 3));</span>
01625         <span class="comment">//## chea 250899</span>
01626         font_chart_blue_sm.right_put( xColumn2, y+2, m.format(finance.projected_total_operating_expense.change_budget_year.total, 24));
01627 
01628         font_chart_blue_sm.right_put( xColumn3, y+2, m.format(finance.budget_total_operating_expense.total, 2));
01629         <span class="comment">//                      font_chart_blue_sm.right_put( xColumn4, y+2, m.format(finance.projected_total_operating_expense.change_last_year.total, 3));</span>
01630         <span class="comment">//## chea 250899</span>
01631         font_chart_blue_sm.right_put( xColumn4, y+2, m.format(finance.projected_total_operating_expense.change_last_year.total, 24));
01632 
01633         font_chart_blue_sm.right_put( xColumn5, y+2, m.format(finance.projected_total_operating_expense.this_year.total, 2));
01634     }
01635     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+5) {
01636         i=recNo-7-<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>;
01637         font_chartsm.disp( x, y, game_str_res.financial_report_str(i+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>),  xColumn1);
01638         font_chartsm.right_put( xColumn1, y+2, m.format(finance.expense_array[i].total, 2));
01639         <span class="comment">//                      font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[i].change_budget_year.total, 3));</span>
01640         <span class="comment">//## chea 250899</span>
01641         font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[i].change_budget_year.total, 24));
01642 
01643         font_chartsm.right_put( xColumn3, y+2, m.format(finance.budget_expense_array[i].total, 2));
01644         <span class="comment">//                      font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[i].change_last_year.total, 3));</span>
01645         <span class="comment">//## chea 250899</span>
01646         font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[i].change_last_year.total, 24));
01647 
01648         font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[i].this_year.total, 2));
01649     }
01650     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+6) {
01651         i=recNo-7-<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>;
01652         font_chartsm.disp( x, y, game_str_res.financial_report_str(i+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>),  xColumn1);
01653         font_chartsm.right_put( xColumn1, y+2, m.format(finance.expense_array[i].total, 2));
01654         <span class="comment">//                      font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[i].change_budget_year.total, 3));</span>
01655         font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[i].change_budget_year.total, 24));
01656 
01657         font_chartsm.right_put( xColumn3, y+2, m.format(finance.budget_expense_array[i].total, 2));
01658         <span class="comment">//                      font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[i].change_last_year.total, 3));</span>
01659         font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[i].change_last_year.total, 24));
01660 
01661         font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[i].this_year.total, 2));
01662     }
01663     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+7) {
01664         font_chart_blue_sm.disp( x, y,<span class="stringliteral">"  Total uses of funds"</span>, xColumn1);
01665         font_chart_blue_sm.right_put( xColumn1, y+2, m.format(finance.total_expense.total, 2));
01666         <span class="comment">//                      font_chart_blue_sm.right_put( xColumn2, y+2, m.format(finance.projected_total_expense.change_budget_year.total, 3));</span>
01667         <span class="comment">//## chea 250899</span>
01668         font_chart_blue_sm.right_put( xColumn2, y+2, m.format(finance.projected_total_expense.change_budget_year.total, 24));
01669 
01670         font_chart_blue_sm.right_put( xColumn3, y+2, m.format(finance.budget_total_expense.total, 2));
01671         <span class="comment">//                      font_chart_blue_sm.right_put( xColumn4, y+2, m.format(finance.projected_total_expense.change_last_year.total, 3));</span>
01672         <span class="comment">//## chea 250899</span>
01673         font_chart_blue_sm.right_put( xColumn4, y+2, m.format(finance.projected_total_expense.change_last_year.total, 24));
01674 
01675         font_chart_blue_sm.right_put( xColumn5, y+2, m.format(finance.projected_total_expense.this_year.total, 2));
01676     }
01677     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>+8) {
01678         font_chartsm.disp( x, y,<span class="stringliteral">"Surplus (deficit)"</span>, xColumn2);
01679 
01680         <span class="keywordflow">if</span>(finance.last_year.surplus_deficit&gt;0)
01681             font_chart_green_sm.right_put( xColumn1, y+2, m.format(finance.last_year.surplus_deficit, 2));
01682         <span class="keywordflow">else</span>
01683             font_chart_red_sm.right_put( xColumn1, y+2, m.format(finance.last_year.surplus_deficit, 2));
01684 
01685         <span class="keywordflow">if</span>(finance.budget_year.surplus_deficit&gt;0)
01686             font_chart_green_sm.right_put( xColumn3, y+2, m.format(finance.budget_year.surplus_deficit, 2));
01687         <span class="keywordflow">else</span>
01688             font_chart_red_sm.right_put( xColumn3, y+2, m.format(finance.budget_year.surplus_deficit, 2));
01689 
01690         <span class="keywordflow">if</span>(finance.this_year.surplus_deficit&gt;0)
01691             font_chart_green_sm.right_put( xColumn5, y+2, m.format(finance.this_year.surplus_deficit, 2));
01692         <span class="keywordflow">else</span>
01693             font_chart_red_sm.right_put( xColumn5, y+2, m.format(finance.this_year.surplus_deficit, 2));
01694     }
01695     <span class="comment">//## fred 990519</span>
01696 }
01697 <span class="preprocessor">#endif</span>
01698 <span class="preprocessor"></span><span class="comment">//------ End of static function fin_rep_case4 --------//</span>
01699 
01700 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01701 <span class="preprocessor"></span><span class="comment">//------ Begin of static function export_fin_rep_case4 --------//</span>
01702 <span class="comment">//</span>
01703 <span class="comment">// write fin_rep_case4 to a text file</span>
01704 <span class="comment">//</span>
01705 <span class="keywordtype">void</span> export_fin_rep_case4( <a class="code" href="classFile.html">File</a> *filePtr ) {
01706     <span class="comment">// year no</span>
01707     <span class="keywordtype">int</span> tyear = info.financial_year();
01708     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Budget vs Actual"</span> ); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
01709     <span class="comment">// write year label</span>
01710     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// item revenue/expenditure item field</span>
01711     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Initial"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01712     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, m.format(tyear-1, 16)); <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">" actual"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01713     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Change"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01714     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, m.format(tyear, 16)); <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">" budget"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01715     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Change"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01716     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, m.format(tyear, 16)); <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">" actual"</span>); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
01717     <span class="comment">// write revenue label</span>
01718     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Revenue"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01719     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// blank initial</span>
01720     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// blank last year actual</span>
01721     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// blank change</span>
01722     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// blank this year budget</span>
01723     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// blank change</span>
01724     <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);                <span class="comment">// blank this year actual</span>
01725 
01726     <span class="comment">// revenue</span>
01727     <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>; ++i ) {
01728         <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, game_str_res.financial_report_str(i)); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01729         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.initial_revenue_array[i].total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01730         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.revenue_array[i].total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01731         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_revenue_array[i].change_budget_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01732         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.budget_revenue_array[i].total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01733         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_revenue_array[i].change_last_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01734         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_revenue_array[i].this_year.total); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
01735     }
01736     <span class="comment">// total revenue</span>
01737     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"  Total sources of funds"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01738     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.initial_total_revenue_total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01739     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.total_revenue.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01740     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_revenue.change_budget_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01741     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.budget_total_revenue.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01742     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_revenue.change_last_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01743     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_revenue.this_year.total); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
01744 
01745     <span class="comment">// expenditure label</span>
01746     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"Expenditures"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01747     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// blank initial</span>
01748     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// blank last year actual</span>
01749     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// blank change</span>
01750     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// blank this year budget</span>
01751     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// blank change</span>
01752     <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);                <span class="comment">// blank this year actual</span>
01753 
01754     <span class="comment">// expenditure item</span>
01755     <span class="keywordflow">for</span>( i=0; i &lt; <a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>; ++i ) {
01756         <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, game_str_res.financial_report_str(i+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>)); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01757 
01758         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.initial_expense_array[i].total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01759         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.expense_array[i].total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01760         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_expense_array[i].change_budget_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01761         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.budget_expense_array[i].total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01762         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_expense_array[i].change_last_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01763         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_expense_array[i].this_year.total); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
01764 
01765         <span class="keywordflow">if</span>( i==<a class="code" href="Ofinance_8h.html#a102a42">OPERATING_EXPENSE_ITEM_COUNT</a>-1 ) {
01766             <span class="comment">// total operatring expenditure</span>
01767             <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"  Total operating expenditures"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01768             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.initial_total_operating_expense.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01769             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.total_operating_expense.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01770             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_operating_expense.change_budget_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01771             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.budget_total_operating_expense.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01772             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_operating_expense.change_last_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01773             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_operating_expense.this_year.total); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
01774         }
01775     }
01776 
01777     <span class="comment">// total use of fund</span>
01778     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"  Total uses of funds"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01779     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.initial_total_expense.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01780     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.total_expense.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01781     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_expense.change_budget_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01782     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.budget_total_expense.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01783     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_expense.change_last_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01784     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_expense.this_year.total); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
01785 
01786     <span class="comment">// surplus</span>
01787     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"  Surplus (deficit)"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01788     <span class="comment">// blank initial</span>
01789     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.initial_last_year.surplus_deficit); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01790     <span class="comment">// blank last year actual</span>
01791     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.last_year.surplus_deficit); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01792     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// blank change</span>
01793     <span class="comment">// blank this year budget</span>
01794     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.budget_year.surplus_deficit); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
01795     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);                 <span class="comment">// blank change</span>
01796     <span class="comment">// blank this year actual</span>
01797     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.this_year.surplus_deficit); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
01798 }
01799 
01800 <span class="comment">//------ End of static function export_fin_rep_case4 --------//</span>
01801 <span class="preprocessor">#endif</span>
01802 <span class="preprocessor"></span>
01803 <span class="comment">//------ Begin of static function fin_rep_case5 --------//</span>
01804 <span class="comment">// Case 5: BALANCE SHEET &amp;&amp; LAST YEAR</span>
01805 <span class="comment">// recNo -- record no. (row no.) to be displayed</span>
01806 <span class="comment">// x,y  -- left top position of the display region</span>
01807 <span class="comment">//</span>
01808 <span class="keyword">static</span> <span class="keywordtype">void</span> fin_rep_case5(<span class="keywordtype">int</span> recNo,<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y) {
01809     <span class="keywordtype">int</span> i;
01810     <span class="keywordtype">int</span> xColumn1=x+305, xColumn2=440, xColumn3=510, xColumn4=590, xColumn5=680;
01811     <span class="comment">//          if(recNo==1)</span>
01812     <span class="comment">//          {</span>
01813     <span class="comment">//                  font_chart_blue_sm.disp( BS_TAB1, y, "Balance sheet", BS_TAB1+200 );</span>
01814     <span class="comment">//          }</span>
01815 
01816     <span class="comment">// Show title //</span>
01817     <span class="keywordflow">if</span>(recNo==1) {
01818         <a class="code" href="classString.html">String</a> str;
01819         <span class="comment">// fix in version 2</span>
01820         <span class="comment">// int tyear=(int)(info.game_year+(info.game_month-9.0)/12);</span>
01821         <span class="keywordtype">int</span> tyear=info.financial_year();
01823         <span class="keywordflow">if</span>(sys.view_mode==<a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a>)tyear++;
01824 
01825         str=<span class="stringliteral">"Previous Year : Year "</span>;
01826         str+=m.format(tyear-1,4);
01827 
01828         font_charts.put( xColumn1-50, y+2, str.<a class="code" href="classString.html#m0">str_buf</a>);
01829         <span class="keywordflow">return</span>;
01830     }
01831     recNo--;
01832 
01833     <span class="comment">// Shift the page a row upper.</span>
01834     recNo++;
01835     <span class="keywordflow">if</span>(recNo==2) {
01836         font_chart_red_sm.disp( <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>, y+2, <span class="stringliteral">"Assets"</span>, <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>+200 );
01837     }
01838     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;2)&amp;&amp;(recNo&lt;=<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+2)) {
01839         i=recNo-3;
01840 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01841 <span class="preprocessor"></span>        <span class="keywordflow">if</span> ( i == 3 )
01842             i = 5;
01843         <span class="keywordflow">else</span>
01844             <span class="keywordflow">if</span> ( i&gt;3 &amp;&amp; i&lt;6 )
01845                 i -= 1;
01846 <span class="preprocessor">#endif</span>
01847 <span class="preprocessor"></span>        font_chartsm.disp( <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>, y+2, game_str_res.balance_sheet_str(i),  <a class="code" href="ofin__rep_8cpp.html#a37a19">BS_TAB2</a>);
01848         font_chartsm.right_put( <a class="code" href="ofin__rep_8cpp.html#a37a19">BS_TAB2</a>, y+2, m.format(finance.last_year.asset_array[i], 2));
01849     }
01850     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+4) {
01851         font_chart_red_sm.disp( <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>, y+2, <span class="stringliteral">"Liabilities"</span>, <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>+200 );
01852     }
01853     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;=<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+5)&amp;&amp;(recNo&lt;<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+5+<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>)) {
01854         i=recNo-5-<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>;
01855         font_chartsm.disp( <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>, y+2, game_str_res.balance_sheet_str(i+<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>),  <a class="code" href="ofin__rep_8cpp.html#a37a19">BS_TAB2</a>);
01856         font_chartsm.right_put( <a class="code" href="ofin__rep_8cpp.html#a37a19">BS_TAB2</a>, y+2, m.format(finance.last_year.liability_array[i], 2));
01857     }
01858     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>+6) {
01859         font_chart_blue_sm.disp( <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>, y+2, <span class="stringliteral">"Fund balances"</span>, <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>+200 );
01860         font_chart_blue_sm.right_put( <a class="code" href="ofin__rep_8cpp.html#a37a19">BS_TAB2</a>, y+2,
01861                                       m.format(finance.last_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-
01862                                                finance.last_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1], 2));
01863 
01864     }
01865     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>+7) {
01866         font_chart_blue_sm.disp( <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>, y+2, <span class="stringliteral">"Total liabilities and fund balance"</span>, <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>+220);
01867         font_chart_blue_sm.right_put( <a class="code" href="ofin__rep_8cpp.html#a37a19">BS_TAB2</a>, y+2,
01868                                       m.format(finance.last_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1], 2));
01869     }
01870 }
01871 
01872 <span class="comment">//------ End of static function fin_rep_case5 --------//</span>
01873 
01874 <span class="comment">//------ Begin of static function fin_rep_case6 --------//</span>
01875 <span class="comment">// Case 6: BALANCE SHEET &amp;&amp; THIS YEAR</span>
01876 <span class="comment">// recNo -- record no. (row no.) to be displayed</span>
01877 <span class="comment">// x,y  -- left top position of the display region</span>
01878 <span class="comment">//</span>
01879 <span class="keyword">static</span> <span class="keywordtype">void</span> fin_rep_case6(<span class="keywordtype">int</span> recNo,<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y) {
01880     <span class="keywordtype">int</span> i;
01881     <span class="keywordtype">int</span> xColumn1=x+305, xColumn2=440, xColumn3=510, xColumn4=590, xColumn5=680;
01882 
01883     <span class="comment">// Show title //</span>
01884     <span class="keywordflow">if</span>(recNo==1) {
01885         <a class="code" href="classString.html">String</a> str;
01886         <span class="comment">// fix in version 2</span>
01887         <span class="comment">// int tyear=(int)(info.game_year+(info.game_month-9.0)/12);</span>
01888         <span class="keywordtype">int</span> tyear=info.financial_year();
01889         str=<span class="stringliteral">"Present Year : Year "</span>;
01890         <span class="comment">//                      str+=m.format(tyear,16);   //## chea 061199</span>
01891         str+=m.format(tyear,4);
01892 
01893         <span class="comment">//                      str+="-";</span>
01894         <span class="comment">//                      str+=m.format(tyear+1,16); //## chea 061199</span>
01895 
01896         font_charts.put( xColumn1-50, y+2, str.<a class="code" href="classString.html#m0">str_buf</a>);
01897         <span class="keywordflow">return</span>;
01898     }
01899     <span class="keywordflow">if</span>(recNo==2) {
01900         <span class="comment">//</span>
01901         font_chart_red_sm.disp( <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>, y+2, <span class="stringliteral">"Assets"</span>, <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>+200 );
01902     }
01903     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;2)&amp;&amp;(recNo&lt;=<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+2)) {
01904         i=recNo-3;
01905 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01906 <span class="preprocessor"></span>        <span class="keywordflow">if</span> ( i == 3 )
01907             i = 5;
01908         <span class="keywordflow">else</span>
01909             <span class="keywordflow">if</span> ( i&gt;3 &amp;&amp; i&lt;6 )
01910                 i -= 1;
01911 <span class="preprocessor">#endif</span>
01912 <span class="preprocessor"></span>        font_chartsm.disp( <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>, y+2, game_str_res.balance_sheet_str(i),  <a class="code" href="ofin__rep_8cpp.html#a37a19">BS_TAB2</a>);
01913         <span class="comment">//</span>
01914         font_chartsm.right_put( <a class="code" href="ofin__rep_8cpp.html#a37a19">BS_TAB2</a>, y+2, m.format(finance.this_year.asset_array[i], 2));
01915     }
01916     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+4) {
01917         <span class="comment">//</span>
01918         font_chart_red_sm.disp( <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>, y+2, <span class="stringliteral">"Liabilities"</span>, <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>+200 );
01919     }
01920     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;=<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+5)&amp;&amp;(recNo&lt;<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+5+<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>)) {
01921         i=recNo-5-<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>;
01922         font_chartsm.disp( <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>, y+2, game_str_res.balance_sheet_str(i+<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>),  <a class="code" href="ofin__rep_8cpp.html#a37a19">BS_TAB2</a>);
01923         font_chartsm.right_put( <a class="code" href="ofin__rep_8cpp.html#a37a19">BS_TAB2</a>, y+2, m.format(finance.this_year.liability_array[i], 2));
01924     }
01925     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>+6) {
01926         font_chart_blue_sm.disp( <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>, y+2, <span class="stringliteral">"Fund balances"</span>, <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>+200 );
01927         font_chart_blue_sm.right_put( <a class="code" href="ofin__rep_8cpp.html#a37a19">BS_TAB2</a>, y+2, m.format(finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-
01928                                                              finance.this_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1], 2));
01929 
01930     }
01931     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>+7) {
01932         font_chart_blue_sm.disp( <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>, y+2, <span class="stringliteral">"Total liabilities and fund balance"</span>, <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>+220);
01933         font_chart_blue_sm.right_put( <a class="code" href="ofin__rep_8cpp.html#a37a19">BS_TAB2</a>, y+2, m.format(finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1], 2));
01934     }
01935 }
01936 
01937 <span class="comment">//------ End of static function fin_rep_case6 --------//</span>
01938 
01939 <span class="comment">//------ Begin of static function fin_rep_case7 --------//</span>
01940 <span class="comment">// Case 7: BALANCE SHEET &amp;&amp; NEXT YEAR</span>
01941 <span class="comment">// recNo -- record no. (row no.) to be displayed</span>
01942 <span class="comment">// x,y  -- left top position of the display region</span>
01943 <span class="comment">//</span>
01944 <span class="keyword">static</span> <span class="keywordtype">void</span> fin_rep_case7(<span class="keywordtype">int</span> recNo,<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y) {
01945     <span class="keywordtype">int</span> i;
01946     <span class="keywordtype">int</span> xColumn1=x+305, xColumn2=440, xColumn3=510, xColumn4=590, xColumn5=680;
01947 
01948     <span class="comment">// Show title //</span>
01949     <span class="keywordflow">if</span>(recNo==1) {
01950         <a class="code" href="classString.html">String</a> str;
01951         <span class="comment">// fix in version2</span>
01952         <span class="comment">// int tyear=(int)(info.game_year+(info.game_month-9.0)/12);</span>
01953         <span class="keywordtype">int</span> tyear=info.financial_year();
01954         str=<span class="stringliteral">"Next Year : Year "</span>;
01955         <span class="comment">//                      str+=m.format(tyear+1,16);  //## chea 061199</span>
01956         str+=m.format(tyear+1,4);
01957 
01958         <span class="comment">//                      str+="-";</span>
01959         <span class="comment">//                      str+=m.format(tyear+2,16);  //## chea 061199</span>
01960 
01961         font_charts.put( xColumn1-50, y+2, str.<a class="code" href="classString.html#m0">str_buf</a>);
01962         <span class="keywordflow">return</span>;
01963     }
01964     <span class="keywordflow">if</span>(recNo==2) {
01965         font_chart_red_sm.disp( <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>, y+2, <span class="stringliteral">"Assets"</span>, <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>+200 );
01966     }
01967     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;2)&amp;&amp;(recNo&lt;=<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+2)) {
01968         i=recNo-3;
01969 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01970 <span class="preprocessor"></span>        <span class="keywordflow">if</span> ( i == 3 )
01971             i = 5;
01972         <span class="keywordflow">else</span>
01973             <span class="keywordflow">if</span> ( i &gt; 3 &amp;&amp; i &lt; 6 )
01974                 i -= 1;
01975 <span class="preprocessor">#endif</span>
01976 <span class="preprocessor"></span>        font_chartsm.disp( <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>, y+2, game_str_res.balance_sheet_str(i),  <a class="code" href="ofin__rep_8cpp.html#a37a19">BS_TAB2</a>);
01977         font_chartsm.right_put( <a class="code" href="ofin__rep_8cpp.html#a37a19">BS_TAB2</a>, y+2, m.format(finance.next_year.asset_array[i], 2));
01978     }
01979     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+4) {
01980         font_chart_red_sm.disp( <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>, y+2, <span class="stringliteral">"Liabilities"</span>, <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>+200 );
01981     }
01982     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;=<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+5)&amp;&amp;(recNo&lt;<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+5+<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>)) {
01983         i=recNo-5-<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>;
01984         font_chartsm.disp( <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>, y+2, game_str_res.balance_sheet_str(i+<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>),  <a class="code" href="ofin__rep_8cpp.html#a37a19">BS_TAB2</a>);
01985         font_chartsm.right_put( <a class="code" href="ofin__rep_8cpp.html#a37a19">BS_TAB2</a>, y+2, m.format(finance.next_year.liability_array[i], 2));
01986     }
01987     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>+6) {
01988         font_chart_blue_sm.disp( <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>, y+2, <span class="stringliteral">"Fund balances"</span>, <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>+200 );
01989         font_chart_blue_sm.right_put( <a class="code" href="ofin__rep_8cpp.html#a37a19">BS_TAB2</a>, y+2, m.format(finance.next_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-
01990                                                              finance.next_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1], 2));
01991 
01992     }
01993     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>+7) {
01994         font_chart_blue_sm.disp( <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>, y+2, <span class="stringliteral">"Total liabilities and fund balance"</span>, <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>+220 );
01995         font_chart_blue_sm.right_put( <a class="code" href="ofin__rep_8cpp.html#a37a19">BS_TAB2</a>, y+2, m.format(finance.next_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1], 2));
01996     }
01997 }
01998 
01999 <span class="comment">//------ End of static function fin_rep_case7 --------//</span>
02000 
02001 <span class="comment">//------ Begin of static function fin_rep_case8 --------//</span>
02002 <span class="comment">// Case 8: BALANCE SHEET &amp;&amp; THREE YEAR</span>
02003 <span class="comment">// recNo -- record no. (row no.) to be displayed</span>
02004 <span class="comment">// x,y  -- left top position of the display region</span>
02005 <span class="comment">//</span>
02006 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
02007 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">void</span> fin_rep_case8(<span class="keywordtype">int</span> recNo,<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y) {
02008     <span class="keywordtype">int</span> i;
02009     <span class="keywordtype">int</span> xColumn1=395, xColumn2=465, xColumn3=545, xColumn4=615, xColumn5=695,xColumn6=745;
02010 
02011     <span class="comment">// ##### Begin MArco ##### //</span>
02012     <span class="keywordtype">int</span> xColumn0 = 315;
02013     <span class="comment">// ##### End Marco ##### //</span>
02014 
02015     <span class="comment">// Show title //</span>
02016     <span class="keywordflow">if</span>(recNo==1) {
02017         font_charts.disp( xColumn1-60, y+2, <span class="stringliteral">"Three-Year Balance Sheets"</span>, xColumn4+90 );
02018         <span class="keywordflow">return</span>;
02019     }
02020     <span class="comment">//          recNo--;</span>
02021 
02022     <span class="keywordflow">if</span>(recNo==2) {
02023         font_chart_blue_sm.disp( x, y, <span class="stringliteral">""</span>, x+200 );
02024         <span class="comment">// fix in version 2</span>
02025         <span class="comment">// int tyear=(int)(info.game_year+(info.game_month-9.0)/12);</span>
02026         <span class="keywordtype">int</span> tyear=info.financial_year();
02027         <span class="comment">/*</span>
02028 <span class="comment">          String s1="Yr. ";             //## chea 061199</span>
02029 <span class="comment">          s1+=m.format(tyear-1,16);</span>
02030 <span class="comment">          s1+="-";</span>
02031 <span class="comment">          s1+=m.format(tyear,16);</span>
02032 <span class="comment">          font_chart_red_sm.disp( xColumn1-50, y+2, s1.str_buf, xColumn1+60 );</span>
02033 <span class="comment"></span>
02034 <span class="comment">          s1="Yr. ";                    //## chea 061199</span>
02035 <span class="comment">          s1+=m.format(tyear,16);</span>
02036 <span class="comment">          s1+="-";</span>
02037 <span class="comment">          s1+=m.format(tyear+1,16);</span>
02038 <span class="comment">          font_chart_red_sm.disp( xColumn3-50, y+2, s1.str_buf, xColumn3+60 );</span>
02039 <span class="comment"></span>
02040 <span class="comment">          s1="Yr. ";                    //## chea 061199</span>
02041 <span class="comment">          s1+=m.format(tyear+1,16);</span>
02042 <span class="comment">          s1+="-";</span>
02043 <span class="comment">          s1+=m.format(tyear+2,16);</span>
02044 <span class="comment">          font_chart_red_sm.disp( xColumn5-50, y+2, s1.str_buf, xColumn6 );</span>
02045 <span class="comment">        */</span>
02046 
02047         <a class="code" href="classString.html">String</a> s1,s2,s3;                              <span class="comment">//## chea 061199 2.5.1</span>
02048         s1+=m.format(tyear-1,16);
02049         <span class="comment">//font_chart_red_sm.disp( xColumn1-35, y+2, s1.str_buf, xColumn1+60 );</span>
02050         font_chart_red_sm.disp( xColumn0-35, y+2, s1.<a class="code" href="classString.html#m0">str_buf</a>, xColumn0+60 );
02051 
02052         s2+=m.format(tyear,16);
02053         <span class="comment">//font_chart_red_sm.disp( xColumn3-35, y+2, s2.str_buf, xColumn3+60 );</span>
02054         font_chart_red_sm.disp( xColumn2-35, y+2, s2.<a class="code" href="classString.html#m0">str_buf</a>, xColumn2+60 );
02055 
02056         s3+=m.format(tyear+1,16);
02057         font_chart_red_sm.disp( xColumn5-35, y+2, s3.<a class="code" href="classString.html#m0">str_buf</a>, xColumn6 );
02058 
02059         <span class="comment">// ##### Begin Marco ##### //</span>
02060         font_chart_purple_sm.disp( xColumn3-35, y+2, <span class="stringliteral">"Initial"</span>, xColumn4+60 );
02061         <span class="comment">// #### End Marco #####//</span>
02062 
02063     }
02064     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==3) {
02065         font_chart_red_sm.disp( x, y+2, <span class="stringliteral">"Assets"</span>, x+200 );
02066 
02067         <span class="comment">// ##### Begin Marco ##### //</span>
02068         font_chart_red_sm.disp( xColumn2-45, y+2, <span class="stringliteral">"(Current)"</span>, xColumn2+60 );
02069         <span class="comment">// ##### End Marco ##### //</span>
02070     }
02071     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;3)&amp;&amp;(recNo&lt;=<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+3)) {
02072         i=recNo-4;
02073 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
02074 <span class="preprocessor"></span>        <span class="keywordflow">if</span> ( i == 3 )                                 <span class="comment">// should display value of quasi endowment</span>
02075             i = 5;
02076         <span class="keywordflow">else</span>
02077             <span class="keywordflow">if</span> ( i &gt; 3 &amp;&amp; i &lt; 6 )
02078                 i -= 1;
02079 <span class="preprocessor">#endif</span>
02080 <span class="preprocessor"></span>        font_chartsm.disp( x, y+2, game_str_res.balance_sheet_str(i),  xColumn1);
02081         <span class="comment">//                      font_chartsm.right_put( xColumn1, y+2, m.format(finance.last_year.asset_array[i], 2));</span>
02082         <span class="comment">//                      font_chartsm.right_put( xColumn3, y+2, m.format(finance.this_year.asset_array[i], 2));</span>
02083         font_chartsm.right_put( xColumn0, y+2, m.format(finance.last_year.asset_array[i], 2));
02084         font_chartsm.right_put( xColumn2, y+2, m.format(finance.this_year.asset_array[i], 2));
02085         font_chartsm.right_put( xColumn5, y+2, m.format(finance.next_year.asset_array[i], 2));
02086 
02087         <span class="comment">// ##### Begin Marco ##### //</span>
02088         font_chart_purple_sm.right_put( xColumn3, y+2, m.format(finance.initial_last_year.asset_array[i], 2));
02089         <span class="comment">// ##### End Marco ##### //</span>
02090         <span class="comment">/* //## chea 250899</span>
02091 <span class="comment">           font_chartsm.right_put( xColumn2, y+2,</span>
02092 <span class="comment">           m.format(100*(finance.this_year.asset_array[i]-finance.last_year.asset_array[i])</span>
02093 <span class="comment">           /finance.last_year.asset_array[i],</span>
02094 <span class="comment">           3));</span>
02095 <span class="comment">           font_chartsm.right_put( xColumn4, y+2,</span>
02096 <span class="comment">           m.format(100*(finance.next_year.asset_array[i]-finance.this_year.asset_array[i])</span>
02097 <span class="comment">           /finance.this_year.asset_array[i],</span>
02098 <span class="comment">           3));</span>
02099 <span class="comment">        */</span>
02100 
02101         <span class="comment">//                      font_chartsm.right_put( xColumn2, y+2,</span>
02102         font_chartsm.right_put( xColumn1, y+2,
02103                                 m.format(100*math.safe_divide((finance.this_year.asset_array[i]-finance.last_year.asset_array[i])
02104                                                               ,finance.last_year.asset_array[i]),
02105                                          24));                                       <span class="comment">//## chea 250899</span>
02106 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
02107 <span class="preprocessor"></span>        font_chartsm.right_put( xColumn4, y+2,
02108                                 m.format(100*math.safe_divide((finance.next_year.asset_array[i]-finance.last_year.asset_array[i])
02109                                                               ,finance.last_year.asset_array[i]),
02110                                          24));
02111 <span class="preprocessor">#else</span>
02112 <span class="preprocessor"></span>        font_chartsm.right_put( xColumn4, y+2,
02113                                 m.format(100*(finance.next_year.asset_array[i]-finance.this_year.asset_array[i])
02114                                          /finance.this_year.asset_array[i],
02115                                          24));                                       <span class="comment">//## chea 250899</span>
02116 <span class="preprocessor">#endif</span>
02117 <span class="preprocessor"></span>
02118     }
02119     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+4) {
02120         font_chart_red_sm.disp( x, y+2, <span class="stringliteral">"Liabilities"</span>, x+200 );
02121     }
02122     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;=<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+5)&amp;&amp;(recNo&lt;<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+5+<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>)) {
02123         i=recNo-5-<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>;
02124         font_chartsm.disp( x, y+2, game_str_res.balance_sheet_str(i+<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>),  xColumn1);
02125         <span class="comment">//                      font_chartsm.right_put( xColumn1, y+2, m.format(finance.last_year.liability_array[i], 2));</span>
02126         <span class="comment">//                      font_chartsm.right_put( xColumn3, y+2, m.format(finance.this_year.liability_array[i], 2));</span>
02127         font_chartsm.right_put( xColumn0, y+2, m.format(finance.last_year.liability_array[i], 2));
02128         font_chartsm.right_put( xColumn2, y+2, m.format(finance.this_year.liability_array[i], 2));
02129         font_chartsm.right_put( xColumn5, y+2, m.format(finance.next_year.liability_array[i], 2));
02130 
02131         <span class="comment">// ##### Begin Marco ##### //</span>
02132         font_chart_purple_sm.right_put( xColumn3, y+2, m.format(finance.initial_last_year.liability_array[i], 2));
02133         <span class="comment">// ##### End Marco ##### //</span>
02134 
02135         <span class="comment">/*  //## chea 250899</span>
02136 <span class="comment">            font_chartsm.right_put( xColumn2, y+2,</span>
02137 <span class="comment">            m.format(100*(finance.this_year.liability_array[i]-finance.last_year.liability_array[i])</span>
02138 <span class="comment">            /finance.last_year.liability_array[i],</span>
02139 <span class="comment">            3));</span>
02140 <span class="comment">            font_chartsm.right_put( xColumn4, y+2,</span>
02141 <span class="comment">            m.format(100*(finance.next_year.liability_array[i]-finance.this_year.liability_array[i])</span>
02142 <span class="comment">            /finance.this_year.liability_array[i],</span>
02143 <span class="comment">            3));</span>
02144 <span class="comment">        */</span>
02145 
02146         <span class="comment">//                      font_chartsm.right_put( xColumn2, y+2,</span>
02147         font_chartsm.right_put( xColumn1, y+2,
02148                                 m.format(100*(finance.this_year.liability_array[i]-finance.last_year.liability_array[i])
02149                                          /finance.last_year.liability_array[i],
02150                                          24));                                       <span class="comment">//## chea 250899</span>
02151         font_chartsm.right_put( xColumn4, y+2,
02152                                 m.format(100*(finance.next_year.liability_array[i]-finance.this_year.liability_array[i])
02153                                          /finance.this_year.liability_array[i],
02154                                          24));                                       <span class="comment">//## chea 250899</span>
02155 
02156     }
02157     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>+6) {
02158         font_chart_blue_sm.disp( x, y+2, <span class="stringliteral">"Fund balances"</span>, x+200 );
02159         <span class="comment">//                      font_chart_blue_sm.right_put( xColumn1, y+2, m.format(finance.last_year.asset_array[ASSET_ITEM_COUNT-1]-</span>
02160         font_chart_blue_sm.right_put( xColumn0, y+2, m.format(finance.last_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-
02161                                                               finance.last_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1], 2));
02162         <span class="comment">//                      font_chart_blue_sm.right_put( xColumn3, y+2, m.format(finance.this_year.asset_array[ASSET_ITEM_COUNT-1]-</span>
02163         font_chart_blue_sm.right_put( xColumn2, y+2, m.format(finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-
02164                                                               finance.this_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1], 2));
02165         font_chart_blue_sm.right_put( xColumn5, y+2, m.format(finance.next_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-
02166                                                               finance.next_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1], 2));
02167 
02168         <span class="comment">// ##### Begin Marco ##### //</span>
02169         font_chart_purple_sm.right_put( xColumn3, y+2, m.format(finance.initial_last_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-
02170                                                                 finance.initial_last_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1], 2));
02171         <span class="comment">// ##### End Marco ##### //</span>
02172 
02173         <span class="comment">/*  //## chea 250899</span>
02174 <span class="comment">            font_chart_blue_sm.right_put( xColumn2, y+2,</span>
02175 <span class="comment">            m.format(100*(</span>
02176 <span class="comment">            finance.this_year.asset_array[ASSET_ITEM_COUNT-1]-finance.this_year.liability_array[LIABILITY_ITEM_COUNT-1]-</span>
02177 <span class="comment">            finance.last_year.asset_array[ASSET_ITEM_COUNT-1]+finance.last_year.liability_array[LIABILITY_ITEM_COUNT-1])</span>
02178 <span class="comment">            /(finance.this_year.asset_array[ASSET_ITEM_COUNT-1]-finance.this_year.liability_array[LIABILITY_ITEM_COUNT-1]),</span>
02179 <span class="comment">            //                          finance.this_year.liability_array[LIABILITY_ITEM_COUNT-1]-finance.last_year.liability_array[LIABILITY_ITEM_COUNT-1])</span>
02180 <span class="comment">            //                          /finance.last_year.liability_array[LIABILITY_ITEM_COUNT-1],</span>
02181 <span class="comment">            3));</span>
02182 <span class="comment">            font_chart_blue_sm.right_put( xColumn4, y+2,</span>
02183 <span class="comment">            m.format(100*(</span>
02184 <span class="comment">            finance.next_year.asset_array[ASSET_ITEM_COUNT-1]-finance.next_year.liability_array[LIABILITY_ITEM_COUNT-1]-</span>
02185 <span class="comment">            finance.this_year.asset_array[ASSET_ITEM_COUNT-1]+finance.this_year.liability_array[LIABILITY_ITEM_COUNT-1])</span>
02186 <span class="comment">            /(finance.next_year.asset_array[ASSET_ITEM_COUNT-1]-finance.next_year.liability_array[LIABILITY_ITEM_COUNT-1]),</span>
02187 <span class="comment">            //                          finance.next_year.liability_array[LIABILITY_ITEM_COUNT-1]-finance.this_year.liability_array[LIABILITY_ITEM_COUNT-1])</span>
02188 <span class="comment">            //                          /finance.this_year.liability_array[LIABILITY_ITEM_COUNT-1],</span>
02189 <span class="comment">            3));</span>
02190 <span class="comment">        */</span>
02191 
02192         <span class="comment">//                      font_chart_blue_sm.right_put( xColumn2, y+2,</span>
02193         font_chart_blue_sm.right_put( xColumn1, y+2,
02194                                       m.format(100*(
02195                                           finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-finance.this_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1]-
02196                                           finance.last_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]+finance.last_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1])
02197                                                /(finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-finance.this_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1]),
02198                                                24));                                       <span class="comment">//## chea 250899</span>
02199         font_chart_blue_sm.right_put( xColumn4, y+2,
02200                                       m.format(100*(
02201                                           finance.next_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-finance.next_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1]-
02202                                           finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]+finance.this_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1])
02203                                                /(finance.next_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-finance.next_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1]),
02204                                                24));                                       <span class="comment">//## chea 250899</span>
02205 
02206     }
02207     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>+7) {
02208         font_chart_blue_sm.disp( x, y+2, <span class="stringliteral">"Total liabilities and fund balance"</span>, <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>+220);
02209         <span class="comment">//                      font_chart_blue_sm.right_put( xColumn1, y+2, m.format(finance.last_year.asset_array[ASSET_ITEM_COUNT-1], 2));</span>
02210         <span class="comment">//                      font_chart_blue_sm.right_put( xColumn3, y+2, m.format(finance.this_year.asset_array[ASSET_ITEM_COUNT-1], 2));</span>
02211         font_chart_blue_sm.right_put( xColumn0, y+2, m.format(finance.last_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1], 2));
02212         font_chart_blue_sm.right_put( xColumn2, y+2, m.format(finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1], 2));
02213         font_chart_blue_sm.right_put( xColumn5, y+2, m.format(finance.next_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1], 2));
02214         <span class="comment">//                      font_chart_blue_sm.right_put( xColumn2, y+2,</span>
02215         <span class="comment">//                              m.format(100*(finance.this_year.asset_array[ASSET_ITEM_COUNT-1]-finance.last_year.asset_array[ASSET_ITEM_COUNT-1])</span>
02216         <span class="comment">//                              /finance.last_year.asset_array[ASSET_ITEM_COUNT-1],</span>
02217         <span class="comment">//                              3));</span>
02218 
02219         <span class="comment">// ##### Begin Marco ##### //</span>
02220         font_chart_purple_sm.right_put( xColumn3, y+2, m.format(finance.initial_last_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1], 2));
02221         <span class="comment">// ##### End Marco ##### //</span>
02222 
02223         <span class="comment">//                      font_chart_blue_sm.right_put( xColumn2, y+2,</span>
02224         font_chart_blue_sm.right_put( xColumn1, y+2,
02225                                       m.format(100*(finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-finance.last_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1])
02226                                                /finance.last_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1],
02227                                                24));                                       <span class="comment">//## chea 250899</span>
02228 
02229         <span class="comment">//                      font_chart_blue_sm.right_put( xColumn4, y+2,</span>
02230         <span class="comment">//                              m.format(100*(finance.next_year.asset_array[ASSET_ITEM_COUNT-1]-finance.this_year.asset_array[ASSET_ITEM_COUNT-1])</span>
02231         <span class="comment">//                              /finance.this_year.asset_array[ASSET_ITEM_COUNT-1],</span>
02232         <span class="comment">//                              3));</span>
02233 
02234         font_chart_blue_sm.right_put( xColumn4, y+2,
02235                                       m.format(100*(finance.next_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1])
02236                                                /finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1],
02237                                                24));                                       <span class="comment">//## chea 250899</span>
02238 
02239     }
02240 }
02241 
02242 <span class="preprocessor">#else</span>
02243 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">void</span> fin_rep_case8(<span class="keywordtype">int</span> recNo,<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y) {
02244     <span class="keywordtype">int</span> i;
02245     <span class="keywordtype">int</span> xColumn1=395, xColumn2=465, xColumn3=545, xColumn4=615, xColumn5=695,xColumn6=745;
02246 
02247     <span class="comment">// Show title //</span>
02248     <span class="keywordflow">if</span>(recNo==1) {
02249         font_charts.disp( xColumn1-60, y+2, <span class="stringliteral">"Three-Year Balance Sheets"</span>, xColumn4+90 );
02250         <span class="keywordflow">return</span>;
02251     }
02252     <span class="comment">//          recNo--;</span>
02253 
02254     <span class="keywordflow">if</span>(recNo==2) {
02255         font_chart_blue_sm.disp( x, y, <span class="stringliteral">""</span>, x+200 );
02256         <span class="keywordtype">int</span> tyear=(int)(info.game_year+(info.game_month-9.0)/12);
02257         <span class="comment">/*</span>
02258 <span class="comment">          String s1="Yr. ";             //## chea 061199</span>
02259 <span class="comment">          s1+=m.format(tyear-1,16);</span>
02260 <span class="comment">          s1+="-";</span>
02261 <span class="comment">          s1+=m.format(tyear,16);</span>
02262 <span class="comment">          font_chart_red_sm.disp( xColumn1-50, y+2, s1.str_buf, xColumn1+60 );</span>
02263 <span class="comment"></span>
02264 <span class="comment">          s1="Yr. ";                    //## chea 061199</span>
02265 <span class="comment">          s1+=m.format(tyear,16);</span>
02266 <span class="comment">          s1+="-";</span>
02267 <span class="comment">          s1+=m.format(tyear+1,16);</span>
02268 <span class="comment">          font_chart_red_sm.disp( xColumn3-50, y+2, s1.str_buf, xColumn3+60 );</span>
02269 <span class="comment"></span>
02270 <span class="comment">          s1="Yr. ";                    //## chea 061199</span>
02271 <span class="comment">          s1+=m.format(tyear+1,16);</span>
02272 <span class="comment">          s1+="-";</span>
02273 <span class="comment">          s1+=m.format(tyear+2,16);</span>
02274 <span class="comment">          font_chart_red_sm.disp( xColumn5-50, y+2, s1.str_buf, xColumn6 );</span>
02275 <span class="comment">        */</span>
02276 
02277         <a class="code" href="classString.html">String</a> s1,s2,s3;                              <span class="comment">//## chea 061199 2.5.1</span>
02278         s1+=m.format(tyear-1,16);
02279         font_chart_red_sm.disp( xColumn1-35, y+2, s1.<a class="code" href="classString.html#m0">str_buf</a>, xColumn1+60 );
02280 
02281         s2+=m.format(tyear,16);
02282         font_chart_red_sm.disp( xColumn3-35, y+2, s2.<a class="code" href="classString.html#m0">str_buf</a>, xColumn3+60 );
02283 
02284         s3+=m.format(tyear+1,16);
02285         font_chart_red_sm.disp( xColumn5-35, y+2, s3.<a class="code" href="classString.html#m0">str_buf</a>, xColumn6 );
02286 
02287     }
02288     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==3) {
02289         font_chart_red_sm.disp( x, y+2, <span class="stringliteral">"Assets"</span>, x+200 );
02290     }
02291     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;3)&amp;&amp;(recNo&lt;=<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+3)) {
02292         i=recNo-4;
02293         font_chartsm.disp( x, y+2, game_str_res.balance_sheet_str(i),  xColumn1);
02294         font_chartsm.right_put( xColumn1, y+2, m.format(finance.last_year.asset_array[i], 2));
02295         font_chartsm.right_put( xColumn3, y+2, m.format(finance.this_year.asset_array[i], 2));
02296         font_chartsm.right_put( xColumn5, y+2, m.format(finance.next_year.asset_array[i], 2));
02297         <span class="comment">/* //## chea 250899</span>
02298 <span class="comment">           font_chartsm.right_put( xColumn2, y+2,</span>
02299 <span class="comment">           m.format(100*(finance.this_year.asset_array[i]-finance.last_year.asset_array[i])</span>
02300 <span class="comment">           /finance.last_year.asset_array[i],</span>
02301 <span class="comment">           3));</span>
02302 <span class="comment">           font_chartsm.right_put( xColumn4, y+2,</span>
02303 <span class="comment">           m.format(100*(finance.next_year.asset_array[i]-finance.this_year.asset_array[i])</span>
02304 <span class="comment">           /finance.this_year.asset_array[i],</span>
02305 <span class="comment">           3));</span>
02306 <span class="comment">        */</span>
02307 
02308         font_chartsm.right_put( xColumn2, y+2,
02309                                 m.format(100*(finance.this_year.asset_array[i]-finance.last_year.asset_array[i])
02310                                          /finance.last_year.asset_array[i],
02311                                          24));                                       <span class="comment">//## chea 250899</span>
02312         font_chartsm.right_put( xColumn4, y+2,
02313                                 m.format(100*(finance.next_year.asset_array[i]-finance.this_year.asset_array[i])
02314                                          /finance.this_year.asset_array[i],
02315                                          24));                                       <span class="comment">//## chea 250899</span>
02316 
02317     }
02318     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+4) {
02319         font_chart_red_sm.disp( x, y+2, <span class="stringliteral">"Liabilities"</span>, x+200 );
02320     }
02321     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;=<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+5)&amp;&amp;(recNo&lt;<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+5+<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>)) {
02322         i=recNo-5-<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>;
02323         font_chartsm.disp( x, y+2, game_str_res.balance_sheet_str(i+<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>),  xColumn1);
02324         font_chartsm.right_put( xColumn1, y+2, m.format(finance.last_year.liability_array[i], 2));
02325         font_chartsm.right_put( xColumn3, y+2, m.format(finance.this_year.liability_array[i], 2));
02326         font_chartsm.right_put( xColumn5, y+2, m.format(finance.next_year.liability_array[i], 2));
02327 
02328         <span class="comment">/*  //## chea 250899</span>
02329 <span class="comment">            font_chartsm.right_put( xColumn2, y+2,</span>
02330 <span class="comment">            m.format(100*(finance.this_year.liability_array[i]-finance.last_year.liability_array[i])</span>
02331 <span class="comment">            /finance.last_year.liability_array[i],</span>
02332 <span class="comment">            3));</span>
02333 <span class="comment">            font_chartsm.right_put( xColumn4, y+2,</span>
02334 <span class="comment">            m.format(100*(finance.next_year.liability_array[i]-finance.this_year.liability_array[i])</span>
02335 <span class="comment">            /finance.this_year.liability_array[i],</span>
02336 <span class="comment">            3));</span>
02337 <span class="comment">        */</span>
02338 
02339         font_chartsm.right_put( xColumn2, y+2,
02340                                 m.format(100*(finance.this_year.liability_array[i]-finance.last_year.liability_array[i])
02341                                          /finance.last_year.liability_array[i],
02342                                          24));                                       <span class="comment">//## chea 250899</span>
02343         font_chartsm.right_put( xColumn4, y+2,
02344                                 m.format(100*(finance.next_year.liability_array[i]-finance.this_year.liability_array[i])
02345                                          /finance.this_year.liability_array[i],
02346                                          24));                                       <span class="comment">//## chea 250899</span>
02347 
02348     }
02349     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>+6) {
02350         font_chart_blue_sm.disp( x, y+2, <span class="stringliteral">"Fund balances"</span>, x+200 );
02351         font_chart_blue_sm.right_put( xColumn1, y+2, m.format(finance.last_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-
02352                                                               finance.last_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1], 2));
02353         font_chart_blue_sm.right_put( xColumn3, y+2, m.format(finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-
02354                                                               finance.this_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1], 2));
02355         font_chart_blue_sm.right_put( xColumn5, y+2, m.format(finance.next_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-
02356                                                               finance.next_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1], 2));
02357 
02358         <span class="comment">/*  //## chea 250899</span>
02359 <span class="comment">            font_chart_blue_sm.right_put( xColumn2, y+2,</span>
02360 <span class="comment">            m.format(100*(</span>
02361 <span class="comment">            finance.this_year.asset_array[ASSET_ITEM_COUNT-1]-finance.this_year.liability_array[LIABILITY_ITEM_COUNT-1]-</span>
02362 <span class="comment">            finance.last_year.asset_array[ASSET_ITEM_COUNT-1]+finance.last_year.liability_array[LIABILITY_ITEM_COUNT-1])</span>
02363 <span class="comment">            /(finance.this_year.asset_array[ASSET_ITEM_COUNT-1]-finance.this_year.liability_array[LIABILITY_ITEM_COUNT-1]),</span>
02364 <span class="comment">            //                          finance.this_year.liability_array[LIABILITY_ITEM_COUNT-1]-finance.last_year.liability_array[LIABILITY_ITEM_COUNT-1])</span>
02365 <span class="comment">            //                          /finance.last_year.liability_array[LIABILITY_ITEM_COUNT-1],</span>
02366 <span class="comment">            3));</span>
02367 <span class="comment">            font_chart_blue_sm.right_put( xColumn4, y+2,</span>
02368 <span class="comment">            m.format(100*(</span>
02369 <span class="comment">            finance.next_year.asset_array[ASSET_ITEM_COUNT-1]-finance.next_year.liability_array[LIABILITY_ITEM_COUNT-1]-</span>
02370 <span class="comment">            finance.this_year.asset_array[ASSET_ITEM_COUNT-1]+finance.this_year.liability_array[LIABILITY_ITEM_COUNT-1])</span>
02371 <span class="comment">            /(finance.next_year.asset_array[ASSET_ITEM_COUNT-1]-finance.next_year.liability_array[LIABILITY_ITEM_COUNT-1]),</span>
02372 <span class="comment">            //                          finance.next_year.liability_array[LIABILITY_ITEM_COUNT-1]-finance.this_year.liability_array[LIABILITY_ITEM_COUNT-1])</span>
02373 <span class="comment">            //                          /finance.this_year.liability_array[LIABILITY_ITEM_COUNT-1],</span>
02374 <span class="comment">            3));</span>
02375 <span class="comment">        */</span>
02376 
02377         font_chart_blue_sm.right_put( xColumn2, y+2,
02378                                       m.format(100*(
02379                                           finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-finance.this_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1]-
02380                                           finance.last_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]+finance.last_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1])
02381                                                /(finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-finance.this_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1]),
02382                                                24));                                       <span class="comment">//## chea 250899</span>
02383         font_chart_blue_sm.right_put( xColumn4, y+2,
02384                                       m.format(100*(
02385                                           finance.next_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-finance.next_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1]-
02386                                           finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]+finance.this_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1])
02387                                                /(finance.next_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-finance.next_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1]),
02388                                                24));                                       <span class="comment">//## chea 250899</span>
02389 
02390     }
02391     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>+<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>+7) {
02392         font_chart_blue_sm.disp( x, y+2, <span class="stringliteral">"Total liabilities and fund balance"</span>, <a class="code" href="ofin__rep_8cpp.html#a37a18">BS_TAB1</a>+220);
02393         font_chart_blue_sm.right_put( xColumn1, y+2, m.format(finance.last_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1], 2));
02394         font_chart_blue_sm.right_put( xColumn3, y+2, m.format(finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1], 2));
02395         font_chart_blue_sm.right_put( xColumn5, y+2, m.format(finance.next_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1], 2));
02396         <span class="comment">//                      font_chart_blue_sm.right_put( xColumn2, y+2,</span>
02397         <span class="comment">//                              m.format(100*(finance.this_year.asset_array[ASSET_ITEM_COUNT-1]-finance.last_year.asset_array[ASSET_ITEM_COUNT-1])</span>
02398         <span class="comment">//                              /finance.last_year.asset_array[ASSET_ITEM_COUNT-1],</span>
02399         <span class="comment">//                              3));</span>
02400 
02401         font_chart_blue_sm.right_put( xColumn2, y+2,
02402                                       m.format(100*(finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-finance.last_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1])
02403                                                /finance.last_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1],
02404                                                24));                                       <span class="comment">//## chea 250899</span>
02405 
02406         <span class="comment">//                      font_chart_blue_sm.right_put( xColumn4, y+2,</span>
02407         <span class="comment">//                              m.format(100*(finance.next_year.asset_array[ASSET_ITEM_COUNT-1]-finance.this_year.asset_array[ASSET_ITEM_COUNT-1])</span>
02408         <span class="comment">//                              /finance.this_year.asset_array[ASSET_ITEM_COUNT-1],</span>
02409         <span class="comment">//                              3));</span>
02410 
02411         font_chart_blue_sm.right_put( xColumn4, y+2,
02412                                       m.format(100*(finance.next_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1])
02413                                                /finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1],
02414                                                24));                                       <span class="comment">//## chea 250899</span>
02415 
02416     }
02417 }
02418 <span class="preprocessor">#endif</span>
02419 <span class="preprocessor"></span><span class="comment">//------ End of static function fin_rep_case8 --------//</span>
02420 
02421 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
02422 <span class="preprocessor"></span><span class="comment">//------ Begin of static function export_fin_rep_case8 --------//</span>
02423 <span class="comment">//</span>
02424 <span class="comment">// export to text file</span>
02425 <span class="comment">//</span>
02426 <span class="keyword">static</span> <span class="keywordtype">void</span> export_fin_rep_case8(<a class="code" href="classFile.html">File</a> *filePtr) {
02427     <span class="keywordtype">int</span> i;
02428     <span class="keywordtype">int</span> tyear=info.financial_year();
02429     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>( filePtr, <span class="stringliteral">"Year"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02430     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, tyear-1); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02431     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank change field</span>
02432     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, tyear); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02433     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>( filePtr, <span class="stringliteral">"Initial"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02434     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank change field</span>
02435     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, tyear+1); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>( filePtr );
02436 
02437     <span class="comment">// write asset label</span>
02438     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>( filePtr, <span class="stringliteral">"Assets"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02439     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank last year field</span>
02440     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank change field</span>
02441     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>( filePtr, <span class="stringliteral">"(Current)"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02442     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank initial field</span>
02443     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank change field</span>
02444     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank next year</span>
02445     <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>( filePtr );              <span class="comment">// blank on value field</span>
02446 
02447     <span class="comment">// write asset</span>
02448     <span class="keywordflow">for</span>( i=0; i&lt;<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>; ++i ) {
02449         <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>( filePtr, game_str_res.balance_sheet_str(i) ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02450         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, finance.last_year.asset_array[i]); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02451         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, (finance.this_year.asset_array[i]-finance.last_year.asset_array[i])/finance.last_year.asset_array[i] ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02452         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, finance.this_year.asset_array[i]); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02453         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, finance.initial_last_year.asset_array[i]); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02454         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, (finance.next_year.asset_array[i]-finance.last_year.asset_array[i])/finance.last_year.asset_array[i]); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02455         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, finance.next_year.asset_array[i]); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>( filePtr );
02456     }
02457 
02458     <span class="comment">// write liabilities label</span>
02459     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>( filePtr, <span class="stringliteral">"Liabilities"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02460     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank last year field</span>
02461     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank change field</span>
02462     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank current year field</span>
02463     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank initial field</span>
02464     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank change field</span>
02465     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank next year</span>
02466     <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>( filePtr );              <span class="comment">// blank on value field</span>
02467 
02468     <span class="comment">// write liabilities</span>
02469     <span class="keywordflow">for</span>( i=0; i&lt;<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>; ++i ) {
02470         <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>( filePtr, game_str_res.balance_sheet_str(i+<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>) ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02471         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, finance.last_year.liability_array[i]); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02472         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, (finance.this_year.liability_array[i]-finance.last_year.liability_array[i])/finance.last_year.liability_array[i]); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02473         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, finance.this_year.liability_array[i]); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02474         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, finance.initial_last_year.liability_array[i], ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02475         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, (finance.next_year.liability_array[i]-finance.this_year.liability_array[i])/finance.this_year.liability_array[i]); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02476         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, finance.next_year.liability_array[i]); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>( filePtr );
02477     }
02478 
02479     <span class="comment">// write fund balance</span>
02480     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>( filePtr, <span class="stringliteral">"Fund balances"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02481     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, finance.last_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-finance.last_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1]); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02482     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, (finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-finance.this_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1]-
02483                                finance.last_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]+finance.last_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1])
02484                      /(finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-finance.this_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1]) );
02485     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02486     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-finance.this_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1]); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02487     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, finance.initial_last_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-finance.initial_last_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1]); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02488     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, (finance.next_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-finance.next_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1]-
02489                                finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]+finance.this_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1])
02490                      /(finance.next_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-finance.next_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1]) );
02491     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02492     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, finance.next_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-finance.next_year.liability_array[<a class="code" href="Ofinance_8h.html#a98a26">LIABILITY_ITEM_COUNT</a>-1]); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>( filePtr );
02493 
02494     <span class="comment">// write total liabilites and fund balance</span>
02495     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>( filePtr, <span class="stringliteral">"Total liabilities and fund balance"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02496     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, finance.last_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02497     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, (finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-finance.last_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1])/finance.last_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1] ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02498     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02499     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, finance.initial_last_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02500     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, (finance.next_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]-finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1])/finance.last_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
02501     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, finance.next_year.asset_array[<a class="code" href="Ofinance_8h.html#a96a19">ASSET_ITEM_COUNT</a>-1]); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>( filePtr );
02502 }
02503 
02504 <span class="comment">//------ End of static function export_fin_rep_case8 --------//</span>
02505 <span class="preprocessor">#endif</span>
02506 <span class="preprocessor"></span>
02507 <span class="comment">//------ Begin of static function fin_rep_case9 --------//</span>
02508 <span class="comment">// Case 9: EXPANDING THREE YEARS REVENUE</span>
02509 <span class="comment">// recNo -- record no. (row no.) to be displayed</span>
02510 <span class="comment">// x,y  -- left top position of the display region</span>
02511 <span class="comment">//</span>
02512 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
02513 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">void</span> fin_rep_case9(<span class="keywordtype">int</span> recNo,<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y) {
02514     <span class="keywordtype">int</span> i;
02515     <span class="keywordtype">int</span> xColumn1=395, xColumn2=460, xColumn3=545, xColumn4=610, xColumn5=695,xColumn6=745;
02516 
02517     <span class="comment">// ##### Begin Marco ##### //</span>
02518     <span class="keywordtype">int</span> xColumn0 = 315;
02519     <span class="comment">// ##### End Marco ##### //</span>
02520 
02521     <span class="comment">// Show title //</span>
02522     <span class="keywordflow">if</span>(recNo==1) {
02523         font_charts.disp( xColumn1-75, y+2, <span class="stringliteral">"Three-Year Projection (Expanded)"</span>, xColumn4+120 );
02524         <span class="keywordflow">return</span>;
02525     }
02526 
02527     <span class="keywordflow">if</span>(recNo==2) {
02528         font_chart_red_sm.disp( xColumn2-35, y+2, <span class="stringliteral">"Change"</span>, xColumn3 );
02529         font_chart_red_sm.disp( xColumn4-35, y+2, <span class="stringliteral">"Change"</span>, xColumn5 );
02530 
02531         <a class="code" href="classString.html">String</a> *s1,*s2,*s3;
02532         <span class="keywordtype">int</span> tyear=(int)(info.game_year+(info.game_month-9.0)/12);
02533         <span class="comment">/*</span>
02534 <span class="comment">          s1=new String(m.format(tyear-1,16));</span>
02535 <span class="comment">          s2=new String(m.format(tyear,16));</span>
02536 <span class="comment">          (*s1)+="-";</span>
02537 <span class="comment">          (*s1)+=(*s2);</span>
02538 <span class="comment">          font_chart_red_sm.disp( xColumn1-50, y+2, s1-&gt;str_buf, xColumn2-10 );</span>
02539 <span class="comment"></span>
02540 <span class="comment">          (*s1)=String(m.format(tyear,16));</span>
02541 <span class="comment">          (*s2)=String(m.format(tyear+1,16));</span>
02542 <span class="comment">          (*s1)+=   "-";</span>
02543 <span class="comment">          (*s1)+=(*s2);</span>
02544 <span class="comment">          font_chart_red_sm.disp( xColumn3-50, y+2, s1-&gt;str_buf, xColumn4-10 );</span>
02545 <span class="comment"></span>
02546 <span class="comment">          (*s1)=String(m.format(tyear+1,16));</span>
02547 <span class="comment">          (*s2)=String(m.format(tyear+2,16));</span>
02548 <span class="comment">          (*s1)+="-";</span>
02549 <span class="comment">          (*s1)+=(*s2);</span>
02550 <span class="comment">          font_chart_red_sm.disp( xColumn5-50, y+2, s1-&gt;str_buf, xColumn6 );</span>
02551 <span class="comment">          delete s1,s2;</span>
02552 <span class="comment">        */</span>
02553 
02554         <span class="comment">//## chea 061199 2.5.1</span>
02555         s1=<span class="keyword">new</span> <a class="code" href="classString.html">String</a>(m.format(tyear-1,16));
02556         s2=<span class="keyword">new</span> <a class="code" href="classString.html">String</a>(m.format(tyear,16));
02557         s3=<span class="keyword">new</span> <a class="code" href="classString.html">String</a>(m.format(tyear+1,16));
02558 
02559         font_chart_red_sm.disp( xColumn1-35, y+2, s1-&gt;<a class="code" href="classString.html#m0">str_buf</a>, xColumn2-10 );
02560 
02561         font_chart_red_sm.disp( xColumn3-35, y+2, s2-&gt;<a class="code" href="classString.html#m0">str_buf</a>, xColumn4-10 );
02562 
02563         font_chart_red_sm.disp( xColumn5-35, y+2, s3-&gt;<a class="code" href="classString.html#m0">str_buf</a>, xColumn6 );
02564 
02565         <span class="comment">// ##### Begin Marco ##### //</span>
02566         <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
02567             font_chart_purple_sm.disp( xColumn0-35, y+2, <span class="stringliteral">"Initial"</span>, xColumn1-10 );
02568         <span class="comment">// ##### End Marco ##### //</span>
02569 
02570         <span class="keyword">delete</span> s1,s2,s3;
02571 
02572     }
02573 
02574     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==3) {
02575         font_chart_red_sm.disp( x, y, <span class="stringliteral">"Revenue"</span>, x+200 );
02576     }
02577     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;=4) &amp;&amp; (recNo&lt;=6)) {
02578         i=recNo-4;
02579         font_chartsm.disp( x, y, game_str_res.financial_report_str(i),  xColumn1);
02580         font_chartsm.right_put( xColumn1, y+2, m.format(finance.revenue_array[i].total, 2));
02581         font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_revenue_array[i].change_last_year.total, 24) );
02582         font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_revenue_array[i].this_year.total, 2) );
02583         font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[i].change_next_year.total, 24) );
02584         font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_revenue_array[i].next_year.total, 2) );
02585 
02586         <span class="comment">// ##### Begin Marco ##### //</span>
02587         <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
02588             font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_revenue_array[i].total, 2));
02589         <span class="comment">// ##### End Marco ##### //</span>
02590     }
02591     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;=7) &amp;&amp; (recNo&lt;=10)) {
02592         <span class="keywordflow">if</span>(recNo==7) {
02593             font_chartsm.disp( x, y, game_str_res.financial_report_str(3),  xColumn1);
02594         }
02595         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==8) {
02596             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tDirect"</span>,  xColumn1);
02597             font_chartsm.right_put( xColumn1, y+2, m.format(finance.revenue_array[3].direct, 2));
02598             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_revenue_array[3].change_last_year.direct, 24) );
02599             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_revenue_array[3].this_year.direct, 2) );
02600             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[3].change_next_year.direct, 24) );
02601             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_revenue_array[3].next_year.direct, 2) );
02602 
02603             <span class="comment">// ##### Begin Marco ##### //</span>
02604             <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
02605                 font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_revenue_array[3].direct, 2));
02606             <span class="comment">// ##### End Marco ##### //</span>
02607         }
02608         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==9) {
02609             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tIndirect"</span>,  xColumn1);
02610             font_chartsm.right_put( xColumn1, y+2, m.format(finance.revenue_array[3].indirect, 2));
02611             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_revenue_array[3].change_last_year.indirect, 24) );
02612             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_revenue_array[3].this_year.indirect, 2) );
02613             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[3].change_next_year.indirect, 24) );
02614             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_revenue_array[3].next_year.indirect, 2) );
02615 
02616             <span class="comment">// ##### Begin Marco ##### //</span>
02617             <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
02618                 font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_revenue_array[3].indirect, 2));
02619             <span class="comment">// ##### End Marco ##### //</span>
02620         }
02621         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==10) {
02622             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tTotal"</span>,  xColumn1);
02623             font_chartsm.right_put( xColumn1, y+2, m.format(finance.revenue_array[3].total, 2));
02624             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_revenue_array[3].change_last_year.total, 24) );
02625             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_revenue_array[3].this_year.total, 2) );
02626             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[3].change_next_year.total, 24) );
02627             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_revenue_array[3].next_year.total, 2) );
02628 
02629             <span class="comment">// ##### Begin Marco ##### //</span>
02630             <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
02631                 font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_revenue_array[3].total, 2));
02632             <span class="comment">// ##### End Marco ##### //</span>
02633         }
02634     }
02635     <span class="comment">//          else if((recNo&gt;=11) &amp;&amp; (recNo&lt;=16))</span>
02636     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;=11) &amp;&amp; (recNo&lt;=14)) {
02637         i=recNo-7;
02638         font_chartsm.disp( x, y, game_str_res.financial_report_str(i),  xColumn1);
02639         font_chartsm.right_put( xColumn1, y+2, m.format(finance.revenue_array[i].total, 2));
02640         font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_revenue_array[i].change_last_year.total, 24) );
02641         font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_revenue_array[i].this_year.total, 2) );
02642         font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[i].change_next_year.total, 24) );
02643         font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_revenue_array[i].next_year.total, 2) );
02644 
02645         <span class="comment">// ##### Begin Marco ##### //</span>
02646         <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
02647             font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_revenue_array[i].total, 2));
02648         <span class="comment">// ##### End Marco ##### //</span>
02649     }
02650     <span class="comment">// ##### Begin Marco ##### //</span>
02651     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (recNo == 15) {
02652         i=recNo-7;
02653         font_chartsm.disp( x, y, <span class="stringliteral">"  Interest earned or paid on"</span>,  xColumn1);
02654         font_chartsm.right_put( xColumn1, y+2, m.format(finance.revenue_array[i].total, 2));
02655         font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_revenue_array[i].change_last_year.total, 24) );
02656         font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_revenue_array[i].this_year.total, 2) );
02657         font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[i].change_next_year.total, 24) );
02658         font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_revenue_array[i].next_year.total, 2) );
02659 
02660         <span class="comment">// ##### Begin Marco ##### //</span>
02661         <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
02662             font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_revenue_array[i].total, 2));
02663         <span class="comment">// ##### End Marco ##### //</span>
02664     }
02665     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (recNo == 16) {
02666         font_chartsm.disp( x + 30, y, <span class="stringliteral">"operating reserve"</span>,  xColumn1);
02667     }
02668     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (recNo == 17) {
02669         i=recNo-8;
02670         font_chartsm.disp( x, y, game_str_res.financial_report_str(i),  xColumn1);
02671         font_chartsm.right_put( xColumn1, y+2, m.format(finance.revenue_array[i].total, 2));
02672         font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_revenue_array[i].change_last_year.total, 24) );
02673         font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_revenue_array[i].this_year.total, 2) );
02674         font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[i].change_next_year.total, 24) );
02675         font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_revenue_array[i].next_year.total, 2) );
02676 
02677         <span class="comment">// ##### Begin Marco ##### //</span>
02678         <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
02679             font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_revenue_array[i].total, 2));
02680         <span class="comment">// ##### End Marco ##### //</span>
02681     }
02682     <span class="comment">// ##### End Marco ##### //</span>
02683     <span class="comment">//          else if(recNo==17)</span>
02684     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==18) {                            <span class="comment">//marco</span>
02685         font_chart_blue_sm.disp( x, y, <span class="stringliteral">"  Total sources of funds"</span>,  xColumn1);
02686         font_chart_blue_sm.right_put( xColumn1, y+2, m.format(finance.total_revenue.total, 2));
02687         font_chart_blue_sm.right_put( xColumn2, y+2, m.format(finance.projected_total_revenue.change_last_year.total, 24) );
02688         font_chart_blue_sm.right_put( xColumn3, y+2, m.format(finance.projected_total_revenue.this_year.total, 2) );
02689         font_chart_blue_sm.right_put( xColumn4, y+2, m.format(finance.projected_total_revenue.change_next_year.total, 24) );
02690         font_chart_blue_sm.right_put( xColumn5, y+2, m.format(finance.projected_total_revenue.next_year.total, 2) );
02691 
02692         <span class="comment">// ##### Begin Marco ##### //</span>
02693         <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
02694             <span class="comment">//                          font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_total_revenue.total, 2));</span>
02695             font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_total_revenue_total, 2));
02696         <span class="comment">// ##### End Marco ##### //</span>
02697     }
02698     <span class="comment">//          else if(recNo==18)</span>
02699     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==19) {                            <span class="comment">//marco</span>
02700         font_chart_red_sm.disp( x, y, <span class="stringliteral">"Expenditures"</span>, x+200 );
02701     }
02702 
02703     <span class="comment">// Calculate the sub-index p,q form recNo</span>
02704     <span class="comment">// recNo = p*5 + q +19</span>
02705     <span class="keywordtype">int</span> p,q;
02706 
02707     <span class="comment">//          p=(recNo-19)/5;</span>
02708     <span class="comment">//          q=(recNo-19)-p*5;</span>
02709     p=(recNo-20)/5;                                 <span class="comment">//marco</span>
02710     q=(recNo-20)-p*5;                               <span class="comment">//marco</span>
02711 
02712     <span class="keywordflow">if</span>((p&gt;=0)&amp;&amp;(p&lt;2)) {
02713         <span class="keywordflow">if</span> (q==0) {
02714             font_chartsm.disp( x, y, game_str_res.financial_report_str(p+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>),  xColumn1);
02715         }
02716         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(q==1) {
02717             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tAY faculty compensation"</span>,  xColumn1);
02718             font_chartsm.right_put( xColumn1, y+2, m.format(finance.expense_array[p].faculty, 2));
02719             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[p].change_last_year.faculty, 24) );
02720             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_expense_array[p].this_year.faculty, 2) );
02721             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[p].change_next_year.faculty, 24) );
02722             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[p].next_year.faculty, 2) );
02723 
02724             <span class="comment">// ##### Begin Marco ##### //</span>
02725             <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
02726                 font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_expense_array[p].faculty, 2));
02727             <span class="comment">// ##### End Marco ##### //</span>
02728         }
02729         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(q==2) {
02730             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tStaff compensation"</span>,  xColumn1);
02731             font_chartsm.right_put( xColumn1, y+2, m.format(finance.expense_array[p].staff, 2));
02732             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[p].change_last_year.staff, 24) );
02733             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_expense_array[p].this_year.staff, 2) );
02734             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[p].change_next_year.staff, 24) );
02735             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[p].next_year.staff, 2) );
02736 
02737             <span class="comment">// ##### Begin Marco ##### //</span>
02738             <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
02739                 font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_expense_array[p].staff, 2));
02740             <span class="comment">// ##### End Marco ##### //</span>
02741         }
02742         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(q==3) {
02743             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tOther expenditures"</span>,  xColumn1);
02744             font_chartsm.right_put( xColumn1, y+2, m.format(finance.expense_array[p].other, 2));
02745             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[p].change_last_year.other, 24) );
02746             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_expense_array[p].this_year.other, 2) );
02747             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[p].change_next_year.other, 24) );
02748             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[p].next_year.other, 2) );
02749 
02750             <span class="comment">// ##### Begin Marco ##### //</span>
02751             <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
02752                 font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_expense_array[p].other, 2));
02753             <span class="comment">// ##### End Marco ##### //</span>
02754         }
02755         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(q==4) {
02756             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tTotal"</span>,  xColumn1);
02757             font_chartsm.right_put( xColumn1, y+2, m.format(finance.expense_array[p].total, 2));
02758             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[p].change_last_year.total, 24) );
02759             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_expense_array[p].this_year.total, 2) );
02760             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[p].change_next_year.total, 24) );
02761             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[p].next_year.total, 2) );
02762 
02763             <span class="comment">// ##### Begin Marco ##### //</span>
02764             <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
02765                 font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_expense_array[p].total, 2));
02766             <span class="comment">// ##### End Marco ##### //</span>
02767         }
02768     }
02769 
02770     <span class="comment">// Calculate the sub-index p,q form recNo</span>
02771     <span class="comment">// recNo = p*4 + q +29</span>
02772 
02773     <span class="comment">//          p=(recNo-29)/4;         //0--6</span>
02774     <span class="comment">//          q=(recNo-29)-p*4;</span>
02775     p=(recNo-30)/4;                                 <span class="comment">//marco</span>
02776     q=(recNo-30)-p*4;                               <span class="comment">//marco</span>
02777 
02778     <span class="keywordflow">if</span>((p&gt;=0)&amp;&amp;(p&lt;=<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>-5)) {
02779         <span class="comment">// BUGHERE EXPENSE_ITEM_COUNT should be  minus 3</span>
02780         p+=2;
02781         <span class="keywordflow">if</span> (q==0) {
02782             font_chartsm.disp( x, y, game_str_res.financial_report_str(p+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>),  xColumn1);
02783         }
02784         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(q==1) {
02785             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tStaff compensation"</span>,  xColumn1);
02786             font_chartsm.right_put( xColumn1, y+2, m.format(finance.expense_array[p].staff, 2));
02787             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[p].change_last_year.staff, 24) );
02788             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_expense_array[p].this_year.staff, 2) );
02789             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[p].change_next_year.staff, 24) );
02790             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[p].next_year.staff, 2) );
02791 
02792             <span class="comment">// ##### Begin Marco ##### //</span>
02793             <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
02794                 font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_expense_array[p].staff, 2));
02795             <span class="comment">// ##### End Marco ##### //</span>
02796         }
02797         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(q==2) {
02798             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tOther expenditures"</span>,  xColumn1);
02799             font_chartsm.right_put( xColumn1, y+2, m.format(finance.expense_array[p].other, 2));
02800             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[p].change_last_year.other, 24) );
02801             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_expense_array[p].this_year.other, 2) );
02802             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[p].change_next_year.other, 24) );
02803             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[p].next_year.other, 2) );
02804 
02805             <span class="comment">// ##### Begin Marco ##### //</span>
02806             <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
02807                 font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_expense_array[p].other, 2));
02808             <span class="comment">// ##### End Marco ##### //</span>
02809         }
02810         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(q==3) {
02811             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tTotal"</span>,  xColumn1);
02812             font_chartsm.right_put( xColumn1, y+2, m.format(finance.expense_array[p].total, 2));
02813             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[p].change_last_year.total, 24) );
02814             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_expense_array[p].this_year.total, 2) );
02815             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[p].change_next_year.total, 24) );
02816             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[p].next_year.total, 2) );
02817 
02818             <span class="comment">// ##### Begin Marco ##### //</span>
02819             <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
02820                 font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_expense_array[p].total, 2));
02821             <span class="comment">// ##### End Marco ##### //</span>
02822         }
02823     }
02824 
02825     <span class="comment">//          if((recNo&gt;=61)&amp;&amp;(recNo&lt;=65))</span>
02826     <span class="comment">//          {       if (recNo==61)</span>
02827     <span class="keywordflow">if</span>((recNo&gt;=62)&amp;&amp;(recNo&lt;=66)) {                  <span class="comment">//marco</span>
02828         <span class="comment">//marco</span>
02829         <span class="keywordflow">if</span> (recNo==62) {
02830             font_chart_blue_sm.disp( x, y,<span class="stringliteral">"  Total operating expenditures"</span>, xColumn1);
02831         }
02832         <span class="comment">//                      else if(recNo==62)</span>
02833         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==63) {                          <span class="comment">//marco</span>
02834             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tAY faculty compensation"</span>,  xColumn1);
02835             font_chartsm.right_put( xColumn1, y+2, m.format(finance.total_operating_expense.faculty, 2));
02836             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_total_operating_expense.change_last_year.faculty, 24) );
02837             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_total_operating_expense.this_year.faculty, 2) );
02838             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_total_operating_expense.change_next_year.faculty, 24) );
02839             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_total_operating_expense.next_year.faculty, 2) );
02840 
02841             <span class="comment">// ##### Begin Marco ##### //</span>
02842             <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
02843                 font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_total_operating_expense.faculty, 2));
02844             <span class="comment">// ##### End Marco ##### //</span>
02845         }
02846         <span class="comment">//                      else if(recNo==63)</span>
02847         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==64) {                          <span class="comment">//marco</span>
02848             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tStaff compensation"</span>,  xColumn1);
02849             font_chartsm.right_put( xColumn1, y+2, m.format(finance.total_operating_expense.staff, 2));
02850             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_total_operating_expense.change_last_year.staff, 24) );
02851             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_total_operating_expense.this_year.staff, 2) );
02852             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_total_operating_expense.change_next_year.staff, 24) );
02853             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_total_operating_expense.next_year.staff, 2) );
02854 
02855             <span class="comment">// ##### Begin Marco ##### //</span>
02856             <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
02857                 font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_total_operating_expense.staff, 2));
02858             <span class="comment">// ##### End Marco ##### //</span>
02859         }
02860         <span class="comment">//                      else if(recNo==64)</span>
02861         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==65) {                          <span class="comment">//marco</span>
02862             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tOther expenditures"</span>,  xColumn1);
02863             font_chartsm.right_put( xColumn1, y+2, m.format(finance.total_operating_expense.other, 2));
02864             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_total_operating_expense.change_last_year.other, 24) );
02865             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_total_operating_expense.this_year.other, 2) );
02866             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_total_operating_expense.change_next_year.other, 24) );
02867             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_total_operating_expense.next_year.other, 2) );
02868 
02869             <span class="comment">// ##### Begin Marco ##### //</span>
02870             <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
02871                 font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_total_operating_expense.other, 2));
02872             <span class="comment">// ##### End Marco ##### //</span>
02873         }
02874         <span class="comment">//                      else if(recNo==65)</span>
02875         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==66) {                          <span class="comment">//marco</span>
02876             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tTotal"</span>,  xColumn1);
02877             font_chartsm.right_put( xColumn1, y+2, m.format(finance.total_operating_expense.total, 2));
02878             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_total_operating_expense.change_last_year.total, 24) );
02879             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_total_operating_expense.this_year.total, 2) );
02880             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_total_operating_expense.change_next_year.total, 24) );
02881             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_total_operating_expense.next_year.total, 2) );
02882 
02883             <span class="comment">// ##### Begin Marco ##### //</span>
02884             <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
02885                 font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_total_operating_expense.total, 2));
02886             <span class="comment">// ##### End Marco ##### //</span>
02887         }
02888     }
02889 
02890     <span class="comment">// Calculate the sub-index p,q form recNo</span>
02891     <span class="comment">// recNo = p*3 + q +62</span>
02892 
02893     <span class="comment">//          p=(recNo-66)/3;         //0--6</span>
02894     <span class="comment">//          q=(recNo-66)-p*3;</span>
02895     p=(recNo-67)/3;                                 <span class="comment">//marco</span>
02896     q=(recNo-67)-p*3;                               <span class="comment">//marco</span>
02897 
02898     <span class="keywordflow">if</span>((p&gt;=0)&amp;&amp;(p&lt;2)) {
02899         <span class="comment">// BUGHERE EXPENSE_ITEM_COUNT should be  minus 3</span>
02900         p+=10;
02901         <span class="keywordflow">if</span> (q==0) {
02902             font_chartsm.disp( x, y, game_str_res.financial_report_str(p+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>),  xColumn1);
02903         }
02904         <span class="comment">//                      else if(q==1)</span>
02905         <span class="comment">//                      {</span>
02906         <span class="comment">//                              font_chart_red_sm.disp( x, y, "\tStaff compensation",  xColumn1);</span>
02907         <span class="comment">//                              font_chartsm.disp( xColumn1, y+2, finance.expense_array[p].staff, 2));</span>
02908         <span class="comment">//                              font_chartsm.disp( xColumn2, y+2, finance.projected_expense_array[p].change_last_year.staff, 3) );</span>
02909         <span class="comment">//                              font_chartsm.disp( xColumn3, y+2, finance.projected_expense_array[p].this_year.staff, 2) );</span>
02910         <span class="comment">//                              font_chartsm.disp( xColumn4, y+2, finance.projected_expense_array[p].change_next_year.staff, 3) );</span>
02911         <span class="comment">//                              font_chartsm.disp( xColumn5, y+2, finance.projected_expense_array[p].next_year.staff, 2) );</span>
02912         <span class="comment">//                      }</span>
02913         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(q==1) {
02914             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tOther expenditures"</span>,  xColumn1);
02915             font_chartsm.right_put( xColumn1, y+2, m.format(finance.expense_array[p].other, 2));
02916             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[p].change_last_year.other, 24) );
02917             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_expense_array[p].this_year.other, 2) );
02918             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[p].change_next_year.other, 24) );
02919             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[p].next_year.other, 2) );
02920 
02921             <span class="comment">// ##### Begin Marco ##### //</span>
02922             <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
02923                 font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_expense_array[p].other, 2));
02924             <span class="comment">// ##### End Marco ##### //</span>
02925         }
02926         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(q==2) {
02927             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tTotal"</span>,  xColumn1);
02928             font_chartsm.right_put( xColumn1, y+2, m.format(finance.expense_array[p].total, 2));
02929             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[p].change_last_year.total, 24) );
02930             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_expense_array[p].this_year.total, 2) );
02931             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[p].change_next_year.total, 24) );
02932             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[p].next_year.total, 2) );
02933 
02934             <span class="comment">// ##### Begin Marco ##### //</span>
02935             <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
02936                 font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_expense_array[p].total, 2));
02937             <span class="comment">// ##### End Marco ##### //</span>
02938         }
02939     }
02940     <span class="comment">//          else if(recNo==70)</span>
02941     <span class="comment">//          {</span>
02942     <span class="comment">//                  font_chartsm.disp( x, y,"  Service on general plant debt", xColumn1);</span>
02943     <span class="comment">//                  //BUGHERE Service on generatl plant debt, Transfer to capital reserve are missing</span>
02944     <span class="comment">//                  //                      font_chartsm.disp( x, y,"Surplus (deficit)", xColumn1);</span>
02945     <span class="comment">//                  //                      font_chartsm.disp( xColumn4, y+2, finance.projected_surplus_deficit, 2) );</span>
02946     <span class="comment">//          }</span>
02947     <span class="comment">//          else if(recNo==71)</span>
02948     <span class="comment">//          {</span>
02949     <span class="comment">//                  font_chartsm.disp( x, y,"  Transfer to capital reserve", xColumn1);</span>
02950     <span class="comment">//          }</span>
02951     <span class="comment">//  else if((recNo&gt;=72)&amp;&amp;(recNo&lt;=76))</span>
02952     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;=73)&amp;&amp;(recNo&lt;=77)) {             <span class="comment">//Marco</span>
02953         <span class="comment">//              if (recNo==72)</span>
02954         <span class="keywordflow">if</span> (recNo==73) {                              <span class="comment">//Marco</span>
02955             font_chart_blue_sm.disp( x, y,<span class="stringliteral">"  Total uses of funds"</span>, xColumn1);
02956         }
02957         <span class="comment">//              else if(recNo==73)</span>
02958         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==74) {                          <span class="comment">//Marco</span>
02959             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tAY faculty compensation"</span>,  xColumn1);
02960             font_chartsm.right_put( xColumn1, y+2, m.format(finance.total_expense.faculty, 2));
02961             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_total_expense.change_last_year.faculty, 24));
02962             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_total_expense.this_year.faculty, 2));
02963             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_total_expense.change_next_year.faculty, 24));
02964             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_total_expense.next_year.faculty, 2));
02965 
02966             <span class="comment">// ##### Begin Marco ##### //</span>
02967             <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
02968                 font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_total_expense.faculty, 2));
02969             <span class="comment">// ##### End Marco ##### //</span>
02970         }
02971         <span class="comment">//              else if(recNo==74)</span>
02972         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==75) {                          <span class="comment">//Marco</span>
02973             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tStaff compensation"</span>,  xColumn1);
02974             font_chartsm.right_put( xColumn1, y+2, m.format(finance.total_expense.staff, 2));
02975             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_total_expense.change_last_year.staff, 24));
02976             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_total_expense.this_year.staff, 2));
02977             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_total_expense.change_next_year.staff, 24));
02978             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_total_expense.next_year.staff, 2));
02979 
02980             <span class="comment">// ##### Begin Marco ##### //</span>
02981             <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
02982                 font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_total_expense.staff, 2));
02983             <span class="comment">// ##### End Marco ##### //</span>
02984         }
02985         <span class="comment">//              else if(recNo==75)</span>
02986         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==76) {                          <span class="comment">//Marco</span>
02987             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tOther expenditures"</span>,  xColumn1);
02988             font_chartsm.right_put( xColumn1, y+2, m.format(finance.total_expense.other, 2));
02989             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_total_expense.change_last_year.other, 24));
02990             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_total_expense.this_year.other, 2));
02991             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_total_expense.change_next_year.other, 24));
02992             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_total_expense.next_year.other, 2));
02993 
02994             <span class="comment">// ##### Begin Marco ##### //</span>
02995             <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
02996                 font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_total_expense.other, 2));
02997             <span class="comment">// ##### End Marco ##### //</span>
02998         }
02999         <span class="comment">//              else if(recNo==76)</span>
03000         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==77) {                          <span class="comment">//Marco</span>
03001             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tTotal"</span>,  xColumn1);
03002             font_chartsm.right_put( xColumn1, y+2, m.format(finance.total_expense.total, 2));
03003             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_total_expense.change_last_year.total, 24));
03004             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_total_expense.this_year.total, 2));
03005             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_total_expense.change_next_year.total, 24));
03006             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_total_expense.next_year.total, 2));
03007 
03008             <span class="comment">// ##### Begin Marco ##### //</span>
03009             <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
03010                 font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_total_expense.total, 2));
03011             <span class="comment">// ##### End Marco ##### //</span>
03012         }
03013     }
03014     <span class="comment">//  else if((recNo&gt;=77)&amp;&amp;(recNo&lt;=81))</span>
03015     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;=78)&amp;&amp;(recNo&lt;=82)) {             <span class="comment">//Marco</span>
03016         <span class="comment">//              if (recNo==77)</span>
03017         <span class="keywordflow">if</span> (recNo==78) {
03018             font_chartsm.disp( x, y, <span class="stringliteral">"  Percent of total uses"</span>,  xColumn1);
03019         }
03020         <span class="comment">//              else if(recNo==78)</span>
03021         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==79) {                          <span class="comment">//Marco</span>
03022             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tAY faculty compensation"</span>,  xColumn1);
03023             <span class="keywordtype">double</span> percent1,percent2,percent3;
03024             percent1=100*finance.total_expense.faculty/finance.total_expense.total;
03025             percent2=100*finance.projected_total_expense.this_year.faculty/
03026                 finance.projected_total_expense.this_year.total;
03027             percent3=100*finance.projected_total_expense.next_year.faculty/
03028                 finance.projected_total_expense.next_year.total;
03029 
03030             font_chartsm.right_put( xColumn1, y+2, m.format(percent1, 24));
03031             font_chartsm.right_put( xColumn3, y+2, m.format(percent2, 24));
03032             font_chartsm.right_put( xColumn5, y+2, m.format(percent3, 24));
03033 
03034             <span class="comment">// ##### Begin Marco ##### //</span>
03035             <span class="keywordtype">double</span> percent4=100*finance.initial_total_expense.faculty/finance.initial_total_expense.total;
03036             <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
03037                 font_chart_purple_sm.right_put( xColumn0, y+2, m.format(percent4, 24));
03038             <span class="comment">// ##### End Marco ##### //</span>
03039         }
03040         <span class="comment">//              else if(recNo==79)</span>
03041         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==80) {                          <span class="comment">//Marco</span>
03042             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tStaff compensation"</span>,  xColumn1);
03043             <span class="keywordtype">double</span> percent1,percent2,percent3;
03044             percent1=100*finance.total_expense.staff/finance.total_expense.total;
03045             percent2=100*finance.projected_total_expense.this_year.staff/
03046                 finance.projected_total_expense.this_year.total;
03047             percent3=100*finance.projected_total_expense.next_year.staff/
03048                 finance.projected_total_expense.next_year.total;
03049 
03050             font_chartsm.right_put( xColumn1, y+2, m.format(percent1, 24));
03051             font_chartsm.right_put( xColumn3, y+2, m.format(percent2, 24));
03052             font_chartsm.right_put( xColumn5, y+2, m.format(percent3, 24));
03053 
03054             <span class="comment">// ##### Begin Marco ##### //</span>
03055             <span class="keywordtype">double</span> percent4=100*finance.initial_total_expense.staff/finance.initial_total_expense.total;
03056             <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
03057                 font_chart_purple_sm.right_put( xColumn0, y+2, m.format(percent4, 24));
03058             <span class="comment">// ##### End Marco ##### //</span>
03059         }
03060         <span class="comment">//              else if(recNo==80)</span>
03061         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==81) {                          <span class="comment">//Marco</span>
03062             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tOther expenditures"</span>,  xColumn1);
03063             <span class="keywordtype">double</span> percent1,percent2,percent3;
03064             percent1=100*finance.total_expense.other/finance.total_expense.total;
03065             percent2=100*finance.projected_total_expense.this_year.other/
03066                 finance.projected_total_expense.this_year.total;
03067             percent3=100*finance.projected_total_expense.next_year.other/
03068                 finance.projected_total_expense.next_year.total;
03069 
03070             font_chartsm.right_put( xColumn1, y+2, m.format(percent1, 24));
03071             font_chartsm.right_put( xColumn3, y+2, m.format(percent2, 24));
03072             font_chartsm.right_put( xColumn5, y+2, m.format(percent3, 24));
03073 
03074             <span class="comment">// ##### Begin Marco ##### //</span>
03075             <span class="keywordtype">double</span> percent4=100*finance.initial_total_expense.other/finance.initial_total_expense.total;
03076             <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
03077                 font_chart_purple_sm.right_put( xColumn0, y+2, m.format(percent4, 24));
03078             <span class="comment">// ##### End Marco ##### //</span>
03079         }
03080         <span class="comment">//              else if(recNo==81)</span>
03081         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==82) {                          <span class="comment">//Marco</span>
03082             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tTotal"</span>,  xColumn1);
03083             <span class="keywordtype">double</span> percent1,percent2,percent3;
03084             percent1=100;
03085             percent2=100;
03086             percent3=100;
03087 
03088             font_chartsm.right_put( xColumn1, y+2, m.format(percent1, 24));
03089             font_chartsm.right_put( xColumn3, y+2, m.format(percent2, 24));
03090             font_chartsm.right_put( xColumn5, y+2, m.format(percent3, 24));
03091 
03092             <span class="comment">// ##### Begin Marco ##### //</span>
03093             <span class="keywordtype">double</span> percent4 = 100;
03094             <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
03095                 font_chart_purple_sm.right_put( xColumn0, y+2, m.format(percent4, 24));
03096             <span class="comment">// ##### End Marco ##### //</span>
03097         }
03098     }
03099     <span class="comment">//          else if(recNo==82)</span>
03100     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (recNo == 83) {                         <span class="comment">// Marco</span>
03101         font_chartsm.disp( x, y,<span class="stringliteral">"  Surplus (deficit)"</span>, xColumn2);
03102         <span class="keywordflow">if</span>(finance.last_year.surplus_deficit&gt;0)
03103             font_chart_green_sm.right_put( xColumn1, y+2, m.format(finance.last_year.surplus_deficit, 2));
03104         <span class="keywordflow">else</span>
03105             font_chart_red_sm.right_put( xColumn1, y+2, m.format(finance.last_year.surplus_deficit, 2));
03106 
03107         <span class="keywordflow">if</span>(finance.this_year.surplus_deficit&gt;0)
03108             font_chart_green_sm.right_put( xColumn3, y+2, m.format(finance.this_year.surplus_deficit, 2));
03109         <span class="keywordflow">else</span>
03110             font_chart_red_sm.right_put( xColumn3, y+2, m.format(finance.this_year.surplus_deficit, 2));
03111 
03112         <span class="keywordflow">if</span>(finance.next_year.surplus_deficit&gt;0)
03113             font_chart_green_sm.right_put( xColumn5, y+2, m.format(finance.next_year.surplus_deficit, 2));
03114         <span class="keywordflow">else</span>
03115             font_chart_red_sm.right_put( xColumn5, y+2, m.format(finance.next_year.surplus_deficit, 2));
03116 
03117         <span class="comment">// ##### Begin Marco ##### //</span>
03118         <span class="keywordflow">if</span> (info.financial_year() &gt; 1)
03119             font_chart_purple_sm.right_put( xColumn0, y+2, m.format(finance.initial_last_year.surplus_deficit, 2));
03120         <span class="comment">// ##### End Marco ##### //</span>
03121     }
03122 
03123 }
03124 
03125 <span class="preprocessor">#else</span>
03126 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">void</span> fin_rep_case9(<span class="keywordtype">int</span> recNo,<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y) {
03127     <span class="keywordtype">int</span> i;
03128     <span class="keywordtype">int</span> xColumn1=395, xColumn2=460, xColumn3=545, xColumn4=610, xColumn5=695,xColumn6=745;
03129 
03130     <span class="comment">// Show title //</span>
03131     <span class="keywordflow">if</span>(recNo==1) {
03132         font_charts.disp( xColumn1-75, y+2, <span class="stringliteral">"Three-Year Projection (Expanded)"</span>, xColumn4+120 );
03133         <span class="keywordflow">return</span>;
03134     }
03135 
03136     <span class="keywordflow">if</span>(recNo==2) {
03137         font_chart_red_sm.disp( xColumn2-35, y+2, <span class="stringliteral">"Change"</span>, xColumn3 );
03138         font_chart_red_sm.disp( xColumn4-35, y+2, <span class="stringliteral">"Change"</span>, xColumn5 );
03139 
03140         <a class="code" href="classString.html">String</a> *s1,*s2,*s3;
03141         <span class="keywordtype">int</span> tyear=(int)(info.game_year+(info.game_month-9.0)/12);
03142         <span class="comment">/*</span>
03143 <span class="comment">          s1=new String(m.format(tyear-1,16));</span>
03144 <span class="comment">          s2=new String(m.format(tyear,16));</span>
03145 <span class="comment">          (*s1)+="-";</span>
03146 <span class="comment">          (*s1)+=(*s2);</span>
03147 <span class="comment">          font_chart_red_sm.disp( xColumn1-50, y+2, s1-&gt;str_buf, xColumn2-10 );</span>
03148 <span class="comment"></span>
03149 <span class="comment">          (*s1)=String(m.format(tyear,16));</span>
03150 <span class="comment">          (*s2)=String(m.format(tyear+1,16));</span>
03151 <span class="comment">          (*s1)+=   "-";</span>
03152 <span class="comment">          (*s1)+=(*s2);</span>
03153 <span class="comment">          font_chart_red_sm.disp( xColumn3-50, y+2, s1-&gt;str_buf, xColumn4-10 );</span>
03154 <span class="comment"></span>
03155 <span class="comment">          (*s1)=String(m.format(tyear+1,16));</span>
03156 <span class="comment">          (*s2)=String(m.format(tyear+2,16));</span>
03157 <span class="comment">          (*s1)+="-";</span>
03158 <span class="comment">          (*s1)+=(*s2);</span>
03159 <span class="comment">          font_chart_red_sm.disp( xColumn5-50, y+2, s1-&gt;str_buf, xColumn6 );</span>
03160 <span class="comment">          delete s1,s2;</span>
03161 <span class="comment">        */</span>
03162 
03163         <span class="comment">//## chea 061199 2.5.1</span>
03164         s1=<span class="keyword">new</span> <a class="code" href="classString.html">String</a>(m.format(tyear-1,16));
03165         s2=<span class="keyword">new</span> <a class="code" href="classString.html">String</a>(m.format(tyear,16));
03166         s3=<span class="keyword">new</span> <a class="code" href="classString.html">String</a>(m.format(tyear+1,16));
03167 
03168         font_chart_red_sm.disp( xColumn1-35, y+2, s1-&gt;<a class="code" href="classString.html#m0">str_buf</a>, xColumn2-10 );
03169 
03170         font_chart_red_sm.disp( xColumn3-35, y+2, s2-&gt;<a class="code" href="classString.html#m0">str_buf</a>, xColumn4-10 );
03171 
03172         font_chart_red_sm.disp( xColumn5-35, y+2, s3-&gt;<a class="code" href="classString.html#m0">str_buf</a>, xColumn6 );
03173         <span class="keyword">delete</span> s1,s2,s3;
03174 
03175     }
03176 
03177     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==3) {
03178         font_chart_red_sm.disp( x, y, <span class="stringliteral">"Revenue"</span>, x+200 );
03179     }
03180     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;=4) &amp;&amp; (recNo&lt;=6)) {
03181         i=recNo-4;
03182         font_chartsm.disp( x, y, game_str_res.financial_report_str(i),  xColumn1);
03183         font_chartsm.right_put( xColumn1, y+2, m.format(finance.revenue_array[i].total, 2));
03184         font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_revenue_array[i].change_last_year.total, 24) );
03185         font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_revenue_array[i].this_year.total, 2) );
03186         font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[i].change_next_year.total, 24) );
03187         font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_revenue_array[i].next_year.total, 2) );
03188     }
03189     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;=7) &amp;&amp; (recNo&lt;=10)) {
03190         <span class="keywordflow">if</span>(recNo==7) {
03191             font_chartsm.disp( x, y, game_str_res.financial_report_str(3),  xColumn1);
03192         }
03193         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==8) {
03194             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tDirect"</span>,  xColumn1);
03195             font_chartsm.right_put( xColumn1, y+2, m.format(finance.revenue_array[3].direct, 2));
03196             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_revenue_array[3].change_last_year.direct, 24) );
03197             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_revenue_array[3].this_year.direct, 2) );
03198             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[3].change_next_year.direct, 24) );
03199             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_revenue_array[3].next_year.direct, 2) );
03200         }
03201         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==9) {
03202             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tIndirect"</span>,  xColumn1);
03203             font_chartsm.right_put( xColumn1, y+2, m.format(finance.revenue_array[3].indirect, 2));
03204             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_revenue_array[3].change_last_year.indirect, 24) );
03205             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_revenue_array[3].this_year.indirect, 2) );
03206             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[3].change_next_year.indirect, 24) );
03207             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_revenue_array[3].next_year.indirect, 2) );
03208         }
03209         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==10) {
03210             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tTotal"</span>,  xColumn1);
03211             font_chartsm.right_put( xColumn1, y+2, m.format(finance.revenue_array[3].total, 2));
03212             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_revenue_array[3].change_last_year.total, 24) );
03213             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_revenue_array[3].this_year.total, 2) );
03214             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[3].change_next_year.total, 24) );
03215             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_revenue_array[3].next_year.total, 2) );
03216         }
03217     }
03218     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;=11) &amp;&amp; (recNo&lt;=16)) {
03219         i=recNo-7;
03220         font_chartsm.disp( x, y, game_str_res.financial_report_str(i),  xColumn1);
03221         font_chartsm.right_put( xColumn1, y+2, m.format(finance.revenue_array[i].total, 2));
03222         font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_revenue_array[i].change_last_year.total, 24) );
03223         font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_revenue_array[i].this_year.total, 2) );
03224         font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_revenue_array[i].change_next_year.total, 24) );
03225         font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_revenue_array[i].next_year.total, 2) );
03226     }
03227     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==17) {
03228         font_chart_blue_sm.disp( x, y, <span class="stringliteral">"  Total sources of funds"</span>,  xColumn1);
03229         font_chart_blue_sm.right_put( xColumn1, y+2, m.format(finance.total_revenue.total, 2));
03230         font_chart_blue_sm.right_put( xColumn2, y+2, m.format(finance.projected_total_revenue.change_last_year.total, 24) );
03231         font_chart_blue_sm.right_put( xColumn3, y+2, m.format(finance.projected_total_revenue.this_year.total, 2) );
03232         font_chart_blue_sm.right_put( xColumn4, y+2, m.format(finance.projected_total_revenue.change_next_year.total, 24) );
03233         font_chart_blue_sm.right_put( xColumn5, y+2, m.format(finance.projected_total_revenue.next_year.total, 2) );
03234     }
03235     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==18) {
03236         font_chart_red_sm.disp( x, y, <span class="stringliteral">"Expenditures"</span>, x+200 );
03237     }
03238 
03239     <span class="comment">// Calculate the sub-index p,q form recNo</span>
03240     <span class="comment">// recNo = p*5 + q +19</span>
03241     <span class="keywordtype">int</span> p,q;
03242 
03243     p=(recNo-19)/5;
03244     q=(recNo-19)-p*5;
03245 
03246     <span class="keywordflow">if</span>((p&gt;=0)&amp;&amp;(p&lt;2)) {
03247         <span class="keywordflow">if</span> (q==0) {
03248             font_chartsm.disp( x, y, game_str_res.financial_report_str(p+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>),  xColumn1);
03249         }
03250         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(q==1) {
03251             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tAY faculty compensation"</span>,  xColumn1);
03252             font_chartsm.right_put( xColumn1, y+2, m.format(finance.expense_array[p].faculty, 2));
03253             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[p].change_last_year.faculty, 24) );
03254             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_expense_array[p].this_year.faculty, 2) );
03255             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[p].change_next_year.faculty, 24) );
03256             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[p].next_year.faculty, 2) );
03257         }
03258         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(q==2) {
03259             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tStaff compensation"</span>,  xColumn1);
03260             font_chartsm.right_put( xColumn1, y+2, m.format(finance.expense_array[p].staff, 2));
03261             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[p].change_last_year.staff, 24) );
03262             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_expense_array[p].this_year.staff, 2) );
03263             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[p].change_next_year.staff, 24) );
03264             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[p].next_year.staff, 2) );
03265         }
03266         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(q==3) {
03267             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tOther expenditures"</span>,  xColumn1);
03268             font_chartsm.right_put( xColumn1, y+2, m.format(finance.expense_array[p].other, 2));
03269             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[p].change_last_year.other, 24) );
03270             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_expense_array[p].this_year.other, 2) );
03271             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[p].change_next_year.other, 24) );
03272             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[p].next_year.other, 2) );
03273         }
03274         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(q==4) {
03275             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tTotal"</span>,  xColumn1);
03276             font_chartsm.right_put( xColumn1, y+2, m.format(finance.expense_array[p].total, 2));
03277             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[p].change_last_year.total, 24) );
03278             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_expense_array[p].this_year.total, 2) );
03279             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[p].change_next_year.total, 24) );
03280             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[p].next_year.total, 2) );
03281         }
03282     }
03283 
03284     <span class="comment">// Calculate the sub-index p,q form recNo</span>
03285     <span class="comment">// recNo = p*4 + q +29</span>
03286 
03287     p=(recNo-29)/4;                                 <span class="comment">//0--6</span>
03288     q=(recNo-29)-p*4;
03289 
03290     <span class="keywordflow">if</span>((p&gt;=0)&amp;&amp;(p&lt;=<a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>-5)) {
03291         <span class="comment">// BUGHERE EXPENSE_ITEM_COUNT should be  minus 3</span>
03292         p+=2;
03293         <span class="keywordflow">if</span> (q==0) {
03294             font_chartsm.disp( x, y, game_str_res.financial_report_str(p+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>),  xColumn1);
03295         }
03296         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(q==1) {
03297             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tStaff compensation"</span>,  xColumn1);
03298             font_chartsm.right_put( xColumn1, y+2, m.format(finance.expense_array[p].staff, 2));
03299             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[p].change_last_year.staff, 24) );
03300             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_expense_array[p].this_year.staff, 2) );
03301             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[p].change_next_year.staff, 24) );
03302             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[p].next_year.staff, 2) );
03303         }
03304         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(q==2) {
03305             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tOther expenditures"</span>,  xColumn1);
03306             font_chartsm.right_put( xColumn1, y+2, m.format(finance.expense_array[p].other, 2));
03307             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[p].change_last_year.other, 24) );
03308             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_expense_array[p].this_year.other, 2) );
03309             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[p].change_next_year.other, 24) );
03310             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[p].next_year.other, 2) );
03311         }
03312         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(q==3) {
03313             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tTotal"</span>,  xColumn1);
03314             font_chartsm.right_put( xColumn1, y+2, m.format(finance.expense_array[p].total, 2));
03315             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[p].change_last_year.total, 24) );
03316             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_expense_array[p].this_year.total, 2) );
03317             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[p].change_next_year.total, 24) );
03318             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[p].next_year.total, 2) );
03319         }
03320     }
03321 
03322     <span class="keywordflow">if</span>((recNo&gt;=61)&amp;&amp;(recNo&lt;=65)) {
03323         <span class="keywordflow">if</span> (recNo==61) {
03324             font_chart_blue_sm.disp( x, y,<span class="stringliteral">"  Total operating expenditures"</span>, xColumn1);
03325         }
03326         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==62) {
03327             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tAY faculty compensation"</span>,  xColumn1);
03328             font_chartsm.right_put( xColumn1, y+2, m.format(finance.total_operating_expense.faculty, 2));
03329             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_total_operating_expense.change_last_year.faculty, 24) );
03330             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_total_operating_expense.this_year.faculty, 2) );
03331             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_total_operating_expense.change_next_year.faculty, 24) );
03332             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_total_operating_expense.next_year.faculty, 2) );
03333         }
03334         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==63) {
03335             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tStaff compensation"</span>,  xColumn1);
03336             font_chartsm.right_put( xColumn1, y+2, m.format(finance.total_operating_expense.staff, 2));
03337             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_total_operating_expense.change_last_year.staff, 24) );
03338             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_total_operating_expense.this_year.staff, 2) );
03339             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_total_operating_expense.change_next_year.staff, 24) );
03340             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_total_operating_expense.next_year.staff, 2) );
03341         }
03342         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==64) {
03343             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tOther expenditures"</span>,  xColumn1);
03344             font_chartsm.right_put( xColumn1, y+2, m.format(finance.total_operating_expense.other, 2));
03345             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_total_operating_expense.change_last_year.other, 24) );
03346             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_total_operating_expense.this_year.other, 2) );
03347             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_total_operating_expense.change_next_year.other, 24) );
03348             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_total_operating_expense.next_year.other, 2) );
03349         }
03350         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==65) {
03351             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tTotal"</span>,  xColumn1);
03352             font_chartsm.right_put( xColumn1, y+2, m.format(finance.total_operating_expense.total, 2));
03353             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_total_operating_expense.change_last_year.total, 24) );
03354             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_total_operating_expense.this_year.total, 2) );
03355             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_total_operating_expense.change_next_year.total, 24) );
03356             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_total_operating_expense.next_year.total, 2) );
03357         }
03358     }
03359 
03360     <span class="comment">// Calculate the sub-index p,q form recNo</span>
03361     <span class="comment">// recNo = p*3 + q +62</span>
03362 
03363     p=(recNo-66)/3;                                 <span class="comment">//0--6</span>
03364     q=(recNo-66)-p*3;
03365 
03366     <span class="keywordflow">if</span>((p&gt;=0)&amp;&amp;(p&lt;2)) {
03367         <span class="comment">// BUGHERE EXPENSE_ITEM_COUNT should be  minus 3</span>
03368         p+=10;
03369         <span class="keywordflow">if</span> (q==0) {
03370             font_chartsm.disp( x, y, game_str_res.financial_report_str(p+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>),  xColumn1);
03371         }
03372         <span class="comment">//                      else if(q==1)</span>
03373         <span class="comment">//                      {</span>
03374         <span class="comment">//                              font_chart_red_sm.disp( x, y, "\tStaff compensation",  xColumn1);</span>
03375         <span class="comment">//                              font_chartsm.disp( xColumn1, y+2, finance.expense_array[p].staff, 2));</span>
03376         <span class="comment">//                              font_chartsm.disp( xColumn2, y+2, finance.projected_expense_array[p].change_last_year.staff, 3) );</span>
03377         <span class="comment">//                              font_chartsm.disp( xColumn3, y+2, finance.projected_expense_array[p].this_year.staff, 2) );</span>
03378         <span class="comment">//                              font_chartsm.disp( xColumn4, y+2, finance.projected_expense_array[p].change_next_year.staff, 3) );</span>
03379         <span class="comment">//                              font_chartsm.disp( xColumn5, y+2, finance.projected_expense_array[p].next_year.staff, 2) );</span>
03380         <span class="comment">//                      }</span>
03381         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(q==1) {
03382             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tOther expenditures"</span>,  xColumn1);
03383             font_chartsm.right_put( xColumn1, y+2, m.format(finance.expense_array[p].other, 2));
03384             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[p].change_last_year.other, 24) );
03385             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_expense_array[p].this_year.other, 2) );
03386             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[p].change_next_year.other, 24) );
03387             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[p].next_year.other, 2) );
03388         }
03389         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(q==2) {
03390             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tTotal"</span>,  xColumn1);
03391             font_chartsm.right_put( xColumn1, y+2, m.format(finance.expense_array[p].total, 2));
03392             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_expense_array[p].change_last_year.total, 24) );
03393             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_expense_array[p].this_year.total, 2) );
03394             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_expense_array[p].change_next_year.total, 24) );
03395             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_expense_array[p].next_year.total, 2) );
03396         }
03397     }
03398     <span class="comment">//          else if(recNo==70)</span>
03399     <span class="comment">//          {</span>
03400     <span class="comment">//                  font_chartsm.disp( x, y,"  Service on general plant debt", xColumn1);</span>
03401     <span class="comment">//                  //BUGHERE Service on generatl plant debt, Transfer to capital reserve are missing</span>
03402     <span class="comment">//                  //                      font_chartsm.disp( x, y,"Surplus (deficit)", xColumn1);</span>
03403     <span class="comment">//                  //                      font_chartsm.disp( xColumn4, y+2, finance.projected_surplus_deficit, 2) );</span>
03404     <span class="comment">//          }</span>
03405     <span class="comment">//          else if(recNo==71)</span>
03406     <span class="comment">//          {</span>
03407     <span class="comment">//                  font_chartsm.disp( x, y,"  Transfer to capital reserve", xColumn1);</span>
03408     <span class="comment">//          }</span>
03409     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;=72)&amp;&amp;(recNo&lt;=76)) {
03410         <span class="keywordflow">if</span> (recNo==72) {
03411             font_chart_blue_sm.disp( x, y,<span class="stringliteral">"  Total uses of funds"</span>, xColumn1);
03412         }
03413         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==73) {
03414             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tAY faculty compensation"</span>,  xColumn1);
03415             font_chartsm.right_put( xColumn1, y+2, m.format(finance.total_expense.faculty, 2));
03416             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_total_expense.change_last_year.faculty, 24));
03417             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_total_expense.this_year.faculty, 2));
03418             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_total_expense.change_next_year.faculty, 24));
03419             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_total_expense.next_year.faculty, 2));
03420         }
03421         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==74) {
03422             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tStaff compensation"</span>,  xColumn1);
03423             font_chartsm.right_put( xColumn1, y+2, m.format(finance.total_expense.staff, 2));
03424             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_total_expense.change_last_year.staff, 24));
03425             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_total_expense.this_year.staff, 2));
03426             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_total_expense.change_next_year.staff, 24));
03427             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_total_expense.next_year.staff, 2));
03428         }
03429         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==75) {
03430             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tOther expenditures"</span>,  xColumn1);
03431             font_chartsm.right_put( xColumn1, y+2, m.format(finance.total_expense.other, 2));
03432             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_total_expense.change_last_year.other, 24));
03433             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_total_expense.this_year.other, 2));
03434             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_total_expense.change_next_year.other, 24));
03435             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_total_expense.next_year.other, 2));
03436         }
03437         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==76) {
03438             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tTotal"</span>,  xColumn1);
03439             font_chartsm.right_put( xColumn1, y+2, m.format(finance.total_expense.total, 2));
03440             font_chartsm.right_put( xColumn2, y+2, m.format(finance.projected_total_expense.change_last_year.total, 24));
03441             font_chartsm.right_put( xColumn3, y+2, m.format(finance.projected_total_expense.this_year.total, 2));
03442             font_chartsm.right_put( xColumn4, y+2, m.format(finance.projected_total_expense.change_next_year.total, 24));
03443             font_chartsm.right_put( xColumn5, y+2, m.format(finance.projected_total_expense.next_year.total, 2));
03444         }
03445     }
03446     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((recNo&gt;=77)&amp;&amp;(recNo&lt;=81)) {
03447         <span class="keywordflow">if</span> (recNo==77) {
03448             font_chartsm.disp( x, y, <span class="stringliteral">"  Percent of total uses"</span>,  xColumn1);
03449         }
03450         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==78) {
03451             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tAY faculty compensation"</span>,  xColumn1);
03452             <span class="keywordtype">double</span> percent1,percent2,percent3;
03453             percent1=100*finance.total_expense.faculty/finance.total_expense.total;
03454             percent2=100*finance.projected_total_expense.this_year.faculty/
03455                 finance.projected_total_expense.this_year.total;
03456             percent3=100*finance.projected_total_expense.next_year.faculty/
03457                 finance.projected_total_expense.next_year.total;
03458 
03459             font_chartsm.right_put( xColumn1, y+2, m.format(percent1, 24));
03460             font_chartsm.right_put( xColumn3, y+2, m.format(percent2, 24));
03461             font_chartsm.right_put( xColumn5, y+2, m.format(percent3, 24));
03462         }
03463         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==79) {
03464             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tStaff compensation"</span>,  xColumn1);
03465             <span class="keywordtype">double</span> percent1,percent2,percent3;
03466             percent1=100*finance.total_expense.staff/finance.total_expense.total;
03467             percent2=100*finance.projected_total_expense.this_year.staff/
03468                 finance.projected_total_expense.this_year.total;
03469             percent3=100*finance.projected_total_expense.next_year.staff/
03470                 finance.projected_total_expense.next_year.total;
03471 
03472             font_chartsm.right_put( xColumn1, y+2, m.format(percent1, 24));
03473             font_chartsm.right_put( xColumn3, y+2, m.format(percent2, 24));
03474             font_chartsm.right_put( xColumn5, y+2, m.format(percent3, 24));
03475         }
03476         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==80) {
03477             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tOther expenditures"</span>,  xColumn1);
03478             <span class="keywordtype">double</span> percent1,percent2,percent3;
03479             percent1=100*finance.total_expense.other/finance.total_expense.total;
03480             percent2=100*finance.projected_total_expense.this_year.other/
03481                 finance.projected_total_expense.this_year.total;
03482             percent3=100*finance.projected_total_expense.next_year.other/
03483                 finance.projected_total_expense.next_year.total;
03484 
03485             font_chartsm.right_put( xColumn1, y+2, m.format(percent1, 24));
03486             font_chartsm.right_put( xColumn3, y+2, m.format(percent2, 24));
03487             font_chartsm.right_put( xColumn5, y+2, m.format(percent3, 24));
03488         }
03489         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==81) {
03490             font_chart_red_sm.disp( x, y, <span class="stringliteral">"\tTotal"</span>,  xColumn1);
03491             <span class="keywordtype">double</span> percent1,percent2,percent3;
03492             percent1=100;
03493             percent2=100;
03494             percent3=100;
03495 
03496             font_chartsm.right_put( xColumn1, y+2, m.format(percent1, 24));
03497             font_chartsm.right_put( xColumn3, y+2, m.format(percent2, 24));
03498             font_chartsm.right_put( xColumn5, y+2, m.format(percent3, 24));
03499         }
03500     }
03501     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(recNo==82) {
03502         font_chartsm.disp( x, y,<span class="stringliteral">"Surplus (deficit)"</span>, xColumn2);
03503         <span class="keywordflow">if</span>(finance.last_year.surplus_deficit&gt;0)
03504             font_chart_green_sm.right_put( xColumn1, y+2, m.format(finance.last_year.surplus_deficit, 2));
03505         <span class="keywordflow">else</span>
03506             font_chart_red_sm.right_put( xColumn1, y+2, m.format(finance.last_year.surplus_deficit, 2));
03507 
03508         <span class="keywordflow">if</span>(finance.this_year.surplus_deficit&gt;0)
03509             font_chart_green_sm.right_put( xColumn3, y+2, m.format(finance.this_year.surplus_deficit, 2));
03510         <span class="keywordflow">else</span>
03511             font_chart_red_sm.right_put( xColumn3, y+2, m.format(finance.this_year.surplus_deficit, 2));
03512 
03513         <span class="keywordflow">if</span>(finance.next_year.surplus_deficit&gt;0)
03514             font_chart_green_sm.right_put( xColumn5, y+2, m.format(finance.next_year.surplus_deficit, 2));
03515         <span class="keywordflow">else</span>
03516             font_chart_red_sm.right_put( xColumn5, y+2, m.format(finance.next_year.surplus_deficit, 2));
03517     }
03518 
03519 }
03520 <span class="preprocessor">#endif</span>
03521 <span class="preprocessor"></span><span class="comment">//------ End of static function fin_rep_case9 --------//</span>
03522 
03523 <span class="comment">//------ Begin of static function fin_rep_case9 --------//</span>
03524 <span class="comment">//</span>
03525 <span class="comment">// export the content of export_fin_rep_case9 to file</span>
03526 <span class="comment">//</span>
<a name="l03527"></a><a class="code" href="ofin__rep_8cpp.html#a31">03527</a> <span class="keywordtype">void</span> <a class="code" href="ofin__rep_8cpp.html#a31">export_fin_rep_case9</a>( <a class="code" href="classFile.html">File</a> *filePtr ) {
03528     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>( filePtr, <span class="stringliteral">"Three-Year Projection (Expanded)"</span> ); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>( filePtr );
03529     <span class="keywordtype">int</span> tyear=info.financial_year();
03530     <span class="keywordtype">int</span> i;
03531     <span class="comment">// write year label</span>
03532     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>( filePtr, <span class="stringliteral">"Year"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
03533     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>( filePtr, <span class="stringliteral">"Initial"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
03534     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, tyear-1 ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
03535     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>( filePtr, <span class="stringliteral">"Change"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
03536     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, tyear ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
03537     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>( filePtr, <span class="stringliteral">"Change"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
03538     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>( filePtr, tyear+1 ); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>( filePtr );
03539     <span class="comment">// revenue</span>
03540     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>( filePtr, <span class="stringliteral">"Revenue"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
03541     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank initial field</span>
03542     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank last year</span>
03543     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank change</span>
03544     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank this year</span>
03545     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank change</span>
03546     <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>( filePtr );              <span class="comment">// blank next year</span>
03547 
03548     <span class="comment">// revenue records</span>
03549     <span class="keywordflow">for</span>( i=0; i &lt; <a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>; ++i ) {
03550         <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, game_str_res.financial_report_str(i) ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03551 
03552         <span class="keywordflow">if</span>(i==<a class="code" href="Ofinance_8h.html#a101a35">AC_SPONSORED_RESEARCH_REVENUE</a>) {
03553             <span class="comment">// insert Direct and inDirect, total</span>
03554             <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );           <span class="comment">// blank initial field</span>
03555             <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );           <span class="comment">// blank last year</span>
03556             <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );           <span class="comment">// blank change</span>
03557             <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );           <span class="comment">// blank this year</span>
03558             <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );           <span class="comment">// blank change</span>
03559             <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>( filePtr );          <span class="comment">// blank next year</span>
03560 
03561             <span class="comment">// direct</span>
03562             <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"     Direct"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03563             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.initial_revenue_array[i].direct); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03564             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.revenue_array[i].direct); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03565             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_revenue_array[i].change_last_year.direct); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03566             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_revenue_array[i].this_year.direct); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03567             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_revenue_array[i].change_next_year.direct); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03568             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_revenue_array[i].next_year.direct); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
03569 
03570             <span class="comment">// in-direct</span>
03571             <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"     Indirect"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03572             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.initial_revenue_array[i].indirect); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03573             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.revenue_array[i].indirect); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03574             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_revenue_array[i].change_last_year.indirect); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03575             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_revenue_array[i].this_year.indirect); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03576             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_revenue_array[i].change_next_year.indirect); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03577             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_revenue_array[i].next_year.indirect); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
03578 
03579             <span class="comment">// write total label</span>
03580             <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"     Total"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03581         }
03582 
03583         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.initial_revenue_array[i].total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03584         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.revenue_array[i].total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03585         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_revenue_array[i].change_last_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03586         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_revenue_array[i].this_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03587         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_revenue_array[i].change_next_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03588         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_revenue_array[i].next_year.total); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
03589     }
03590 
03591     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"  Total sources of funds"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03592     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.initial_total_revenue_total ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03593     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.total_revenue.total ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03594     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_revenue.change_last_year.total ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03595     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_revenue.this_year.total ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03596     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_revenue.change_next_year.total ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03597     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_revenue.next_year.total ); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
03598 
03599     <span class="comment">// expenditure</span>
03600     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>( filePtr, <span class="stringliteral">"Expenditures"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
03601     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank initial field</span>
03602     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank last year</span>
03603     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank change</span>
03604     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank this year</span>
03605     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank change</span>
03606     <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>( filePtr );              <span class="comment">// blank next year</span>
03607 
03608     <span class="keywordflow">for</span>( i=0; i &lt; <a class="code" href="Ofinance_8h.html#a103a44">EXPENSE_ITEM_COUNT</a>; ++i ) {
03609         <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>( filePtr, game_str_res.financial_report_str(i+<a class="code" href="Ofinance_8h.html#a100a31">REVENUE_ITEM_COUNT</a>) ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
03610         <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );             <span class="comment">// blank initial field</span>
03611         <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );             <span class="comment">// blank last year</span>
03612         <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );             <span class="comment">// blank change</span>
03613         <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );             <span class="comment">// blank this year</span>
03614         <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );             <span class="comment">// blank change</span>
03615         <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>( filePtr );            <span class="comment">// blank next year</span>
03616 
03617         <span class="comment">// write AY faculty compensation</span>
03618         <span class="keywordflow">if</span>( i==<a class="code" href="Ofinance_8h.html#a104a45">AC_ACADEMIC_DEPARTMENTS</a>||i==<a class="code" href="Ofinance_8h.html#a104a46">AC_SPONSORED_RESEARCH_EXPENSE</a>) {
03619             <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"     AY faculty compensation"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03620             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.initial_expense_array[i].faculty); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03621             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.expense_array[i].faculty); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03622             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_expense_array[i].change_last_year.faculty); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03623             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_expense_array[i].this_year.faculty); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03624             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_expense_array[i].change_next_year.faculty); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03625             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_expense_array[i].next_year.faculty); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
03626         }
03627 
03628         <span class="keywordflow">if</span>(i&lt;<a class="code" href="Ofinance_8h.html#a102a42">OPERATING_EXPENSE_ITEM_COUNT</a>) {          <span class="comment">//only for operating expenditures</span>
03629             <span class="comment">// write staff compensation</span>
03630             <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"     Staff compensation"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03631             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.initial_expense_array[i].staff ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03632             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.expense_array[i].staff ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03633             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_expense_array[i].change_last_year.staff ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03634             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_expense_array[i].this_year.staff ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03635             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_expense_array[i].change_next_year.staff ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03636             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_expense_array[i].next_year.staff ); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
03637         }
03638 
03639         <span class="comment">// write other expenditures</span>
03640         <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"     Other expenditures"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03641         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.initial_expense_array[i].other ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03642         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.expense_array[i].other ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03643         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_expense_array[i].change_last_year.other ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03644         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_expense_array[i].this_year.other ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03645         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_expense_array[i].change_next_year.other ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03646         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_expense_array[i].next_year.other ); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
03647 
03648         <span class="comment">// write total</span>
03649         <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"     Total"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03650         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.initial_expense_array[i].total ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03651         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.expense_array[i].total ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03652         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_expense_array[i].change_last_year.total ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03653         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_expense_array[i].this_year.total ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03654         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_expense_array[i].change_next_year.total ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03655         <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_expense_array[i].next_year.total ); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
03656 
03657         <span class="comment">// write total operating expenditures</span>
03658         <span class="keywordflow">if</span>( i==<a class="code" href="Ofinance_8h.html#a102a42">OPERATING_EXPENSE_ITEM_COUNT</a>-1 ) {
03659             <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>( filePtr, <span class="stringliteral">"  Total operating expenditures"</span> );<a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );
03660             <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );           <span class="comment">// blank initial field</span>
03661             <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );           <span class="comment">// blank last year</span>
03662             <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );           <span class="comment">// blank change</span>
03663             <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );           <span class="comment">// blank this year</span>
03664             <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );           <span class="comment">// blank change</span>
03665             <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>( filePtr );          <span class="comment">// blank next year</span>
03666 
03667             <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"     AY faculty compensation"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03668             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.initial_total_operating_expense.faculty); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03669             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.total_operating_expense.faculty); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03670             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_operating_expense.change_last_year.faculty); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03671             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_operating_expense.this_year.faculty); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03672             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_operating_expense.change_next_year.faculty); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03673             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_operating_expense.next_year.faculty); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
03674 
03675             <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"     Staff faculty compensation"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03676             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.initial_total_operating_expense.staff); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03677             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.total_operating_expense.staff); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03678             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_operating_expense.change_last_year.staff); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03679             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_operating_expense.this_year.staff); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03680             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_operating_expense.change_next_year.staff); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03681             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_operating_expense.next_year.staff); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
03682 
03683             <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"     Other expenditures"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03684             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.initial_total_operating_expense.other); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03685             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.total_operating_expense.other); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03686             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_operating_expense.change_last_year.other); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03687             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_operating_expense.this_year.other); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03688             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_operating_expense.change_next_year.other); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03689             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_operating_expense.next_year.other); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
03690 
03691             <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"     Total"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03692             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.initial_total_operating_expense.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03693             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.total_operating_expense.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03694             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_operating_expense.change_last_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03695             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_operating_expense.this_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03696             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_operating_expense.change_next_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03697             <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_operating_expense.next_year.total); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
03698         }
03699     }
03700 
03701     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"  Total uses of funds"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03702     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank initial field</span>
03703     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank last year</span>
03704     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank change</span>
03705     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank this year</span>
03706     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank change</span>
03707     <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>( filePtr );              <span class="comment">// blank next year</span>
03708 
03709     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"     AY faculty compensation"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03710     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.initial_total_expense.faculty ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03711     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.total_expense.faculty); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03712     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_expense.change_last_year.faculty); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03713     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_expense.this_year.faculty); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03714     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_expense.change_next_year.faculty); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03715     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_expense.next_year.faculty); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
03716 
03717     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"     Staff compensation"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03718     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.initial_total_expense.staff ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03719     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.total_expense.staff); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03720     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_expense.change_last_year.staff); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03721     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_expense.this_year.staff); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03722     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_expense.change_next_year.staff); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03723     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_expense.next_year.staff); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
03724 
03725     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"     Other expenditures"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03726     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.initial_total_expense.other ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03727     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.total_expense.other); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03728     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_expense.change_last_year.other); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03729     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_expense.this_year.other); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03730     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_expense.change_next_year.other); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03731     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_expense.next_year.other); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
03732 
03733     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"     Total"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03734     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.initial_total_expense.total ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03735     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.total_expense.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03736     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_expense.change_last_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03737     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_expense.this_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03738     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, 0.01*finance.projected_total_expense.change_next_year.total); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03739     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.projected_total_expense.next_year.total); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
03740 
03741     <span class="comment">// write percent of total use</span>
03742     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"  Percent of total uses"</span> ); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03743     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank initial field</span>
03744     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank last year</span>
03745     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank change</span>
03746     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank this year</span>
03747     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>( filePtr );               <span class="comment">// blank change</span>
03748     <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>( filePtr );              <span class="comment">// blank next year</span>
03749 
03750     <span class="keywordtype">double</span> percent1,percent2,percent3,percent4;
03751 
03752     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"     AY faculty compensation"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03753     percent1=finance.total_expense.faculty/finance.total_expense.total;
03754     percent2=finance.projected_total_expense.this_year.faculty/
03755         finance.projected_total_expense.this_year.total;
03756     percent3=finance.projected_total_expense.next_year.faculty/
03757         finance.projected_total_expense.next_year.total;
03758     percent4=finance.initial_total_expense.faculty/finance.initial_total_expense.total;
03759     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent4); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03760     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent1); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03761     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03762     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent2); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03763     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03764     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent3); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
03765 
03766     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"     Staff compensation"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03767     percent1=finance.total_expense.staff/finance.total_expense.total;
03768     percent2=finance.projected_total_expense.this_year.staff/
03769         finance.projected_total_expense.this_year.total;
03770     percent3=finance.projected_total_expense.next_year.staff/
03771         finance.projected_total_expense.next_year.total;
03772     percent4=finance.initial_total_expense.staff/finance.initial_total_expense.total;
03773     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent4); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03774     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent1); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03775     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03776     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent2); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03777     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03778     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent3); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
03779 
03780     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"     Other expenditures"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03781     percent1=finance.total_expense.other/finance.total_expense.total;
03782     percent2=finance.projected_total_expense.this_year.other/
03783         finance.projected_total_expense.this_year.total;
03784     percent3=finance.projected_total_expense.next_year.other/
03785         finance.projected_total_expense.next_year.total;
03786     percent4=finance.initial_total_expense.other/finance.initial_total_expense.total;
03787     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent4); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03788     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent1); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03789     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03790     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent2); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03791     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03792     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent3); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
03793 
03794     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"     Total"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03795     percent1=1.0;
03796     percent2=1.0;
03797     percent3=1.0;
03798     percent4=1.0;
03799     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent4); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03800     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent1); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03801     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03802     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent2); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03803     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03804     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, percent3); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
03805 
03806     <a class="code" href="ogfile5_8cpp.html#a1">WRITE_STR_FIELD</a>(filePtr, <span class="stringliteral">"  Surplus (deficit)"</span>); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03807     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.initial_last_year.surplus_deficit); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03808     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.last_year.surplus_deficit); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03809     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03810     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.this_year.surplus_deficit); <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03811     <a class="code" href="ogfile5_8cpp.html#a0">WRITE_FIELD_SEPARATOR</a>(filePtr);
03812     <a class="code" href="ogfile5_8cpp.html#a2">WRITE_NUM_FIELD</a>(filePtr, finance.next_year.surplus_deficit); <a class="code" href="ogfile5_8cpp.html#a4">WRITE_RECORD_SEPARATOR</a>(filePtr);
03813 }
03814 
03815 <span class="comment">//------ End of static function export_fin_rep_case9 --------//</span>
03816 
03817 <span class="comment">//------ Begin of static function disp_fin_rep_row --------//</span>
03818 
03819 <span class="keyword">static</span> <span class="keywordtype">void</span> disp_fin_rep_row(<span class="keywordtype">int</span> recNo, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> refreshFlag) {
03820     <span class="comment">//----- display financial report -----//</span>
03821     <span class="comment">//  user_interface.bar(x, y, REPORT_X2-10, y+browse_financial.rec_height*2-5,FIN_REP_SHEET_COLOR);</span>
03822 
03823     <span class="comment">// Case 1: RENVENUE and PREVIOUS YEAR</span>
03824     <span class="keywordflow">if</span>(finance.report_type==<a class="code" href="Ofinance_8h.html#a92a4">REPORT_TYPE_REVENUE</a> &amp;&amp;
03825        finance.report_year==<a class="code" href="Ofinance_8h.html#a94a13">REPORT_YEAR_PREV</a>) {
03826         fin_rep_case1(recNo,x,y);
03827     }
03828 
03829     <span class="comment">// Case 2: RENVENUE and THIS YEAR</span>
03830     <span class="keywordflow">if</span>(finance.report_type==<a class="code" href="Ofinance_8h.html#a92a4">REPORT_TYPE_REVENUE</a> &amp;&amp;
03831        finance.report_year==<a class="code" href="Ofinance_8h.html#a94a14">REPORT_YEAR_THIS</a>) {
03832         fin_rep_case2(recNo,x,y);
03833     }
03834 
03835     <span class="comment">// Case 3: RENVENUE and NEXT YEAR</span>
03836     <span class="keywordflow">if</span>(finance.report_type==<a class="code" href="Ofinance_8h.html#a92a4">REPORT_TYPE_REVENUE</a> &amp;&amp;
03837        finance.report_year==<a class="code" href="Ofinance_8h.html#a94a15">REPORT_YEAR_NEXT</a>) {
03838         fin_rep_case3(recNo,x,y);
03839     }
03840 
03841     <span class="comment">// Case 4: RENVENUE and THREE YEARS</span>
03842     <span class="keywordflow">if</span>(finance.report_type==<a class="code" href="Ofinance_8h.html#a92a4">REPORT_TYPE_REVENUE</a> &amp;&amp;
03843        finance.report_year==<a class="code" href="Ofinance_8h.html#a94a12">REPORT_YEAR_THREE_YEARS</a>  <span class="comment">//&amp;&amp;</span>
03844         ) {                                             
03845         fin_rep_case4(recNo,x,y);
03846     }
03847 
03848     <span class="comment">// Case 5: BALANCE SHEET &amp;&amp; LAST YEAR</span>
03849     <span class="keywordflow">if</span>(finance.report_type==<a class="code" href="Ofinance_8h.html#a92a5">REPORT_TYPE_BALANCE</a> &amp;&amp;
03850        finance.report_year==<a class="code" href="Ofinance_8h.html#a94a13">REPORT_YEAR_PREV</a>) {
03851         fin_rep_case5(recNo,x,y);
03852     }
03853 
03854     <span class="comment">// Case 6: BALANCE SHEET &amp;&amp; THIS YEAR</span>
03855     <span class="keywordflow">if</span>(finance.report_type==<a class="code" href="Ofinance_8h.html#a92a5">REPORT_TYPE_BALANCE</a> &amp;&amp;
03856        finance.report_year==<a class="code" href="Ofinance_8h.html#a94a14">REPORT_YEAR_THIS</a>) {
03857         fin_rep_case6(recNo,x,y);
03858     }
03859 
03860     <span class="comment">// Case 7: BALANCE SHEET &amp;&amp; NEXT YEAR</span>
03861     <span class="keywordflow">if</span>(finance.report_type==<a class="code" href="Ofinance_8h.html#a92a5">REPORT_TYPE_BALANCE</a> &amp;&amp;
03862        finance.report_year==<a class="code" href="Ofinance_8h.html#a94a15">REPORT_YEAR_NEXT</a>) {
03863         fin_rep_case7(recNo,x,y);
03864     }
03865 
03866     <span class="comment">// Case 8: BALANCE SHEET &amp;&amp; THREE YEAR</span>
03867 
03868     <span class="keywordflow">if</span>(finance.report_type==<a class="code" href="Ofinance_8h.html#a92a5">REPORT_TYPE_BALANCE</a> &amp;&amp;
03869        finance.report_year==<a class="code" href="Ofinance_8h.html#a94a12">REPORT_YEAR_THREE_YEARS</a>) {
03870         fin_rep_case8(recNo,x,y);
03871     }
03872 
03873     <span class="comment">// Case 9: EXPANDING THREE YEARS REVENUE</span>
03874     <span class="comment">/*  if( finance.report_is_expanded &amp;&amp;</span>
03875 <span class="comment">        finance.report_type==REPORT_TYPE_REVENUE &amp;&amp;</span>
03876 <span class="comment">        finance.report_year==REPORT_YEAR_THREE_YEARS )</span>
03877 <span class="comment">    */</span>
03878     <span class="keywordflow">if</span>(finance.report_type==<a class="code" href="Ofinance_8h.html#a92a7">REPORT_TYPE_DETAIL_REN</a>) {
03879         finance.report_year=<a class="code" href="Ofinance_8h.html#a94a12">REPORT_YEAR_THREE_YEARS</a>;
03880         fin_rep_case9(recNo,x,y);
03881     }
03882     <span class="comment">//  vga.blt_buf( x, y, REPORT_X2-10, y+browse_financial.rec_height*2-5);</span>
03883 
03884 }
03885 
03886 <span class="comment">//------ End of static function disp_fin_rep_row --------//</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:37:37 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
