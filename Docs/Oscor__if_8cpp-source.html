<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Oscor_if.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Oscor_if.cpp</h1><a href="Oscor__if_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : OSCOR_IF.CPP</span>
00002 <span class="comment">//Description : Score Report</span>
00003 
00004 <span class="preprocessor">#include &lt;<a class="code" href="KEY_8H.html">KEY.H</a>&gt;</span>
00005 <span class="preprocessor">#include &lt;<a class="code" href="OVGA_8H.html">OVGA.H</a>&gt;</span>
00006 <span class="preprocessor">#include &lt;OFONT.H&gt;</span>
00007 <span class="preprocessor">#include &lt;<a class="code" href="OWORLD_8H.html">OWORLD.H</a>&gt;</span>
00008 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00009 <span class="preprocessor">#include &lt;<a class="code" href="OSCHLRES_8H.html">OSCHLRES.H</a>&gt;</span>
00010 <span class="preprocessor">#include &lt;<a class="code" href="OPEERSCH_8H.html">OPEERSCH.H</a>&gt;</span>                             <span class="comment">// enrollment</span>
00011 <span class="preprocessor">#include &lt;OINFO.H&gt;</span>
00012 <span class="preprocessor">#include &lt;<a class="code" href="OGRPHYR_8H.html">OGRPHYR.H</a>&gt;</span>
00013 <span class="preprocessor">#include &lt;OIFACE.H&gt;</span>
00014 <span class="preprocessor">#include &lt;OBUTTON.H&gt;</span>
00015 <span class="preprocessor">#include &lt;ODEPT.H&gt;</span>
00016 <span class="preprocessor">#include &lt;OPSCHOOL.H&gt;</span>
00017 <span class="preprocessor">#include &lt;OSTUDENT.H&gt;</span>
00018 <span class="preprocessor">#include &lt;<a class="code" href="OTEXT_8H.html">OTEXT.H</a>&gt;</span>
00019 <span class="preprocessor">#include &lt;OLgTEXT.H&gt;</span>
00020 <span class="preprocessor">#include &lt;OGAMESTR.H&gt;</span>
00021 <span class="preprocessor">#include &lt;<a class="code" href="OPIECHRT_8H.html">OPIECHRT.H</a>&gt;</span>
00022 <span class="preprocessor">#include &lt;<a class="code" href="OGRPH__PM_8H.html">OGRPH_PM.H</a>&gt;</span>
00023 <span class="preprocessor">#include &lt;<a class="code" href="OHELPIF_8H.html">OHELPIF.H</a>&gt;</span>
00024 <span class="preprocessor">#include &lt;<a class="code" href="OVBROW98_8H.html">OVBROW98.H</a>&gt;</span>
00025 <span class="preprocessor">#include &lt;OAUDIO.H&gt;</span>
00026 <span class="preprocessor">#include &lt;OCONFIG.H&gt;</span>
00027 <span class="preprocessor">#include &lt;<a class="code" href="OTASK_8H.html">OTASK.H</a>&gt;</span>                                <span class="comment">//## chea 200899 added task</span>
00028 
00029 <span class="comment">//---------- Define constant ------------//</span>
00030 
00031 <span class="keyword">enum</span> {
00032     <a class="code" href="Oscor__if_8cpp.html#a105a57">REPORT_X1</a> = <a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>+15,
00033     <a class="code" href="Oscor__if_8cpp.html#a105a58">REPORT_Y1</a> = <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>+10,
00034     <a class="code" href="Oscor__if_8cpp.html#a105a59">REPORT_X2</a> = <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-15,
00035     <a class="code" href="Oscor__if_8cpp.html#a105a60">REPORT_Y2</a> = <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-40,
00036 };
00037 
00038 <span class="keyword">enum</span> {
00039     <a class="code" href="Oscor__if_8cpp.html#a106a61">BOTTOM_BUTTON_WIDTH</a> = 100,
00040     <a class="code" href="Oscor__if_8cpp.html#a106a62">BOTTOM_BUTTON_WIDTH2</a> = 150,
00041     <a class="code" href="Oscor__if_8cpp.html#a106a63">BOTTOM_BUTTON_WIDTH3</a> = 220,
00042     <a class="code" href="Oscor__if_8cpp.html#a106a64">BOTTOM_BUTTON_HEIGHT</a> = 25,
00043     <a class="code" href="Oscor__if_8cpp.html#a106a65">BOTTOM_BUTTON_DISTANCE</a>
00044     = (<a class="code" href="Oscor__if_8cpp.html#a105a59">REPORT_X2</a>-<a class="code" href="Oscor__if_8cpp.html#a105a57">REPORT_X1</a>-<a class="code" href="Oscor__if_8cpp.html#a106a61">BOTTOM_BUTTON_WIDTH</a>*6)/6+30  ,
00045     <a class="code" href="Oscor__if_8cpp.html#a106a66">BOTTOM_BUTTON_DISTANCE2</a>
00046     = (<a class="code" href="Oscor__if_8cpp.html#a105a59">REPORT_X2</a>-<a class="code" href="Oscor__if_8cpp.html#a105a57">REPORT_X1</a>-<a class="code" href="Oscor__if_8cpp.html#a106a62">BOTTOM_BUTTON_WIDTH2</a>*2)/24,
00047     <a class="code" href="Oscor__if_8cpp.html#a106a67">BOTTOM_BUTTON_DISTANCE3</a>
00048     = (<a class="code" href="Oscor__if_8cpp.html#a105a59">REPORT_X2</a>-<a class="code" href="Oscor__if_8cpp.html#a105a57">REPORT_X1</a>-<a class="code" href="Oscor__if_8cpp.html#a106a63">BOTTOM_BUTTON_WIDTH3</a>*3)/3-5
00049 };
00050 
00051 <span class="keyword">enum</span> {
00052     <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a> = <a class="code" href="Oscor__if_8cpp.html#a105a57">REPORT_X1</a>+10,
00053     <a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a> = <a class="code" href="Oscor__if_8cpp.html#a105a58">REPORT_Y1</a>+16,
00054     <a class="code" href="Oscor__if_8cpp.html#a107a70">WINDOW_X2</a> = <a class="code" href="Oscor__if_8cpp.html#a105a59">REPORT_X2</a>-10,
00055     <span class="comment">//                  WINDOW_Y2 = REPORT_Y2-44,</span>
00056     <a class="code" href="Oscor__if_8cpp.html#a107a71">WINDOW_Y2</a> = <a class="code" href="Oscor__if_8cpp.html#a105a60">REPORT_Y2</a>-52,
00057 };
00058 
00059 <span class="keyword">enum</span> {                                            <span class="comment">// the bg image id</span>
00060     <a class="code" href="Oscor__if_8cpp.html#a108a72">BG_PIC_ID</a> = 10
00061 };
00062 
00063 <span class="keyword">enum</span> {
00064     <a class="code" href="Oscor__if_8cpp.html#a109a73">MODE_OVERALL</a>=0,
00065     <a class="code" href="Oscor__if_8cpp.html#a109a74">MODE_RANK</a>=1,
00066     <a class="code" href="Oscor__if_8cpp.html#a109a75">MODE_OUTPUTS</a>=2,
00067     <a class="code" href="Oscor__if_8cpp.html#a109a76">MODE_GENERAL_INSTITUTIONAL_PERFORMANCE</a>=3,
00068     <a class="code" href="Oscor__if_8cpp.html#a109a77">MODE_ATTITUDES_TOWARD_THE_INSTITUTION</a>=4,
00069     <a class="code" href="Oscor__if_8cpp.html#a109a78">MODE_FINANCE</a>=5,
00070     <a class="code" href="Oscor__if_8cpp.html#a109a79">MODE_MANAGEMENT</a>=6,
00071     <a class="code" href="Oscor__if_8cpp.html#a109a80">MODE_ADMISSION</a>=7,
00072 };
00073 
00074 <span class="keyword">static</span> <span class="keywordtype">char</span>     report_init_flag=0;
00075 
00076 <span class="keyword">static</span> <a class="code" href="classButtonGroup.html">ButtonGroup</a> type_button_group(8);
00077 
00078 <span class="keyword">static</span> <a class="code" href="classButton.html">Button</a> help_button_array[9];
00079 
00080 <span class="keyword">static</span> <span class="keywordtype">short</span> *type_button_up_bitmap[8];
00081 
00082 <span class="keyword">static</span> <span class="keywordtype">short</span> *type_button_down_bitmap[8];
00083 
00084 <span class="keyword">static</span> <span class="keywordtype">char</span>  *type_button_label[8]= {
00085     <span class="stringliteral">"Overall"</span>,<span class="stringliteral">"Rank"</span>,<span class="stringliteral">"Outputs"</span>,
00086     <span class="stringliteral">"Performance indicators"</span>,
00087     <span class="stringliteral">"Attitudes toward the institution"</span>,
00088     <span class="stringliteral">"Financial indicators"</span>,<span class="stringliteral">"Management"</span>,<span class="stringliteral">"Admission"</span>
00089 };
00090 
00091 <span class="keyword">static</span> <span class="keywordtype">void</span> report_overall(<span class="keywordtype">int</span>);
00092 <span class="keyword">static</span> <span class="keywordtype">void</span> report_rank(<span class="keywordtype">int</span>);
00093 <span class="keyword">static</span> <span class="keywordtype">void</span> report_outputs(<span class="keywordtype">int</span>);
00094 <span class="keyword">static</span> <span class="keywordtype">void</span> report_general(<span class="keywordtype">int</span>);
00095 <span class="keyword">static</span> <span class="keywordtype">void</span> report_attitudes(<span class="keywordtype">int</span>);
00096 <span class="keyword">static</span> <span class="keywordtype">void</span> report_management(<span class="keywordtype">int</span>);
00097 <span class="keyword">static</span> <span class="keywordtype">void</span> report_finance(<span class="keywordtype">int</span>);
00098 
00099 <span class="keyword">static</span> <span class="keywordtype">int</span> detect_overall();
00100 <span class="keyword">static</span> <span class="keywordtype">int</span> detect_rank();
00101 <span class="keyword">static</span> <span class="keywordtype">int</span> detect_outputs();
00102 <span class="keyword">static</span> <span class="keywordtype">int</span> detect_general();
00103 <span class="keyword">static</span> <span class="keywordtype">int</span> detect_attitudes();
00104 <span class="keyword">static</span> <span class="keywordtype">int</span> detect_management();
00105 <span class="keyword">static</span> <span class="keywordtype">int</span> detect_finance();
00106 
00107 <span class="keyword">static</span> <span class="keywordtype">void</span> deinit_overall();
00108 <span class="keyword">static</span> <span class="keywordtype">void</span> deinit_rank();
00109 <span class="keyword">static</span> <span class="keywordtype">void</span> deinit_outputs();
00110 <span class="keyword">static</span> <span class="keywordtype">void</span> deinit_general();
00111 <span class="keyword">static</span> <span class="keywordtype">void</span> deinit_attitudes();
00112 <span class="keyword">static</span> <span class="keywordtype">void</span> deinit_management();
00113 <span class="keyword">static</span> <span class="keywordtype">void</span> deinit_finance();
00114 
00115 <span class="keyword">static</span> <span class="keywordtype">void</span> overall_disp_rep_row(<span class="keywordtype">int</span> recNo, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> refreshFlag);
00116 <span class="keyword">static</span> <span class="keywordtype">void</span> rank_disp_rep_row(<span class="keywordtype">int</span> recNo, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> refreshFlag);
00117 
<a name="l00118"></a><a class="code" href="Oscor__if_8cpp.html#a13">00118</a> <span class="keyword">typedef</span> void (*<a class="code" href="Oscor__if_8cpp.html#a13">ReportFP</a>)(<span class="keywordtype">int</span> refreshFlag);
<a name="l00119"></a><a class="code" href="Oscor__if_8cpp.html#a14">00119</a> <span class="keyword">typedef</span> int (*<a class="code" href="Oscor__if_8cpp.html#a14">DetectFP</a>)();
<a name="l00120"></a><a class="code" href="Oscor__if_8cpp.html#a15">00120</a> <span class="keyword">typedef</span> void (*<a class="code" href="Oscor__if_8cpp.html#a15">DeinitFP</a>)();
00121 
00122 <span class="keyword">static</span> <a class="code" href="Oscor__if_8cpp.html#a13">ReportFP</a> report_func_ptr[] = {
00123     &amp;report_overall,
00124     &amp;report_rank,
00125     &amp;report_outputs,
00126     &amp;report_general,
00127     &amp;report_attitudes,
00128     <span class="comment">//  &amp;report_management,</span>
00129     &amp;report_finance,
00130 };
00131 
00132 <span class="keyword">static</span> <a class="code" href="Oscor__if_8cpp.html#a14">DetectFP</a> detect_func_ptr[] = {
00133     &amp;detect_overall,
00134     &amp;detect_rank,
00135     &amp;detect_outputs,
00136     &amp;detect_general,
00137     &amp;detect_attitudes,
00138     <span class="comment">//  &amp;detect_management,</span>
00139     &amp;detect_finance,
00140 };
00141 
00142 <span class="keyword">static</span> <a class="code" href="Oscor__if_8cpp.html#a15">DeinitFP</a> deinit_func_ptr[] = {
00143     &amp;deinit_overall,
00144     &amp;deinit_rank,
00145     &amp;deinit_outputs,
00146     &amp;deinit_general,
00147     &amp;deinit_attitudes,
00148     <span class="comment">//  &amp;deinit_management,</span>
00149     &amp;deinit_finance,
00150 };
00151 
<a name="l00152"></a><a class="code" href="classPlayerSchool.html#a29">00152</a> <span class="keywordtype">void</span> <a class="code" href="classPlayerSchool.html#a29">PlayerSchool::score_report</a>(<span class="keywordtype">int</span> refreshFlag) {
00153     <span class="keyword">const</span> <span class="keyword">static</span> tab1=10,tab2=150,tab3=320,tab4=420,tab5=490,tab6=620,tab7=680;
00154     <span class="keyword">const</span> <span class="keyword">static</span> vtab1=22,vtab2=37,vtab3=200,vtab4=330,vtab5=320;
00155 
00156     vga.use_back();
00157     sys.is_institution_report=1;
00158     <span class="keywordflow">if</span>( refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a> ) {
00159 
00160         <span class="keywordflow">if</span>( report_init_flag )                        <span class="comment">// deinit it first if it has already been initialized</span>
00161             <a class="code" href="classPlayerSchool.html#a32">score_report_deinit</a>();
00162         report_init_flag = 1;
00163 
00164         <span class="comment">//----- initialize the bottom sub-menus buttons -----//</span>
00165 
00166         user_interface.bg_img(<a class="code" href="Oscor__if_8cpp.html#a108a72">BG_PIC_ID</a>, &amp;vga_back);
00167 
00168         <span class="comment">// top title</span>
00169         user_interface.brighten(<a class="code" href="Oscor__if_8cpp.html#a105a57">REPORT_X1</a>+100,<a class="code" href="Oscor__if_8cpp.html#a105a58">REPORT_Y1</a>-10,<a class="code" href="Oscor__if_8cpp.html#a105a57">REPORT_X1</a>+630,<a class="code" href="Oscor__if_8cpp.html#a105a58">REPORT_Y1</a>+13);
00170         user_interface.rect(<a class="code" href="Oscor__if_8cpp.html#a105a57">REPORT_X1</a>+100,<a class="code" href="Oscor__if_8cpp.html#a105a58">REPORT_Y1</a>-10,<a class="code" href="Oscor__if_8cpp.html#a105a57">REPORT_X1</a>+630,<a class="code" href="Oscor__if_8cpp.html#a105a58">REPORT_Y1</a>+13,1);
00171         font_charts.put(<a class="code" href="Oscor__if_8cpp.html#a105a57">REPORT_X1</a>+300,<a class="code" href="Oscor__if_8cpp.html#a105a58">REPORT_Y1</a>-4,<span class="stringliteral">"Game Score"</span>);
00172 
00173         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 6 ;i++) {
00174             type_button_up_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00175             type_button_down_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00176         }
00177 
00178         <span class="keywordtype">int</span> x=<a class="code" href="Oscor__if_8cpp.html#a105a57">REPORT_X1</a>+tab1;
00179         <span class="keywordtype">int</span> y=<a class="code" href="Oscor__if_8cpp.html#a105a58">REPORT_Y1</a>+vtab4;
00180 
00181         user_interface.create_button_bitmap(x, y,
00182                                             x+<a class="code" href="Oscor__if_8cpp.html#a106a61">BOTTOM_BUTTON_WIDTH</a>, y+<a class="code" href="Oscor__if_8cpp.html#a106a64">BOTTOM_BUTTON_HEIGHT</a>,
00183                                             type_button_label[0], &amp;type_button_up_bitmap[0],
00184                                             &amp;type_button_down_bitmap[0], &amp;vga_back);
00185 
00186         type_button_group[0].create_bitmapW(x, y,
00187                                             x+<a class="code" href="Oscor__if_8cpp.html#a106a61">BOTTOM_BUTTON_WIDTH</a>, y+<a class="code" href="Oscor__if_8cpp.html#a106a64">BOTTOM_BUTTON_HEIGHT</a>,
00188                                             ((i == <a class="code" href="classPlayerSchool.html#m79">current_score_report_type</a>) ?
00189                                              type_button_down_bitmap[0] :
00190                                              type_button_up_bitmap[0])+4);
00191 
00192         y+=30;
00193 
00194         user_interface.create_button_bitmap(x, y,
00195                                             x+<a class="code" href="Oscor__if_8cpp.html#a106a61">BOTTOM_BUTTON_WIDTH</a>, y+<a class="code" href="Oscor__if_8cpp.html#a106a64">BOTTOM_BUTTON_HEIGHT</a>,
00196                                             type_button_label[1], &amp;type_button_up_bitmap[1],
00197                                             &amp;type_button_down_bitmap[1], &amp;vga_back);
00198 
00199         type_button_group[1].create_bitmapW(x, y,
00200                                             x+<a class="code" href="Oscor__if_8cpp.html#a106a61">BOTTOM_BUTTON_WIDTH</a>, y+<a class="code" href="Oscor__if_8cpp.html#a106a64">BOTTOM_BUTTON_HEIGHT</a>,
00201                                             ((i == <a class="code" href="classPlayerSchool.html#m79">current_score_report_type</a>) ?
00202                                              type_button_down_bitmap[1] :
00203                                              type_button_up_bitmap[1])+4);
00204 
00205         x=<a class="code" href="Oscor__if_8cpp.html#a105a57">REPORT_X1</a>+tab2;
00206         y=<a class="code" href="Oscor__if_8cpp.html#a105a58">REPORT_Y1</a>+vtab4;
00207 
00208         user_interface.create_button_bitmap(x, y,
00209                                             x+<a class="code" href="Oscor__if_8cpp.html#a106a63">BOTTOM_BUTTON_WIDTH3</a>, y+<a class="code" href="Oscor__if_8cpp.html#a106a64">BOTTOM_BUTTON_HEIGHT</a>,
00210                                             type_button_label[2], &amp;type_button_up_bitmap[2],
00211                                             &amp;type_button_down_bitmap[2], &amp;vga_back);
00212         type_button_group[2].create_bitmapW(x, y,
00213                                             x+<a class="code" href="Oscor__if_8cpp.html#a106a63">BOTTOM_BUTTON_WIDTH3</a>, y+<a class="code" href="Oscor__if_8cpp.html#a106a64">BOTTOM_BUTTON_HEIGHT</a>,
00214                                             ((i == <a class="code" href="classPlayerSchool.html#m79">current_score_report_type</a>) ?
00215                                              type_button_down_bitmap[2] :
00216                                              type_button_up_bitmap[2])+4);
00217 
00218         x+=<a class="code" href="Oscor__if_8cpp.html#a106a63">BOTTOM_BUTTON_WIDTH3</a>+<a class="code" href="Oscor__if_8cpp.html#a106a65">BOTTOM_BUTTON_DISTANCE</a>;
00219 
00220         user_interface.create_button_bitmap(x, y,
00221                                             x+<a class="code" href="Oscor__if_8cpp.html#a106a63">BOTTOM_BUTTON_WIDTH3</a>, y+<a class="code" href="Oscor__if_8cpp.html#a106a64">BOTTOM_BUTTON_HEIGHT</a>,
00222                                             type_button_label[3], &amp;type_button_up_bitmap[3],
00223                                             &amp;type_button_down_bitmap[3], &amp;vga_back);
00224         type_button_group[3].create_bitmapW(x, y,
00225                                             x+<a class="code" href="Oscor__if_8cpp.html#a106a63">BOTTOM_BUTTON_WIDTH3</a>, y+<a class="code" href="Oscor__if_8cpp.html#a106a64">BOTTOM_BUTTON_HEIGHT</a>,
00226                                             ((i == <a class="code" href="classPlayerSchool.html#m79">current_score_report_type</a>) ?
00227                                              type_button_down_bitmap[3] :
00228                                              type_button_up_bitmap[3])+4);
00229 
00230         x=<a class="code" href="Oscor__if_8cpp.html#a105a57">REPORT_X1</a>+tab2;
00231         y=<a class="code" href="Oscor__if_8cpp.html#a105a58">REPORT_Y1</a>+vtab4+30;
00232         user_interface.create_button_bitmap(x, y,
00233                                             x+<a class="code" href="Oscor__if_8cpp.html#a106a63">BOTTOM_BUTTON_WIDTH3</a>, y+<a class="code" href="Oscor__if_8cpp.html#a106a64">BOTTOM_BUTTON_HEIGHT</a>,
00234                                             type_button_label[4], &amp;type_button_up_bitmap[4],
00235                                             &amp;type_button_down_bitmap[4], &amp;vga_back);
00236 
00237         type_button_group[4].create_bitmapW(x, y,
00238                                             x+<a class="code" href="Oscor__if_8cpp.html#a106a63">BOTTOM_BUTTON_WIDTH3</a>, y+<a class="code" href="Oscor__if_8cpp.html#a106a64">BOTTOM_BUTTON_HEIGHT</a>,
00239                                             ((<a class="code" href="classPlayerSchool.html#m79">current_score_report_type</a>==4)?
00240                                              type_button_down_bitmap[4] :
00241                                              type_button_up_bitmap[4])+4);
00242 
00243         x+=<a class="code" href="Oscor__if_8cpp.html#a106a63">BOTTOM_BUTTON_WIDTH3</a>+<a class="code" href="Oscor__if_8cpp.html#a106a65">BOTTOM_BUTTON_DISTANCE</a>;
00244 
00245         user_interface.create_button_bitmap(x, y,
00246                                             x+<a class="code" href="Oscor__if_8cpp.html#a106a63">BOTTOM_BUTTON_WIDTH3</a>, y+<a class="code" href="Oscor__if_8cpp.html#a106a64">BOTTOM_BUTTON_HEIGHT</a>,
00247                                             type_button_label[5], &amp;type_button_up_bitmap[5],
00248                                             &amp;type_button_down_bitmap[5], &amp;vga_back);
00249 
00250         type_button_group[5].create_bitmapW(x, y,
00251                                             x+<a class="code" href="Oscor__if_8cpp.html#a106a63">BOTTOM_BUTTON_WIDTH3</a>, y+<a class="code" href="Oscor__if_8cpp.html#a106a64">BOTTOM_BUTTON_HEIGHT</a>,
00252                                             ((<a class="code" href="classPlayerSchool.html#m79">current_score_report_type</a>==5)?
00253                                              type_button_down_bitmap[5] :
00254                                              type_button_up_bitmap[5])+4);
00255 
00256         <span class="keywordflow">if</span>(<a class="code" href="classPlayerSchool.html#m79">current_score_report_type</a>&gt;1) {
00257 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00258 <span class="preprocessor"></span>            user_interface.brighten(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>,<a class="code" href="Oscor__if_8cpp.html#a107a70">WINDOW_X2</a>,<a class="code" href="Oscor__if_8cpp.html#a107a71">WINDOW_Y2</a>);
00259             user_interface.rect(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>,<a class="code" href="Oscor__if_8cpp.html#a107a70">WINDOW_X2</a>,<a class="code" href="Oscor__if_8cpp.html#a107a71">WINDOW_Y2</a>);
00260             user_interface.rect(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>,<a class="code" href="Oscor__if_8cpp.html#a107a70">WINDOW_X2</a>,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab1);
00261             font_chartsm.put(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab1-17,<span class="stringliteral">"Contributing factors"</span>);
00262             font_chartsm.put(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab3-100,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab1-17,<span class="stringliteral">"Current value"</span>);
00263             font_chartsm.put(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab4-95,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab1-17,<span class="stringliteral">"Weight"</span>);
00264             font_chartsm.right_put(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab5, <a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab1-17,<span class="stringliteral">"Change in last year"</span>);
00265             font_chartsm.put(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab5+10,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab1-17,<span class="stringliteral">"Change since start"</span>);
00266             font_chartsm.put(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab6,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab1-17,<span class="stringliteral">"Trend"</span>);
00267 <span class="preprocessor">#else</span>
00268 <span class="preprocessor"></span>            user_interface.brighten(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>,<a class="code" href="Oscor__if_8cpp.html#a107a70">WINDOW_X2</a>,<a class="code" href="Oscor__if_8cpp.html#a107a71">WINDOW_Y2</a>);
00269             user_interface.rect(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>,<a class="code" href="Oscor__if_8cpp.html#a107a70">WINDOW_X2</a>,<a class="code" href="Oscor__if_8cpp.html#a107a71">WINDOW_Y2</a>);
00270             user_interface.rect(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>,<a class="code" href="Oscor__if_8cpp.html#a107a70">WINDOW_X2</a>,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab1);
00271             font_chartsm.put(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab1-17,<span class="stringliteral">"Contributing factors"</span>);
00272             font_chartsm.put(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab3-20,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab1-17,<span class="stringliteral">"Current value"</span>);
00273             font_chartsm.put(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab4-15,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab1-17,<span class="stringliteral">"Weight"</span>);
00274             font_chartsm.put(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab5-20,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab1-17,<span class="stringliteral">"Change since start"</span>);
00275             font_chartsm.put(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab6,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab1-17,<span class="stringliteral">"Trend"</span>);
00276 <span class="preprocessor">#endif</span>
00277 <span class="preprocessor"></span>        }
00278         <span class="keywordflow">else</span> {
00279             user_interface.brighten(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>,<a class="code" href="Oscor__if_8cpp.html#a107a70">WINDOW_X2</a>,<a class="code" href="Oscor__if_8cpp.html#a107a71">WINDOW_Y2</a>);
00280             user_interface.rect(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>,<a class="code" href="Oscor__if_8cpp.html#a107a70">WINDOW_X2</a>,<a class="code" href="Oscor__if_8cpp.html#a107a71">WINDOW_Y2</a>);
00281         }
00282     }
00283     type_button_group.<a class="code" href="classButtonGroup.html#a3">paint</a>(<a class="code" href="classPlayerSchool.html#m79">current_score_report_type</a>);
00284 
00285     vga.use_back();
00286     (*report_func_ptr[<a class="code" href="classPlayerSchool.html#m79">current_score_report_type</a>])(refreshFlag);
00287 
00288     vga.blt_buf(<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>, <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>);
00289     <span class="comment">//##trevor 2807</span>
00290     vga.use_front();
00291 
00292 }
00293 
<a name="l00294"></a><a class="code" href="classPlayerSchool.html#a31">00294</a> <span class="keywordtype">void</span> <a class="code" href="classPlayerSchool.html#a31">PlayerSchool::score_report_detect</a>() {
00295     <span class="comment">//------- detect type buttons --------//</span>
00296     <span class="keywordtype">int</span> summaryButtonGroupDetect;
00297 
00298     <span class="keywordflow">if</span>((summaryButtonGroupDetect = type_button_group.<a class="code" href="classButtonGroup.html#a4">detect</a>()) &gt;= 0) {
00299         type_button_group[<a class="code" href="classPlayerSchool.html#m79">current_score_report_type</a>].body_ptr = (<span class="keywordtype">void</span> *) (type_button_up_bitmap[<a class="code" href="classPlayerSchool.html#m79">current_score_report_type</a>] + 4);
00300         <a class="code" href="classPlayerSchool.html#m79">current_score_report_type</a> = summaryButtonGroupDetect;
00301         type_button_group[<a class="code" href="classPlayerSchool.html#m79">current_score_report_type</a>].body_ptr = (<span class="keywordtype">void</span> *) (type_button_down_bitmap[<a class="code" href="classPlayerSchool.html#m79">current_score_report_type</a>] + 4);
00302         sys.redraw_all_flag = 1;
00303     }
00304     (*detect_func_ptr[<a class="code" href="classPlayerSchool.html#m79">current_score_report_type</a>])();
00305 }
00306 
<a name="l00307"></a><a class="code" href="classPlayerSchool.html#a32">00307</a> <span class="keywordtype">void</span> <a class="code" href="classPlayerSchool.html#a32">PlayerSchool::score_report_deinit</a>() {
00308     <span class="comment">//------- deinit type buttons --------//</span>
00309     type_button_group.<a class="code" href="classButtonGroup.html#a2">deinit_buttons</a>();
00310     <span class="keywordflow">if</span> (*type_button_up_bitmap) {
00311         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 6; i++) {
00312             <a class="code" href="ALL_8H.html#a8">mem_del</a>(type_button_up_bitmap[i]);
00313             <a class="code" href="ALL_8H.html#a8">mem_del</a>(type_button_down_bitmap[i]);
00314             type_button_up_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00315             type_button_down_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00316         }
00317     }
00318     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;6;i++)
00319         (*deinit_func_ptr[i])();
00320 
00321     report_init_flag = 0;
00322 }
00323 
00324 <span class="comment">//--------------------- sub screen (7) ----------------------//</span>
00325 
00326 <span class="keyword">static</span> overall_report_init_flag=0;
00327 <span class="comment">//static LargeText overall_text[5];</span>
00328 <span class="keyword">static</span> <a class="code" href="classLargeText.html">LargeText</a> overall_text[6];                 <span class="comment">//## chea 200899 to added a bouns pt</span>
00329 <span class="keyword">static</span> <a class="code" href="classGraphPerformanceIndicatorMonth.html">GraphPerformanceIndicatorMonth</a> overall_graphicon1;
00330 <span class="keyword">static</span> <a class="code" href="classGraphPerformanceIndicatorMonth.html">GraphPerformanceIndicatorMonth</a> overall_graphicon2;
00331 
00332 <span class="keyword">static</span> <span class="keywordtype">void</span> report_overall(<span class="keywordtype">int</span> refreshFlag) {
00333     <span class="keyword">const</span> <span class="keyword">static</span> tab1=10,tab2=450,tab3=560,tab4=680;
00334     <span class="keyword">const</span> <span class="keyword">static</span> vtab1=40,vtab2=135,vtab3=110,vtab4=285;
00335     <span class="keywordtype">char</span> *label[]= {
00336 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00337 <span class="preprocessor"></span>        <span class="stringliteral">"\tCurrent game score"</span>,
00338 <span class="preprocessor">#else</span>
00339 <span class="preprocessor"></span>        <span class="stringliteral">"\tCurrent trustee evaluation"</span>,
00340 <span class="preprocessor">#endif</span>
00341 <span class="preprocessor"></span>        <span class="stringliteral">"\tLast month change"</span>,
00342         <span class="stringliteral">"\tTrustee evaluation at the beginning of the game"</span>,
00343         <span class="stringliteral">"\tNumber of gaming years"</span>,
00344         <span class="comment">// maintenance upgrade August 2001</span>
00345         <span class="stringliteral">"\tCumulative game score"</span>,                    <span class="comment">// "\tGame score",</span>
00346 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00347 <span class="preprocessor"></span>        <span class="stringliteral">"\t=    (Current game score - Initial trustee evaluation) X 10"</span>,
00348 <span class="preprocessor">#else</span>
00349 <span class="preprocessor"></span>        <span class="stringliteral">"\t=    (Current trustee evaluation - Initial trustee evaluation) X 10"</span>,
00350 <span class="preprocessor">#endif</span>
00351 <span class="preprocessor"></span>        <span class="stringliteral">"\t      + Number of gaming years"</span>,           <span class="comment">//## chea 200899 to added a bouns pt</span>
00352         <span class="stringliteral">"\t      + Total bonus points"</span>,               <span class="comment">//## chea 200899 to added a bouns pt</span>
00353         <span class="stringliteral">"\t=   "</span>,
00354     };
00355 
00356     <span class="keyword">static</span> <span class="keywordtype">int</span> data_num=HISTORY_MONTH_COUNT;
00357     <span class="keyword">static</span> <span class="keywordtype">float</span> *dataArray;
00358     <span class="keyword">static</span> <span class="keywordtype">int</span> *dataArray2;
00359     <span class="keyword">static</span> <span class="keywordtype">float</span> v[6];
00360 
00361     v[0]=player_school.cur_game_score;
00362     <span class="comment">//### begin zb 02/22/99</span>
00363     v[1]=(float)( (int)player_school.game_score_history[HISTORY_MONTH_COUNT-1]-
00364                   (int)player_school.game_score_history[HISTORY_MONTH_COUNT-2] );
00365     <span class="comment">//### end zb 02/22/99</span>
00366     v[2]=player_school.init_game_score;
00367     <span class="comment">//  v[2]=(float)player_school.ultimate_game_score;</span>
00368     v[3]=(float)info.year_passed-1;
00369     v[4]=(float)player_school.ultimate_game_score;
00370 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00371 <span class="preprocessor"></span>    <span class="keyword">static</span> <span class="keywordtype">float</span> totalBonusPoint;
00372     totalBonusPoint = task_array.total_bonus_pt + player_school.bonus_point + player_school.threshold_event_bonus;
00373 <span class="preprocessor">#endif</span>
00374 <span class="preprocessor"></span>    dataArray=player_school.game_score_history;
00375     dataArray2=player_school.ultimate_game_score_history;
00376     vga.use_back();
00377     <span class="keywordflow">if</span>( refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a> ) {
00378         <span class="keywordflow">if</span>( overall_report_init_flag )                <span class="comment">// deinit it first if it has already been initialized</span>
00379             deinit_overall();
00380         overall_report_init_flag = 1;
00381 
00382 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00383 <span class="preprocessor"></span>        overall_graphicon1.<a class="code" href="classGraphPerformanceIndicatorMonth.html#a2">init</a>(
00384             <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab3-30,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+50,
00385             <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab4-30,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+123,
00386             1 ,&amp;data_num ,dataArray, 1, 0, 3);
00387         overall_graphicon1.<a class="code" href="classGraphPerformanceIndicatorMonth.html#a8">paint</a>();
00388 <span class="preprocessor">#else</span>
00389 <span class="preprocessor"></span>        overall_graphicon1.<a class="code" href="classGraphPerformanceIndicatorMonth.html#a2">init</a>(
00390             <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab3-30,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+20,
00391             <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab4-30,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+93,
00392             1 ,&amp;data_num ,dataArray, 1, 0, 3);
00393         overall_graphicon1.<a class="code" href="classGraphPerformanceIndicatorMonth.html#a8">paint</a>();
00394 <span class="preprocessor">#endif</span>
00395 <span class="preprocessor"></span>
00396         overall_graphicon2.<a class="code" href="classGraphPerformanceIndicatorMonth.html#a2">init</a>(
00397             <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab3-30,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+170,
00398             <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab4-30,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+243,
00399             1 ,&amp;data_num ,dataArray2, 1, 0, 3);
00400         overall_graphicon2.<a class="code" href="classGraphPerformanceIndicatorMonth.html#a8">paint</a>();
00401 
00402 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00403 <span class="preprocessor"></span>        font_chartsm.put( <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab3-123,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+5, <span class="stringliteral">"Change in last year"</span> );
00404         font_chartsm.put( <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab3+5,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+5, <span class="stringliteral">"Change in since start"</span> );
00405 
00406         <span class="keywordtype">float</span> zn = player_school.get_protagonist_info(1)-&gt;normalizing_factor;
00407         <span class="comment">// 1 year before</span>
00408         <span class="keywordtype">float</span> trend = (v[0] - player_school.game_score_history[THIS_MONTH-12]) / zn;
00409         <span class="keywordtype">float</span> level = (v[0] - player_school.init_game_score) / zn;
00410 
00411         font_chartsm.put( <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab3-88, <a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+5+5+vtab1-25, m.format(trend,24) );
00412         font_chartsm.put( <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab3+45, <a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+5+5+vtab1-25, m.format(level,24) );
00413 
00414         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;4;i++)
00415             overall_text[i].<a class="code" href="classLargeText.html#a17">right_put</a>
00416                 (<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab2-25,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab1+(i-1)*25+5+5,(<span class="keywordtype">float</span>*)(&amp;v[i]),4);
00417 <span class="preprocessor">#else</span>
00418 <span class="preprocessor"></span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;4;i++)
00419             <span class="comment">//                  overall_text[i].right_put</span>
00420             <span class="comment">//                          (WINDOW_X1+tab2+30,WINDOW_Y1+vtab1+(i-1)*35+5,(float*)(&amp;v[i]),4);</span>
00421             <span class="comment">//## chea 200899 to added a bouns pt</span>
00422             overall_text[i].<a class="code" href="classLargeText.html#a17">right_put</a>
00423                 (<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab2+30,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab1+(i-1)*25+5,(<span class="keywordtype">float</span>*)(&amp;v[i]),4);
00424 <span class="preprocessor">#endif</span>
00425 <span class="preprocessor"></span>
00426 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00427 <span class="preprocessor"></span>        overall_text[4].<a class="code" href="classLargeText.html#a17">right_put</a>
00428             (<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab2-25,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab1+(3)*25+5,&amp;totalBonusPoint,4);
00429 <span class="preprocessor">#else</span>
00430 <span class="preprocessor"></span>        overall_text[4].<a class="code" href="classLargeText.html#a17">right_put</a>
00431             (<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab2+30,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab1+(3)*25+5,task_array.total_bonus_pt,4);
00432 <span class="preprocessor">#endif</span>
00433 <span class="preprocessor"></span>
00434         <span class="comment">//              overall_text[4].put  //## chea 200899 to added a bouns pt</span>
00435         <span class="comment">//              (WINDOW_X1+tab1+70,WINDOW_Y1+vtab2+140,(float*)(&amp;v[4]),4);</span>
00436         overall_text[5].<a class="code" href="classLargeText.html#a11">put</a>
00437             (<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1+70,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+125,(<span class="keywordtype">float</span>*)(&amp;v[4]),4);
00438 
00439     }
00440 
00441     user_interface.bar(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab1+105,<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab4,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab1+106,<a class="code" href="COLOR_8H.html#a23">V_BROWN</a>);
00442 
00443 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00444 <span class="preprocessor"></span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;4;i++)
00445         <span class="comment">//font_charts.put(WINDOW_X1+tab1,WINDOW_Y1+vtab1+(i-1)*35+5,label[i]);</span>
00446         <span class="comment">//## chea 200899 to added a bouns pt</span>
00447         font_charts.put(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab1+(i-1)*25+5+5,label[i]);
00448 
00449     <span class="comment">//## chea 200899 to added a bouns pt</span>
00450     font_charts.put(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab1+(3)*25+5+5,<span class="stringliteral">"\tTotal bonus points"</span>);
00451 <span class="preprocessor">#else</span>
00452 <span class="preprocessor"></span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;4;i++)
00453         <span class="comment">//font_charts.put(WINDOW_X1+tab1,WINDOW_Y1+vtab1+(i-1)*35+5,label[i]);</span>
00454         <span class="comment">//## chea 200899 to added a bouns pt</span>
00455         font_charts.put(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab1+(i-1)*25+5,label[i]);
00456 
00457     <span class="comment">//## chea 200899 to added a bouns pt</span>
00458     font_charts.put(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab1+(3)*25+5,<span class="stringliteral">"\tTotal bonus points"</span>);
00459 <span class="preprocessor">#endif</span>
00460 <span class="preprocessor"></span>
00461     <span class="comment">//  for(i=4;i&lt;8;i++)</span>
00462     <span class="keywordflow">for</span>(i=4;i&lt;9;i++)                                <span class="comment">//## chea 200899 to added a bouns pt</span>
00463         font_charts.put(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+(i-3)*25,label[i]);
00464 
00465     overall_graphicon1.<a class="code" href="classGraphPerformanceIndicatorMonth.html#a9">refresh</a>();
00466     overall_graphicon2.<a class="code" href="classGraphPerformanceIndicatorMonth.html#a9">refresh</a>();
00467     <span class="comment">// ##### begin Gilbert 25/04/2001 #######//</span>
00468     <span class="keywordflow">for</span>(i=0;i&lt;6;i++)                                <span class="comment">// for(i=0;i&lt;5;i++)</span>
00469         overall_text[i].<a class="code" href="classLargeText.html#a25">refresh</a>();
00470     <span class="comment">// ##### end Gilbert 25/04/2001 #######//</span>
00471 };
00472 
00473 <span class="keyword">static</span> <span class="keywordtype">int</span> detect_overall() {
00474     <span class="comment">//  overall_vbrowse.detect();</span>
00475     <span class="keywordflow">return</span> 0;
00476 };
00477 
00478 <span class="keyword">static</span> <span class="keywordtype">void</span> deinit_overall() {
00479     <span class="keywordflow">if</span>(overall_report_init_flag==0)<span class="keywordflow">return</span>;
00480     overall_graphicon1.<a class="code" href="classGraphPerformanceIndicatorMonth.html#a7">deinit</a>();
00481     overall_graphicon2.<a class="code" href="classGraphPerformanceIndicatorMonth.html#a7">deinit</a>();
00482     <span class="comment">// ##### begin Gilbert 25/04/2001 #######//</span>
00483     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;6;i++)                            <span class="comment">// for(int i=0;i&lt;5;i++)</span>
00484         overall_text[i].<a class="code" href="classLargeText.html#a26">deinit</a>();
00485     overall_report_init_flag=0;
00486     <span class="comment">// ##### end Gilbert 25/04/2001 #######//</span>
00487 };
00488 
00489 <span class="keyword">static</span> <span class="keywordtype">void</span> overall_disp_rep_row(<span class="keywordtype">int</span> recNo, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> refreshFlag) {
00490 };
00491 
<a name="l00492"></a><a class="code" href="Oscor__if_8cpp.html#a0">00492</a> <span class="preprocessor">#define REC_HEIGHT 16</span>
<a name="l00493"></a><a class="code" href="Oscor__if_8cpp.html#a1">00493</a> <span class="preprocessor"></span><span class="preprocessor">#define SHEET_COLOR Vga::active_buf-&gt;color_down</span>
00494 <span class="preprocessor"></span>
00495 <span class="keyword">static</span> rank_report_init_flag=0;
00496 <span class="keyword">static</span> <span class="keywordtype">short</span>* rank_text_refresh_bitmap1;
00497 <span class="keyword">static</span> <a class="code" href="classGraphPerformanceIndicatorMonth.html">GraphPerformanceIndicatorMonth</a> rank_graphicon;
00498 <span class="keyword">static</span> <a class="code" href="classVBrowse98.html">VBrowse98</a> rank_vbrowse;
00499 
00500 <span class="comment">//### begin zb 02/22/99</span>
00501 <span class="keyword">static</span> <span class="keywordtype">int</span> sort_peer_school_score_function( <span class="keyword">const</span> <span class="keywordtype">void</span> *a, <span class="keyword">const</span> <span class="keywordtype">void</span> *b ) {
00502     <span class="keywordtype">float</span> valueA = school_res.peer_school_array[(*((<span class="keywordtype">short</span>*)a))].game_score;
00503     <span class="keywordtype">float</span> valueB = school_res.peer_school_array[(*((<span class="keywordtype">short</span>*)b))].game_score;
00504 
00505     <span class="keywordtype">float</span> rc = valueA - valueB;
00506 
00507     <span class="keywordflow">if</span>( rc &gt; 0 )
00508         <span class="keywordflow">return</span> -1;
00509     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( rc &lt;= 0 )
00510         <span class="keywordflow">return</span> 1;
00511     <span class="keywordflow">else</span>
00512         <span class="keywordflow">return</span> 0;
00513 }
00514 
00515 <span class="comment">//### end zb 02/22/99</span>
00516 
00517 <span class="keyword">static</span> <span class="keywordtype">void</span> report_rank(<span class="keywordtype">int</span> refreshFlag) {
00518     <span class="keyword">const</span> <span class="keyword">static</span> tab1=10,tab2=450,tab3=560,tab4=680;
00519     <span class="keyword">const</span> <span class="keyword">static</span> vtab1=20,vtab2=105,vtab3=110,vtab4=285;
00520     <span class="keyword">static</span> <span class="keywordtype">int</span> report_recno=1;
00521 
00522     vga.use_back();
00523 
00524     <span class="comment">//### begin zb 02/22/99</span>
00525     <span class="keywordflow">if</span>((int)school_res.player_peer_school-&gt;game_score!=(int)player_school.cur_game_score) {
00526         school_res.player_peer_school-&gt;game_score=player_school.cur_game_score;
00527         qsort( school_res.peer_school_rank, school_res.peer_school_count, <span class="keyword">sizeof</span>(school_res.peer_school_rank[0]), sort_peer_school_score_function );
00528     }
00529     <span class="comment">//### end zb 02/22/99</span>
00530 
00531     <span class="keywordflow">if</span>( refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a> ) {
00532         <span class="keywordflow">if</span>( rank_report_init_flag )                   <span class="comment">// deinit it first if it has already been initialized</span>
00533             deinit_rank();
00534         rank_report_init_flag = 1;
00535 
00536         rank_vbrowse.<a class="code" href="classVBrowse98.html#a2">init</a>(
00537             <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab1+10,
00538             <a class="code" href="Oscor__if_8cpp.html#a107a70">WINDOW_X2</a>-tab1,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab4,
00539             0, <a class="code" href="Oscor__if_8cpp.html#a0">REC_HEIGHT</a>, school_res.peer_school_count,
00540             rank_disp_rep_row,<a class="code" href="OHELP_8H.html#a0">NULL</a>,0);
00541 
00542         rank_vbrowse.<a class="code" href="classVBrowse98.html#a4">open</a>(report_recno);
00543     }
00544     font_chartsm.put(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+200,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab1+10,<span class="stringliteral">""</span>);
00545     rank_vbrowse.<a class="code" href="classVBrowse98.html#a11">update</a>();
00546     report_recno=rank_vbrowse.<a class="code" href="classVBrowse98.html#a6">recno</a>();
00547 };
00548 
00549 <span class="keyword">static</span> <span class="keywordtype">int</span> detect_rank() {
00550     rank_vbrowse.<a class="code" href="classVBrowse98.html#a8">detect</a>();
00551     <span class="keywordflow">return</span> 0;
00552 };
00553 
00554 <span class="keyword">static</span> <span class="keywordtype">void</span> deinit_rank() {
00555     <span class="keywordflow">if</span>(rank_report_init_flag==0)<span class="keywordflow">return</span>;
00556     <span class="comment">// ####### begin Gilbert 25/04/2001 ######//</span>
00557     rank_vbrowse.<a class="code" href="classVBrowse98.html#a3">deinit</a>();
00558     rank_report_init_flag = 0;
00559     <span class="comment">// ####### end Gilbert 25/04/2001 ######//</span>
00560 };
00561 
00562 <span class="keyword">static</span> <span class="keywordtype">void</span> rank_disp_rep_row(<span class="keywordtype">int</span> recNo, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> refreshFlag) {
00563     <span class="keywordtype">int</span> tab1=10,tab2=60,tab3=400,tab4=600;
00564 
00565     <span class="comment">//  vga_back.bar_down(x,y,x+tab4,y+20);</span>
00566 
00567     <span class="keywordflow">if</span>(recNo==1) {
00568         font_chartsm.put(x+tab1,y,<span class="stringliteral">"Rank"</span>);
00569         font_chartsm.put(x+tab2,y,<span class="stringliteral">"University"</span>);
00570         font_chartsm.put(x+tab3,y,<span class="stringliteral">"Current trustee evaluation"</span>);
00571         <span class="keywordflow">return</span>;
00572     }
00573     <span class="keywordflow">else</span> {
00574         <span class="keywordtype">int</span> idx = school_res.peer_school_rank[recNo-2];
00575 
00576         <a class="code" href="classPeerSchool.html">PeerSchool</a> *ps = &amp;(school_res.peer_school_array[idx]);
00577         <span class="keywordflow">if</span>(ps==school_res.player_peer_school) {
00578             font_chart_blue_sm.right_put(x+tab1+20,y,m.format(recNo-1,4));
00579             font_chart_blue_sm.put(x+tab2,y,ps-&gt;<a class="code" href="classSchool.html#m0">name</a>);
00580             font_chart_blue_sm.right_put(x+tab3+70,y,m.format((<span class="keywordtype">int</span>)ps-&gt;<a class="code" href="classPeerSchool.html#m6">game_score</a>,4));
00581         }
00582         <span class="keywordflow">else</span> {
00583             font_chartsm.right_put(x+tab1+20,y,m.format(recNo-1,4));
00584             font_chartsm.put(x+tab2,y,ps-&gt;<a class="code" href="classSchool.html#m0">name</a>);
00585             font_chartsm.right_put(x+tab3+70,y,m.format((<span class="keywordtype">int</span>)ps-&gt;<a class="code" href="classPeerSchool.html#m6">game_score</a>,4));
00586         }
00587     }
00588 
00589 };
00590 
00591 <span class="comment">//-- screen 2 : outputs ---/</span>
<a name="l00592"></a><a class="code" href="Oscor__if_8cpp.html#a2">00592</a> <span class="preprocessor">#define OUTPUTS_ITEMS_NUM 2</span>
00593 <span class="preprocessor"></span><span class="keyword">static</span> outputs_report_init_flag=0;
00594 <span class="keyword">static</span> <a class="code" href="classGraphPerformanceIndicatorMonth.html">GraphPerformanceIndicatorMonth</a> outputs_graphicon[<a class="code" href="Oscor__if_8cpp.html#a2">OUTPUTS_ITEMS_NUM</a>];
00595 <span class="keyword">static</span> <a class="code" href="classText.html">Text</a> outputs_text1[<a class="code" href="Oscor__if_8cpp.html#a2">OUTPUTS_ITEMS_NUM</a>];
00596 <span class="keyword">static</span> <a class="code" href="classText.html">Text</a> outputs_text2[<a class="code" href="Oscor__if_8cpp.html#a2">OUTPUTS_ITEMS_NUM</a>];
00597 <span class="keyword">static</span> <a class="code" href="classText.html">Text</a> outputs_text3[<a class="code" href="Oscor__if_8cpp.html#a2">OUTPUTS_ITEMS_NUM</a>];
00598 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00599 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="classText.html">Text</a> outputs_text4[<a class="code" href="Oscor__if_8cpp.html#a2">OUTPUTS_ITEMS_NUM</a>];
00600 <span class="preprocessor">#endif</span>
00601 <span class="preprocessor"></span>
00602 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00603 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">char</span> * outputs_help_title[<a class="code" href="Oscor__if_8cpp.html#a2">OUTPUTS_ITEMS_NUM</a>]= {
00604     <span class="stringliteral">"Degrees granted"</span>,
00605     <span class="comment">// maintenance upgrade August 2001</span>
00606     <span class="comment">// "Sponsored performance"</span>
00607     <span class="stringliteral">"Faculty research performance"</span>
00608 };
00609 <span class="preprocessor">#else</span>
00610 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">char</span> * outputs_help_title[<a class="code" href="Oscor__if_8cpp.html#a2">OUTPUTS_ITEMS_NUM</a>]= {
00611     <span class="stringliteral">"Degrees granted"</span>,
00612     <span class="comment">// maintenance upgrade August 2001</span>
00613     <span class="comment">// "Sponsored performance"</span>
00614     <span class="stringliteral">"Sponsored research performance"</span>
00615 };
00616 <span class="preprocessor">#endif</span>
00617 <span class="preprocessor"></span>
00618 <span class="keyword">static</span> <span class="keywordtype">void</span> report_outputs(<span class="keywordtype">int</span> refreshFlag) {
00619     <span class="keyword">const</span> <span class="keyword">static</span> tab1=30,tab2=320,tab3=420,tab4=490;
00620     <span class="keyword">const</span> <span class="keyword">static</span> tab5=620,tab6=680,tab7=660,tab8=760;
00621     <span class="keyword">const</span> <span class="keyword">static</span> vtab1=22,vtab2=37,vtab3=200,vtab4=330,vtab5=320;
00622 
00623     <span class="keyword">static</span> <span class="keywordtype">int</span> data_num=HISTORY_MONTH_COUNT;
00624     <span class="keyword">static</span> <span class="keywordtype">float</span> *dataArray[<a class="code" href="Oscor__if_8cpp.html#a2">OUTPUTS_ITEMS_NUM</a>];
00625     <span class="keyword">static</span> <span class="keywordtype">float</span> v1[<a class="code" href="Oscor__if_8cpp.html#a2">OUTPUTS_ITEMS_NUM</a>];
00626     <span class="keyword">static</span> <span class="keywordtype">float</span> v2[<a class="code" href="Oscor__if_8cpp.html#a2">OUTPUTS_ITEMS_NUM</a>];
00627     <span class="keyword">static</span> <span class="keywordtype">float</span> v3[<a class="code" href="Oscor__if_8cpp.html#a2">OUTPUTS_ITEMS_NUM</a>];
00628 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00629 <span class="preprocessor"></span>    <span class="keyword">static</span> <span class="keywordtype">float</span> v4[<a class="code" href="Oscor__if_8cpp.html#a2">OUTPUTS_ITEMS_NUM</a>];
00630 <span class="preprocessor">#endif</span>
00631 <span class="preprocessor"></span>
00632     <span class="keywordtype">int</span> i,j;
00633     <span class="keywordflow">for</span>(i=0,j=<a class="code" href="Opschool_8h.html#a65a37">S_DEGREES_GRANTED</a>;i&lt;<a class="code" href="Oscor__if_8cpp.html#a2">OUTPUTS_ITEMS_NUM</a>;i++,j++) {
00634         dataArray[i]=player_school.sub_score[j];
00635         v1[i]=dataArray[i][HISTORY_MONTH_COUNT-1];
00636         v2[i]=player_school.sub_score_weight[j];
00637         v3[i]=player_school.sub_score_change[j];
00638 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00639 <span class="preprocessor"></span>        <span class="keywordtype">float</span> zn = player_school.get_protagonist_info(j+2)-&gt;normalizing_factor;
00640         <span class="comment">// 1 year before</span>
00641         <span class="keywordtype">float</span> trend = (v1[i] - dataArray[i][HISTORY_MONTH_COUNT-1-12]) / zn;
00642         <span class="keywordtype">float</span> level = (v1[i] - player_school.sub_score_start[j]) / zn;
00643         v4[i] = trend;
00644         v3[i] = level;
00645 <span class="preprocessor">#endif</span>
00646 <span class="preprocessor"></span>    }
00647 
00648     vga.use_back();
00649     <span class="keywordflow">if</span>( refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a> ) {
00650         <span class="keywordflow">if</span>( outputs_report_init_flag )                <span class="comment">// deinit it first if it has already been initialized</span>
00651             deinit_outputs();
00652         outputs_report_init_flag = 1;
00653 
00654         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="Oscor__if_8cpp.html#a2">OUTPUTS_ITEMS_NUM</a>;i++) {
00655             outputs_graphicon[i].<a class="code" href="classGraphPerformanceIndicatorMonth.html#a2">init</a>(
00656                 <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab5,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32-10,
00657                 <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab6,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32+20,
00658                 1 ,&amp;data_num ,dataArray[i], 1, 0, 3);
00659             outputs_graphicon[i].<a class="code" href="classGraphPerformanceIndicatorMonth.html#a8">paint</a>();
00660 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00661 <span class="preprocessor"></span>            outputs_text1[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab2-40,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32,v1+i,4);
00662             outputs_text2[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab3-60,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32,v2+i,24);
00663             outputs_text4[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab3+30, <a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32, v4+i, 24);
00664             <span class="comment">//## chea 110899</span>
00665             outputs_text3[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab4+95,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32,v3+i,24);
00666 <span class="preprocessor">#else</span>
00667 <span class="preprocessor"></span>            outputs_text1[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab2+40,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32,v1+i,4);
00668             outputs_text2[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab3+20,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32,v2+i,24);
00669             <span class="comment">//## chea 110899</span>
00670             outputs_text3[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab4+60,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32,v3+i,24);
00671 <span class="preprocessor">#endif</span>
00672 <span class="preprocessor"></span>
00673             <span class="keywordflow">if</span>(user_interface.backgd_flag==1) {
00674                 image_interface.put_back(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-23,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32-2,<span class="stringliteral">"QUEST_UP"</span>);
00675                 help_button_array[i].<a class="code" href="classButton.html#a10">create_text</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-23,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32-2,<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-5,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32+16,<span class="stringliteral">"?"</span>);
00676             }
00677         }
00678     }
00679 
00680     <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="Oscor__if_8cpp.html#a2">OUTPUTS_ITEMS_NUM</a>;i++) {
00681         outputs_text1[i].<a class="code" href="classText.html#a25">refresh</a>();
00682         outputs_text2[i].<a class="code" href="classText.html#a25">refresh</a>();
00683         outputs_text3[i].<a class="code" href="classText.html#a25">refresh</a>();
00684 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00685 <span class="preprocessor"></span>        outputs_text4[i].<a class="code" href="classText.html#a25">refresh</a>();
00686 <span class="preprocessor">#endif</span>
00687 <span class="preprocessor"></span>        outputs_graphicon[i].<a class="code" href="classGraphPerformanceIndicatorMonth.html#a9">refresh</a>();
00688         font_chartsm.put(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32,outputs_help_title[i]);
00689     }
00690 
00691     vga.blt_buf(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>, <a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>, <a class="code" href="Oscor__if_8cpp.html#a107a70">WINDOW_X2</a>, <a class="code" href="Oscor__if_8cpp.html#a107a71">WINDOW_Y2</a>);
00692 
00693     vga.use_front();
00694 };
00695 
00696 <span class="keyword">static</span> <span class="keywordtype">int</span> detect_outputs() {
00697     <span class="keyword">const</span> <span class="keyword">static</span> tab1=30,vtab2=37;
00698     vga.use_back();
00699     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="Oscor__if_8cpp.html#a2">OUTPUTS_ITEMS_NUM</a>;i++)
00700         <span class="keywordflow">if</span>(help_button_array[i].<a class="code" href="classButton.html#a21">detect</a>()) {
00701             <span class="comment">// ## begin chwg1022  create the global ResTxt help_resource later //</span>
00702             <a class="code" href="classString.html">String</a> str;
00703             str  = <a class="code" href="Gamedef_8h.html#a4">DIR_RES</a>;
00704             str += <span class="stringliteral">"SCORE"</span>;
00705 
00706             <a class="code" href="classResTxt.html">ResTxt</a> rs;
00707             rs.<a class="code" href="classResTxt.html#a2">init</a>(str);
00708             <span class="comment">// ## chwg1022 end ////////////////////////</span>
00709 
00710             image_interface.put_back(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-23,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32-2,<span class="stringliteral">"QUEST_DN"</span>);
00711             vga.blt_buf(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-23,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32-2,<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-2,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32+16);
00712             sys.back_view_mode=sys.view_mode;
00713             help_if.help_textlist.topic_id=rs.<a class="code" href="classResTxt.html#a7">locate_topic</a>(outputs_help_title[i]);
00714             <span class="keywordflow">if</span>(help_if.help_textlist.topic_id&gt;0) {
00715                 help_if.help_textlist.add_history(help_if.help_textlist.topic_id);
00716                 sys.set_view_mode(<a class="code" href="Osys_8h.html#a45a31">MODE_HELP_DESC</a>);
00717                 sys.redraw_all_flag = 1;
00718                 audio.play_wav(<span class="stringliteral">"BEEPS-1"</span>,audio.int_to_DsVolume(config.sound_effect_volume));
00719             }
00720             <span class="keywordflow">return</span> 1;
00721         }
00722     <span class="keywordflow">return</span> 0;
00723 };
00724 
00725 <span class="keyword">static</span> <span class="keywordtype">void</span> deinit_outputs() {
00726 
00727     <span class="keywordflow">if</span>(outputs_report_init_flag==0)<span class="keywordflow">return</span>;
00728 
00729     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="Oscor__if_8cpp.html#a2">OUTPUTS_ITEMS_NUM</a>;i++) {
00730         outputs_graphicon[i].<a class="code" href="classGraphPerformanceIndicatorMonth.html#a7">deinit</a>();
00731         outputs_text1[i].<a class="code" href="classText.html#a26">deinit</a>();
00732         outputs_text2[i].<a class="code" href="classText.html#a26">deinit</a>();
00733         outputs_text3[i].<a class="code" href="classText.html#a26">deinit</a>();
00734         <span class="comment">// ##### begin Gilbert 28/04/2001 #####//</span>
00735         help_button_array[i].<a class="code" href="classButton.html#a2">deinit</a>();
00736         <span class="comment">// ##### end Gilbert 28/04/2001 #####//</span>
00737     }
00738     <span class="comment">// ###### begin Gilbert 25/04/2001 #######//</span>
00739     outputs_report_init_flag = 0;
00740     <span class="comment">// ###### end Gilbert 25/04/2001 #######//</span>
00741 
00742 };
00743 
00744 <span class="comment">//-- screen 3 : general ---/</span>
<a name="l00745"></a><a class="code" href="Oscor__if_8cpp.html#a3">00745</a> <span class="preprocessor">#define GENERAL_ITEMS_NUM 6</span>
00746 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">char</span> * general_help_title[<a class="code" href="Oscor__if_8cpp.html#a3">GENERAL_ITEMS_NUM</a>]= {
00747     <span class="stringliteral">"Institutional prestige"</span>,
00748     <span class="stringliteral">"Educational quality"</span>,
00749     <span class="stringliteral">"Scholarship, broadly defined"</span>,
00750     <span class="stringliteral">"Student diversity"</span>,
00751     <span class="stringliteral">"Faculty diversity"</span>,
00752     <span class="stringliteral">"Percentage of alumni who have donated during the last five years"</span>,
00753 };
00754 
00755 <span class="keyword">static</span> general_report_init_flag=0;
00756 <span class="keyword">static</span> <a class="code" href="classGraphPerformanceIndicatorMonth.html">GraphPerformanceIndicatorMonth</a> general_graphicon[<a class="code" href="Oscor__if_8cpp.html#a3">GENERAL_ITEMS_NUM</a>];
00757 <span class="keyword">static</span> <a class="code" href="classText.html">Text</a> general_text1[<a class="code" href="Oscor__if_8cpp.html#a3">GENERAL_ITEMS_NUM</a>];
00758 <span class="keyword">static</span> <a class="code" href="classText.html">Text</a> general_text2[<a class="code" href="Oscor__if_8cpp.html#a3">GENERAL_ITEMS_NUM</a>];
00759 <span class="keyword">static</span> <a class="code" href="classText.html">Text</a> general_text3[<a class="code" href="Oscor__if_8cpp.html#a3">GENERAL_ITEMS_NUM</a>];
00760 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00761 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="classText.html">Text</a> general_text4[<a class="code" href="Oscor__if_8cpp.html#a3">GENERAL_ITEMS_NUM</a>];
00762 <span class="preprocessor">#endif</span>
00763 <span class="preprocessor"></span>
00764 <span class="keyword">static</span> <span class="keywordtype">void</span> report_general(<span class="keywordtype">int</span> refreshFlag) {
00765     <span class="keyword">const</span> <span class="keyword">static</span> tab1=30,tab2=320,tab3=420,tab4=490;
00766     <span class="keyword">const</span> <span class="keyword">static</span> tab5=620,tab6=680,tab7=660,tab8=760;
00767     <span class="keyword">const</span> <span class="keyword">static</span> vtab1=22,vtab2=37,vtab3=200,vtab4=330,vtab5=320;
00768 
00769     <span class="keyword">static</span> <span class="keywordtype">int</span> data_num=HISTORY_MONTH_COUNT;
00770 
00771     <span class="keyword">static</span> <span class="keywordtype">float</span> *dataArray[<a class="code" href="Oscor__if_8cpp.html#a3">GENERAL_ITEMS_NUM</a>];
00772     <span class="keyword">static</span> <span class="keywordtype">float</span> v1[<a class="code" href="Oscor__if_8cpp.html#a3">GENERAL_ITEMS_NUM</a>];
00773     <span class="keyword">static</span> <span class="keywordtype">float</span> v2[<a class="code" href="Oscor__if_8cpp.html#a3">GENERAL_ITEMS_NUM</a>];
00774     <span class="keyword">static</span> <span class="keywordtype">float</span> v3[<a class="code" href="Oscor__if_8cpp.html#a3">GENERAL_ITEMS_NUM</a>];
00775 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00776 <span class="preprocessor"></span>    <span class="keyword">static</span> <span class="keywordtype">float</span> v4[<a class="code" href="Oscor__if_8cpp.html#a3">GENERAL_ITEMS_NUM</a>];
00777 <span class="preprocessor">#endif</span>
00778 <span class="preprocessor"></span>
00779     <span class="keywordtype">int</span> i,j;
00780 
00781     <span class="keywordflow">for</span>(i=0,j=<a class="code" href="Opschool_8h.html#a65a39">S_PRESTIGE</a>;i&lt;<a class="code" href="Oscor__if_8cpp.html#a3">GENERAL_ITEMS_NUM</a>;i++,j++) {
00782         dataArray[i]=player_school.sub_score[j];
00783         v1[i]=dataArray[i][HISTORY_MONTH_COUNT-1];
00784         v2[i]=player_school.sub_score_weight[j];
00785         v3[i]=player_school.sub_score_change[j];
00786 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00787 <span class="preprocessor"></span>        <span class="keywordtype">float</span> zn = player_school.get_protagonist_info(j+2)-&gt;normalizing_factor;
00788         <span class="comment">// 1 year before</span>
00789         <span class="keywordtype">float</span> trend = (v1[i] - dataArray[i][HISTORY_MONTH_COUNT-1-12]) / zn;
00790         <span class="keywordtype">float</span> level = (v1[i] - player_school.sub_score_start[j]) / zn;
00791         v4[i] = trend;
00792         v3[i] = level;
00793 <span class="preprocessor">#endif</span>
00794 <span class="preprocessor"></span>    }
00795 
00796     <span class="comment">//## chea 201099 I have do this just after the prerun year</span>
00797     <span class="keywordflow">if</span>(info.game_date &lt; 1721699)
00798         v3[0] = task_array.rand_init;
00799 
00800     vga.use_back();
00801     <span class="keywordflow">if</span>( refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a> ) {
00802         <span class="keywordflow">if</span>( general_report_init_flag )                <span class="comment">// deinit it first if it has already been initialized</span>
00803             deinit_general();
00804         general_report_init_flag = 1;
00805 
00806         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="Oscor__if_8cpp.html#a3">GENERAL_ITEMS_NUM</a>;i++) {
00807             general_graphicon[i].<a class="code" href="classGraphPerformanceIndicatorMonth.html#a2">init</a>(
00808                 <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab5,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40-10,
00809                 <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab6,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40+20,
00810                 1 ,&amp;data_num ,dataArray[i], 1, 0, 3);
00811             general_graphicon[i].<a class="code" href="classGraphPerformanceIndicatorMonth.html#a8">paint</a>();
00812 
00813             <span class="keywordflow">if</span>(user_interface.backgd_flag==1) {
00814                 image_interface.put_back(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-23,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40-2,<span class="stringliteral">"QUEST_UP"</span>);
00815                 help_button_array[i].<a class="code" href="classButton.html#a10">create_text</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-23,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40-2,<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-5,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40+16,<span class="stringliteral">"?"</span>);
00816             }
00817 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00818 <span class="preprocessor"></span>            general_text1[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab2-40,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40,v1+i,4);
00819             general_text2[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab3-60,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40,v2+i,24);
00820             general_text4[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab3+30, <a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40, v4+i, 24);
00821             <span class="comment">//## chea 110899</span>
00822             general_text3[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab4+95,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40,v3+i,24);
00823 <span class="preprocessor">#else</span>
00824 <span class="preprocessor"></span>            general_text1[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab2+40,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40,v1+i,4);
00825             general_text2[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab3+20,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40,v2+i,24);
00826             <span class="comment">//general_text3[i].right_put(WINDOW_X1+tab4+60,WINDOW_Y1+vtab2+i*40,v3+i,4);</span>
00827             <span class="comment">//## chea 110899</span>
00828             general_text3[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab4+60,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40,v3+i,24);
00829 <span class="preprocessor">#endif</span>
00830 <span class="preprocessor"></span>        }
00831     }
00832 
00833     <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="Oscor__if_8cpp.html#a3">GENERAL_ITEMS_NUM</a>;i++) {
00834 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00835 <span class="preprocessor"></span>        font_chartsm.put_paragraph(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40,
00836                                    <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab2-90,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40+40,
00837                                    general_help_title[i]);
00838 <span class="preprocessor">#else</span>
00839 <span class="preprocessor"></span>        font_chartsm.put_paragraph(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40,
00840                                    <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab2-10,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40+40,
00841                                    general_help_title[i]);
00842 <span class="preprocessor">#endif</span>
00843 <span class="preprocessor"></span>        general_graphicon[i].<a class="code" href="classGraphPerformanceIndicatorMonth.html#a9">refresh</a>();
00844         general_text1[i].<a class="code" href="classText.html#a25">refresh</a>();
00845         general_text2[i].<a class="code" href="classText.html#a25">refresh</a>();
00846         general_text3[i].<a class="code" href="classText.html#a25">refresh</a>();
00847     }
00848 
00849     vga.blt_buf(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>, <a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>, <a class="code" href="Oscor__if_8cpp.html#a107a70">WINDOW_X2</a>, <a class="code" href="Oscor__if_8cpp.html#a107a71">WINDOW_Y2</a>);
00850     vga.use_front();
00851 };
00852 
00853 <span class="keyword">static</span> <span class="keywordtype">int</span> detect_general() {
00854     <span class="keyword">const</span> <span class="keyword">static</span> tab1=30,vtab2=37;
00855 
00856     vga.use_back();
00857     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="Oscor__if_8cpp.html#a3">GENERAL_ITEMS_NUM</a>;i++) {
00858         <span class="keywordflow">if</span>(help_button_array[i].<a class="code" href="classButton.html#a21">detect</a>()) {
00859             <span class="comment">// ## begin chwg1022  create the global ResTxt help_resource later //</span>
00860             <a class="code" href="classString.html">String</a> str;
00861             str  = <a class="code" href="Gamedef_8h.html#a4">DIR_RES</a>;
00862             str += <span class="stringliteral">"SCORE"</span>;
00863 
00864             <a class="code" href="classResTxt.html">ResTxt</a> rs;
00865             rs.<a class="code" href="classResTxt.html#a2">init</a>(str);
00866             <span class="comment">// ## chwg1022 end ////////////////////////</span>
00867 
00868             <span class="keywordflow">if</span>(user_interface.backgd_flag==1) {
00869                 image_interface.put_back(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-23,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40-2,<span class="stringliteral">"QUEST_DN"</span>);
00870                 vga.blt_buf(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-23,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40-2,<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-2,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40+16);
00871             }
00872             sys.back_view_mode=sys.view_mode;
00873             help_if.help_textlist.topic_id=rs.<a class="code" href="classResTxt.html#a7">locate_topic</a>(general_help_title[i]);
00874             <span class="keywordflow">if</span>(help_if.help_textlist.topic_id&gt;0) {
00875                 help_if.help_textlist.add_history(help_if.help_textlist.topic_id);
00876                 sys.set_view_mode(<a class="code" href="Osys_8h.html#a45a31">MODE_HELP_DESC</a>);
00877                 sys.redraw_all_flag = 1;
00878                 audio.play_wav(<span class="stringliteral">"BEEPS-1"</span>,audio.int_to_DsVolume(config.sound_effect_volume));
00879             }
00880             <span class="keywordflow">return</span> 1;
00881         }
00882     }
00883     <span class="keywordflow">return</span> 0;
00884 };
00885 
00886 <span class="keyword">static</span> <span class="keywordtype">void</span> deinit_general() {
00887     <span class="keywordflow">if</span>(general_report_init_flag==0)<span class="keywordflow">return</span>;
00888 
00889     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="Oscor__if_8cpp.html#a3">GENERAL_ITEMS_NUM</a>;i++) {
00890         general_graphicon[i].<a class="code" href="classGraphPerformanceIndicatorMonth.html#a7">deinit</a>();
00891         general_text1[i].<a class="code" href="classText.html#a26">deinit</a>();
00892         general_text2[i].<a class="code" href="classText.html#a26">deinit</a>();
00893         general_text3[i].<a class="code" href="classText.html#a26">deinit</a>();
00894         <span class="comment">// ###### begin Gilbert 28/04/2001 ######//</span>
00895         help_button_array[i].<a class="code" href="classButton.html#a2">deinit</a>();
00896         <span class="comment">// ###### end Gilbert 28/04/2001 ######//</span>
00897     }
00898 
00899     <span class="comment">// ###### begin Gilbert 25/04/2001 ######//</span>
00900     general_report_init_flag = 0;
00901     <span class="comment">// ###### end Gilbert 25/04/2001 ######//</span>
00902 };
00903 
00904 <span class="comment">//-- screen 4 : attitudes ---/</span>
<a name="l00905"></a><a class="code" href="Oscor__if_8cpp.html#a4">00905</a> <span class="preprocessor">#define ATTITUDES_ITEMS_NUM 3</span>
00906 <span class="preprocessor"></span><span class="keyword">static</span> attitudes_report_init_flag=0;
00907 <span class="keyword">static</span> <span class="keywordtype">char</span> *attitudes_help_title[]= {
00908     <span class="stringliteral">"Faculty morale"</span>,
00909     <span class="stringliteral">"Student morale"</span>,
00910     <span class="stringliteral">"Staff morale"</span>,
00911 };
00912 <span class="keyword">static</span> <a class="code" href="classGraphPerformanceIndicatorMonth.html">GraphPerformanceIndicatorMonth</a> attitudes_graphicon[<a class="code" href="Oscor__if_8cpp.html#a4">ATTITUDES_ITEMS_NUM</a>];
00913 <span class="keyword">static</span> <a class="code" href="classText.html">Text</a> attitudes_text1[<a class="code" href="Oscor__if_8cpp.html#a4">ATTITUDES_ITEMS_NUM</a>];
00914 <span class="keyword">static</span> <a class="code" href="classText.html">Text</a> attitudes_text2[<a class="code" href="Oscor__if_8cpp.html#a4">ATTITUDES_ITEMS_NUM</a>];
00915 <span class="keyword">static</span> <a class="code" href="classText.html">Text</a> attitudes_text3[<a class="code" href="Oscor__if_8cpp.html#a4">ATTITUDES_ITEMS_NUM</a>];
00916 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00917 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="classText.html">Text</a> attitudes_text4[<a class="code" href="Oscor__if_8cpp.html#a4">ATTITUDES_ITEMS_NUM</a>];
00918 <span class="preprocessor">#endif</span>
00919 <span class="preprocessor"></span>
00920 <span class="keyword">static</span> <span class="keywordtype">void</span> report_attitudes(<span class="keywordtype">int</span> refreshFlag) {
00921     <span class="keyword">const</span> <span class="keyword">static</span> tab1=30,tab2=320,tab3=420,tab4=490;
00922     <span class="keyword">const</span> <span class="keyword">static</span> tab5=620,tab6=680,tab7=660,tab8=760;
00923     <span class="keyword">const</span> <span class="keyword">static</span> vtab1=22,vtab2=37,vtab3=200,vtab4=330,vtab5=320;
00924 
00925     <span class="keyword">static</span> <span class="keywordtype">int</span> data_num=HISTORY_MONTH_COUNT;
00926 
00927     <span class="keyword">static</span> <span class="keywordtype">float</span> *dataArray[<a class="code" href="Oscor__if_8cpp.html#a4">ATTITUDES_ITEMS_NUM</a>];
00928     <span class="keyword">static</span> <span class="keywordtype">float</span> v1[<a class="code" href="Oscor__if_8cpp.html#a4">ATTITUDES_ITEMS_NUM</a>];
00929     <span class="keyword">static</span> <span class="keywordtype">float</span> v2[<a class="code" href="Oscor__if_8cpp.html#a4">ATTITUDES_ITEMS_NUM</a>];
00930     <span class="keyword">static</span> <span class="keywordtype">float</span> v3[<a class="code" href="Oscor__if_8cpp.html#a4">ATTITUDES_ITEMS_NUM</a>];
00931 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00932 <span class="preprocessor"></span>    <span class="keyword">static</span> <span class="keywordtype">float</span> v4[<a class="code" href="Oscor__if_8cpp.html#a4">ATTITUDES_ITEMS_NUM</a>];
00933 <span class="preprocessor">#endif</span>
00934 <span class="preprocessor"></span>
00935     <span class="keywordtype">int</span> i,j;
00936     <span class="keywordflow">for</span>(i=0,j=<a class="code" href="Opschool_8h.html#a65a45">S_FACULTY_MORALE</a>;i&lt;<a class="code" href="Oscor__if_8cpp.html#a4">ATTITUDES_ITEMS_NUM</a>;i++,j++) {
00937         dataArray[i]=player_school.sub_score[j];
00938         v1[i]=dataArray[i][HISTORY_MONTH_COUNT-1];
00939         v2[i]=player_school.sub_score_weight[j];
00940         v3[i]=player_school.sub_score_change[j];
00941 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00942 <span class="preprocessor"></span>        <span class="keywordtype">float</span> zn = player_school.get_protagonist_info(j+2)-&gt;normalizing_factor;
00943         <span class="comment">// 1 year before</span>
00944         <span class="keywordtype">float</span> trend = (v1[i] - dataArray[i][HISTORY_MONTH_COUNT-1-12]) / zn;
00945         <span class="keywordtype">float</span> level = (v1[i] - player_school.sub_score_start[j]) / zn;
00946         v4[i] = trend;
00947         v3[i] = level;
00948 <span class="preprocessor">#endif</span>
00949 <span class="preprocessor"></span>    }
00950 
00951     vga.use_back();
00952     <span class="keywordflow">if</span>( refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a> ) {
00953         <span class="keywordflow">if</span>( attitudes_report_init_flag )              <span class="comment">// deinit it first if it has already been initialized</span>
00954             deinit_attitudes();
00955         attitudes_report_init_flag = 1;
00956 
00957         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="Oscor__if_8cpp.html#a4">ATTITUDES_ITEMS_NUM</a>;i++) {
00958             attitudes_graphicon[i].<a class="code" href="classGraphPerformanceIndicatorMonth.html#a2">init</a>(
00959                 <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab5,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32-10,
00960                 <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab6,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32+20,
00961                 1 ,&amp;data_num ,dataArray[i], 1, 0, 3);
00962             attitudes_graphicon[i].<a class="code" href="classGraphPerformanceIndicatorMonth.html#a8">paint</a>();
00963 
00964 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00965 <span class="preprocessor"></span>            attitudes_text1[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab2-40,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32,v1+i,4);
00966             attitudes_text2[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab3-60,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32,v2+i,24);
00967             attitudes_text4[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab3+30, <a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32, v4+i, 24);
00968             <span class="comment">//## chea 110899</span>
00969             attitudes_text3[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab4+95,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32,v3+i,24);
00970 <span class="preprocessor">#else</span>
00971 <span class="preprocessor"></span>            attitudes_text1[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab2+40,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32,v1+i,4);
00972             attitudes_text2[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab3+20,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32,v2+i,24);
00973             <span class="comment">//attitudes_text3[i].right_put(WINDOW_X1+tab4+60,WINDOW_Y1+vtab2+i*32,v3+i,4);</span>
00974             <span class="comment">//## chea 110899</span>
00975             attitudes_text3[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab4+60,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32,v3+i,24);
00976 <span class="preprocessor">#endif</span>
00977 <span class="preprocessor"></span>            <span class="keywordflow">if</span>(user_interface.backgd_flag==1) {
00978                 image_interface.put_back(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-23,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32-2,<span class="stringliteral">"QUEST_UP"</span>);
00979                 help_button_array[i].<a class="code" href="classButton.html#a10">create_text</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-23,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32-2,<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-5,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32+16,<span class="stringliteral">"?"</span>);
00980             }
00981         }
00982     }
00983 
00984     <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="Oscor__if_8cpp.html#a4">ATTITUDES_ITEMS_NUM</a>;i++) {
00985         font_chartsm.put(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32,attitudes_help_title[i]);
00986         attitudes_graphicon[i].<a class="code" href="classGraphPerformanceIndicatorMonth.html#a9">refresh</a>();
00987         attitudes_text1[i].<a class="code" href="classText.html#a25">refresh</a>();
00988         attitudes_text2[i].<a class="code" href="classText.html#a25">refresh</a>();
00989         attitudes_text3[i].<a class="code" href="classText.html#a25">refresh</a>();
00990     }
00991 
00992     vga.blt_buf(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>, <a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>, <a class="code" href="Oscor__if_8cpp.html#a107a70">WINDOW_X2</a>, <a class="code" href="Oscor__if_8cpp.html#a107a71">WINDOW_Y2</a>);
00993     vga.use_front();
00994 };
00995 
00996 <span class="keyword">static</span> <span class="keywordtype">int</span> detect_attitudes() {
00997     <span class="keyword">const</span> <span class="keyword">static</span> tab1=30,vtab2=37;
00998 
00999     vga.use_back();
01000     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="Oscor__if_8cpp.html#a4">ATTITUDES_ITEMS_NUM</a>;i++) {
01001         <span class="keywordflow">if</span>(help_button_array[i].<a class="code" href="classButton.html#a21">detect</a>()) {
01002             <span class="comment">// ## begin chwg1022  create the global ResTxt help_resource later //</span>
01003             <a class="code" href="classString.html">String</a> str;
01004             str  = <a class="code" href="Gamedef_8h.html#a4">DIR_RES</a>;
01005             str += <span class="stringliteral">"SCORE"</span>;
01006 
01007             <a class="code" href="classResTxt.html">ResTxt</a> rs;
01008             rs.<a class="code" href="classResTxt.html#a2">init</a>(str);
01009             <span class="comment">// ## chwg1022 end ////////////////////////</span>
01010 
01011             image_interface.put_back(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-23,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32-2,<span class="stringliteral">"QUEST_DN"</span>);
01012             vga.blt_buf(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-23,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32-2,<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-2,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*32+16);
01013             sys.back_view_mode=sys.view_mode;
01014             help_if.help_textlist.topic_id=rs.<a class="code" href="classResTxt.html#a7">locate_topic</a>(attitudes_help_title[i]);
01015             <span class="keywordflow">if</span>(help_if.help_textlist.topic_id&gt;0) {
01016                 help_if.help_textlist.add_history(help_if.help_textlist.topic_id);
01017                 sys.set_view_mode(<a class="code" href="Osys_8h.html#a45a31">MODE_HELP_DESC</a>);
01018                 sys.redraw_all_flag = 1;
01019                 audio.play_wav(<span class="stringliteral">"BEEPS-1"</span>,audio.int_to_DsVolume(config.sound_effect_volume));
01020             }
01021             <span class="keywordflow">return</span> 1;
01022         }
01023     }
01024     <span class="keywordflow">return</span> 0;
01025 };
01026 
01027 <span class="keyword">static</span> <span class="keywordtype">void</span> deinit_attitudes() {
01028     <span class="keywordflow">if</span>(attitudes_report_init_flag==0)<span class="keywordflow">return</span>;
01029 
01030     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="Oscor__if_8cpp.html#a4">ATTITUDES_ITEMS_NUM</a>;i++) {
01031         attitudes_graphicon[i].<a class="code" href="classGraphPerformanceIndicatorMonth.html#a7">deinit</a>();
01032         attitudes_text1[i].<a class="code" href="classText.html#a26">deinit</a>();
01033         attitudes_text2[i].<a class="code" href="classText.html#a26">deinit</a>();
01034         attitudes_text3[i].<a class="code" href="classText.html#a26">deinit</a>();
01035         <span class="comment">// ##### begin Gilbert 28/04/2001 #####//</span>
01036         help_button_array[i].<a class="code" href="classButton.html#a2">deinit</a>();
01037         <span class="comment">// ##### end Gilbert 28/04/2001 #####//</span>
01038     }
01039     <span class="comment">// ##### begin Gilbert 25/04/2001 ######//</span>
01040     attitudes_report_init_flag = 0;
01041     <span class="comment">// ##### end Gilbert 25/04/2001 ######//</span>
01042 };
01043 
01044 <span class="comment">//-- screen 5 : management ---/</span>
<a name="l01045"></a><a class="code" href="Oscor__if_8cpp.html#a5">01045</a> <span class="preprocessor">#define MANAGEMENT_ITEMS_NUM 5</span>
01046 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">char</span> *management_help_title[]= {
01047     <span class="stringliteral">"Average of class sizes as a percent normal class sizes"</span>,
01048     <span class="stringliteral">"Library volumes per FTE student"</span>,
01049     <span class="stringliteral">"Percent of TSUs using IT in course"</span>,
01050     <span class="stringliteral">"Administrative performance"</span>,
01051     <span class="stringliteral">"Percentage of alumni who have donated during the last five years"</span>,
01052 };
01053 <span class="keyword">static</span> management_report_init_flag=0;
01054 <span class="keyword">static</span> <a class="code" href="classGraphPerformanceIndicatorMonth.html">GraphPerformanceIndicatorMonth</a> management_graphicon[<a class="code" href="Oscor__if_8cpp.html#a5">MANAGEMENT_ITEMS_NUM</a>];
01055 <span class="keyword">static</span> <a class="code" href="classText.html">Text</a> management_text1[<a class="code" href="Oscor__if_8cpp.html#a5">MANAGEMENT_ITEMS_NUM</a>];
01056 <span class="keyword">static</span> <a class="code" href="classText.html">Text</a> management_text2[<a class="code" href="Oscor__if_8cpp.html#a5">MANAGEMENT_ITEMS_NUM</a>];
01057 <span class="keyword">static</span> <a class="code" href="classText.html">Text</a> management_text3[<a class="code" href="Oscor__if_8cpp.html#a5">MANAGEMENT_ITEMS_NUM</a>];
01058 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01059 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="classText.html">Text</a> management_text4[<a class="code" href="Oscor__if_8cpp.html#a5">MANAGEMENT_ITEMS_NUM</a>];
01060 <span class="preprocessor">#endif</span>
01061 <span class="preprocessor"></span>
01062 <span class="keyword">static</span> <span class="keywordtype">void</span> report_management(<span class="keywordtype">int</span> refreshFlag) {
01063     <span class="keyword">const</span> <span class="keyword">static</span> tab1=30,tab2=320,tab3=420,tab4=490;
01064     <span class="keyword">const</span> <span class="keyword">static</span> tab5=620,tab6=680,tab7=660,tab8=760;
01065     <span class="keyword">const</span> <span class="keyword">static</span> vtab1=22,vtab2=37,vtab3=200,vtab4=330,vtab5=480;
01066 
01067     <span class="keyword">static</span> <span class="keywordtype">int</span> data_num=HISTORY_MONTH_COUNT;
01068 
01069     <span class="keyword">static</span> <span class="keywordtype">float</span> *dataArray[<a class="code" href="Oscor__if_8cpp.html#a5">MANAGEMENT_ITEMS_NUM</a>];
01070     <span class="keyword">static</span> <span class="keywordtype">float</span> v1[<a class="code" href="Oscor__if_8cpp.html#a5">MANAGEMENT_ITEMS_NUM</a>];
01071     <span class="keyword">static</span> <span class="keywordtype">float</span> v2[<a class="code" href="Oscor__if_8cpp.html#a5">MANAGEMENT_ITEMS_NUM</a>];
01072     <span class="keyword">static</span> <span class="keywordtype">float</span> v3[<a class="code" href="Oscor__if_8cpp.html#a5">MANAGEMENT_ITEMS_NUM</a>];
01073 
01074     <span class="keywordtype">int</span> i,j;
01075     <span class="comment">//#### fred 1007 for compilation ####//</span>
01076     <span class="comment">//for(i=0,j=S_AVERAGE_OF_CLASS_SIZES_PERCENT;i&lt;MANAGEMENT_ITEMS_NUM;i++,j++)</span>
01077     <span class="keywordflow">for</span>(i=0,j=7;i&lt;<a class="code" href="Oscor__if_8cpp.html#a5">MANAGEMENT_ITEMS_NUM</a>;i++,j++) {
01078         <span class="comment">//#### fred 1007 ####//</span>
01079         dataArray[i]=player_school.sub_score[j];
01080         v1[i]=dataArray[i][HISTORY_MONTH_COUNT-1];
01081         v2[i]=player_school.sub_score_weight[j];
01082         v3[i]=player_school.sub_score_change[j];
01083     }
01084 
01085     vga.use_back();
01086     <span class="keywordflow">if</span>( refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a> ) {
01087         <span class="keywordflow">if</span>( management_report_init_flag )             <span class="comment">// deinit it first if it has already been initialized</span>
01088             deinit_management();
01089         management_report_init_flag = 1;
01090 
01091         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="Oscor__if_8cpp.html#a5">MANAGEMENT_ITEMS_NUM</a>;i++) {
01092             management_graphicon[i].<a class="code" href="classGraphPerformanceIndicatorMonth.html#a2">init</a>(
01093                 <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab5,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*48-10,
01094                 <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab6,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*48+20,
01095                 1 ,&amp;data_num ,dataArray[i], 1, 0, 3);
01096             management_graphicon[i].<a class="code" href="classGraphPerformanceIndicatorMonth.html#a8">paint</a>();
01097 
01098             management_text1[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab2+40,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*48,v1+i,4);
01099             management_text2[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab3+20,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*48,v2+i,24);
01100             <span class="comment">//management_text3[i].right_put(WINDOW_X1+tab4+60,WINDOW_Y1+vtab2+i*48,v3+i,4);</span>
01101             <span class="comment">//## chea 110899</span>
01102             management_text3[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab4+60,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*48,v3+i,24);
01103 
01104             <span class="keywordflow">if</span>(user_interface.backgd_flag==1) {
01105                 image_interface.put_back(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-23,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*48-2,<span class="stringliteral">"QUEST_UP"</span>);
01106                 help_button_array[i].<a class="code" href="classButton.html#a10">create_text</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-23,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*48-2,<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-5,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*48+16,<span class="stringliteral">"?"</span>);
01107             }
01108         }
01109     }
01110 
01111     <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="Oscor__if_8cpp.html#a5">MANAGEMENT_ITEMS_NUM</a>;i++) {
01112         font_chartsm.put_paragraph( <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*48,
01113                                     <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab2,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+(i+1)*48,
01114                                     management_help_title[i]);
01115         management_graphicon[i].<a class="code" href="classGraphPerformanceIndicatorMonth.html#a9">refresh</a>();
01116         management_text1[i].<a class="code" href="classText.html#a25">refresh</a>();
01117         management_text2[i].<a class="code" href="classText.html#a25">refresh</a>();
01118         management_text3[i].<a class="code" href="classText.html#a25">refresh</a>();
01119     }
01120 
01121     vga.blt_buf(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>, <a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>, <a class="code" href="Oscor__if_8cpp.html#a107a70">WINDOW_X2</a>, <a class="code" href="Oscor__if_8cpp.html#a107a71">WINDOW_Y2</a>);
01122     vga.use_front();
01123 };
01124 
01125 <span class="keyword">static</span> <span class="keywordtype">int</span> detect_management() {
01126     <span class="keyword">const</span> <span class="keyword">static</span> tab1=30,vtab2=37;
01127 
01128     vga.use_back();
01129     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="Oscor__if_8cpp.html#a3">GENERAL_ITEMS_NUM</a>;i++) {
01130         <span class="keywordflow">if</span>(help_button_array[i].<a class="code" href="classButton.html#a21">detect</a>()) {
01131             <span class="comment">// ## begin chwg1022  create the global ResTxt help_resource later //</span>
01132             <a class="code" href="classString.html">String</a> str;
01133             str  = <a class="code" href="Gamedef_8h.html#a4">DIR_RES</a>;
01134             str += <span class="stringliteral">"SCORE"</span>;
01135 
01136             <a class="code" href="classResTxt.html">ResTxt</a> rs;
01137             rs.<a class="code" href="classResTxt.html#a2">init</a>(str);
01138             <span class="comment">// ## chwg1022 end ////////////////////////</span>
01139 
01140             image_interface.put_back(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-23,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*48-2,<span class="stringliteral">"QUEST_DN"</span>);
01141             vga.blt_buf(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-23,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*48-2,<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-2,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*48+16);
01142             sys.back_view_mode=sys.view_mode;
01143             help_if.help_textlist.topic_id=rs.<a class="code" href="classResTxt.html#a7">locate_topic</a>(management_help_title[i]);
01144             <span class="keywordflow">if</span>(help_if.help_textlist.topic_id&gt;0) {
01145                 help_if.help_textlist.add_history(help_if.help_textlist.topic_id);
01146                 sys.set_view_mode(<a class="code" href="Osys_8h.html#a45a31">MODE_HELP_DESC</a>);
01147                 sys.redraw_all_flag = 1;
01148                 audio.play_wav(<span class="stringliteral">"BEEPS-1"</span>,audio.int_to_DsVolume(config.sound_effect_volume));
01149             }
01150             <span class="keywordflow">return</span> 1;
01151         }
01152     }
01153     <span class="keywordflow">return</span> 0;
01154 }
01155 
01156 <span class="keyword">static</span> <span class="keywordtype">void</span> deinit_management() {
01157     <span class="keywordflow">if</span>(management_report_init_flag==0)<span class="keywordflow">return</span>;
01158 
01159     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="Oscor__if_8cpp.html#a5">MANAGEMENT_ITEMS_NUM</a>;i++) {
01160         management_graphicon[i].<a class="code" href="classGraphPerformanceIndicatorMonth.html#a7">deinit</a>();
01161         management_text1[i].<a class="code" href="classText.html#a26">deinit</a>();
01162         management_text2[i].<a class="code" href="classText.html#a26">deinit</a>();
01163         management_text3[i].<a class="code" href="classText.html#a26">deinit</a>();
01164         <span class="comment">// ###### begin Gilbert 25/04/2001 ######//</span>
01165         help_button_array[i].<a class="code" href="classButton.html#a2">deinit</a>();
01166         <span class="comment">// ###### end Gilbert 25/04/2001 ######//</span>
01167     }
01168     <span class="comment">// ###### begin Gilbert 25/04/2001 ######//</span>
01169     management_report_init_flag = 0;
01170     <span class="comment">// ###### end Gilbert 25/04/2001 ######//</span>
01171 };
01172 
01173 <span class="comment">//-- screen 6 : finance ---/</span>
<a name="l01174"></a><a class="code" href="Oscor__if_8cpp.html#a6">01174</a> <span class="preprocessor">#define FINANCE_ITEMS_NUM 4</span>
01175 <span class="preprocessor"></span><span class="keyword">static</span> finance_report_init_flag=0;
01176 <span class="keyword">static</span> <span class="keywordtype">char</span> *finance_help_title[<a class="code" href="Oscor__if_8cpp.html#a6">FINANCE_ITEMS_NUM</a>]= {
01177     <span class="stringliteral">"Current surplus (deficit) as a percentage of expenditure"</span>,
01178     <span class="stringliteral">"Smoothed surplus (deficit) as a percentage of expenditure"</span>,
01179     <span class="stringliteral">"Endowment payout rate relative to the equilibrium payout rate"</span>,
01180     <span class="stringliteral">"Deferred maintenance backlog"</span>,
01181 };
01182 <span class="keyword">static</span> <a class="code" href="classGraphPerformanceIndicatorMonth.html">GraphPerformanceIndicatorMonth</a> finance_graphicon[<a class="code" href="Oscor__if_8cpp.html#a6">FINANCE_ITEMS_NUM</a>];
01183 <span class="keyword">static</span> <a class="code" href="classText.html">Text</a> finance_text1[<a class="code" href="Oscor__if_8cpp.html#a6">FINANCE_ITEMS_NUM</a>];
01184 <span class="keyword">static</span> <a class="code" href="classText.html">Text</a> finance_text2[<a class="code" href="Oscor__if_8cpp.html#a6">FINANCE_ITEMS_NUM</a>];
01185 <span class="keyword">static</span> <a class="code" href="classText.html">Text</a> finance_text3[<a class="code" href="Oscor__if_8cpp.html#a6">FINANCE_ITEMS_NUM</a>];
01186 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01187 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="classText.html">Text</a> finance_text4[<a class="code" href="Oscor__if_8cpp.html#a6">FINANCE_ITEMS_NUM</a>];
01188 <span class="preprocessor">#endif</span>
01189 <span class="preprocessor"></span>
01190 <span class="keyword">static</span> <span class="keywordtype">void</span> report_finance(<span class="keywordtype">int</span> refreshFlag) {
01191     <span class="keyword">const</span> <span class="keyword">static</span> tab1=30,tab2=320,tab3=420,tab4=490;
01192     <span class="keyword">const</span> <span class="keyword">static</span> tab5=620,tab6=680,tab7=660,tab8=760;
01193     <span class="keyword">const</span> <span class="keyword">static</span> vtab1=22,vtab2=37,vtab3=200,vtab4=330,vtab5=480;
01194 
01195     <span class="keyword">static</span> <span class="keywordtype">int</span> data_num=HISTORY_MONTH_COUNT;
01196 
01197     <span class="keyword">static</span> <span class="keywordtype">float</span> *dataArray[<a class="code" href="Oscor__if_8cpp.html#a6">FINANCE_ITEMS_NUM</a>];
01198     <span class="keyword">static</span> <span class="keywordtype">float</span> v1[<a class="code" href="Oscor__if_8cpp.html#a6">FINANCE_ITEMS_NUM</a>];
01199     <span class="keyword">static</span> <span class="keywordtype">float</span> v2[<a class="code" href="Oscor__if_8cpp.html#a6">FINANCE_ITEMS_NUM</a>];
01200     <span class="keyword">static</span> <span class="keywordtype">float</span> v3[<a class="code" href="Oscor__if_8cpp.html#a6">FINANCE_ITEMS_NUM</a>];
01201 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01202 <span class="preprocessor"></span>    <span class="keyword">static</span> <span class="keywordtype">float</span> v4[<a class="code" href="Oscor__if_8cpp.html#a6">FINANCE_ITEMS_NUM</a>];
01203 <span class="preprocessor">#endif</span>
01204 <span class="preprocessor"></span>
01205     <span class="keywordtype">int</span> i,j;
01206     <span class="keywordflow">for</span>(i=0,j=<a class="code" href="Opschool_8h.html#a65a48">S_CURRENT_SURPLUS_DEFICIT_PERCENT</a>;i&lt;<a class="code" href="Oscor__if_8cpp.html#a6">FINANCE_ITEMS_NUM</a>;i++,j++) {
01207         dataArray[i]=player_school.sub_score[j];
01208         v1[i]=dataArray[i][HISTORY_MONTH_COUNT-1];
01209         v2[i]=player_school.sub_score_weight[j];
01210         v3[i]=player_school.sub_score_change[j];
01211 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01212 <span class="preprocessor"></span>        <span class="keywordtype">float</span> zn = player_school.get_protagonist_info(j+2)-&gt;normalizing_factor;
01213         <span class="comment">// 1 year before</span>
01214         <span class="keywordtype">float</span> trend = (v1[i] - dataArray[i][HISTORY_MONTH_COUNT-1-12]) / zn;
01215         <span class="keywordtype">float</span> level = (v1[i] - player_school.sub_score_start[j]) / zn;
01216         v4[i] = trend;
01217         v3[i] = level;
01218 <span class="preprocessor">#endif</span>
01219 <span class="preprocessor"></span>    }
01220 
01221     vga.use_back();
01222     <span class="keywordflow">if</span>(refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>) {
01223         <span class="keywordflow">if</span>(finance_report_init_flag)                  <span class="comment">// deinit it first if it has already been initialized</span>
01224             deinit_finance();
01225         finance_report_init_flag = 1;
01226 
01227         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="Oscor__if_8cpp.html#a6">FINANCE_ITEMS_NUM</a>;i++) {
01228             finance_graphicon[i].<a class="code" href="classGraphPerformanceIndicatorMonth.html#a2">init</a>(
01229                 <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab5,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40-10,
01230                 <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab6,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40+20,
01231                 1 ,&amp;data_num ,dataArray[i], 1, 0, 3);
01232             finance_graphicon[i].<a class="code" href="classGraphPerformanceIndicatorMonth.html#a8">paint</a>();
01233             <span class="keywordflow">if</span>(user_interface.backgd_flag==1) {
01234                 image_interface.put_back(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-23,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40-2,<span class="stringliteral">"QUEST_UP"</span>);
01235                 help_button_array[i].<a class="code" href="classButton.html#a10">create_text</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-23,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40-2,<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-5,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40+16,<span class="stringliteral">"?"</span>);
01236             }
01237 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01238 <span class="preprocessor"></span>            finance_text1[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab2-40,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40,v1+i,4);
01239             finance_text2[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab3-60,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40,v2+i,24);
01240             finance_text4[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab3+30, <a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40, v4+i, 24);
01241             <span class="comment">//## chea 110899</span>
01242             finance_text3[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab4+95,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40,v3+i,24);
01243 <span class="preprocessor">#else</span>
01244 <span class="preprocessor"></span>            finance_text1[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab2+40,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40,v1+i,4);
01245             finance_text2[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab3+20,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40,v2+i,24);
01246             <span class="comment">//finance_text3[i].right_put(WINDOW_X1+tab4+60,WINDOW_Y1+vtab2+i*40,v3+i,4);</span>
01247             <span class="comment">//## chea 110899</span>
01248             finance_text3[i].<a class="code" href="classText.html#a17">right_put</a>(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab4+60,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40,v3+i,24);
01249 <span class="preprocessor">#endif</span>
01250 <span class="preprocessor"></span>        }
01251     }
01252 
01253     <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="Oscor__if_8cpp.html#a6">FINANCE_ITEMS_NUM</a>;i++) {
01254 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01255 <span class="preprocessor"></span>        font_chartsm.put_paragraph( <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40,
01256                                     <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab2-95,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+(i+1)*40,
01257                                     finance_help_title[i]);
01258 <span class="preprocessor">#else</span>
01259 <span class="preprocessor"></span>        font_chartsm.put_paragraph( <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40,
01260                                     <a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab2-15,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+(i+1)*40,
01261                                     finance_help_title[i]);
01262 <span class="preprocessor">#endif</span>
01263 <span class="preprocessor"></span>        finance_graphicon[i].<a class="code" href="classGraphPerformanceIndicatorMonth.html#a9">refresh</a>();
01264         finance_text1[i].<a class="code" href="classText.html#a25">refresh</a>();
01265         finance_text2[i].<a class="code" href="classText.html#a25">refresh</a>();
01266         finance_text3[i].<a class="code" href="classText.html#a25">refresh</a>();
01267     }
01268 
01269     vga.blt_buf(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>, <a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>, <a class="code" href="Oscor__if_8cpp.html#a107a70">WINDOW_X2</a>, <a class="code" href="Oscor__if_8cpp.html#a107a71">WINDOW_Y2</a>);
01270     vga.use_front();
01271 };
01272 
01273 <span class="keyword">static</span> <span class="keywordtype">int</span> detect_finance() {
01274     <span class="keyword">const</span> <span class="keyword">static</span> tab1=30,vtab2=37;
01275 
01276     vga.use_back();
01277     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="Oscor__if_8cpp.html#a3">GENERAL_ITEMS_NUM</a>;i++) {
01278         <span class="keywordflow">if</span>(help_button_array[i].<a class="code" href="classButton.html#a21">detect</a>()) {
01279             <span class="comment">// ## begin chwg1022  create the global ResTxt help_resource later //</span>
01280             <a class="code" href="classString.html">String</a> str;
01281             str  = <a class="code" href="Gamedef_8h.html#a4">DIR_RES</a>;
01282             str += <span class="stringliteral">"SCORE"</span>;
01283 
01284             <a class="code" href="classResTxt.html">ResTxt</a> rs;
01285             rs.<a class="code" href="classResTxt.html#a2">init</a>(str);
01286             <span class="comment">// ## chwg1022 end ////////////////////////</span>
01287 
01288             image_interface.put_back(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-23,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40-2,<span class="stringliteral">"QUEST_DN"</span>);
01289             vga.blt_buf(<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-23,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40-2,<a class="code" href="Oscor__if_8cpp.html#a107a68">WINDOW_X1</a>+tab1-2,<a class="code" href="Oscor__if_8cpp.html#a107a69">WINDOW_Y1</a>+vtab2+i*40+16);
01290             sys.back_view_mode=sys.view_mode;
01291             help_if.help_textlist.topic_id=rs.<a class="code" href="classResTxt.html#a7">locate_topic</a>(finance_help_title[i]);
01292             <span class="keywordflow">if</span>(help_if.help_textlist.topic_id&gt;0) {
01293                 help_if.help_textlist.add_history(help_if.help_textlist.topic_id);
01294                 sys.set_view_mode(<a class="code" href="Osys_8h.html#a45a31">MODE_HELP_DESC</a>);
01295                 sys.redraw_all_flag = 1;
01296                 audio.play_wav(<span class="stringliteral">"BEEPS-1"</span>,audio.int_to_DsVolume(config.sound_effect_volume));
01297             }
01298             <span class="keywordflow">return</span> 1;
01299         }
01300     }
01301     <span class="keywordflow">return</span> 0;
01302 }
01303 
01304 <span class="keyword">static</span> <span class="keywordtype">void</span> deinit_finance() {
01305     <span class="keywordflow">if</span>(finance_report_init_flag==0)<span class="keywordflow">return</span>;
01306 
01307     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="Oscor__if_8cpp.html#a6">FINANCE_ITEMS_NUM</a>;i++) {
01308         finance_graphicon[i].<a class="code" href="classGraphPerformanceIndicatorMonth.html#a7">deinit</a>();
01309         finance_text1[i].<a class="code" href="classText.html#a26">deinit</a>();
01310         finance_text2[i].<a class="code" href="classText.html#a26">deinit</a>();
01311         finance_text3[i].<a class="code" href="classText.html#a26">deinit</a>();
01312         <span class="comment">// ##### begin Gilbert 28/04/2001 ######//</span>
01313         help_button_array[i].<a class="code" href="classButton.html#a2">deinit</a>();
01314         <span class="comment">// ##### end Gilbert 28/04/2001 ######//</span>
01315     }
01316     <span class="comment">// ###### begin Gilbert 25/04/2001 ######//</span>
01317     finance_report_init_flag = 0;
01318     <span class="comment">// ###### end Gilbert 25/04/2001 ######//</span>
01319 };
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:38:21 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
