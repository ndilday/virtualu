<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>NEWMAT8.CPP Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>NEWMAT8.CPP</h1><a href="NEWMAT8_8CPP.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Owner: Fred</span>
00002 <span class="comment">//$$ newmat8.cpp         Advanced LU transform, scalar functions</span>
00003 
00004 <span class="comment">// Copyright (C) 1991,2,3,4: R B Davies</span>
00005 
<a name="l00006"></a><a class="code" href="NEWMAT8_8CPP.html#a0">00006</a> <span class="preprocessor">#define WANT_MATH</span>
00007 <span class="preprocessor"></span>
00008 <span class="preprocessor">#include "include.h"</span>
00009 
00010 <span class="preprocessor">#include "newmatap.h"</span>
00011 <span class="preprocessor">#include "precisio.h"</span>
00012 
00013 <span class="preprocessor">#ifdef use_namespace</span>
00014 <span class="preprocessor"></span><span class="keyword">namespace </span>NEWMAT {
00015 <span class="preprocessor">#endif</span>
00016 <span class="preprocessor"></span>
00017 <span class="preprocessor">#ifdef DO_REPORT</span>
00018 <span class="preprocessor"></span><span class="preprocessor">#define REPORT { static ExeCounter ExeCount(__LINE__,8); ++ExeCount; }</span>
00019 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00020"></a><a class="code" href="NEWMAT8_8CPP.html#a1">00020</a> <span class="preprocessor"></span><span class="preprocessor">#define REPORT {}</span>
00021 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00022 <span class="preprocessor"></span>
00023     <span class="comment">/************************** LU transformation ****************************/</span>
00024 
00025     <span class="keywordtype">void</span> CroutMatrix::ludcmp() {
00026         <span class="comment">// LU decomposition from Golub &amp; Van Loan, algorithm 3.4.1, (the "outer</span>
00027         <span class="comment">// product" version).</span>
00028         <span class="comment">// This replaces the code derived from Numerical Recipes in C in previous</span>
00029         <span class="comment">// versions of newmat and being row oriented runs much faster with large</span>
00030         <span class="comment">// matrices.</span>
00031         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>
00032             <a class="code" href="classTracer.html">Tracer</a> trace( <span class="stringliteral">"Crout(ludcmp)"</span> ); sing = <span class="keyword">false</span>;
00033         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* akk = store;                            <span class="comment">// runs down diagonal</span>
00034 
00035         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> big = <a class="code" href="OLINALG_8CPP.html#a2">fabs</a>(*akk); <span class="keywordtype">int</span> mu = 0; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* ai = akk; <span class="keywordtype">int</span> k;
00036 
00037         <span class="keywordflow">for</span> (k = 1; k &lt; nrows; k++) {
00038             ai += nrows; <span class="keyword">const</span> <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> trybig = <a class="code" href="OLINALG_8CPP.html#a2">fabs</a>(*ai);
00039             <span class="keywordflow">if</span> (big &lt; trybig) { big = trybig; mu = k; }
00040         }
00041 
00042         <span class="keywordflow">for</span> (k = 0; k &lt; nrows; k++) {
00043             <span class="comment">/*</span>
00044 <span class="comment">              int mu1;</span>
00045 <span class="comment">              {</span>
00046 <span class="comment">              Real big = fabs(*akk); mu1 = k; Real* ai = akk; int i;</span>
00047 <span class="comment"></span>
00048 <span class="comment">              for (i = k+1; i &lt; nrows; i++)</span>
00049 <span class="comment">              {</span>
00050 <span class="comment">              ai += nrows; const Real trybig = fabs(*ai);</span>
00051 <span class="comment">              if (big &lt; trybig) { big = trybig; mu1 = i; }</span>
00052 <span class="comment">              }</span>
00053 <span class="comment">              }</span>
00054 <span class="comment">              if (mu1 != mu) cout &lt;&lt; k &lt;&lt; " " &lt;&lt; mu &lt;&lt; " " &lt;&lt; mu1 &lt;&lt; endl;</span>
00055 <span class="comment">            */</span>
00056 
00057             indx[k] = mu;
00058 
00059             <span class="keywordflow">if</span> (mu != k) {                              <span class="comment">//row swap</span>
00060                 <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* a1 = store + nrows * k; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* a2 = store + nrows * mu; d = !d;
00061                 <span class="keywordtype">int</span> j = nrows;
00062                 <span class="keywordflow">while</span> (j--) { <span class="keyword">const</span> <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> temp = *a1; *a1++ = *a2; *a2++ = temp; }
00063             }
00064 
00065             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> diag = *akk; big = 0; mu = k + 1;
00066             <span class="keywordflow">if</span> (diag != 0) {
00067                 ai = akk; <span class="keywordtype">int</span> i = nrows - k - 1;
00068                 <span class="keywordflow">while</span> (i--) {
00069                     ai += nrows; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* al = ai; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> mult = *al / diag; *al = mult;
00070                     <span class="keywordtype">int</span> l = nrows - k - 1; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* aj = akk;
00071                     <span class="comment">// work out the next pivot as part of this loop</span>
00072                     <span class="comment">// this saves a column operation</span>
00073                     <span class="keywordflow">if</span> (l-- != 0) {
00074                         *(++al) -= (mult * *(++aj));
00075                         <span class="keyword">const</span> <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> trybig = <a class="code" href="OLINALG_8CPP.html#a2">fabs</a>(*al);
00076                         <span class="keywordflow">if</span> (big &lt; trybig) { big = trybig; mu = nrows - i - 1; }
00077                         <span class="keywordflow">while</span> (l--) *(++al) -= (mult * *(++aj));
00078                     }
00079                 }
00080             }
00081             <span class="keywordflow">else</span> sing = <span class="keyword">true</span>;
00082             akk += nrows + 1;
00083         }
00084     }
00085 
<a name="l00086"></a><a class="code" href="classNEWMAT_1_1CroutMatrix.html#a2">00086</a>     <span class="keywordtype">void</span> CroutMatrix::lubksb(<a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* B, <span class="keywordtype">int</span> mini) {
00087         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>
00088             <span class="comment">// this has been adapted from Numerical Recipes in C. The code has been</span>
00089             <span class="comment">// substantially streamlined, so I don't think much of the original</span>
00090             <span class="comment">// copyright remains. However there is not much opportunity for</span>
00091             <span class="comment">// variation in the code, so it is still similar to the NR code.</span>
00092             <span class="comment">// I follow the NR code in skipping over initial zeros in the B vector.</span>
00093 
00094             <a class="code" href="classTracer.html">Tracer</a> trace(<span class="stringliteral">"Crout(lubksb)"</span>);
00095         <span class="keywordflow">if</span> (sing) Throw(<a class="code" href="classNEWMAT_1_1SingularException.html">SingularException</a>(*<span class="keyword">this</span>));
00096         <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>, j, ii;
00097 
00098         <span class="comment">// scan for first non-zero in B</span>
00099         <span class="keywordflow">for</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = 0; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> &lt; <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>++) {
00100             <span class="keywordtype">int</span> ip = indx[<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>]; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> temp = B[ip]; B[ip] = B[<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>]; B[<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>] = temp;
00101             <span class="keywordflow">if</span> (temp != 0.0) { ii = <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>; <span class="keywordflow">break</span>; }
00102         }
00103 
00104         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* bi = B + ii; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* ai = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a> + ii + (ii + 1) * <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>;
00105 
00106         <span class="keywordflow">for</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = ii + 1; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> &lt; <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>++) {
00107             <span class="keywordtype">int</span> ip = indx[<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>]; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum = B[ip]; B[ip] = B[<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>];
00108             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* aij = ai; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* bj = bi; j = <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> - ii;
00109             <span class="keywordflow">while</span> (j--) sum -= *aij++ * *bj++;
00110             B[<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>] = sum; ai += <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>;
00111         }
00112 
00113         ai = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a> + <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a> * <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>;
00114 
00115         <span class="keywordflow">for</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a> - 1; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> &gt;= mini; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) {
00116             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* bj = B+<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>; ai -= <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* ajx = ai+<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>;
00117             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum = *bj; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> diag = *ajx;
00118             j = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a> - <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>; <span class="keywordflow">while</span>(--j) sum -= *(++ajx) * *(++bj);
00119             B[<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>] = sum / diag;
00120         }
00121     }
00122 
00123     <span class="comment">/****************************** scalar functions ****************************/</span>
00124 
00125     <span class="keyword">inline</span> <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> <a class="code" href="namespaceNEWMAT.html#a1">square</a>(<a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> x) { <span class="keywordflow">return</span> x*x; }
00126 
<a name="l00127"></a><a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a38">00127</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> GeneralMatrix::SumSquare()<span class="keyword"> const </span>{
00128         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>
00129             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum = 0.0; <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n3">storage</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>;
00130             <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) sum += <a class="code" href="NEWMATRM_8H.html#a1">square</a>(*s++);
00131             ((<a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp;)*<span class="keyword">this</span>).tDelete(); <span class="keywordflow">return</span> sum;
00132     }
00133 
<a name="l00134"></a><a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a39">00134</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> GeneralMatrix::SumAbsoluteValue()<span class="keyword"> const </span>{
00135         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>
00136             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum = 0.0; <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n3">storage</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>;
00137             <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) sum += <a class="code" href="OLINALG_8CPP.html#a2">fabs</a>(*s++);
00138             ((<a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp;)*<span class="keyword">this</span>).tDelete(); <span class="keywordflow">return</span> sum;
00139     }
00140 
<a name="l00141"></a><a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a40">00141</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> GeneralMatrix::Sum()<span class="keyword"> const </span>{
00142         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>
00143             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum = 0.0; <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n3">storage</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>;
00144             <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) sum += *s++;
00145             ((<a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp;)*<span class="keyword">this</span>).tDelete(); <span class="keywordflow">return</span> sum;
00146     }
00147 
<a name="l00148"></a><a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a41">00148</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> GeneralMatrix::MaximumAbsoluteValue()<span class="keyword"> const </span>{
00149         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>
00150             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> maxval = 0.0; <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n3">storage</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>;
00151             <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) { <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> a = <a class="code" href="OLINALG_8CPP.html#a2">fabs</a>(*s++); <span class="keywordflow">if</span> (maxval &lt; a) maxval = a; }
00152             ((<a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp;)*<span class="keyword">this</span>).tDelete(); <span class="keywordflow">return</span> maxval;
00153     }
00154 
<a name="l00155"></a><a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a42">00155</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> GeneralMatrix::MaximumValue()<span class="keyword"> const </span>{
00156         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>
00157             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> maxval = 0.0; <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n3">storage</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>;
00158             <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) { <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> a = *s++; <span class="keywordflow">if</span> (maxval &lt; a) maxval = a; }
00159             ((<a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp;)*<span class="keyword">this</span>).tDelete(); <span class="keywordflow">return</span> maxval;
00160     }
00161 
<a name="l00162"></a><a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a43">00162</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> GeneralMatrix::MinimumValue()<span class="keyword"> const </span>{
00163         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>
00164             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> minval = 0.0; <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n3">storage</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>;
00165             <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) { <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> a = *s++; <span class="keywordflow">if</span> (minval &gt; a) minval = a; }
00166             ((<a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp;)*<span class="keyword">this</span>).tDelete(); <span class="keywordflow">return</span> minval;
00167     }
00168 
<a name="l00169"></a><a class="code" href="classNEWMAT_1_1SymmetricMatrix.html#a11">00169</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> SymmetricMatrix::SumSquare()<span class="keyword"> const </span>{
00170         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>
00171             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum1 = 0.0; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum2 = 0.0; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>; <span class="keywordtype">int</span> nr = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>;
00172             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = 0; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>&lt;nr; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>++) {
00173                 <span class="keywordtype">int</span> j = <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>;
00174                 <span class="keywordflow">while</span> (j--) sum2 += <a class="code" href="NEWMATRM_8H.html#a1">square</a>(*s++);
00175                 sum1 += <a class="code" href="NEWMATRM_8H.html#a1">square</a>(*s++);
00176             }
00177             ((<a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp;)*<span class="keyword">this</span>).tDelete(); <span class="keywordflow">return</span> sum1 + 2.0 * sum2;
00178     }
00179 
<a name="l00180"></a><a class="code" href="classNEWMAT_1_1SymmetricMatrix.html#a12">00180</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> SymmetricMatrix::SumAbsoluteValue()<span class="keyword"> const </span>{
00181         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>
00182             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum1 = 0.0; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum2 = 0.0; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>; <span class="keywordtype">int</span> nr = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>;
00183             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = 0; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>&lt;nr; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>++) {
00184                 <span class="keywordtype">int</span> j = <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>;
00185                 <span class="keywordflow">while</span> (j--) sum2 += <a class="code" href="OLINALG_8CPP.html#a2">fabs</a>(*s++);
00186                 sum1 += <a class="code" href="OLINALG_8CPP.html#a2">fabs</a>(*s++);
00187             }
00188             ((<a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp;)*<span class="keyword">this</span>).tDelete(); <span class="keywordflow">return</span> sum1 + 2.0 * sum2;
00189     }
00190 
<a name="l00191"></a><a class="code" href="classNEWMAT_1_1SymmetricMatrix.html#a13">00191</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> SymmetricMatrix::Sum()<span class="keyword"> const </span>{
00192         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>
00193             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum1 = 0.0; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum2 = 0.0; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>; <span class="keywordtype">int</span> nr = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>;
00194             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = 0; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>&lt;nr; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>++) {
00195                 <span class="keywordtype">int</span> j = <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>;
00196                 <span class="keywordflow">while</span> (j--) sum2 += *s++;
00197                 sum1 += *s++;
00198             }
00199             ((<a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp;)*<span class="keyword">this</span>).tDelete(); <span class="keywordflow">return</span> sum1 + 2.0 * sum2;
00200     }
00201 
<a name="l00202"></a><a class="code" href="classNEWMAT_1_1BaseMatrix.html#a26">00202</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> BaseMatrix::SumSquare()<span class="keyword"> const </span>{
00203         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a> <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gm = ((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp;)*<span class="keyword">this</span>).Evaluate();
00204         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> s = gm-&gt;SumSquare(); <span class="keywordflow">return</span> s;
00205     }
00206 
<a name="l00207"></a><a class="code" href="classNEWMAT_1_1BaseMatrix.html#a27">00207</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> BaseMatrix::SumAbsoluteValue()<span class="keyword"> const </span>{
00208         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a> <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gm = ((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp;)*<span class="keyword">this</span>).Evaluate();
00209         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> s = gm-&gt;SumAbsoluteValue(); <span class="keywordflow">return</span> s;
00210     }
00211 
<a name="l00212"></a><a class="code" href="classNEWMAT_1_1BaseMatrix.html#a28">00212</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> BaseMatrix::Sum()<span class="keyword"> const </span>{
00213         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a> <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gm = ((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp;)*<span class="keyword">this</span>).Evaluate();
00214         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> s = gm-&gt;Sum(); <span class="keywordflow">return</span> s;
00215     }
00216 
<a name="l00217"></a><a class="code" href="classNEWMAT_1_1BaseMatrix.html#a29">00217</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> BaseMatrix::MaximumAbsoluteValue()<span class="keyword"> const </span>{
00218         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a> <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gm = ((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp;)*<span class="keyword">this</span>).Evaluate();
00219         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> s = gm-&gt;MaximumAbsoluteValue(); <span class="keywordflow">return</span> s;
00220     }
00221 
<a name="l00222"></a><a class="code" href="classNEWMAT_1_1BaseMatrix.html#a30">00222</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> BaseMatrix::MaximumValue()<span class="keyword"> const </span>{
00223         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a> <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gm = ((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp;)*<span class="keyword">this</span>).Evaluate();
00224         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> s = gm-&gt;MaximumValue(); <span class="keywordflow">return</span> s;
00225     }
<a name="l00226"></a><a class="code" href="classNEWMAT_1_1BaseMatrix.html#a31">00226</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> BaseMatrix::MinimumValue()<span class="keyword"> const </span>{
00227         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a> <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gm = ((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp;)*<span class="keyword">this</span>).Evaluate();
00228         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> s = gm-&gt;MinimumValue(); <span class="keywordflow">return</span> s;
00229     }
00230 
<a name="l00231"></a><a class="code" href="classNEWMAT_1_1Matrix.html#a12">00231</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> Matrix::Trace()<span class="keyword"> const </span>{
00232         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>
00233             <a class="code" href="classTracer.html">Tracer</a> trace(<span class="stringliteral">"Trace"</span>);
00234         <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>; <span class="keywordtype">int</span> d = <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>+1;
00235         <span class="keywordflow">if</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> != <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n2">ncols</a>) Throw(<a class="code" href="classNEWMAT_1_1NotSquareException.html">NotSquareException</a>(*<span class="keyword">this</span>));
00236         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum = 0.0; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>;
00237         <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) { sum += *s; s += d; }
00238         ((<a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp;)*<span class="keyword">this</span>).tDelete(); <span class="keywordflow">return</span> sum;
00239     }
00240 
<a name="l00241"></a><a class="code" href="classNEWMAT_1_1DiagonalMatrix.html#a15">00241</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> DiagonalMatrix::Trace()<span class="keyword"> const </span>{
00242         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>
00243             <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum = 0.0; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>;
00244             <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) sum += *s++;
00245             ((<a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp;)*<span class="keyword">this</span>).tDelete(); <span class="keywordflow">return</span> sum;
00246     }
00247 
<a name="l00248"></a><a class="code" href="classNEWMAT_1_1SymmetricMatrix.html#a14">00248</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> SymmetricMatrix::Trace()<span class="keyword"> const </span>{
00249         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>
00250             <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum = 0.0; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>; <span class="keywordtype">int</span> j = 2;
00251             <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) { sum += *s; s += j++; }
00252             ((<a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp;)*<span class="keyword">this</span>).tDelete(); <span class="keywordflow">return</span> sum;
00253     }
00254 
<a name="l00255"></a><a class="code" href="classNEWMAT_1_1LowerTriangularMatrix.html#a14">00255</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> LowerTriangularMatrix::Trace()<span class="keyword"> const </span>{
00256         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>
00257             <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum = 0.0; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>; <span class="keywordtype">int</span> j = 2;
00258             <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) { sum += *s; s += j++; }
00259             ((<a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp;)*<span class="keyword">this</span>).tDelete(); <span class="keywordflow">return</span> sum;
00260     }
00261 
<a name="l00262"></a><a class="code" href="classNEWMAT_1_1UpperTriangularMatrix.html#a14">00262</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> UpperTriangularMatrix::Trace()<span class="keyword"> const </span>{
00263         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>
00264             <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum = 0.0; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>;
00265             <span class="keywordflow">while</span> (i) { sum += *s; s += <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--; }
00266             ((<a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp;)*<span class="keyword">this</span>).tDelete(); <span class="keywordflow">return</span> sum;
00267     }
00268 
<a name="l00269"></a><a class="code" href="classNEWMAT_1_1BandMatrix.html#a13">00269</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> BandMatrix::Trace()<span class="keyword"> const </span>{
00270         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>
00271             <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>; <span class="keywordtype">int</span> w = <a class="code" href="classNEWMAT_1_1BandMatrix.html#m0">lower</a>+<a class="code" href="classNEWMAT_1_1BandMatrix.html#m1">upper</a>+1;
00272         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum = 0.0; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>+<a class="code" href="classNEWMAT_1_1BandMatrix.html#m0">lower</a>;
00273         <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) { sum += *s; s += w; }
00274         ((<a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp;)*<span class="keyword">this</span>).tDelete(); <span class="keywordflow">return</span> sum;
00275     }
00276 
<a name="l00277"></a><a class="code" href="classNEWMAT_1_1SymmetricBandMatrix.html#a16">00277</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> SymmetricBandMatrix::Trace()<span class="keyword"> const </span>{
00278         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>
00279             <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>; <span class="keywordtype">int</span> w = <a class="code" href="classNEWMAT_1_1SymmetricBandMatrix.html#m0">lower</a>+1;
00280         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum = 0.0; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>+<a class="code" href="classNEWMAT_1_1SymmetricBandMatrix.html#m0">lower</a>;
00281         <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) { sum += *s; s += w; }
00282         ((<a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp;)*<span class="keyword">this</span>).tDelete(); <span class="keywordflow">return</span> sum;
00283     }
00284 
<a name="l00285"></a><a class="code" href="classNEWMAT_1_1BaseMatrix.html#a32">00285</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> BaseMatrix::Trace()<span class="keyword"> const </span>{
00286         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>
00287             <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gm = ((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp;)*<span class="keyword">this</span>).Evaluate(MatrixType::Dg);
00288         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum = gm-&gt;Trace(); <span class="keywordflow">return</span> sum;
00289     }
00290 
<a name="l00291"></a><a class="code" href="classNEWMAT_1_1LogAndSign.html#a2">00291</a>     <span class="keywordtype">void</span> LogAndSign::operator*=(<a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> x) {
00292         <span class="keywordflow">if</span> (x &gt; 0.0) { log_value += log(x); }
00293         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x &lt; 0.0) { log_value += log(-x); sign = -sign; }
00294         <span class="keywordflow">else</span> sign = 0;
00295     }
00296 
<a name="l00297"></a><a class="code" href="classNEWMAT_1_1LogAndSign.html#a6">00297</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> LogAndSign::Value()<span class="keyword"> const </span>{
00298         <a class="code" href="classTracer.html">Tracer</a> et(<span class="stringliteral">"LogAndSign::Value"</span>);
00299         <span class="keywordflow">if</span> (log_value &gt;= FloatingPointPrecision::LnMaximum())
00300             Throw(<a class="code" href="classNEWMAT_1_1OverflowException.html">OverflowException</a>(<span class="stringliteral">"Overflow in exponential"</span>));
00301         <span class="keywordflow">return</span> sign * exp(log_value);
00302     }
00303 
<a name="l00304"></a><a class="code" href="classNEWMAT_1_1LogAndSign.html#a1">00304</a>     LogAndSign::LogAndSign(<a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> f) {
00305         <span class="keywordflow">if</span> (f == 0.0) { log_value = 0.0; sign = 0; <span class="keywordflow">return</span>; }
00306         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (f &lt; 0.0) { sign = -1; f = -f; }
00307         <span class="keywordflow">else</span> sign = 1;
00308         log_value = log(f);
00309     }
00310 
<a name="l00311"></a><a class="code" href="classNEWMAT_1_1DiagonalMatrix.html#a14">00311</a>     <a class="code" href="classNEWMAT_1_1LogAndSign.html">LogAndSign</a> DiagonalMatrix::LogDeterminant()<span class="keyword"> const </span>{
00312         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>
00313             <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>; <a class="code" href="classNEWMAT_1_1LogAndSign.html">LogAndSign</a> sum; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>;
00314             <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) sum *= *s++;
00315             ((<a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp;)*<span class="keyword">this</span>).tDelete(); <span class="keywordflow">return</span> sum;
00316     }
00317 
<a name="l00318"></a><a class="code" href="classNEWMAT_1_1LowerTriangularMatrix.html#a13">00318</a>     <a class="code" href="classNEWMAT_1_1LogAndSign.html">LogAndSign</a> LowerTriangularMatrix::LogDeterminant()<span class="keyword"> const </span>{
00319         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>
00320             <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>; <a class="code" href="classNEWMAT_1_1LogAndSign.html">LogAndSign</a> sum; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>; <span class="keywordtype">int</span> j = 2;
00321             <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) { sum *= *s; s += j++; }
00322             ((<a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp;)*<span class="keyword">this</span>).tDelete(); <span class="keywordflow">return</span> sum;
00323     }
00324 
<a name="l00325"></a><a class="code" href="classNEWMAT_1_1UpperTriangularMatrix.html#a13">00325</a>     <a class="code" href="classNEWMAT_1_1LogAndSign.html">LogAndSign</a> UpperTriangularMatrix::LogDeterminant()<span class="keyword"> const </span>{
00326         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>
00327             <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>; <a class="code" href="classNEWMAT_1_1LogAndSign.html">LogAndSign</a> sum; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>;
00328             <span class="keywordflow">while</span> (i) { sum *= *s; s += <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--; }
00329             ((<a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp;)*<span class="keyword">this</span>).tDelete(); <span class="keywordflow">return</span> sum;
00330     }
00331 
<a name="l00332"></a><a class="code" href="classNEWMAT_1_1BaseMatrix.html#a25">00332</a>     <a class="code" href="classNEWMAT_1_1LogAndSign.html">LogAndSign</a> BaseMatrix::LogDeterminant()<span class="keyword"> const </span>{
00333         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a> <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gm = ((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp;)*<span class="keyword">this</span>).Evaluate();
00334         <a class="code" href="classNEWMAT_1_1LogAndSign.html">LogAndSign</a> sum = gm-&gt;LogDeterminant(); <span class="keywordflow">return</span> sum;
00335     }
00336 
<a name="l00337"></a><a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a44">00337</a>     <a class="code" href="classNEWMAT_1_1LogAndSign.html">LogAndSign</a> GeneralMatrix::LogDeterminant()<span class="keyword"> const </span>{
00338         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>
00339             <a class="code" href="classTracer.html">Tracer</a> tr(<span class="stringliteral">"Determinant"</span>);
00340         <span class="keywordflow">if</span> (<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a> != <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n2">ncols</a>) Throw(<a class="code" href="classNEWMAT_1_1NotSquareException.html">NotSquareException</a>(*<span class="keyword">this</span>));
00341         <a class="code" href="classNEWMAT_1_1CroutMatrix.html">CroutMatrix</a> C(*<span class="keyword">this</span>); <span class="keywordflow">return</span> C.<a class="code" href="classNEWMAT_1_1CroutMatrix.html#a5">LogDeterminant</a>();
00342     }
00343 
<a name="l00344"></a><a class="code" href="classNEWMAT_1_1CroutMatrix.html#a5">00344</a>     <a class="code" href="classNEWMAT_1_1LogAndSign.html">LogAndSign</a> CroutMatrix::LogDeterminant()<span class="keyword"> const </span>{
00345         <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>
00346             <span class="keywordflow">if</span> (sing) <span class="keywordflow">return</span> 0.0;
00347         <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>; <span class="keywordtype">int</span> dd = <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>+1; <a class="code" href="classNEWMAT_1_1LogAndSign.html">LogAndSign</a> sum; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>;
00348         <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) { sum *= *s; s += dd; }
00349         <span class="keywordflow">if</span> (!d) sum.<a class="code" href="classNEWMAT_1_1LogAndSign.html#a3">ChangeSign</a>(); <span class="keywordflow">return</span> sum;
00350 
00351     }
00352 
00353     <a class="code" href="classLinearEquationSolver.html#a0">LinearEquationSolver::LinearEquationSolver</a>(<span class="keyword">const</span> BaseMatrix&amp; bm)
00354         : gm( ( ((BaseMatrix&amp;)bm).Evaluate() )-&gt;MakeSolver() ) {
00355         <span class="keywordflow">if</span> (gm==&amp;bm) { <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>  gm = gm-&gt;Image(); }
00356         <span class="comment">// want a copy if  *gm is actually bm</span>
00357         <span class="keywordflow">else</span> { <a class="code" href="NEWMAT8_8CPP.html#a1">REPORT</a>  gm-&gt;Protect(); }
00358     }
00359 
00360 <span class="preprocessor">#ifdef use_namespace</span>
00361 <span class="preprocessor"></span>}
00362 <span class="preprocessor">#endif</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:37:10 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
