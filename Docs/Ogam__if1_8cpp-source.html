<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Ogam_if1.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Ogam_if1.cpp</h1><a href="Ogam__if1_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : OGAM_IF1.H</span>
00002 <span class="comment">//Description : Game Class Definition (Play a Scenario)</span>
00003 <span class="comment">//Owner       : Fred</span>
00004 
00005 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00006 <span class="preprocessor">#include &lt;<a class="code" href="OLOG_8H.html">OLOG.H</a>&gt;</span>
00007 <span class="preprocessor">#include &lt;OMOUSE.H&gt;</span>
00008 <span class="preprocessor">#include &lt;<a class="code" href="OVGA_8H.html">OVGA.H</a>&gt;</span>
00009 
00010 <span class="preprocessor">#include &lt;OWORLDMT.H&gt;</span>                             <span class="comment">// ZOOM_Y1, etc</span>
00011 <span class="preprocessor">#include &lt;OIFACE.H&gt;</span>
00012 <span class="preprocessor">#include &lt;<a class="code" href="OGAME_8H.html">OGAME.H</a>&gt;</span>
00013 <span class="preprocessor">#include &lt;OGFILE.H&gt;</span>
00014 
00015 <span class="preprocessor">#include &lt;<a class="code" href="OVBROWSE_8H.html">OVBROWSE.H</a>&gt;</span>
00016 
00017 <span class="preprocessor">#include &lt;OAUDIO.H&gt;</span>
00018 <span class="preprocessor">#include &lt;OCONFIG.H&gt;</span>
00019 
00021 <span class="preprocessor">#include &lt;<a class="code" href="COLOR_8H.html">COLOR.H</a>&gt;</span>
00022 <span class="preprocessor">#include &lt;OFONT.H&gt;</span>
00023 <span class="preprocessor">#include &lt;OGAMESTR.H&gt;</span>
00024 
00025 <span class="preprocessor">#include &lt;<a class="code" href="OGAMESET_8H.html">OGAMESET.H</a>&gt;</span>
00026 <span class="preprocessor">#include &lt;<a class="code" href="OGSET_8H.html">OGSET.H</a>&gt;</span>
00027 
00028 <span class="preprocessor">#include &lt;<a class="code" href="ORADIO_8H.html">ORADIO.H</a>&gt;</span>
00029 <span class="preprocessor">#include &lt;<a class="code" href="OTABMENU_8H.html">OTABMENU.H</a>&gt;</span>
00030 <span class="preprocessor">#include &lt;<a class="code" href="OSLIDER_8H.html">OSLIDER.H</a>&gt;</span>
00031 <span class="preprocessor">#include &lt;<a class="code" href="OVALSLDR_8H.html">OVALSLDR.H</a>&gt;</span>
00032 
00033 <span class="preprocessor">#include &lt;OINFO.H&gt;</span>
00034 <span class="preprocessor">#include &lt;OSPINNER.H&gt;</span>
00035 <span class="preprocessor">#include &lt;<a class="code" href="OBNDSLDR_8H.html">OBNDSLDR.H</a>&gt;</span>
00036 <span class="preprocessor">#include &lt;<a class="code" href="OBOX_8H.html">OBOX.H</a>&gt;</span>
00037 
00038 <span class="preprocessor">#include &lt;OPSCHOOL.H&gt;</span>
00039 <span class="preprocessor">#include &lt;OFINANCE.H&gt;</span>
00040 <span class="comment">//*/</span>
00041 
<a name="l00042"></a><a class="code" href="Ogam__if1_8cpp.html#a0">00042</a> <span class="preprocessor">#define DEPARTMENT_TYPE_COUNT 28</span>
00043 <span class="preprocessor"></span>
00044 <span class="keyword">enum</span> {
00045     <a class="code" href="Ogam__if1_8cpp.html#a50a28">REPORT_X1</a> = <a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a> + 15,
00046     <a class="code" href="Ogam__if1_8cpp.html#a50a29">REPORT_Y1</a> = <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a> + 15,
00047     <a class="code" href="Ogam__if1_8cpp.html#a50a30">REPORT_X2</a> = <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a> - 15,
00048     <a class="code" href="Ogam__if1_8cpp.html#a50a31">REPORT_Y2</a> = <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a> - 40
00049 };
00050 
00051 <span class="keyword">enum</span> {
00052     <a class="code" href="Ogam__if1_8cpp.html#a51a32">TMENU_X1</a> = <a class="code" href="Ogam__if1_8cpp.html#a50a28">REPORT_X1</a> + 5,
00053     <a class="code" href="Ogam__if1_8cpp.html#a51a33">TMENU_Y1</a> = <a class="code" href="Ogam__if1_8cpp.html#a50a29">REPORT_Y1</a> + 35,
00054     <a class="code" href="Ogam__if1_8cpp.html#a51a34">TMENU_X2</a> = <a class="code" href="Ogam__if1_8cpp.html#a50a30">REPORT_X2</a> - 5,
00055     <a class="code" href="Ogam__if1_8cpp.html#a51a35">TMENU_Y2</a> = <a class="code" href="Ogam__if1_8cpp.html#a50a31">REPORT_Y2</a> - 5
00056 };
00057 
00058 <span class="keyword">enum</span> { <a class="code" href="Ogam__if1_8cpp.html#a52a36">LEFT_PUSHED</a>, <a class="code" href="Ogam__if1_8cpp.html#a52a37">RIGHT_PUSHED</a>, <a class="code" href="Ogam__if1_8cpp.html#a52a38">ALL_POP</a> };
00059 
00060 <span class="keyword">enum</span> { <a class="code" href="Ogam__if1_8cpp.html#a53a39">TAB_SCREEN</a>,<a class="code" href="Ogam__if1_8cpp.html#a53a40">SAVE_EXPRESS</a>};
00061 
00062 <span class="keyword">static</span> current_report_mode=<a class="code" href="Ogam__if1_8cpp.html#a53a39">TAB_SCREEN</a>;
00063 <span class="keyword">static</span> button_state = <a class="code" href="Ogam__if1_8cpp.html#a52a38">ALL_POP</a>;
00064 <span class="keyword">static</span> button_timing = 0;
00065 
00066 <span class="comment">//static TabMenu tab_menu;</span>
00067 <span class="keyword">static</span> <span class="keywordtype">int</span> tab_sel;
00068 <span class="keyword">static</span> <span class="keywordtype">char</span> *tab_short_desc[] = {
00069     <span class="stringliteral">"Express games"</span>,
00070     <span class="stringliteral">"Basic options"</span>,
00071     <span class="stringliteral">"Advanced options I"</span>,
00072     <span class="stringliteral">"Advanced options II"</span>,
00073 };
00074 
00075 <span class="keyword">static</span> <a class="code" href="classButton.html">Button</a> button_start,button_cancel;
00076 <span class="keyword">static</span> <span class="keywordtype">char</span> * button_label[]={<span class="stringliteral">"Start scenario"</span>,<span class="stringliteral">"Cancel"</span>};
00077 
00078 <span class="keyword">static</span> <a class="code" href="classButton.html">Button</a> button_left,button_right,button_add,button_remove,button_reset,button_addall;
00079 
00080 <span class="keyword">static</span> <span class="keywordtype">char</span> screen_init_flag=0;
00081 <span class="keyword">static</span> <span class="keywordtype">char</span> redraw_browser_flag=0;
00082 <span class="keyword">static</span> <span class="keywordtype">int</span> pic_id=9;
00083 
00084 <span class="comment">// Screen Basic Option</span>
00085 <span class="keyword">static</span> <a class="code" href="classVBrowse.html">VBrowse</a> scr2_vbrowser1;
00086 <span class="keyword">static</span> <a class="code" href="classVBrowse.html">VBrowse</a> scr2_vbrowser2;
00087 <span class="keyword">static</span> <span class="keywordtype">int</span> scr2_browseRecCount1=1;
00088 <span class="keyword">static</span> <span class="keywordtype">int</span> scr2_browseRecCount2=1;
00089 <span class="keyword">static</span> <span class="keywordtype">int</span> scr2_browseRecHeight=20;
00090 <span class="keyword">static</span> <span class="keywordtype">void</span> scr2_disp_rep_row1(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>);
00091 <span class="keyword">static</span> <span class="keywordtype">void</span> scr2_disp_rep_row2(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>);
00092 <span class="comment">// ##### begin Gilber 19/04/2001 ####//</span>
00093 <span class="comment">// static short* button_refresh_bitmap;</span>
00094 <span class="keyword">static</span> <span class="keywordtype">short</span>* button_refresh_bitmap = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00095 <span class="comment">// ##### end Gilber 19/04/2001 ####//</span>
00096 <span class="keyword">static</span> <a class="code" href="classGetAGroup.html">GetAGroup</a> scr2_name(3);
00097 <span class="comment">/*</span>
00098 <span class="comment">  static int tmp_department_pool_flag[DEPARTMENT_TYPE_COUNT];</span>
00099 <span class="comment">  static int right_bws_pool[DEPARTMENT_TYPE_COUNT];</span>
00100 <span class="comment">  static int left_bws_pool[DEPARTMENT_TYPE_COUNT];</span>
00101 <span class="comment">  static int right_bws_pool_size;</span>
00102 <span class="comment">  static int left_bws_pool_size;</span>
00103 <span class="comment">  static int pool_selected_size;</span>
00104 <span class="comment">  static int just_add=0,just_remove=0;</span>
00105 <span class="comment">  static int player_school_prestige;</span>
00106 <span class="comment">  static int player_school_doctoral_program_intensity;</span>
00107 <span class="comment">  static int player_school_sponsored_research_intensity;</span>
00108 <span class="comment">*/</span>
00109 
<a name="l00110"></a><a class="code" href="classGame.html#a7">00110</a> <span class="keywordtype">void</span> <a class="code" href="classGame.html#a7">Game::scenario_deinit</a>() {
00111     <span class="keywordflow">if</span>(button_refresh_bitmap) {
00112         <a class="code" href="ALL_8H.html#a8">mem_del</a>(button_refresh_bitmap);
00113         button_refresh_bitmap=<a class="code" href="OHELP_8H.html#a0">NULL</a>;
00114     }
00115 
00116     scr2_browseRecCount1=1;
00117     scr2_browseRecCount2=1;
00118 
00119     screen_init_flag = 0;
00120 }
00121 
00123 <span class="comment">//</span>
00124 <span class="keyword">static</span> <span class="keywordtype">int</span> callback_disp(<span class="keywordtype">int</span> selNum, <span class="keywordtype">int</span> refreshFlag) {
00125 
00126     <span class="keywordflow">if</span>(selNum==1) {
00127         <span class="keywordtype">int</span> vtab1=<a class="code" href="Ogam__if1_8cpp.html#a51a33">TMENU_Y1</a>+15,vtab2=<a class="code" href="Ogam__if1_8cpp.html#a51a33">TMENU_Y1</a>+60,vtab3=<a class="code" href="Ogam__if1_8cpp.html#a51a33">TMENU_Y1</a>+120,vtab4=<a class="code" href="Ogam__if1_8cpp.html#a51a33">TMENU_Y1</a>+320;
00128         <span class="keywordtype">int</span> vtab5=<a class="code" href="Ogam__if1_8cpp.html#a51a33">TMENU_Y1</a>+280,vtab6=<a class="code" href="Ogam__if1_8cpp.html#a51a33">TMENU_Y1</a>+220,vtab7=<a class="code" href="Ogam__if1_8cpp.html#a51a33">TMENU_Y1</a>+255,vtab8=<a class="code" href="Ogam__if1_8cpp.html#a51a33">TMENU_Y1</a>+290;
00129         <span class="keywordtype">int</span> tab1=<a class="code" href="Ogam__if1_8cpp.html#a51a32">TMENU_X1</a>+15,tab2=<a class="code" href="Ogam__if1_8cpp.html#a51a32">TMENU_X1</a>+90,tab3=<a class="code" href="Ogam__if1_8cpp.html#a51a32">TMENU_X1</a>+390,tab4=<a class="code" href="Ogam__if1_8cpp.html#a51a32">TMENU_X1</a>+680;
00130 
00131         <span class="keywordflow">if</span>(refreshFlag== <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>) {
00132             <span class="comment">//---init. of screen 2 -//</span>
00133             game.scenario_deinit();
00134 
00135             button_refresh_bitmap=
00136                 vga_back.save_area(tab1,vtab1+65,tab1+60,vtab1+95);
00137             button_left.<a class="code" href="classButton.html#a10">create_text</a>(tab1,vtab1+70,tab1+25,vtab1+90,<span class="stringliteral">"&lt;"</span>);
00138             button_right.<a class="code" href="classButton.html#a10">create_text</a>(tab1+35,vtab1+70,tab1+60,vtab1+90,<span class="stringliteral">"&gt;"</span>);
00139 
00140             <span class="comment">//button_add.create_text(tab1+285,vtab3+60,tab1+385,vtab3+80,"Add &gt;&gt;");</span>
00141             <span class="comment">//button_remove.create_text(tab1+285,vtab3+100,tab1+385,vtab3+120,"&lt;&lt; Remove ");</span>
00142             <span class="comment">//button_reset.create_text(tab1+285,vtab3+140,tab1+385,vtab3+160,"Reset");</span>
00143 
00144             <span class="comment">//font_chart_blue_sm.put(tab2,vtab1,"Institution name");</span>
00145             font_chart_blue_sm.put_paragraph(tab2,vtab1+55,tab2+80,vtab1+100,<span class="stringliteral">"Player first name"</span>);
00146             font_chart_blue_sm.put(tab3,vtab1+65,<span class="stringliteral">"Last name"</span>);
00147             <span class="comment">//font_charts.put(tab1+40,vtab3,"Nonactive department");</span>
00148             <span class="comment">//font_charts.put(tab1+460,vtab3,"Active department");</span>
00149 
00150             <span class="comment">// Basic options --//</span>
00151             scr2_name[0].init(tab2+15,vtab1+25,tab2+600,player_school.school_name,<span class="keyword">sizeof</span>(player_school.school_name)-1,&amp;font_chartsm,0,1);
00152             scr2_name[1].init(tab2+80,vtab1+65,tab2+300,player_school.player_first_name,<span class="keyword">sizeof</span>(player_school.player_first_name)-1,&amp;font_chartsm,0,1);
00153             scr2_name[2].init(tab3+80,vtab1+65,tab3+300,player_school.player_last_name,<span class="keyword">sizeof</span>(player_school.player_last_name)-1,&amp;font_chartsm,0,1);
00154             scr2_name.<a class="code" href="classGetAGroup.html#a4">set_focus</a>(0);
00155             scr2_name[0].<a class="code" href="classGetAGroup.html#a2">paint</a>();
00156             scr2_name[1].<a class="code" href="classGetAGroup.html#a2">paint</a>();
00157             scr2_name[2].<a class="code" href="classGetAGroup.html#a2">paint</a>();
00158         }
00159 
00161 
00162         scr2_browseRecCount1=scr2_vbrowser1.<a class="code" href="classVBrowse.html#a4">recno</a>();
00163         scr2_browseRecCount2=scr2_vbrowser2.<a class="code" href="classVBrowse.html#a4">recno</a>();
00164 
00165         <span class="comment">// update screen//</span>
00166         image_mascot.put_back(tab1,vtab1,player_school.mascot);
00167 
00168         image_interface.put_back(tab1,vtab1+70,<span class="stringliteral">"L-ARW-UP"</span>);
00169         image_interface.put_back(tab1+35,vtab1+70,<span class="stringliteral">"R-ARW-UP"</span>);
00170 
00171         user_interface.bar(tab2+10,vtab1+20,tab2+590,vtab1+42,<a class="code" href="COLOR_8H.html#a17">V_WHITE</a>);
00172         user_interface.bar(tab2+75,vtab1+60,tab2+280,vtab1+82,<a class="code" href="COLOR_8H.html#a17">V_WHITE</a>);
00173         user_interface.bar(tab3+75,vtab1+60,tab3+280,vtab1+82,<a class="code" href="COLOR_8H.html#a17">V_WHITE</a>);
00174         user_interface.rect(tab2+10,vtab1+20,tab2+590,vtab1+42,2);
00175         user_interface.rect(tab2+75,vtab1+60,tab2+280,vtab1+82,2);
00176         user_interface.rect(tab3+75,vtab1+60,tab3+280,vtab1+82,2);
00177 
00178         scr2_name.<a class="code" href="classGetAGroup.html#a2">paint</a>();
00179     }
00180 
00181     <span class="comment">//  vga.blt_buf(TMENU_X1+5,TMENU_Y1+5,TMENU_X2-5,TMENU_Y2-5,0);</span>
00182     <span class="keywordflow">return</span> 0;
00183 }
00184 
00185 <span class="keyword">static</span> <span class="keywordtype">int</span> callback_detect(<span class="keywordtype">int</span> selNum) {
00186     <span class="keywordflow">if</span>(selNum==1) {
00187         <span class="keywordtype">int</span> tab1=<a class="code" href="Ogam__if1_8cpp.html#a51a32">TMENU_X1</a>+15,vtab1=<a class="code" href="Ogam__if1_8cpp.html#a51a33">TMENU_Y1</a>+15;
00188         vga.use_back();
00189 
00190         <span class="keywordflow">if</span>(button_left.<a class="code" href="classButton.html#a21">detect</a>()) {
00191             <span class="keywordflow">do</span> {
00192                 player_school.mascot--;
00193                 <span class="keywordflow">if</span>(player_school.mascot&lt;1)
00194                     player_school.mascot=image_mascot.rec_count;
00195             } <span class="keywordflow">while</span>( player_school.is_hidden_mascot(player_school.mascot) );
00196             vga_back.rest_area(button_refresh_bitmap,0,0);
00197             image_interface.put_front(tab1,vtab1+70,<span class="stringliteral">"L-ARW-DN"</span>);
00198             audio.play_wav(<span class="stringliteral">"BEEPS-1"</span>,audio.int_to_DsVolume(config.sound_effect_volume));
00199         }
00200 
00201         <span class="keywordflow">if</span>(button_right.<a class="code" href="classButton.html#a21">detect</a>()) {
00202             <span class="keywordflow">do</span> {
00203                 player_school.mascot++;
00204                 <span class="keywordflow">if</span>(player_school.mascot&gt;image_mascot.rec_count)
00205                     player_school.mascot=1;
00206             } <span class="keywordflow">while</span>( player_school.is_hidden_mascot(player_school.mascot) );
00207             vga_back.rest_area(button_refresh_bitmap,0,0);
00208             image_interface.put_front(tab1+35,vtab1+70,<span class="stringliteral">"R-ARW-DN"</span>);
00209             audio.play_wav(<span class="stringliteral">"BEEPS-1"</span>,audio.int_to_DsVolume(config.sound_effect_volume));
00210         }
00211 
00212         scr2_name.<a class="code" href="classGetAGroup.html#a3">detect</a>();
00213 
00214         <span class="comment">//vga.use_front();              // ## use_front to make the button flashing in release mode.</span>
00215 
00216         <span class="comment">//vga.use_back();</span>
00217     }
00218 
00219     <span class="keywordflow">return</span> 0;
00220 }
00221 
00222 <span class="comment">/*</span>
00223 <span class="comment">static void scr2_disp_rep_row1(int recNo, int x, int y, int refreshFlag)</span>
00224 <span class="comment">{</span>
00225 <span class="comment">  user_interface.bar(x, y, x+240, y+16,Vga::active_buf-&gt;color_down);</span>
00226 <span class="comment">  for(int i=0,j=0;(i&lt;recNo)&amp;&amp;(j&lt;DEPARTMENT_TYPE_COUNT);j++)</span>
00227 <span class="comment">    if(tmp_department_pool_flag[j]==1)</span>
00228 <span class="comment">        i++;</span>
00229 <span class="comment">//      err.run("department_res.department_count=%d\n",department_res.department_count);</span>
00230 <span class="comment">  if(j&lt;=department_res.department_count)</span>
00231 <span class="comment">    font_chartsm.put(x,y,department_res[j]-&gt;name);</span>
00232 <span class="comment">}</span>
00233 <span class="comment">static void scr2_disp_rep_row2(int recNo, int x, int y, int refreshFlag)</span>
00234 <span class="comment">{</span>
00235 <span class="comment">user_interface.bar(x, y, x+240, y+16,Vga::active_buf-&gt;color_down);</span>
00236 <span class="comment">for(int i=0,j=0;(i&lt;recNo)&amp;&amp;(j&lt;DEPARTMENT_TYPE_COUNT);j++)</span>
00237 <span class="comment">if(tmp_department_pool_flag[j]==0)</span>
00238 <span class="comment">i++;</span>
00239 <span class="comment">//      DEBUG_LOG("j=");</span>
00240 <span class="comment">//      DEBUG_LOG(j);</span>
00241 <span class="comment">//      DEBUG_LOG("\n");</span>
00242 <span class="comment">if(j&lt;=department_res.department_count)</span>
00243 <span class="comment">font_chartsm.put(x,y,department_res[j]-&gt;name);</span>
00244 <span class="comment">}</span>
00245 <span class="comment">*/</span>
00246 
00247 <span class="comment">//-----------------------------------------------------------------//</span>
00248 
00249 <span class="keyword">enum</span> {                                            <span class="comment">// screen coordinates</span>
00250     <a class="code" href="Ogam__if1_8cpp.html#a54a41">WIN_X1</a> = <a class="code" href="Ogam__if1_8cpp.html#a50a28">REPORT_X1</a>+15,
00251     <a class="code" href="Ogam__if1_8cpp.html#a54a42">WIN_Y1</a> = <a class="code" href="Ogam__if1_8cpp.html#a50a29">REPORT_Y1</a>+25,
00252     <a class="code" href="Ogam__if1_8cpp.html#a54a43">WIN_X2</a> = <a class="code" href="Ogam__if1_8cpp.html#a50a30">REPORT_X2</a>-15,
00253     <a class="code" href="Ogam__if1_8cpp.html#a54a44">WIN_Y2</a> = <a class="code" href="Ogam__if1_8cpp.html#a50a31">REPORT_Y2</a>-25
00254 };
00255 
00256 <span class="keyword">static</span> <span class="keywordtype">char</span> *rbuttion_label[] = {
00257     <span class="stringliteral">"Private research university"</span>,
00258     <span class="stringliteral">"Private liberal arts college"</span>,
00259     <span class="stringliteral">"Public research university"</span>,
00260     <span class="stringliteral">"Public comprehensive university"</span>,
00261 };
00262 
00263 <span class="keyword">static</span> <span class="keywordtype">int</span> browser_rec_size;
00264 <span class="keyword">static</span> <a class="code" href="classVBrowse.html">VBrowse</a> game_browser;
00265 
00266 <span class="keyword">static</span> <span class="keywordtype">void</span> disp_load_game_rec(<span class="keywordtype">int</span> recNo, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> refreshFlag) {
00267     <span class="keywordflow">if</span>((recNo&gt;0)&amp;&amp;(recNo&lt;=game_file_array.size())) {
00268         <a class="code" href="classGameFile.html">GameFile</a>* gfPtr = game_file_array[recNo];
00269         <span class="keywordtype">char</span>* name = gfPtr-&gt;<a class="code" href="classGameFile.html#a0">get_save_name</a>();
00270         font_chartsm.put(x,y,name);
00271     }
00272 };
00273 
00274 <span class="comment">//------- Begin of function Game::scenario_init ------//</span>
00277 <span class="comment"></span>
00278 <span class="comment">//------- Begin of function Game::scenario_init ------//</span>
00280 <span class="comment">void Game::scenario_init() {</span>
00281     screen_init_flag = 0;
00282 
00283     game_file_array.init(<span class="stringliteral">"*.SAV"</span>);
00284     browser_rec_size=game_file_array.size();
00285 }
00286 
00287 <span class="comment">//------- End of function Game::scenario_report ------//</span>
00288 
00289 <span class="comment">//------- Begin of function Game::scenario_report ------//</span>
00291 <span class="comment">void Game::scenario_report(int refreshFlag) {</span>
00292     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span>  tab1=<a class="code" href="Ogam__if1_8cpp.html#a54a41">WIN_X1</a>+10,
00293         tab2=<a class="code" href="Ogam__if1_8cpp.html#a54a41">WIN_X1</a>+410,
00294         vtab0=<a class="code" href="Ogam__if1_8cpp.html#a54a42">WIN_Y1</a>+10,
00295         vtab1=<a class="code" href="Ogam__if1_8cpp.html#a54a42">WIN_Y1</a>+60,
00296         vtab2=<a class="code" href="Ogam__if1_8cpp.html#a54a44">WIN_Y2</a>-30;
00297 
00298     vga.use_back();
00299 
00300     <span class="keywordflow">if</span>(current_report_mode==<a class="code" href="Ogam__if1_8cpp.html#a53a39">TAB_SCREEN</a>) {
00301         <span class="keywordflow">if</span> (refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>) {
00302             user_interface.bg_img(pic_id, &amp;vga_back);
00303             font_charts.put(tab1+290, vtab0,<span class="stringliteral">"Scenario Games"</span>);
00304 
00305             <span class="keywordflow">if</span> (!screen_init_flag) {
00306                 button_start.<a class="code" href="classButton.html#a10">create_text</a>
00307                     (<a class="code" href="Ogam__if1_8cpp.html#a50a28">REPORT_X1</a>+150, <a class="code" href="Ogam__if1_8cpp.html#a50a31">REPORT_Y2</a>+15,
00308                      <a class="code" href="Ogam__if1_8cpp.html#a50a28">REPORT_X1</a>+300, <a class="code" href="Ogam__if1_8cpp.html#a50a31">REPORT_Y2</a>+35, button_label[0]);
00309                 button_cancel.<a class="code" href="classButton.html#a10">create_text</a>
00310                     (<a class="code" href="Ogam__if1_8cpp.html#a50a28">REPORT_X1</a>+400, <a class="code" href="Ogam__if1_8cpp.html#a50a31">REPORT_Y2</a>+15,
00311                      <a class="code" href="Ogam__if1_8cpp.html#a50a28">REPORT_X1</a>+550, <a class="code" href="Ogam__if1_8cpp.html#a50a31">REPORT_Y2</a>+35, button_label[1]);
00312                 screen_init_flag = 1;
00313             }
00314             <span class="keywordflow">else</span> {
00315 
00316             }
00317 
00318             game_browser.<a class="code" href="classVBrowse.html#a1">init</a>( tab1+100, vtab1+10, tab1+550, vtab2-20,
00319                                0, 18, browser_rec_size, disp_load_game_rec );
00320             game_browser.<a class="code" href="classVBrowse.html#a2">open</a>(game_browser.<a class="code" href="classVBrowse.html#a4">recno</a>());
00321         }
00322         <span class="keywordflow">else</span> {
00323         }
00324 
00325         button_start.<a class="code" href="classButton.html#a20">paint</a>();
00326         button_cancel.<a class="code" href="classButton.html#a20">paint</a>();
00327     }
00328 
00329     vga.blt_buf(0,0,<a class="code" href="OVGA_8H.html#a0">VGA_WIDTH</a>-1,<a class="code" href="OVGA_8H.html#a1">VGA_HEIGHT</a>-1);      <span class="comment">// DON'T need to blt all area...</span>
00330 }
00331 
00332 <span class="comment">//------- End of function GameSetting::report ------//</span>
00333 
00334 <span class="comment">//------ Begin of function GameSetting::detect ------//</span>
00340 <span class="comment">int Game::scenario_detect() {</span>
00341     <span class="keywordtype">int</span> rc=0, rec=0;
00342     vga.use_back();
00343 
00344     <span class="keywordflow">if</span>(current_report_mode==<a class="code" href="Ogam__if1_8cpp.html#a53a39">TAB_SCREEN</a>) {
00345         vga.use_front();
00346 
00347         <span class="keywordflow">if</span>( button_start.<a class="code" href="classButton.html#a21">detect</a>() ) {
00348             <span class="keywordflow">if</span> ( game_file_array.size()&gt;=game_browser.<a class="code" href="classVBrowse.html#a4">recno</a>() &amp;&amp; game_browser.<a class="code" href="classVBrowse.html#a4">recno</a>()&gt;0) {
00349                 rec = game_browser.<a class="code" href="classVBrowse.html#a4">recno</a>();
00350                 <span class="comment">//0127 game_file_array[game_browser.recno()]-&gt;load_game();</span>
00351 
00352                 sys.redraw_all_flag=1;
00353                 <span class="comment">//menu_pull_down = 0;</span>
00354                 sys.set_staying_view_mode(0);
00355                 sys.redraw_all_flag=1;
00356                 rc = 1;                                   <span class="comment">//BUGHERE should be the scenId</span>
00357             }
00358 
00359         }
00360 
00361         <span class="keywordflow">if</span>( button_cancel.<a class="code" href="classButton.html#a21">detect</a>() )
00362             rc = -1;
00363 
00364         vga.use_back();                               <span class="comment">// why do this here? before vbrowse??</span>
00365 
00366         <span class="keywordflow">if</span>(rec=game_browser.<a class="code" href="classVBrowse.html#a6">detect</a>()) {
00367             game_browser.<a class="code" href="classVBrowse.html#a8">refresh</a>(rec);
00368             <span class="keywordflow">if</span>(game_browser.<a class="code" href="classVBrowse.html#m1">double_click</a>) {
00369                 <span class="keywordflow">if</span> (game_file_array.size()&gt;=rec &amp;&amp; rec&gt;0) {
00370                     <span class="comment">//0127 game_file_array[rec]-&gt;load_game();</span>
00371 
00372                     sys.redraw_all_flag=1;
00373                     <span class="comment">//menu_pull_down = 0;</span>
00374                     sys.set_staying_view_mode(0);           <span class="comment">// 0: restore last saved mode which is not "staying"</span>
00375                     sys.redraw_all_flag=1;
00376                     rc = 1;
00377                     <span class="comment">// 0127                                     return 1;                               //BUGHERE should be the scenId</span>
00378                 }
00379             }
00380         }
00381     }
00382     vga.use_back();
00383 
00384     <span class="keywordflow">if</span> (rc&gt;=1)
00385         <span class="keywordflow">return</span> rec;
00386     <span class="keywordflow">else</span>
00387         <span class="keywordflow">return</span> rc;
00388 }
00389 
00390 <span class="comment">//------- End of function GameSetting::detect ------//</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:37:41 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
