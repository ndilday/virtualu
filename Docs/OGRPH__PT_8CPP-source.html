<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>OGRPH_PT.CPP Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>OGRPH_PT.CPP</h1><a href="OGRPH__PT_8CPP.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : OGRPH_PT.CPP</span>
00002 <span class="comment">//Description : Object GraphPerformanceIndicatorTrimester</span>
00003 <span class="comment">//Owner                 : Kevin(Ho)</span>
00004 
00005 <span class="preprocessor">#include &lt;<a class="code" href="ALL_8H.html">ALL.H</a>&gt;</span>
00006 <span class="preprocessor">#include &lt;<a class="code" href="COLOR_8H.html">COLOR.H</a>&gt;</span>
00007 <span class="preprocessor">#include &lt;OINFO.H&gt;</span>
00008 <span class="preprocessor">#include &lt;<a class="code" href="OVGA_8H.html">OVGA.H</a>&gt;</span>
00009 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00010 <span class="preprocessor">#include &lt;OFONT.H&gt;</span>
00011 <span class="preprocessor">#include &lt;OMOUSE.H&gt;</span>
00012 <span class="preprocessor">#include &lt;<a class="code" href="OGRPH__PT_8H.html">OGRPH_PT.H</a>&gt;</span>
00013 <span class="preprocessor">#include &lt;OIFACE.H&gt;</span>
00014 
00015 <span class="preprocessor">#include &lt;math.h&gt;</span>
00016 
00017 <span class="comment">//--------- Define macro constant -----------//</span>
00018 
<a name="l00019"></a><a class="code" href="OGRPH__PT_8CPP.html#a0">00019</a> <span class="preprocessor">#define MAX_LEN_LABEL "0%"</span>
00020 <span class="preprocessor"></span>
00021 <span class="keyword">static</span> <span class="keywordtype">int</span> default_series_color[] = {
00022     <a class="code" href="COLOR_8H.html#a21">V_BLUE</a>,
00023     <a class="code" href="COLOR_8H.html#a20">V_GREEN</a>,
00024     <a class="code" href="COLOR_8H.html#a19">V_RED</a>,
00025     <a class="code" href="COLOR_8H.html#a25">V_YELLOW</a>,
00026     <a class="code" href="COLOR_8H.html#a22">V_VIOLET</a>,
00027     <a class="code" href="COLOR_8H.html#a23">V_BROWN</a>,
00028     <a class="code" href="COLOR_8H.html#a18">V_ORANGE</a>,
00029     <a class="code" href="COLOR_8H.html#a24">V_PINK</a>,
00030     <a class="code" href="COLOR_8H.html#a15">V_BLACK</a>,
00031     <a class="code" href="COLOR_8H.html#a17">V_WHITE</a>,
00032 };                                                <span class="comment">// 10 default series colors</span>
00033 
00034 <span class="keyword">enum</span> {  <a class="code" href="OGRPH__PT_8CPP.html#a7a2">DEFAULT_SERIES_COLOR_NUM</a> = 10 };
00035 
00036 <span class="keyword">enum</span> {
00037     <a class="code" href="OGRPH__PT_8CPP.html#a8a3">LEGEND_SIZE</a> = 11,
00038     <a class="code" href="OGRPH__PT_8CPP.html#a8a4">LEGEND_X_SPACING</a> = 12,
00039     <a class="code" href="OGRPH__PT_8CPP.html#a8a5">LEGEND_Y_SPACING</a> = 2,
00040 };
00041 
00042 <span class="keyword">enum</span> {  <a class="code" href="OGRPH__PT_8CPP.html#a9a6">COMMON_OFFSET</a> = 2         };
00043 
00044 <span class="comment">//-------------- Define static vars ------------//</span>
00045 
00046 <span class="comment">//static char paint_flag = 0;</span>
00047 
00048 <span class="comment">//-------- Begin of function GraphPerformanceIndicatorTrimester::GraphPerformanceIndicatorTrimester ----//</span>
<a name="l00050"></a><a class="code" href="classGraphPerformanceIndicatorTrimester.html#a0">00050</a> <span class="comment">GraphPerformanceIndicatorTrimester::GraphPerformanceIndicatorTrimester() {</span>
00051     init_flag = 0;
00052     grapha_bitmap = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00053 }
00054 
00055 <span class="comment">//---------- End of function GraphPerformanceIndicatorTrimester::GraphPerformanceIndicatorTrimester ----//</span>
00056 
00057 <span class="comment">//-------- Begin of function GraphPerformanceIndicatorTrimester::~GraphPerformanceIndicatorTrimester -----//</span>
<a name="l00059"></a><a class="code" href="classGraphPerformanceIndicatorTrimester.html#a1">00059</a> <span class="comment">GraphPerformanceIndicatorTrimester::~GraphPerformanceIndicatorTrimester() {</span>
00060     deinit();
00061 }
00062 
00063 <span class="comment">//---------- End of function GraphPerformanceIndicatorTrimester::~GraphPerformanceIndicatorTrimester -----//</span>
00064 
00065 <span class="comment">//-------- Begin of function GraphPerformanceIndicatorTrimester::init --------//</span>
00094 <span class="comment">void GraphPerformanceIndicatorTrimester::init(int x1, int y1, int x2, int y2,</span>
00095                                               <span class="keywordtype">int</span> seriesNum, <span class="keywordtype">int</span> *dataNum,
00096                                               <span class="keywordtype">void</span> *dataArray,
00097                                               <span class="keywordtype">char</span> dataTypeFlag,
00098                                               <span class="keywordtype">char</span> transparentFlag,
00099                                               <span class="keywordtype">char</span> valueFlag,
00100                                               <span class="keywordtype">int</span> numFormat, <span class="keywordtype">double</span> defaultUpperBound, <span class="keywordtype">int</span> *seriesColor, <span class="keywordtype">int</span> axisColor
00101     ) {
00102     <a class="code" href="ALL_8H.html#a0">err_when</a>(seriesNum &gt; <a class="code" href="OGRPH__PT_8CPP.html#a7a2">DEFAULT_SERIES_COLOR_NUM</a> &amp;&amp; !seriesColor);
00103     <a class="code" href="ALL_8H.html#a0">err_when</a>(seriesNum &lt;= 0);
00104 
00105     graph_width = x2 - x1 - 6;
00106 
00107     <a class="code" href="ALL_8H.html#a0">err_when</a>(graph_width &lt; 0);
00108 
00109     grapha_x1 = x1;
00110     grapha_y1 = y1;
00111     grapha_x2 = x2;
00112     grapha_y2 = y2;
00113     series_num = seriesNum;
00114     data_num = dataNum;
00115     data_array = dataArray;
00116     data_type_flag = dataTypeFlag;
00117     transparent_flag = transparentFlag;
00118     value_flag = valueFlag;
00119     num_format = numFormat;
00120     series_color = seriesColor ? seriesColor : default_series_color;
00121     axis_color = axisColor;
00122     default_upper_bound = defaultUpperBound;
00123 
00124     init_flag = 1;
00125 
00126     <span class="keywordflow">if</span>(value_flag)
00127         y_label_max_len = font_chartsm.text_width(<a class="code" href="OGRPH__PT_8CPP.html#a0">MAX_LEN_LABEL</a>);
00128     <span class="keywordflow">else</span>
00129         y_label_max_len = 0;
00130     set_font(&amp;font_chartsm);
00131 
00132 }
00133 
00134 <span class="comment">//------------- End of function GraphPerformanceIndicatorTrimester::init -----------//</span>
00135 
00136 <span class="comment">//-------- Begin of function GraphPerformanceIndicatorTrimester::deinit ------------//</span>
<a name="l00138"></a><a class="code" href="classGraphPerformanceIndicatorTrimester.html#a7">00138</a> <span class="comment">void GraphPerformanceIndicatorTrimester::deinit() {</span>
00139     <span class="keywordflow">if</span> (grapha_bitmap) {
00140         <a class="code" href="ALL_8H.html#a8">mem_del</a>(grapha_bitmap);
00141         grapha_bitmap = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00142     }
00143     init_flag = 0;
00144 }
00145 
00146 <span class="comment">//------------- End of function GraphPerformanceIndicatorTrimester::deinit ---------//</span>
00147 
00148 <span class="comment">//-------- Begin of function GraphPerformanceIndicatorTrimester::set_font ------------//</span>
<a name="l00150"></a><a class="code" href="classGraphPerformanceIndicatorTrimester.html#a10">00150</a> <span class="comment">void GraphPerformanceIndicatorTrimester::set_font(Font *fontPtr) {</span>
00151     <span class="keywordflow">if</span> (!init_flag)
00152         <span class="keywordflow">return</span>;
00153 
00154     font_ptr = fontPtr;
00155 
00156     calc_pos();
00157 }
00158 
00159 <span class="comment">//------------- End of function GraphPerformanceIndicatorTrimester::set_font ---------//</span>
00160 
00161 <span class="comment">//-------- Begin of function GraphPerformanceIndicatorTrimester::calc_pos ------------//</span>
<a name="l00166"></a><a class="code" href="classGraphPerformanceIndicatorTrimester.html#a11">00166</a> <span class="comment">void GraphPerformanceIndicatorTrimester::calc_pos() {</span>
00167     graph_height = grapha_y2 - grapha_y1 ;
00168     <span class="keywordtype">short</span> YLabelWidth =  -<a class="code" href="OGRPH__PT_8CPP.html#a9a6">COMMON_OFFSET</a>;
00169     <span class="keywordtype">short</span> XLabelHeight = -<a class="code" href="OGRPH__PT_8CPP.html#a9a6">COMMON_OFFSET</a>;
00170     series_x1 = grapha_x1 + 4 + <a class="code" href="OGRPH__PT_8CPP.html#a9a6">COMMON_OFFSET</a>*2;
00171     series_y1 = grapha_y1 + 4 + <a class="code" href="OGRPH__PT_8CPP.html#a9a6">COMMON_OFFSET</a>*4;
00172     series_x2 = grapha_x2 - 4 - <a class="code" href="OGRPH__PT_8CPP.html#a9a6">COMMON_OFFSET</a>*2;
00173     series_y2 = grapha_y1 + graph_height - <a class="code" href="OGRPH__PT_8CPP.html#a9a6">COMMON_OFFSET</a>*2;
00174 }
00175 
00176 <span class="comment">//------------ End of function GraphPerformanceIndicatorTrimester::calc_pos ---------//</span>
00177 
00178 <span class="comment">//-------- Begin of function GraphPerformanceIndicatorTrimester::paint --------------//</span>
<a name="l00180"></a><a class="code" href="classGraphPerformanceIndicatorTrimester.html#a8">00180</a> <span class="comment">void GraphPerformanceIndicatorTrimester::paint() {</span>
00181     <span class="keywordflow">if</span> (transparent_flag) {
00182         vga.use_back();
00183 
00184         user_interface.brighten(grapha_x1+4, grapha_y1+4, grapha_x2-2, grapha_y2-2);
00185         grapha_bitmap = vga_back.save_area(grapha_x1+4, grapha_y1+4, grapha_x2-2, grapha_y2-2, grapha_bitmap);
00186     }
00187     <span class="comment">//  paint_flag = 1;</span>
00188     refresh();
00189 }
00190 
00191 <span class="comment">//------------- End of function GraphPerformanceIndicatorTrimester::paint -----------//</span>
00192 
00193 <span class="comment">//-------- Begin of function GraphPerformanceIndicatorTrimester::refresh ------------//</span>
<a name="l00195"></a><a class="code" href="classGraphPerformanceIndicatorTrimester.html#a9">00195</a> <span class="comment">void GraphPerformanceIndicatorTrimester::refresh() {</span>
00196     <span class="comment">//  vga.use_back();</span>
00197 
00198     <span class="keywordflow">if</span> (transparent_flag) {
00199         user_interface.rect(grapha_x1, grapha_y1, grapha_x2, grapha_y2, 1);
00200         vga_back.rest_area(grapha_bitmap, 0, 0);
00201     }
00202     <span class="keywordflow">else</span> {
00203         user_interface.bar(grapha_x1, grapha_y1, grapha_x2, grapha_y2);
00204         user_interface.panel(grapha_x1+3, grapha_y1+3, grapha_x2-4, grapha_y2-4);
00205     }
00206     draw_scale();
00207     draw_series();
00208 
00209     <span class="comment">//  if (!paint_flag)</span>
00210     <span class="comment">//          vga.blt_buf(grapha_x1, grapha_y1, grapha_x2+2, grapha_y2+2);</span>
00211     <span class="comment">//  else</span>
00212     <span class="comment">//          paint_flag = 0;</span>
00213 }
00214 
00215 <span class="comment">//------------- End of function GraphPerformanceIndicatorTrimester::refresh ---------//</span>
00216 
00217 <span class="comment">//---------- Begin of function GraphPerformanceIndicatorTrimester::find_scale -------------//</span>
<a name="l00219"></a><a class="code" href="classGraphPerformanceIndicatorTrimester.html#b0">00219</a> <span class="comment">void GraphPerformanceIndicatorTrimester::find_scale() {</span>
00220     <span class="keywordtype">double</span> data, maxVal = 0.0;
00221     x_axis_pos = 0;
00222 
00223     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; series_num * *data_num; i++) {
00224         <span class="keywordflow">switch</span> (data_type_flag) {
00225         <span class="keywordflow">case</span> DATA_DOUBLE:
00226             data = ((<span class="keywordtype">double</span>*)data_array)[i];
00227             <span class="keywordflow">break</span>;
00228         <span class="keywordflow">case</span> DATA_FLOAT:
00229             data = double(((<span class="keywordtype">float</span>*)data_array)[i]);
00230             <span class="keywordflow">break</span>;
00231         <span class="keywordflow">case</span> DATA_INT:
00232             data = double(((<span class="keywordtype">int</span>*)data_array)[i]);
00233             <span class="keywordflow">break</span>;
00234         <span class="keywordflow">case</span> DATA_LONG:
00235             data = double(((<span class="keywordtype">long</span>*)data_array)[i]);
00236             <span class="keywordflow">break</span>;
00237         }
00238         <span class="keywordflow">if</span> (<a class="code" href="OLINALG_8CPP.html#a2">fabs</a>(data) &gt; maxVal)
00239             maxVal = <a class="code" href="OLINALG_8CPP.html#a2">fabs</a>(data);
00240         <span class="keywordflow">if</span> (!x_axis_pos &amp;&amp; data &lt; 0.0)
00241             x_axis_pos = 1;
00242     }
00243     <span class="keywordflow">if</span> (maxVal &gt; default_upper_bound)
00244         max_scale = maxVal;
00245     <span class="keywordflow">else</span>
00246         max_scale = default_upper_bound;
00247 }
00248 
00249 <span class="comment">//------------ End of function GraphPerformanceIndicatorTrimester::find_scale -------------//</span>
00250 
00251 <span class="comment">//---------- Begin of function GraphPerformanceIndicatorTrimester::draw_scale -------------//</span>
<a name="l00253"></a><a class="code" href="classGraphPerformanceIndicatorTrimester.html#b1">00253</a> <span class="comment">void GraphPerformanceIndicatorTrimester::draw_scale() {</span>
00254     find_scale();
00255     <span class="comment">//------ Draw y-axis -------//</span>
00256 
00257     <span class="keywordflow">if</span> (x_axis_pos)
00258         vga_back.bar(series_x1, series_y1-<a class="code" href="OGRPH__PT_8CPP.html#a9a6">COMMON_OFFSET</a>*2, series_x1+1, series_y2+<a class="code" href="OGRPH__PT_8CPP.html#a9a6">COMMON_OFFSET</a>*2, axis_color);
00259     <span class="keywordflow">else</span>
00260         vga_back.bar(series_x1, series_y1-<a class="code" href="OGRPH__PT_8CPP.html#a9a6">COMMON_OFFSET</a>*2, series_x1+1, series_y2, axis_color);
00261 
00262     <span class="keywordflow">if</span> (x_axis_pos)
00263         vga_back.bar(series_x1, series_y2+<a class="code" href="OGRPH__PT_8CPP.html#a9a6">COMMON_OFFSET</a>*2, series_x2-<a class="code" href="OGRPH__PT_8CPP.html#a9a6">COMMON_OFFSET</a>, series_y2+<a class="code" href="OGRPH__PT_8CPP.html#a9a6">COMMON_OFFSET</a>*2, axis_color);
00264     <span class="keywordflow">else</span>
00265         vga_back.bar(series_x1, series_y2, series_x2-<a class="code" href="OGRPH__PT_8CPP.html#a9a6">COMMON_OFFSET</a>, series_y2, axis_color);
00266 
00267     <span class="comment">//------ Draw x-axis -------//</span>
00268     x_axis_step = (double)(series_x2-series_x1) / (*data_num-1);
00269 }
00270 
00271 <span class="comment">//------------ End of function GraphPerformanceIndicatorTrimester::draw_scale -------------//</span>
00272 
00273 <span class="comment">//---------- Begin of function GraphPerformanceIndicatorTrimester::draw_series ------------//</span>
<a name="l00275"></a><a class="code" href="classGraphPerformanceIndicatorTrimester.html#b2">00275</a> <span class="comment">void GraphPerformanceIndicatorTrimester::draw_series() {</span>
00276     <span class="keywordflow">switch</span> (data_type_flag) {
00277     <span class="keywordflow">case</span> DATA_FLOAT: draw_series_float(); <span class="keywordflow">break</span>;
00278     <span class="keywordflow">case</span> DATA_DOUBLE: draw_series_double(); <span class="keywordflow">break</span>;
00279     <span class="keywordflow">case</span> DATA_INT: draw_series_int(); <span class="keywordflow">break</span>;
00280     <span class="keywordflow">case</span> DATA_LONG: draw_series_long(); <span class="keywordflow">break</span>;
00281     }
00282 }
00283 
00284 <span class="comment">//------------ End of function GraphPerformanceIndicatorTrimester::draw_series ------------//</span>
00285 
00286 <span class="comment">//---------- Begin of function GraphPerformanceIndicatorTrimester::draw_series_float ------------//</span>
<a name="l00288"></a><a class="code" href="classGraphPerformanceIndicatorTrimester.html#b3">00288</a> <span class="comment">void GraphPerformanceIndicatorTrimester::draw_series_float() {</span>
00289     <span class="keywordtype">float</span> *dataArray = (<span class="keywordtype">float</span> *) data_array;
00290     <span class="keywordtype">short</span> prevX, prevY, currX, currY;
00291 
00292     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; series_num; i++) {
00293         dataArray-=info.graph_trimester_passed;
00294         dataArray+=HISTORY_TRIMESTER_COUNT;
00295         prevX = series_x1;
00296         <span class="keywordflow">if</span> (x_axis_pos)
00297             prevY = series_y2 - short(((*dataArray+<span class="keywordtype">float</span>(max_scale)) * <span class="keywordtype">float</span>(series_y2-series_y1) / <span class="keywordtype">float</span>(max_scale*2)));
00298         <span class="keywordflow">else</span>
00299             prevY = series_y2 - short(*dataArray * <span class="keywordtype">float</span>(series_y2-series_y1) / <span class="keywordtype">float</span>(max_scale));
00300 
00301         dataArray++;
00302         vga_back.thick_line(prevX-1, prevY, prevX+1, prevY, vga_back.translate_color(series_color[i]));
00303 
00304         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; info.graph_trimester_passed; j++) {
00305             currX = series_x1 + (int)(x_axis_step*j);
00306             <span class="keywordflow">if</span> (x_axis_pos)
00307                 currY = series_y2 - short(((*dataArray+<span class="keywordtype">float</span>(max_scale)) * <span class="keywordtype">float</span>(series_y2-series_y1) / <span class="keywordtype">float</span>(max_scale*2)));
00308             <span class="keywordflow">else</span>
00309                 currY = series_y2 - short(*dataArray * <span class="keywordtype">float</span>(series_y2-series_y1) / <span class="keywordtype">float</span>(max_scale));
00310 
00311             vga_back.thick_line(prevX, prevY, currX, currY, vga_back.translate_color(series_color[i]));
00312 
00313             prevX = currX;
00314             prevY = currY;
00315             dataArray++;
00316         }
00317 
00318         <span class="keywordflow">if</span> (value_flag)
00319             draw_value(dataArray-1, vga_back.translate_color(<a class="code" href="COLOR_8H.html#a15">V_BLACK</a>), prevX+<a class="code" href="OGRPH__PT_8CPP.html#a9a6">COMMON_OFFSET</a>-(int)(0.3f*x_axis_step), prevY-font_ptr-&gt;max_font_height/2, DATA_FLOAT);
00320     }
00321 }
00322 
00323 <span class="comment">//------------ End of function GraphPerformanceIndicatorTrimester::draw_series_float ------------//</span>
00324 
00325 <span class="comment">//---------- Begin of function GraphPerformanceIndicatorTrimester::draw_series_double ------------//</span>
<a name="l00327"></a><a class="code" href="classGraphPerformanceIndicatorTrimester.html#b4">00327</a> <span class="comment">void GraphPerformanceIndicatorTrimester::draw_series_double() {</span>
00328     <span class="keywordtype">double</span> *dataArray = (<span class="keywordtype">double</span> *) data_array;
00329     <span class="keywordtype">short</span> prevX, prevY, currX, currY;
00330 
00331     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; series_num; i++) {
00332         dataArray-=info.graph_trimester_passed;
00333         dataArray+=HISTORY_TRIMESTER_COUNT;
00334         prevX = series_x1;
00335         <span class="keywordflow">if</span> (x_axis_pos)
00336             prevY = series_y2 - short(((*dataArray+max_scale) * <span class="keywordtype">double</span>(series_y2-series_y1) / (max_scale*2)));
00337         <span class="keywordflow">else</span>
00338             prevY = series_y2 - short(*dataArray * <span class="keywordtype">double</span>(series_y2-series_y1) / max_scale);
00339 
00340         dataArray++;
00341         vga_back.thick_line(prevX-1, prevY, prevX+1, prevY, vga_back.translate_color(series_color[i]));
00342 
00343         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; info.graph_trimester_passed; j++) {
00344             currX = series_x1 + (int)(x_axis_step*j);
00345             <span class="keywordflow">if</span> (x_axis_pos)
00346                 currY = series_y2 - short(((*dataArray+max_scale) * <span class="keywordtype">double</span>(series_y2-series_y1) / (max_scale*2)));
00347             <span class="keywordflow">else</span>
00348                 currY = series_y2 - short(*dataArray * <span class="keywordtype">double</span>(series_y2-series_y1) / max_scale);
00349 
00350             vga_back.thick_line(prevX, prevY, currX, currY, vga_back.translate_color(series_color[i]));
00351 
00352             prevX = currX;
00353             prevY = currY;
00354             dataArray++;
00355         }
00356 
00357         <span class="keywordflow">if</span> (value_flag)
00358             draw_value(dataArray-1, vga_back.translate_color(<a class="code" href="COLOR_8H.html#a15">V_BLACK</a>), prevX+<a class="code" href="OGRPH__PT_8CPP.html#a9a6">COMMON_OFFSET</a>-(int)(0.3f*x_axis_step), prevY-font_ptr-&gt;max_font_height/2, DATA_DOUBLE);
00359     }
00360 }
00361 
00362 <span class="comment">//------------ End of function GraphPerformanceIndicatorTrimester::draw_series_double ------------//</span>
00363 
00364 <span class="comment">//---------- Begin of function GraphPerformanceIndicatorTrimester::draw_series_int ------------//</span>
<a name="l00366"></a><a class="code" href="classGraphPerformanceIndicatorTrimester.html#b5">00366</a> <span class="comment">void GraphPerformanceIndicatorTrimester::draw_series_int() {</span>
00367     <span class="keywordtype">int</span> *dataArray = (<span class="keywordtype">int</span> *) data_array;
00368 
00369     <span class="keywordtype">short</span> prevX, prevY, currX, currY;
00370 
00371     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; series_num; i++) {
00372         dataArray-=info.graph_trimester_passed;
00373         dataArray+=HISTORY_TRIMESTER_COUNT;
00374         prevX = series_x1;
00375         <span class="keywordflow">if</span> (x_axis_pos)
00376             prevY = series_y2 - ((*dataArray+int(max_scale)) * (series_y2-series_y1) / int(max_scale*2));
00377         <span class="keywordflow">else</span>
00378             prevY = series_y2 - *dataArray * (series_y2-series_y1) / int(max_scale);
00379 
00380         dataArray++;
00381         vga_back.thick_line(prevX-1, prevY, prevX+1, prevY, vga_back.translate_color(series_color[i]));
00382 
00383         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; info.graph_trimester_passed; j++) {
00384             currX = series_x1 + (int)(x_axis_step*j);
00385             <span class="keywordflow">if</span> (x_axis_pos)
00386                 currY = series_y2 - ((*dataArray+int(max_scale)) * (series_y2-series_y1) / int(max_scale*2));
00387             <span class="keywordflow">else</span>
00388                 currY = series_y2 - *dataArray * (series_y2-series_y1) / int(max_scale);
00389 
00390             vga_back.thick_line(prevX, prevY, currX, currY, vga_back.translate_color(series_color[i]));
00391 
00392             prevX = currX;
00393             prevY = currY;
00394             dataArray++;
00395         }
00396 
00397         <span class="keywordflow">if</span> (value_flag)
00398             draw_value(dataArray-1, vga_back.translate_color(<a class="code" href="COLOR_8H.html#a15">V_BLACK</a>), prevX+<a class="code" href="OGRPH__PT_8CPP.html#a9a6">COMMON_OFFSET</a>-(int)(0.3f*x_axis_step), prevY-font_ptr-&gt;max_font_height/2, DATA_INT);
00399     }
00400 }
00401 
00402 <span class="comment">//------------ End of function GraphPerformanceIndicatorTrimester::draw_series_int ------------//</span>
00403 
00404 <span class="comment">//---------- Begin of function GraphPerformanceIndicatorTrimester::draw_series_long ------------//</span>
<a name="l00406"></a><a class="code" href="classGraphPerformanceIndicatorTrimester.html#b6">00406</a> <span class="comment">void GraphPerformanceIndicatorTrimester::draw_series_long() {</span>
00407     <span class="keywordtype">long</span> *dataArray = (<span class="keywordtype">long</span> *) data_array;
00408     <span class="keywordtype">short</span> prevX, prevY, currX, currY;
00409 
00410     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; series_num; i++) {
00411         dataArray-=info.graph_trimester_passed;
00412         dataArray+=HISTORY_TRIMESTER_COUNT;
00413         prevX = series_x1;
00414         <span class="keywordflow">if</span> (x_axis_pos)
00415             prevY = series_y2 - short(((*dataArray+<span class="keywordtype">long</span>(max_scale)) * <span class="keywordtype">long</span>(series_y2-series_y1) / <span class="keywordtype">long</span>(max_scale*2)));
00416         <span class="keywordflow">else</span>
00417             prevY = series_y2 - short(*dataArray * <span class="keywordtype">long</span>(series_y2-series_y1) / <span class="keywordtype">long</span>(max_scale));
00418 
00419         dataArray++;
00420         vga_back.thick_line(prevX-1, prevY, prevX+1, prevY, vga_back.translate_color(series_color[i]));
00421 
00422         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; info.graph_trimester_passed; j++) {
00423             currX = series_x1 + (int)(x_axis_step*j);
00424             <span class="keywordflow">if</span> (x_axis_pos)
00425                 currY = series_y2 - short(((*dataArray+<span class="keywordtype">long</span>(max_scale)) * <span class="keywordtype">long</span>(series_y2-series_y1) / <span class="keywordtype">long</span>(max_scale*2)));
00426             <span class="keywordflow">else</span>
00427                 currY = series_y2 - short(*dataArray * <span class="keywordtype">long</span>(series_y2-series_y1) / <span class="keywordtype">long</span>(max_scale));
00428 
00429             vga_back.thick_line(prevX, prevY, currX, currY, vga_back.translate_color(series_color[i]));
00430 
00431             prevX = currX;
00432             prevY = currY;
00433             dataArray++;
00434         }
00435 
00436         <span class="keywordflow">if</span> (value_flag)
00437             draw_value(dataArray-1, vga_back.translate_color(<a class="code" href="COLOR_8H.html#a15">V_BLACK</a>), prevX+<a class="code" href="OGRPH__PT_8CPP.html#a9a6">COMMON_OFFSET</a>-(int)(0.3f*x_axis_step), prevY-font_ptr-&gt;max_font_height/2, DATA_LONG);
00438     }
00439 }
00440 
00441 <span class="comment">//------------ End of function GraphPerformanceIndicatorTrimester::draw_series_float ------------//</span>
00442 
00443 <span class="comment">//---------- Begin of function GraphPerformanceIndicatorTrimester::draw_value -------------------//</span>
<a name="l00445"></a><a class="code" href="classGraphPerformanceIndicatorTrimester.html#b7">00445</a> <span class="comment">void GraphPerformanceIndicatorTrimester::draw_value(void *value, int color, short x, short y, int dataType) {</span>
00446     <span class="keywordtype">char</span> *valueString;
00447     <span class="keywordflow">switch</span> (data_type_flag) {
00448     <span class="keywordflow">case</span> DATA_FLOAT:
00449         valueString = m.format(*((<span class="keywordtype">float</span> *) value), num_format); <span class="keywordflow">break</span>;
00450     <span class="keywordflow">case</span> DATA_DOUBLE:
00451         valueString = m.format(*((<span class="keywordtype">double</span> *) value), num_format); <span class="keywordflow">break</span>;
00452     <span class="keywordflow">case</span> DATA_INT:
00453         valueString = m.format(*((<span class="keywordtype">int</span> *) value), num_format); <span class="keywordflow">break</span>;
00454     <span class="keywordflow">case</span> DATA_LONG:
00455         valueString = m.format(*((<span class="keywordtype">long</span> *) value), num_format); <span class="keywordflow">break</span>;
00456     }
00457 
00458     <span class="keywordtype">short</span> textHeight = font_ptr-&gt;max_font_height;
00459     <span class="keywordtype">short</span> textWidth = font_ptr-&gt;text_width(valueString) + 1;
00460     <span class="comment">/*  </span>
00461 <span class="comment">        short *bitmap = (short *) sys.common_data_buf;</span>
00462 <span class="comment">        err_when( (2 + textWidth * textHeight) * sizeof(short) &gt; COMMON_DATA_BUF_SIZE );</span>
00463 <span class="comment">        *bitmap++ = textWidth;</span>
00464 <span class="comment">        *bitmap++ = textHeight;</span>
00465 <span class="comment"></span>
00466 <span class="comment">        short *shortPtr = bitmap;</span>
00467 <span class="comment">        for (int i = 0; i &lt; textWidth * textHeight; i++)</span>
00468 <span class="comment">        *shortPtr++ = transparent_code_w;</span>
00469 <span class="comment"></span>
00470 <span class="comment">        font_ptr-&gt;put_to_bufferW(bitmap, textWidth * sizeof(short), 0, 0, valueString);</span>
00471 <span class="comment"></span>
00472 <span class="comment">        shortPtr = bitmap;</span>
00473 <span class="comment">        for (i = 0; i &lt; textWidth * textHeight; i++, shortPtr++)</span>
00474 <span class="comment">        if (*shortPtr != transparent_code_w)</span>
00475 <span class="comment">        *shortPtr = color;</span>
00476 <span class="comment"></span>
00477 <span class="comment">        vga_back.put_bitmapW_trans(x, y, (short *) sys.common_data_buf);</span>
00478 <span class="comment">    */</span>
00479     font_chartsm.put(x+3,y,valueString);
00480 }
00481 
00482 <span class="comment">//---------- End of function GraphPerformanceIndicatorTrimester::draw_value -------------------//</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:37:51 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
