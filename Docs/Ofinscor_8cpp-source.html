<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Ofinscor.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Ofinscor.cpp</h1><a href="Ofinscor_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00002 <span class="preprocessor">#include &lt;OCONFIG.H&gt;</span>
00003 <span class="preprocessor">#include &lt;<a class="code" href="OFINSCOR_8H.html">OFINSCOR.H</a>&gt;</span>
00004 <span class="preprocessor">#include &lt;<a class="code" href="OGAMESET_8H.html">OGAMESET.H</a>&gt;</span>
00005 <span class="preprocessor">#include &lt;OWORLDMT.H&gt;</span>
00006 <span class="preprocessor">#include &lt;<a class="code" href="OVGA_8H.html">OVGA.H</a>&gt;</span>
00007 <span class="preprocessor">#include &lt;<a class="code" href="COLOR_8H.html">COLOR.H</a>&gt;</span>
00008 <span class="preprocessor">#include &lt;OFONT.H&gt;</span>
00009 <span class="preprocessor">#include &lt;OGAMESTR.H&gt;</span>
00010 <span class="preprocessor">#include &lt;OMOUSE.H&gt;</span>
00011 <span class="preprocessor">#include &lt;<a class="code" href="OMOUSE2_8H.html">OMOUSE2.H</a>&gt;</span>
00012 <span class="preprocessor">#include &lt;OIFACE.H&gt;</span>
00013 <span class="preprocessor">#include &lt;OINFO.H&gt;</span>
00014 <span class="preprocessor">#include &lt;OBUTTON.H&gt;</span>
00015 <span class="preprocessor">#include &lt;OPSCHOOL.H&gt;</span>
00016 <span class="preprocessor">#include &lt;OGFILE.H&gt;</span>
00017 
00018 <span class="keyword">enum</span> {                                            <span class="comment">// screen coordinates</span>
00019     <a class="code" href="Ofinscor_8cpp.html#a11a1">REPORT_X1</a> = <a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>+15,
00020     <a class="code" href="Ofinscor_8cpp.html#a11a2">REPORT_Y1</a> = <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>+25,
00021     <a class="code" href="Ofinscor_8cpp.html#a11a3">REPORT_X2</a> = <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-15,
00022     <a class="code" href="Ofinscor_8cpp.html#a11a4">REPORT_Y2</a> = <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-55
00023 };
00024 
00025 <span class="keyword">enum</span> {
00026     <a class="code" href="Ofinscor_8cpp.html#a12a5">BUTTON_X0</a> = <a class="code" href="Ofinscor_8cpp.html#a11a1">REPORT_X1</a>+100,
00027     <a class="code" href="Ofinscor_8cpp.html#a12a6">BOTTOM_Y1</a> = <a class="code" href="Ofinscor_8cpp.html#a11a4">REPORT_Y2</a>+25,
00028 };
00029 
00030 <span class="keyword">enum</span> {
00031     <a class="code" href="Ofinscor_8cpp.html#a13a7">BOTTOM_BUTTON_WIDTH</a> = 80,
00032     <a class="code" href="Ofinscor_8cpp.html#a13a8">BOTTOM_BUTTON_HEIGHT</a> = 25,
00033     <a class="code" href="Ofinscor_8cpp.html#a13a9">BOTTOM_BUTTON_DISTANCE</a> = 10,
00034 };
00035 
00036 <span class="keyword">enum</span> {                                            <span class="comment">// the bg image id</span>
00037     <a class="code" href="Ofinscor_8cpp.html#a14a10">BG_PIC_ID</a> = 7
00038 };
00039 
00040 <span class="keyword">static</span> <span class="keywordtype">char</span> final_score_report_init_flag;
00041 <span class="comment">//------- Begin of function FinalScoreReport::FinalScoreReport -----------//</span>
<a name="l00043"></a><a class="code" href="classFinalScoreReport.html#a0">00043</a> <span class="comment">FinalScoreReport::FinalScoreReport() {</span>
00044     init();
00045 }
00046 
00047 <span class="comment">//--------- End of function FinalScoreReport::FinalScoreReport -----------//</span>
00048 
00049 <span class="comment">//------- Begin of function FinalScoreReport::~FinalScoreReport -----------//</span>
<a name="l00051"></a><a class="code" href="classFinalScoreReport.html#a1">00051</a> <span class="comment">FinalScoreReport::~FinalScoreReport() {</span>
00052     deinit();
00053 }
00054 
00055 <span class="comment">//--------- End of function FinalScoreReport::~FinalScoreReport -----------//</span>
00056 
00057 <span class="comment">//------- Begin of function FinalScoreReport::deinit ---------------//</span>
<a name="l00059"></a><a class="code" href="classFinalScoreReport.html#a3">00059</a> <span class="comment">void FinalScoreReport::deinit() {</span>
00060     final_score_report_init_flag = 0;
00061 }
00062 
00063 <span class="comment">//--------- End of function FinalScoreReport::deinit ---------------//</span>
00064 
00065 <span class="comment">//------- Begin of function FinalScoreReport::init -----------------//</span>
<a name="l00067"></a><a class="code" href="classFinalScoreReport.html#a2">00067</a> <span class="comment">void FinalScoreReport::init() {</span>
00068     final_score_report_init_flag = 0;
00069 }
00070 
00071 <span class="comment">//--------- End of function FinalScoreReport::init -----------------//</span>
00072 
00073 <span class="comment">//---------- Begin of function FinalScoreReport::eval_letter_report ------------//</span>
<a name="l00075"></a><a class="code" href="classFinalScoreReport.html#a4">00075</a> <span class="comment">void FinalScoreReport::final_score_report(int refreshFlag) {</span>
00076     <span class="keywordtype">int</span> tab1=<a class="code" href="Ofinscor_8cpp.html#a11a1">REPORT_X1</a>+100,tab2=<a class="code" href="Ofinscor_8cpp.html#a11a1">REPORT_X1</a>+100,
00077         tab3=<a class="code" href="Ofinscor_8cpp.html#a11a1">REPORT_X1</a>+200,tab4=<a class="code" href="Ofinscor_8cpp.html#a11a1">REPORT_X1</a>+700;
00078     <span class="keywordtype">int</span> vtab1=<a class="code" href="Ofinscor_8cpp.html#a11a2">REPORT_Y1</a>+15,vtab2=<a class="code" href="Ofinscor_8cpp.html#a11a2">REPORT_Y1</a>+250,
00079         vtab3=<a class="code" href="Ofinscor_8cpp.html#a11a2">REPORT_Y1</a>+75,vtab4=<a class="code" href="Ofinscor_8cpp.html#a11a2">REPORT_Y1</a>+350;
00080     vga.use_back();
00081 
00082     sys.is_institution_report=1;
00083     <span class="keywordflow">if</span> (refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>) {
00084         <span class="keywordflow">if</span>(final_score_report_init_flag )
00085             deinit();
00086 
00087         <span class="comment">//------------- paint the background ----------------//</span>
00088         <span class="keywordflow">if</span> (!final_score_report_init_flag) {
00089             user_interface.bg_img(<a class="code" href="Ofinscor_8cpp.html#a14a10">BG_PIC_ID</a>, &amp;vga_back);
00090             info.disp_column_bitmap(&amp;vga_back);
00091             final_score_report_init_flag=1;
00092             font_charts.put(tab2,vtab1+30,<span class="stringliteral">"Final Score"</span>);
00093             font_charts.put(tab2,vtab1+70,<span class="stringliteral">"=    (Current Trustee Evaluation - Initial Trustee Evaluation) X 10 "</span> );
00094             font_charts.put(tab2,vtab1+110,<span class="stringliteral">"    + Number Of Gaming Years + Goal Bonus"</span> );
00095 
00096             <a class="code" href="classString.html">String</a> formula;
00097             formula = <span class="stringliteral">"=    ("</span>;
00098             formula += (long)player_school.cur_game_score;
00099             formula += <span class="stringliteral">" - "</span>;
00100             formula += (long)player_school.init_game_score;
00101             formula += <span class="stringliteral">") X 10 + "</span>;
00102             formula += info.year_passed-1;
00103             formula += <span class="stringliteral">" + "</span>;
00104 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00105 <span class="preprocessor"></span>            formula += (player_school.bonus_point + (int)player_school.threshold_event_bonus);
00106 <span class="preprocessor">#else</span>
00107 <span class="preprocessor"></span>            formula += player_school.bonus_point;
00108 <span class="preprocessor">#endif</span>
00109 <span class="preprocessor"></span>            font_charts.put(tab2,vtab1+150,formula.<a class="code" href="classString.html#m0">str_buf</a>);
00110             formula = <span class="stringliteral">"=    "</span>;
00111             formula += player_school.ultimate_game_score;
00112             font_charts.put(tab2,vtab1+190,formula.<a class="code" href="classString.html#m0">str_buf</a>);
00113 
00114             <span class="keywordflow">if</span>(player_school.plaque_granted[<a class="code" href="Opschool_8h.html#a64a35">PLAQUE_BRONZE</a>]==1)
00115                 image_interface.put_back( tab1+400,vtab2,<span class="stringliteral">"PCOPPER"</span> );
00116             <span class="keywordflow">if</span>(player_school.plaque_granted[<a class="code" href="Opschool_8h.html#a64a34">PLAQUE_SILVER</a>]==1)
00117                 image_interface.put_back( tab1+200,vtab2,<span class="stringliteral">"PSILVER"</span> );
00118             <span class="keywordflow">if</span>(player_school.plaque_granted[<a class="code" href="Opschool_8h.html#a64a33">PLAQUE_GOLD</a>]==1)
00119                 image_interface.put_back( tab1,vtab2,<span class="stringliteral">"PGOLD"</span> );
00120 
00121         }
00122     }
00123     <span class="comment">//------- blt the back buffer to front buffer -------//</span>
00124     vga.blt_buf(<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>, <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>);
00125 }
00126 
00127 <span class="comment">//---------- End of function Development::eval_letter_report ------------//</span>
00128 
00130 
<a name="l00131"></a><a class="code" href="classFinalScoreReport.html#a5">00131</a> <span class="keywordtype">int</span> <a class="code" href="classFinalScoreReport.html#a5">FinalScoreReport::final_score_detect</a>() {
00132     <span class="keywordtype">int</span> tab1=<a class="code" href="Ofinscor_8cpp.html#a11a1">REPORT_X1</a>,tab2=<a class="code" href="Ofinscor_8cpp.html#a11a1">REPORT_X1</a>+100,
00133         tab3=<a class="code" href="Ofinscor_8cpp.html#a11a1">REPORT_X1</a>+200,tab4=<a class="code" href="Ofinscor_8cpp.html#a11a1">REPORT_X1</a>+600;
00134     <span class="keywordtype">int</span> vtab1=<a class="code" href="Ofinscor_8cpp.html#a11a2">REPORT_Y1</a>+15,vtab2=<a class="code" href="Ofinscor_8cpp.html#a11a2">REPORT_Y1</a>+70,
00135         vtab3=<a class="code" href="Ofinscor_8cpp.html#a11a2">REPORT_Y1</a>+100,vtab4=<a class="code" href="Ofinscor_8cpp.html#a11a2">REPORT_Y1</a>+350;
00136 
00137     <span class="keywordflow">if</span> (!final_score_report_init_flag)
00138         <span class="keywordflow">return</span> 0;
00139     <span class="keywordflow">if</span> (mouse.any_click(2) ) {
00140         <span class="keywordflow">if</span>(player_school.scen_quit_game_flag == 2) {
00141             player_school.scen_quit_game_flag = 0;
00142             <span class="keywordflow">return</span> 0;
00143         }
00144         <span class="keywordflow">else</span> {
00145             <span class="comment">// may call hall_of_fame screen</span>
00146             game_file_array.add_hall_of_fame(player_school.ultimate_game_score);
00147 
00148             sys.signal_exit_flag = 2;
00149             sys.menu_pull_down = 0;
00150             sys.set_staying_view_mode(0);
00151             sys.set_speed(<a class="code" href="Osys_8h.html#a43a7">DEFAULT_SPEED</a>);
00152         }
00153     }
00154     <span class="keywordflow">return</span> 0;
00155 }
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:37:39 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
