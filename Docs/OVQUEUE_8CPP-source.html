<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>OVQUEUE.CPP Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>OVQUEUE.CPP</h1><a href="OVQUEUE_8CPP.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">// Filename    : OVQUEUE.CPP</span>
00002 <span class="comment">// Description : variable length queue</span>
00003 
00004 <span class="preprocessor">#include &lt;<a class="code" href="OVQUEUE_8H.html">OVQUEUE.H</a>&gt;</span>
00005 <span class="preprocessor">#include &lt;<a class="code" href="ALL_8H.html">ALL.H</a>&gt;</span>
00006 <span class="preprocessor">#ifndef __WINDOWS_</span>
00007 <span class="preprocessor"></span><span class="preprocessor">#include &lt;WINDOWS.H&gt;</span>
00008 <span class="preprocessor">#endif</span>
00009 <span class="preprocessor"></span>
<a name="l00010"></a><a class="code" href="OVQUEUE_8CPP.html#a0">00010</a> <span class="preprocessor">#define QUEUE_SIZE_INC 0x1000</span>
00011 <span class="preprocessor"></span>
00012 <span class="comment">// -------- begin of function VLenQueue::VLenQueue ----------//</span>
<a name="l00013"></a><a class="code" href="classVLenQueue.html#a0">00013</a> <a class="code" href="classVLenQueue.html#a0">VLenQueue::VLenQueue</a>() : queue_buf(<a class="code" href="OHELP_8H.html#a0">NULL</a>), queue_buf_size(0), queued_size(0), queue_ptr(<a class="code" href="OHELP_8H.html#a0">NULL</a>) {
00014 }
00015 
<a name="l00016"></a><a class="code" href="classVLenQueue.html#a1">00016</a> <a class="code" href="classVLenQueue.html#a0">VLenQueue::VLenQueue</a>(<span class="keywordtype">int</span> s) : queue_buf(<a class="code" href="ALL_8H.html#a5">mem_add</a>(s)), queue_buf_size(s) {
00017     <a class="code" href="classVLenQueue.html#m2">queued_size</a> = 0;
00018     <a class="code" href="classVLenQueue.html#m3">queue_ptr</a> = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00019 }
00020 
<a name="l00021"></a><a class="code" href="classVLenQueue.html#a2">00021</a> <a class="code" href="classVLenQueue.html#a0">VLenQueue::VLenQueue</a>(<a class="code" href="classVLenQueue.html">VLenQueue</a> &amp;q) : queue_buf(<a class="code" href="ALL_8H.html#a5">mem_add</a>(q.queue_buf_size)),
00022                                      queue_buf_size(q.queue_buf_size) {
00023     memcpy( <a class="code" href="classVLenQueue.html#m0">queue_buf</a>, q.queue_buf, q.queued_size);
00024     <a class="code" href="classVLenQueue.html#m2">queued_size</a> = q.queued_size;
00025     <a class="code" href="classVLenQueue.html#m3">queue_ptr</a> = <a class="code" href="classVLenQueue.html#m0">queue_buf</a> + (q.queue_ptr - q.queue_buf);
00026 }
00027 
00028 <span class="comment">// -------- end of function VLenQueue::VLenQueue ----------//</span>
00029 
00030 <span class="comment">// -------- begin of function VLenQueue::~VLenQueue ----------//</span>
<a name="l00031"></a><a class="code" href="classVLenQueue.html#a3">00031</a> <a class="code" href="classVLenQueue.html#a3">VLenQueue::~VLenQueue</a>() {
00032     <span class="keywordflow">if</span>( queue_buf )
00033         <a class="code" href="ALL_8H.html#a8">mem_del</a>(<a class="code" href="classVLenQueue.html#m0">queue_buf</a>);
00034 }
00035 
00036 <span class="comment">// -------- end of function VLenQueue::~VLenQueue ----------//</span>
00037 
00038 <span class="comment">// -------- begin of function VLenQueue::operator= ----------//</span>
<a name="l00039"></a><a class="code" href="classVLenQueue.html#a4">00039</a> <a class="code" href="classVLenQueue.html">VLenQueue</a>&amp; <a class="code" href="classVLenQueue.html#a4">VLenQueue::operator= </a>(<a class="code" href="classVLenQueue.html">VLenQueue</a> &amp;q) {
00040     expand( q.<a class="code" href="classVLenQueue.html#m2">queued_size</a> );
00041     memcpy( <a class="code" href="classVLenQueue.html#m0">queue_buf</a>, q.<a class="code" href="classVLenQueue.html#m0">queue_buf</a>, <a class="code" href="classVLenQueue.html#m2">queued_size</a> = q.<a class="code" href="classVLenQueue.html#m2">queued_size</a>);
00042     <a class="code" href="classVLenQueue.html#m3">queue_ptr</a> = <a class="code" href="classVLenQueue.html#m0">queue_buf</a> + (q.<a class="code" href="classVLenQueue.html#m3">queue_ptr</a> - q.<a class="code" href="classVLenQueue.html#m0">queue_buf</a>);
00043     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00044 }
00045 
00046 <span class="comment">// -------- end of function VLenQueue::operator= ----------//</span>
00047 
00048 <span class="comment">// -------- begin of function VLenQueue::clear ----------//</span>
<a name="l00049"></a><a class="code" href="classVLenQueue.html#a5">00049</a> <span class="keywordtype">void</span> <a class="code" href="classVLenQueue.html#a5">VLenQueue::clear</a>() {
00050     <a class="code" href="classVLenQueue.html#m2">queued_size</a> = 0;
00051     <a class="code" href="classVLenQueue.html#m3">queue_ptr</a> = <a class="code" href="classVLenQueue.html#m0">queue_buf</a>;
00052 }
00053 
00054 <span class="comment">// -------- end of function VLenQueue::clear ----------//</span>
00055 
00056 <span class="comment">// -------- begin of function VLenQueue::reserve ----------//</span>
<a name="l00057"></a><a class="code" href="classVLenQueue.html#a6">00057</a> <span class="keywordtype">char</span>* <a class="code" href="classVLenQueue.html#a6">VLenQueue::reserve</a>( <span class="keywordtype">int</span> s ) {
00058     expand( <a class="code" href="classVLenQueue.html#m2">queued_size</a> + s);
00059     <span class="keywordtype">char</span> *ret= <a class="code" href="classVLenQueue.html#m0">queue_buf</a> + <a class="code" href="classVLenQueue.html#m2">queued_size</a>;
00060     <a class="code" href="classVLenQueue.html#m2">queued_size</a> += s;
00061     <span class="keywordflow">return</span> ret;
00062 }
00063 
00064 <span class="comment">// -------- end of function VLenQueue::reserve ----------//</span>
00065 
00066 <span class="comment">// -------- begin of function VLenQueue::append_queue ----------//</span>
<a name="l00067"></a><a class="code" href="classVLenQueue.html#a7">00067</a> <span class="keywordtype">void</span> <a class="code" href="classVLenQueue.html#a7">VLenQueue::append_queue</a>( <a class="code" href="classVLenQueue.html">VLenQueue</a> &amp;q ) {
00068     memcpy( <a class="code" href="classVLenQueue.html#a6">reserve</a>(q.<a class="code" href="classVLenQueue.html#m2">queued_size</a>), q.<a class="code" href="classVLenQueue.html#m0">queue_buf</a>, q.<a class="code" href="classVLenQueue.html#m2">queued_size</a>) ;
00069 }
00070 
00071 <span class="comment">// -------- end of function VLenQueue::append_queue ----------//</span>
00072 
00073 <span class="comment">// -------- begin of function VLenQueue::swap ----------//</span>
<a name="l00074"></a><a class="code" href="classVLenQueue.html#a8">00074</a> <span class="keywordtype">void</span> <a class="code" href="classVLenQueue.html#a8">VLenQueue::swap</a>( <a class="code" href="classVLenQueue.html">VLenQueue</a> &amp;q) {
00075     <span class="keywordtype">char</span> *tempPtr;
00076     <span class="keywordtype">int</span> tempInt;
00077 
00078     tempPtr = <a class="code" href="classVLenQueue.html#m0">queue_buf</a>;
00079     <a class="code" href="classVLenQueue.html#m0">queue_buf</a> = q.<a class="code" href="classVLenQueue.html#m0">queue_buf</a>;
00080     q.<a class="code" href="classVLenQueue.html#m0">queue_buf</a> = tempPtr;
00081 
00082     tempInt = <a class="code" href="classVLenQueue.html#m1">queue_buf_size</a>;
00083     <a class="code" href="classVLenQueue.html#m1">queue_buf_size</a> = q.<a class="code" href="classVLenQueue.html#m1">queue_buf_size</a>;
00084     q.<a class="code" href="classVLenQueue.html#m1">queue_buf_size</a> = tempInt;
00085 
00086     tempInt = <a class="code" href="classVLenQueue.html#m2">queued_size</a>;
00087     <a class="code" href="classVLenQueue.html#m2">queued_size</a> = q.<a class="code" href="classVLenQueue.html#m2">queued_size</a>;
00088     q.<a class="code" href="classVLenQueue.html#m2">queued_size</a> = tempInt;
00089 
00090     tempPtr = <a class="code" href="classVLenQueue.html#m3">queue_ptr</a>;
00091     <a class="code" href="classVLenQueue.html#m3">queue_ptr</a> = q.<a class="code" href="classVLenQueue.html#m3">queue_ptr</a>;
00092     q.<a class="code" href="classVLenQueue.html#m3">queue_ptr</a> = tempPtr;
00093 }
00094 
00095 <span class="comment">// -------- end of function VLenQueue::swap ----------//</span>
00096 
00097 <span class="comment">// -------- begin of function VLenQueue::length ----------//</span>
<a name="l00098"></a><a class="code" href="classVLenQueue.html#a9">00098</a> <span class="keywordtype">int</span> <a class="code" href="classVLenQueue.html#a9">VLenQueue::length</a>() {
00099     <span class="keywordflow">return</span> <a class="code" href="classVLenQueue.html#m2">queued_size</a>;
00100 }
00101 
00102 <span class="comment">// -------- end of function VLenQueue::length ----------//</span>
00103 
00104 <span class="comment">// -------- begin of function VLenQueue::expand ----------//</span>
00105 <span class="keywordtype">void</span> VLenQueue::expand( <span class="keywordtype">int</span> newSize) {
00106     <span class="keywordflow">if</span>( newSize &gt; <a class="code" href="classVLenQueue.html#m2">queued_size</a> ) {
00107         <span class="keywordtype">char</span> *oldBuf = <a class="code" href="classVLenQueue.html#m0">queue_buf</a>;
00108         <a class="code" href="classVLenQueue.html#m1">queue_buf_size</a> = newSize + (<a class="code" href="OVQUEUE_8CPP.html#a0">QUEUE_SIZE_INC</a> - newSize % <a class="code" href="OVQUEUE_8CPP.html#a0">QUEUE_SIZE_INC</a>);
00109         <a class="code" href="classVLenQueue.html#m0">queue_buf</a> = <a class="code" href="ALL_8H.html#a7">mem_resize</a>( <a class="code" href="classVLenQueue.html#m0">queue_buf</a>, <a class="code" href="classVLenQueue.html#m1">queue_buf_size</a>);
00110         <a class="code" href="classVLenQueue.html#m3">queue_ptr</a> = <a class="code" href="classVLenQueue.html#m0">queue_buf</a> + (<a class="code" href="classVLenQueue.html#m3">queue_ptr</a> - oldBuf);
00111     }
00112 }
00113 
00114 <span class="comment">// -------- end of function VLenQueue::expand ----------//</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:38:36 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
