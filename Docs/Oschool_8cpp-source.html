<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Oschool.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Oschool.cpp</h1><a href="Oschool_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : OSCHOOL.CPP</span>
00002 <span class="comment">//Description : School class - calc_distance() - also see spreadsheet "indices" of HEinitialization</span>
00003 <span class="comment">//Owner       : Fred</span>
00004 
00005 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00006 <span class="preprocessor">#include &lt;<a class="code" href="OGAMESET_8H.html">OGAMESET.H</a>&gt;</span>
00007 <span class="preprocessor">#include &lt;OPSCHOOL.H&gt;</span>
00008 <span class="preprocessor">#include &lt;<a class="code" href="OSCHLRES_8H.html">OSCHLRES.H</a>&gt;</span>
00009 <span class="preprocessor">#include &lt;<a class="code" href="OSCHOOL_8H.html">OSCHOOL.H</a>&gt;</span>
00010 <span class="preprocessor">#include &lt;OATHLETI.H&gt;</span>
00011 
<a name="l00012"></a><a class="code" href="Oschool_8cpp.html#a0">00012</a> <span class="preprocessor">#define PRESTIGE_IMP    7</span>
<a name="l00013"></a><a class="code" href="Oschool_8cpp.html#a1">00013</a> <span class="preprocessor"></span><span class="preprocessor">#define ATHLETIC_PROGRAM_INTENSITY_IMP    9</span>
<a name="l00014"></a><a class="code" href="Oschool_8cpp.html#a2">00014</a> <span class="preprocessor"></span><span class="preprocessor">#define FULLTIME_UG_IN_HOUSING_PERCENT_IMP  6</span>
<a name="l00015"></a><a class="code" href="Oschool_8cpp.html#a3">00015</a> <span class="preprocessor"></span><span class="preprocessor">#define UG_GET_DEGREE_IN_5YEAR_PERCENT_IMP  0</span>
<a name="l00016"></a><a class="code" href="Oschool_8cpp.html#a4">00016</a> <span class="preprocessor"></span><span class="preprocessor">#define PERCENT_STUDENT_IN_STATE_IMP      3</span>
<a name="l00017"></a><a class="code" href="Oschool_8cpp.html#a5">00017</a> <span class="preprocessor"></span><span class="preprocessor">#define STUDENT_COUNT_IMP             4</span>
<a name="l00018"></a><a class="code" href="Oschool_8cpp.html#a6">00018</a> <span class="preprocessor"></span><span class="preprocessor">#define GRADUATE_STUDENT_PERCENT_IMP      6</span>
<a name="l00019"></a><a class="code" href="Oschool_8cpp.html#a7">00019</a> <span class="preprocessor"></span><span class="preprocessor">#define PARTTIME_UNDERGRAD_PERCENT_IMP    2</span>
<a name="l00020"></a><a class="code" href="Oschool_8cpp.html#a8">00020</a> <span class="preprocessor"></span><span class="preprocessor">#define NONDEGREE_STUDENT_PERCENT_IMP     2</span>
<a name="l00021"></a><a class="code" href="Oschool_8cpp.html#a9">00021</a> <span class="preprocessor"></span><span class="preprocessor">#define DOCTORAL_PROGRAM_INTENSITY_IMP    7</span>
<a name="l00022"></a><a class="code" href="Oschool_8cpp.html#a10">00022</a> <span class="preprocessor"></span><span class="preprocessor">#define RELATIVE_WEALTH_IMP           3</span>
00023 <span class="preprocessor"></span>
00024 <span class="comment">//------ defining static temp varialbes for calculation of distance_value -------//</span>
00025 <span class="comment">// for L5</span>
00026 <span class="keyword">static</span> <span class="keywordtype">float</span> T_range,U_range,Y_range,Z_range;
00027 <span class="keyword">static</span> <span class="keywordtype">int</span>   N_range,O_range,P_range,V_range;
00028 
00029 <span class="comment">// for M5 &amp; J5</span>
00030 <span class="keyword">static</span> <span class="keywordtype">float</span> I_range, M_range;
00031 <span class="keyword">static</span> <span class="keywordtype">int</span>   W_range, AJ_range, AC_range, AE_range,AF_range,AG_range,AH_range,AK_range;
00032 
00033 <span class="comment">// for I5, Z5, K5 respectively</span>
00034 <span class="keyword">static</span> <span class="keywordtype">float</span> K_min,K_max,AA_min,AA_max,L_range;
00035 
00036 <span class="comment">//----------- Define macro functions ---------//</span>
00037 
<a name="l00038"></a><a class="code" href="Oschool_8cpp.html#a11">00038</a> <span class="preprocessor">#define IFZ(x,v)    (!(x)?(v):(x))</span>
<a name="l00039"></a><a class="code" href="Oschool_8cpp.html#a12">00039</a> <span class="preprocessor"></span><span class="preprocessor">#define EXPO2(x)  ((x)*(x))</span>
00040 <span class="preprocessor"></span>
00041 <span class="comment">//-------- Begin of marco function FIND_AVG ------//</span>
00042 
<a name="l00043"></a><a class="code" href="Oschool_8cpp.html#a13">00043</a> <span class="preprocessor">#define FIND_AVG(f,num) \</span>
00044 <span class="preprocessor">{ \</span>
00045 <span class="preprocessor">      sum=0;\</span>
00046 <span class="preprocessor">                for (i=sCount-1; i&gt;=sCount-8; i--) \</span>
00047 <span class="preprocessor">                                                       sum+=(sArray+i)-&gt;f; \</span>
00048 <span class="preprocessor">                                                                               sum /= num; \</span>
00049 <span class="preprocessor">                                                                                               }</span>
00050 <span class="preprocessor"></span>
00051 <span class="comment">//-------- End of marco function FIND_AVG --------//</span>
00052 
00053 <span class="comment">//------------ Begin of marco function FIND_MIN_MAX ----------//</span>
00054 
<a name="l00055"></a><a class="code" href="Oschool_8cpp.html#a14">00055</a> <span class="preprocessor">#define FIND_MIN_MAX(min,max,field,Type) \</span>
00056 <span class="preprocessor">{ \</span>
00057 <span class="preprocessor">      Type      tmp; \</span>
00058 <span class="preprocessor">                         min = max = sArray-&gt;field; \</span>
00059 <span class="preprocessor">                                                        for (i=0; i&lt;sCount; i++) \</span>
00060 <span class="preprocessor">                                                            { \</span>
00061 <span class="preprocessor">                                                                  sPtr = sArray + i; \</span>
00062 <span class="preprocessor">                                                                                         tmp = sPtr-&gt;field; \</span>
00063 <span class="preprocessor">                                                                                                                if ( tmp &lt; min ) \</span>
00064 <span class="preprocessor">                                                                                                                                     min = tmp; \</span>
00065 <span class="preprocessor">                                                                                                                                                    else if ( tmp &gt; max ) \</span>
00066 <span class="preprocessor">                                                                                                                                                                              max = tmp; \</span>
00067 <span class="preprocessor">                                                                                                                                                                                             } \</span>
00068 <span class="preprocessor">                                                                                                                                                                                                   }</span>
00069 <span class="preprocessor"></span>
00070 <span class="comment">//------------ End of marco function FIND_MIN_MAX ----------//</span>
00071 
00072 <span class="comment">//------------ Begin of marco function FIND_RANGE ----------//</span>
00073 
<a name="l00074"></a><a class="code" href="Oschool_8cpp.html#a15">00074</a> <span class="preprocessor">#define FIND_RANGE(field,range,Type) \</span>
00075 <span class="preprocessor">{ \</span>
00076 <span class="preprocessor">      Type  min, max; \</span>
00077 <span class="preprocessor">                          FIND_MIN_MAX(min,max,field,Type); \</span>
00078 <span class="preprocessor">                                                                range = max - min; \</span>
00079 <span class="preprocessor">                                                                                       }</span>
00080 <span class="preprocessor"></span>
00081 <span class="comment">//------------ End of marco function FIND_RANGE ----------//</span>
00082 
00083 <span class="comment">//---------- Begin of function School::calc_distance -----------//</span>
00085 <span class="comment">void School::calc_distance_NOPZ5() {</span>
00086     <span class="keywordtype">float</span> AA5 = doctoral_degrees_per_reg_faculty;
00087 
00088     <span class="keywordtype">short</span> Q5 = usn_wr_ranking;                      <span class="comment">// raw_usn_wr_ranking;</span>
00089     <span class="keywordtype">short</span> R5 = ave_midpt_sat_act;                   <span class="comment">// raw_ave_midpt_sat_act;</span>
00090     <span class="keywordtype">int</span> S5 = freshmen_top_10_class;                 <span class="comment">// raw_freshmen_top_10_percent_of_class/100;        //BUG? /100</span>
00091 
00092     N5 = <a class="code" href="Oschool_8cpp.html#a11">IFZ</a>(Q5,300);
00093     O5 = <a class="code" href="Oschool_8cpp.html#a11">IFZ</a>(R5,800);
00094     P5 = <a class="code" href="Oschool_8cpp.html#a11">IFZ</a>(S5,5);
00095     Z5 = 9*(AA5-AA_min)/(AA_max-AA_min)+1;          <span class="comment">// Doctoral degrees per faculty rating</span>
00096 }
00097 
00098 <span class="comment">//---------- Begin of function School::calc_distance 1 -----------//</span>
00100 <span class="comment">void School::calc_distance_L5() {</span>
00101     <span class="comment">// calc vars for L5</span>
00102     <span class="comment">//</span>
00103     <span class="keywordtype">float</span> T5 = applications_ratio;
00104     <span class="keywordtype">float</span> U5 = float(yield_rate/100.0);
00105     <span class="keywordtype">int</span> V5 = athletics_rating;
00106     <span class="keywordtype">float</span> Y5 = sponsored_research_per_reg_faculty;
00107 
00108   <span class="comment">// calc L5 (Raw prestige index)</span>
00109   <span class="comment">//</span>
00110     L5 = (float)(
00111         (300-N5)*0.1/N_range
00112         +O5*0.1/O_range
00113         +P5*0.1/P_range
00114         +T5*0.15/T_range
00115         +U5*0.15/U_range
00116         +(V5+1)*0.00/V_range                          <span class="comment">//BUG?    player_school!F630.00</span>
00117         +Z5*0.15/Z_range);
00118 
00119 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00120 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00121 <span class="preprocessor"></span>    L5 += Y5*0.25/Y_range;
00122 <span class="preprocessor">#endif</span>
00123 <span class="preprocessor"></span>
00124 }
00125 
00126 <span class="comment">//------------ End of function School::calc_distance 1 -----------//</span>
00127 
00128 <span class="comment">//---------- Begin of function School::calc_distance 2 -----------//</span>
00130 <span class="comment">void School::calc_distance_K5() {</span>
00131     <span class="comment">// calc K5 (Prestige index/SD) for I5</span>
00132     <span class="comment">//</span>
00133     K5 = L5/L_range;
00134 }
00135 
00136 <span class="comment">//------------ End of function School::calc_distance 2 -----------//</span>
00137 
00138 <span class="comment">//---------- Begin of function School::calc_distance 3 -----------//</span>
00140 <span class="comment">void School::calc_distance_prestige() {</span>
00141     <span class="comment">// calc I5 (Prestige) for M5</span>
00142     <span class="comment">//</span>
00143     prestige = 9*(K5-K_min)/(K_max-K_min)+1;
00144 }
00145 
00146 <span class="comment">//------------ End of function School::calc_distance 3 -----------//</span>
00147 
00148 <span class="comment">//---------- Begin of function School::calc_distance 4 -----------//</span>
00149 <span class="keywordtype">void</span> School::calc_distance_ACAH5(<span class="keywordtype">short</span>  sCount, <a class="code" href="classSchool.html">School</a>* sArray) {
00150     <span class="keywordtype">int</span> i, sum;
00151 
00152     <span class="comment">// find AC5</span>
00153     <span class="comment">//</span>
00154     <span class="keywordtype">char</span>  AD5 = freshmen_from_within_the_state_percent;
00155 
00156     <span class="comment">// if (this/me &gt;=10)  AC5 = IFZ(AD5, ave_of_the_last_8_ACs) else AC5 = AD5; //BUG special case!!!</span>
00157     <span class="keywordflow">if</span> ( sCount &gt;= 10 ) {
00158         <span class="keywordflow">if</span> ( AD5 )
00159             AC5 = AD5;
00160         <span class="keywordflow">else</span> {
00161             <a class="code" href="Oschool_8cpp.html#a13">FIND_AVG</a>(AC5,8);
00162             AC5 = sum;
00163         }
00164     }
00165     <span class="keywordflow">else</span>
00166         AC5 = AD5;
00167 
00168     <span class="comment">//</span>
00169     <span class="comment">//</span>
00170     <span class="keywordtype">char</span>  AI5 = non_degree_seeking_percent;         <span class="comment">// excel column name = non_matric</span>
00171     <span class="comment">// if (this/me &gt;=10)  AH5 = IFZ(AI5, ave_of_the_last_8_AHs) else AH5 = AI5          //BUG special case!!!</span>
00172     <span class="keywordflow">if</span> ( sCount &gt;= 10 ) {
00173         <span class="keywordflow">if</span> ( AD5 )
00174             AH5 = AI5;
00175         <span class="keywordflow">else</span> {
00176             <a class="code" href="Oschool_8cpp.html#a13">FIND_AVG</a>(AH5,8);
00177             AH5 = sum;
00178         }
00179     }
00180     <span class="keywordflow">else</span>
00181         AH5 = AI5;
00182 }
00183 
00184 <span class="comment">//------------ End of function School::calc_distance 4 -----------//</span>
00185 
00186 <span class="comment">//---------- Begin of function School::calc_distance 5 -----------//</span>
00188 <span class="comment">void School::calc_distance_M5() {</span>
00189     <span class="comment">// calc M5 (Raw target inst'l distance) for J5</span>
00190     <span class="comment">//</span>
00191     <span class="keywordtype">float</span> I5    = prestige;                         <span class="comment">// see calc_distance_prestige</span>
00192     <span class="keywordtype">short</span> V5    = athletics_rating;
00193     <span class="keywordtype">char</span>  AJ5 = ug_in_housing_percent;
00194     <span class="keywordtype">char</span>  W5    = student_get_bacc_in_5_year_percent;
00195     <span class="keywordtype">int</span> AE5 = enrollment_fte;                       <span class="comment">//total_student (headcount)</span>
00196     <span class="keywordtype">int</span> AF5 = ug_percent;
00197     <span class="keywordtype">int</span> AG5 = part_time_ug_percent;
00198     <span class="keywordtype">int</span> AK5 = financial_condition;
00199     <span class="comment">// Z5: see above calc_distance_NOPZ5()</span>
00200 
00201     <span class="keywordtype">float</span> tmp[11];
00202 
00203     memset( tmp, 0, <span class="keyword">sizeof</span>(tmp) );
00204 
00205     <span class="comment">/* //## chea 180999 org.idea</span>
00206 <span class="comment">       tmp[0] = PRESTIGE_IMP *EXPO2((I5-player_school.prestige)/I_range);</span>
00207 <span class="comment">       tmp[1] = ATHLETIC_PROGRAM_INTENSITY_IMP *EXPO2(float(V5-athletics_office.ncaa_level_value)/V_range);</span>
00208 <span class="comment">       tmp[2] = FULLTIME_UG_IN_HOUSING_PERCENT_IMP *EXPO2(float(AJ5-player_school.fulltime_ug_in_housing_percent)/AJ_range);</span>
00209 <span class="comment">       tmp[3] = UG_GET_DEGREE_IN_5YEAR_PERCENT_IMP *EXPO2(float(W5-player_school.ug_get_degree_in_5year_percent)/W_range);</span>
00210 <span class="comment">       tmp[4] = PERCENT_STUDENT_IN_STATE_IMP *EXPO2(float(AC5-player_school.percent_student_in_state)/AC_range);</span>
00211 <span class="comment">       tmp[5] = STUDENT_COUNT_IMP *EXPO2(float(AE5-player_school.get_player_expected_student_count())/AE_range);</span>
00212 <span class="comment"></span>
00213 <span class="comment">       tmp[6] = GRADUATE_STUDENT_PERCENT_IMP *EXPO2(float(100-AF5-player_school.graduate_student_percent)/AF_range);</span>
00214 <span class="comment">       tmp[7] = PARTTIME_UNDERGRAD_PERCENT_IMP *EXPO2(float(AG5-player_school.parttime_undergrad_percent)/AG_range);</span>
00215 <span class="comment">       tmp[8] = NONDEGREE_STUDENT_PERCENT_IMP *EXPO2(float(AH5-player_school.nondegree_student_percent)/AH_range);</span>
00216 <span class="comment">       tmp[9] = DOCTORAL_PROGRAM_INTENSITY_IMP *EXPO2(float(Z5-player_school.doctoral_program_intensity)/Z_range);</span>
00217 <span class="comment">       tmp[10] = RELATIVE_WEALTH_IMP *EXPO2(float(AK5-player_school.relative_wealth_value)/AK_range);</span>
00218 <span class="comment">    */</span>
00219 
00220     <span class="comment">//## chea 180999 suggest by Bill Massy</span>
00221     tmp[0] = (<a class="code" href="Oschool_8cpp.html#a0">PRESTIGE_IMP</a> *<a class="code" href="Oschlres_8cpp.html#a0">EXPO2</a>((I5-player_school.prestige)/I_range)*10);
00222     <span class="keywordflow">if</span>(player_school.prestige == 1 || player_school.prestige == 10)
00223         tmp[0] = (<a class="code" href="Oschool_8cpp.html#a0">PRESTIGE_IMP</a> *<a class="code" href="Oschlres_8cpp.html#a0">EXPO2</a>((I5-player_school.prestige)/I_range)*10);
00224 
00225     tmp[1] = <a class="code" href="Oschool_8cpp.html#a1">ATHLETIC_PROGRAM_INTENSITY_IMP</a> *<a class="code" href="Oschlres_8cpp.html#a0">EXPO2</a>(<span class="keywordtype">float</span>(V5-athletics_office.ncaa_level_value)/V_range);
00226     <span class="keywordflow">if</span>(athletics_office.ncaa_level_value == 1.5 || athletics_office.ncaa_level_value == 4.5)
00227         tmp[1] = <a class="code" href="Oschool_8cpp.html#a1">ATHLETIC_PROGRAM_INTENSITY_IMP</a> *<a class="code" href="Oschlres_8cpp.html#a0">EXPO2</a>(<span class="keywordtype">float</span>(V5-athletics_office.ncaa_level_value)/V_range)*10;
00228 
00229     tmp[2] = <a class="code" href="Oschool_8cpp.html#a2">FULLTIME_UG_IN_HOUSING_PERCENT_IMP</a> *<a class="code" href="Oschlres_8cpp.html#a0">EXPO2</a>(<span class="keywordtype">float</span>(AJ5-player_school.fulltime_ug_in_housing_percent)/AJ_range);
00230     <span class="keywordflow">if</span>(player_school.fulltime_ug_in_housing_percent == 0 || player_school.fulltime_ug_in_housing_percent == 50)
00231         tmp[2] = (<a class="code" href="Oschool_8cpp.html#a2">FULLTIME_UG_IN_HOUSING_PERCENT_IMP</a> *<a class="code" href="Oschlres_8cpp.html#a0">EXPO2</a>(<span class="keywordtype">float</span>(AJ5-player_school.fulltime_ug_in_housing_percent)/AJ_range))*10;
00232 
00233     tmp[3] = <a class="code" href="Oschool_8cpp.html#a3">UG_GET_DEGREE_IN_5YEAR_PERCENT_IMP</a> *<a class="code" href="Oschlres_8cpp.html#a0">EXPO2</a>(<span class="keywordtype">float</span>(W5-player_school.ug_get_degree_in_5year_percent)/W_range);
00234     <span class="keywordflow">if</span>(player_school.ug_get_degree_in_5year_percent == 50 || player_school.ug_get_degree_in_5year_percent == 100)
00235         tmp[3] = (<a class="code" href="Oschool_8cpp.html#a3">UG_GET_DEGREE_IN_5YEAR_PERCENT_IMP</a> *<a class="code" href="Oschlres_8cpp.html#a0">EXPO2</a>(<span class="keywordtype">float</span>(W5-player_school.ug_get_degree_in_5year_percent)/W_range))*10;
00236 
00237     tmp[4] = <a class="code" href="Oschool_8cpp.html#a4">PERCENT_STUDENT_IN_STATE_IMP</a> *<a class="code" href="Oschlres_8cpp.html#a0">EXPO2</a>(<span class="keywordtype">float</span>(AC5-player_school.percent_student_in_state)/AC_range);
00238     <span class="keywordflow">if</span>(player_school.percent_student_in_state == 30 || player_school.percent_student_in_state == 70)
00239         tmp[4] = <a class="code" href="Oschool_8cpp.html#a4">PERCENT_STUDENT_IN_STATE_IMP</a> *<a class="code" href="Oschlres_8cpp.html#a0">EXPO2</a>(<span class="keywordtype">float</span>(AC5-player_school.percent_student_in_state)/AC_range)*10;
00240 
00241 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00242 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00243 <span class="preprocessor"></span>    <span class="comment">// don't know how to change</span>
00244     tmp[5] = <a class="code" href="Oschool_8cpp.html#a5">STUDENT_COUNT_IMP</a> *<a class="code" href="Oschlres_8cpp.html#a0">EXPO2</a>(<span class="keywordtype">float</span>(AE5-player_school.get_player_expected_student_count())/AE_range);
00245 <span class="preprocessor">#endif</span>
00246 <span class="preprocessor"></span>
00247     tmp[6] = <a class="code" href="Oschool_8cpp.html#a6">GRADUATE_STUDENT_PERCENT_IMP</a> *<a class="code" href="Oschlres_8cpp.html#a0">EXPO2</a>(<span class="keywordtype">float</span>(100-AF5-player_school.graduate_student_percent)/AF_range);
00248     <span class="keywordflow">if</span>(player_school.graduate_student_percent == 5 || player_school.graduate_student_percent == 35)
00249         tmp[6] = <a class="code" href="Oschool_8cpp.html#a6">GRADUATE_STUDENT_PERCENT_IMP</a> *<a class="code" href="Oschlres_8cpp.html#a0">EXPO2</a>(<span class="keywordtype">float</span>(100-AF5-player_school.graduate_student_percent)/AF_range)*10;
00250 
00251     tmp[7] = <a class="code" href="Oschool_8cpp.html#a7">PARTTIME_UNDERGRAD_PERCENT_IMP</a> *<a class="code" href="Oschlres_8cpp.html#a0">EXPO2</a>(<span class="keywordtype">float</span>(AG5-player_school.parttime_undergrad_percent)/AG_range);
00252     <span class="keywordflow">if</span>(player_school.parttime_undergrad_percent == 0 || player_school.parttime_undergrad_percent == 50)
00253         tmp[7] = <a class="code" href="Oschool_8cpp.html#a7">PARTTIME_UNDERGRAD_PERCENT_IMP</a> *<a class="code" href="Oschlres_8cpp.html#a0">EXPO2</a>(<span class="keywordtype">float</span>(AG5-player_school.parttime_undergrad_percent)/AG_range)*10;
00254 
00255     <span class="comment">// not from setting</span>
00256     <span class="keywordflow">if</span>(player_school.nondegree_student_percent == 0 || player_school.nondegree_student_percent == 50)
00257 
00258         tmp[9] = <a class="code" href="Oschool_8cpp.html#a9">DOCTORAL_PROGRAM_INTENSITY_IMP</a> *<a class="code" href="Oschlres_8cpp.html#a0">EXPO2</a>(<span class="keywordtype">float</span>(Z5-player_school.doctoral_program_intensity)/Z_range);
00259     <span class="keywordflow">if</span>(player_school.doctoral_program_intensity == 0 || player_school.doctoral_program_intensity == 10)
00260         tmp[9] = <a class="code" href="Oschool_8cpp.html#a9">DOCTORAL_PROGRAM_INTENSITY_IMP</a> *<a class="code" href="Oschlres_8cpp.html#a0">EXPO2</a>(<span class="keywordtype">float</span>(Z5-player_school.doctoral_program_intensity)/Z_range)*10;
00261 
00262     <span class="comment">//  player_school.relative_wealth=2;   //## chea 081099 testing</span>
00263     <span class="comment">//  player_school.relative_wealth_value=2;   //## chea 081099 testing</span>
00264 
00265     <span class="comment">/*#if(GAME_VERSION&gt;=200)</span>
00266 <span class="comment"></span>
00267 <span class="comment">      float rich = 5000;</span>
00268 <span class="comment">      float middle = 2400;</span>
00269 <span class="comment">      float struggle = 1000;</span>
00270 <span class="comment"></span>
00271 <span class="comment">      float wealth[3] = {5000,2400,1000};</span>
00272 <span class="comment"></span>
00273 <span class="comment">      tmp[10] = abs((year_end_capital_reserve - wealth[player_school.relative_wealth])/wealth[player_school.relative_wealth]);</span>
00274 <span class="comment"></span>
00275 <span class="comment">      #else */</span>
00276 
00277     <span class="keywordflow">if</span>(player_school.relative_wealth_value == 1)
00278         tmp[10] = (<a class="code" href="Oschool_8cpp.html#a10">RELATIVE_WEALTH_IMP</a> *<a class="code" href="Oschlres_8cpp.html#a0">EXPO2</a>(<span class="keywordtype">float</span>(AK5-player_school.relative_wealth_value)/AK_range));
00279     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(player_school.relative_wealth_value == 2)
00280         tmp[10] = (<a class="code" href="Oschool_8cpp.html#a10">RELATIVE_WEALTH_IMP</a> *<a class="code" href="Oschlres_8cpp.html#a0">EXPO2</a>(<span class="keywordtype">float</span>(AK5-player_school.relative_wealth_value)/AK_range)) * 4;
00281     <span class="keywordflow">else</span>
00282         tmp[10] = (<a class="code" href="Oschool_8cpp.html#a10">RELATIVE_WEALTH_IMP</a> *<a class="code" href="Oschlres_8cpp.html#a0">EXPO2</a>(<span class="keywordtype">float</span>(AK5-player_school.relative_wealth_value)/AK_range)) * 10;
00283     <span class="comment">//#endif</span>
00284 
00285     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;11; i++)
00286         M5 += tmp[i];
00287 }
00288 
00289 <span class="comment">//------------ End of function School::calc_distance 5 -----------//</span>
00290 
00291 <span class="comment">//---------- Begin of function School::calc_distance final -----------//</span>
00293 <span class="comment">void School::calc_distance_value() {</span>
00294     <span class="comment">// calc J5 (distance)</span>
00295     <span class="comment">//</span>
00296     distance_value = M5/(M_range);
00297 
00298     <span class="comment">//temp for debug</span>
00299     <span class="comment">//  if ( distance_value &lt;= 0.01 )</span>
00300     <span class="keywordflow">if</span> ( distance_value &lt; 0 ) {
00301         distance_value = 10.0;
00302         <a class="code" href="ALL_8H.html#a1">err_here</a>();
00303     }
00304 }
00305 
00306 <span class="comment">//------------ End of function School::calc_distance final -----------//</span>
00307 
00308 <span class="comment">//---------- Begin of static function School::calc_distance_all_school -----------//</span>
<a name="l00309"></a><a class="code" href="classSchool.html#d0">00309</a> <span class="keywordtype">void</span> <a class="code" href="classSchool.html#d0">School::calc_distance_all_school</a>() {
00310 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00311 <span class="preprocessor"></span>    <span class="keywordtype">short</span>     sCount = school_res.desired_school_count;
00312     <a class="code" href="classSchool.html">School</a>*   sArray = school_res.desired_school_array;
00313 <span class="preprocessor">#else</span>
00314 <span class="preprocessor"></span>    <span class="keywordtype">short</span>       sCount = school_res.db_school_count;<span class="comment">//202;      //TEMP for debug</span>
00315     <a class="code" href="classSchool.html">School</a>*     sArray = school_res.db_school_array;<span class="comment">// an array of schools read from the database</span>
00316 <span class="preprocessor">#endif</span>
00317 <span class="preprocessor"></span>
00318     <a class="code" href="ALL_8H.html#a0">err_when</a>(sCount &lt; 10 || !sArray);
00319     <span class="comment">// update class/global temp vars for Z5</span>
00320     AA_min = AA_max = sArray-&gt;<a class="code" href="classSchool.html#m106">doctoral_degrees_per_reg_faculty</a>;
00321 
00322     <a class="code" href="classSchool.html">School</a>      *sPtr;
00323     <span class="keywordtype">short</span>     i;
00324     <span class="keywordtype">float</span>     tmp;
00325 
00326     <span class="keywordflow">for</span> (i=0; i&lt;sCount; i++) {
00327         sPtr = sArray + i;
00328         tmp = sPtr-&gt;<a class="code" href="classSchool.html#m106">doctoral_degrees_per_reg_faculty</a>;
00329         <span class="keywordflow">if</span> ( tmp &lt; AA_min)
00330             AA_min = tmp ;
00331         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( tmp &gt; AA_max)
00332             AA_max = tmp;
00333     }
00334 
00335     <span class="comment">// update object temp vars for L5</span>
00336     <span class="keywordflow">for</span> (i=0; i&lt;sCount; i++) {
00337         sPtr = sArray + i;
00338         sPtr-&gt;<a class="code" href="classSchool.html#c0">calc_distance_NOPZ5</a>();
00339     }
00340 
00341     <span class="comment">// update class/global temp vars for L5</span>
00342     <a class="code" href="Oschool_8cpp.html#a15">FIND_RANGE</a>(<a class="code" href="classSchool.html#m132">N5</a>,N_range,<span class="keywordtype">int</span>);
00343     <a class="code" href="Oschool_8cpp.html#a15">FIND_RANGE</a>(<a class="code" href="classSchool.html#m133">O5</a>,O_range,<span class="keywordtype">int</span>);
00344     <a class="code" href="Oschool_8cpp.html#a15">FIND_RANGE</a>(<a class="code" href="classSchool.html#m134">P5</a>,P_range,<span class="keywordtype">int</span>);
00345     <a class="code" href="Oschool_8cpp.html#a15">FIND_RANGE</a>(<a class="code" href="classSchool.html#m135">Z5</a>,Z_range,<span class="keywordtype">float</span>);
00346 
00347     <a class="code" href="Oschool_8cpp.html#a15">FIND_RANGE</a>(<a class="code" href="classSchool.html#m99">applications_ratio</a>,T_range,<span class="keywordtype">float</span>);
00348     <a class="code" href="Oschool_8cpp.html#a15">FIND_RANGE</a>(<a class="code" href="classSchool.html#m100">yield_rate</a>,U_range,<span class="keywordtype">float</span>);
00349     U_range /= 100;                                 <span class="comment">// floating point percent</span>
00350     <a class="code" href="Oschool_8cpp.html#a15">FIND_RANGE</a>(<a class="code" href="classSchool.html#m101">athletics_rating</a>,V_range,<span class="keywordtype">int</span>);
00351     <span class="comment">// BUG in data:</span>
00352     <a class="code" href="Oschool_8cpp.html#a15">FIND_RANGE</a>(<a class="code" href="classSchool.html#m105">sponsored_research_per_reg_faculty</a>,Y_range,<span class="keywordtype">float</span>);
00353     <span class="comment">//TEMP set to value in column Y in "Indices"</span>
00354     <span class="comment">//Y_range = float(476.52);</span>
00355 
00356     <span class="comment">// update object temp vars for K5</span>
00357     <span class="keywordflow">for</span> (i=0; i&lt;sCount; i++) {
00358         sPtr = sArray + i;
00359         sPtr-&gt;<a class="code" href="classSchool.html#c1">calc_distance_L5</a>();
00360     }
00361 
00362     <span class="comment">// update class/global temp vars for K5</span>
00363     <a class="code" href="Oschool_8cpp.html#a15">FIND_RANGE</a>(<a class="code" href="classSchool.html#m136">L5</a>,L_range,<span class="keywordtype">float</span>);
00364 
00365     <span class="comment">// update object temp vars for I5 (prestige)</span>
00366     <span class="keywordflow">for</span> (i=0; i&lt;sCount; i++) {
00367         sPtr = sArray + i;
00368         sPtr-&gt;<a class="code" href="classSchool.html#c2">calc_distance_K5</a>();
00369     }
00370 
00371     <span class="comment">// update class/global temp vars for I5 (prestige)</span>
00372     <a class="code" href="Oschool_8cpp.html#a14">FIND_MIN_MAX</a>(K_min, K_max, <a class="code" href="classSchool.html#m137">K5</a>, <span class="keywordtype">float</span>);
00373 
00374     <span class="comment">// update object vars for M5</span>
00375     <span class="keywordflow">for</span> (i=0; i&lt;sCount; i++) {
00376         sPtr = sArray + i;
00377         sPtr-&gt;<a class="code" href="classSchool.html#c4">calc_distance_prestige</a>();
00378         sPtr-&gt;<a class="code" href="classSchool.html#c3">calc_distance_ACAH5</a>(i, sArray);
00379     }
00380 
00381     <span class="comment">// update class/global temp vars for M5</span>
00382     <a class="code" href="Oschool_8cpp.html#a15">FIND_RANGE</a>(<a class="code" href="classSchool.html#m130">prestige</a>, I_range, <span class="keywordtype">float</span>);
00383     <span class="comment">//OR char</span>
00384     <a class="code" href="Oschool_8cpp.html#a15">FIND_RANGE</a>(<a class="code" href="classSchool.html#m18">ug_in_housing_percent</a>, AJ_range, <span class="keywordtype">int</span>);
00385     <a class="code" href="Oschool_8cpp.html#a15">FIND_RANGE</a>(<a class="code" href="classSchool.html#m24">student_get_bacc_in_5_year_percent</a>, W_range, <span class="keywordtype">int</span>);
00386     <a class="code" href="Oschool_8cpp.html#a15">FIND_RANGE</a>(<a class="code" href="classSchool.html#m139">AC5</a>,AC_range,<span class="keywordtype">int</span>);
00387     <a class="code" href="Oschool_8cpp.html#a15">FIND_RANGE</a>(<a class="code" href="classSchool.html#m95">enrollment_fte</a>,AE_range,<span class="keywordtype">int</span>);
00388     <a class="code" href="Oschool_8cpp.html#a15">FIND_RANGE</a>(<a class="code" href="classSchool.html#m96">ug_percent</a>,AF_range,<span class="keywordtype">int</span>);
00389     <a class="code" href="Oschool_8cpp.html#a15">FIND_RANGE</a>(<a class="code" href="classSchool.html#m97">part_time_ug_percent</a>,AG_range,<span class="keywordtype">int</span>);
00390     <a class="code" href="Oschool_8cpp.html#a15">FIND_RANGE</a>(<a class="code" href="classSchool.html#m140">AH5</a>,AH_range,<span class="keywordtype">int</span>);
00391     <a class="code" href="Oschool_8cpp.html#a15">FIND_RANGE</a>(<a class="code" href="classSchool.html#m118">financial_condition</a>,AK_range, <span class="keywordtype">int</span>);
00392 
00393     <span class="comment">// update object vars M5 for distance_value</span>
00394     <span class="keywordflow">for</span> (i=0; i&lt;sCount; i++) {
00395         sPtr = sArray + i;
00396         sPtr-&gt;<a class="code" href="classSchool.html#c5">calc_distance_M5</a>();
00397     }
00398 
00399     <span class="comment">// update class/global temp vars for distance_value</span>
00400     <a class="code" href="Oschool_8cpp.html#a15">FIND_RANGE</a>(<a class="code" href="classSchool.html#m138">M5</a>,M_range,<span class="keywordtype">float</span>);
00401 
00402     <span class="comment">// update object vars: distance_value</span>
00403     <span class="keywordflow">for</span> (i=0; i&lt;sCount; i++) {
00404         sPtr = sArray + i;
00405         sPtr-&gt;<a class="code" href="classSchool.html#c6">calc_distance_value</a>();
00406     }
00407 }
00408 
00409 <span class="comment">//------------ End of function School::calc_distance MAIN -----------//</span>
00410 
00411 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00412 <span class="preprocessor"></span>
00413 <span class="comment">// --- Begin of function School::calc_distance_first --- //</span>
00414 <span class="comment">//</span>
00415 <span class="keywordtype">void</span> School::calc_distance_first() {
00416     <span class="keywordtype">int</span> AE5 = <a class="code" href="classSchool.html#m95">enrollment_fte</a>;                       <span class="comment">//total_student (headcount)</span>
00417     <a class="code" href="classSchool.html">School</a>*     sArray = school_res.desired_school_array;
00418     <span class="keywordtype">short</span>     sCount = school_res.desired_school_count;
00419     <span class="keywordtype">float</span> max = 0;
00420     <span class="keywordtype">float</span> min = 9999;
00421     <span class="keywordtype">float</span> sumSquare=0;
00422     <span class="keywordtype">float</span> sumSingle=0;
00423 
00424     <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;sCount; i++ ) {
00425         <span class="keywordflow">if</span> ( sArray[i].<a class="code" href="classSchool.html#m95">enrollment_fte</a>&gt; max ) {
00426             max = sArray[i].<a class="code" href="classSchool.html#m95">enrollment_fte</a>;
00427         }
00428         <span class="keywordflow">if</span> ( sArray[i].<a class="code" href="classSchool.html#m95">enrollment_fte</a> &lt; min ) {
00429             min = sArray[i].<a class="code" href="classSchool.html#m95">enrollment_fte</a>;
00430         }
00431         sumSquare += <a class="code" href="Oschlres_8cpp.html#a0">EXPO2</a>( sArray[i].<a class="code" href="classSchool.html#m95">enrollment_fte</a>);
00432         sumSingle += sArray[i].<a class="code" href="classSchool.html#m95">enrollment_fte</a>;
00433     }
00434 
00435     <span class="keywordtype">float</span> sd;
00436 
00437     sd = m.sqrt(( sumSquare - <a class="code" href="Oschlres_8cpp.html#a0">EXPO2</a>( sumSingle )/sCount )/sCount);
00438 
00439     <span class="keywordtype">float</span> range = sd;
00440 
00441     <span class="comment">//  if ( desired_recno == 494 || desired_recno == 53 )</span>
00442     <span class="comment">//          range = sd;</span>
00443 
00444     <span class="keywordtype">float</span> distanceValueStudentCount;
00445 
00446     distanceValueStudentCount = <a class="code" href="Oschlres_8cpp.html#a0">EXPO2</a>(<span class="keywordtype">float</span>(AE5-player_school.get_player_expected_student_count())/range);
00447 
00448     <span class="keywordtype">float</span> Y5 = <a class="code" href="classSchool.html#m105">sponsored_research_per_reg_faculty</a>;
00449 
00450     max = 0;
00451     min = 9999;
00452 
00453     <span class="keywordflow">for</span> ( i=0; i&lt;sCount; i++ ) {
00454         <span class="keywordflow">if</span> ( sArray[i].<a class="code" href="classSchool.html#m105">sponsored_research_per_reg_faculty</a> &gt; max )
00455             max = sArray[i].<a class="code" href="classSchool.html#m105">sponsored_research_per_reg_faculty</a>;
00456         <span class="keywordflow">if</span> ( sArray[i].<a class="code" href="classSchool.html#m105">sponsored_research_per_reg_faculty</a> &lt; min )
00457             min = sArray[i].<a class="code" href="classSchool.html#m105">sponsored_research_per_reg_faculty</a>;
00458     }
00459 
00460     range = max - min;
00461 
00462     <span class="keywordtype">float</span> distanceValueSponsoredResearch;
00463 
00464     distanceValueSponsoredResearch = <a class="code" href="Oschlres_8cpp.html#a0">EXPO2</a>(<span class="keywordtype">float</span>(player_school.get_player_expected_sponsored_research()) - 9*Y5/range);
00465 
00466     <a class="code" href="classSchool.html#m131">distance_value</a> = 0.67*distanceValueStudentCount + 0.33*distanceValueSponsoredResearch;
00467 }
00468 
00469 <span class="comment">//</span>
00470 <span class="comment">// --- End of function School::calc_distance_first --- //</span>
00471 <span class="preprocessor">#endif</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:38:20 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
