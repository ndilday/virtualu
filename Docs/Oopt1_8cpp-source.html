<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Oopt1.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Oopt1.cpp</h1><a href="Oopt1_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : OOPT1.CPP</span>
00002 <span class="comment">//Description : Optimization class - stage 1</span>
00003 
00004 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00005 <span class="preprocessor">#include &lt;<a class="code" href="OGAMESET_8H.html">OGAMESET.H</a>&gt;</span>
00006 <span class="preprocessor">#include &lt;OWORLDMT.H&gt;</span>
00007 <span class="preprocessor">#include &lt;<a class="code" href="OBNDSLDR_8H.html">OBNDSLDR.H</a>&gt;</span>
00008 <span class="preprocessor">#include &lt;<a class="code" href="OVGA_8H.html">OVGA.H</a>&gt;</span>
00009 <span class="preprocessor">#include &lt;<a class="code" href="COLOR_8H.html">COLOR.H</a>&gt;</span>
00010 <span class="preprocessor">#include &lt;OFINANCE.H&gt;</span>
00011 <span class="preprocessor">#include &lt;OFONT.H&gt;</span>
00012 <span class="preprocessor">#include &lt;OGAMESTR.H&gt;</span>
00013 <span class="preprocessor">#include &lt;OMOUSE.H&gt;</span>
00014 <span class="preprocessor">#include &lt;OOPT.H&gt;</span>
00015 <span class="preprocessor">#include &lt;OBUTTON.H&gt;</span>
00016 <span class="preprocessor">#include &lt;OIFACE.H&gt;</span>
00017 <span class="preprocessor">#include &lt;<a class="code" href="OIMGRES_8H.html">OIMGRES.H</a>&gt;</span>
00018 <span class="preprocessor">#include &lt;<a class="code" href="OTEXT_8H.html">OTEXT.H</a>&gt;</span>
00019 <span class="preprocessor">#include &lt;<a class="code" href="OHELPIF_8H.html">OHELPIF.H</a>&gt;</span>
00020 <span class="preprocessor">#include &lt;<a class="code" href="OHELP_8H.html">OHELP.H</a>&gt;</span>
00021 <span class="preprocessor">#include &lt;OAUDIO.H&gt;</span>
00022 <span class="preprocessor">#include &lt;OCONFIG.H&gt;</span>
00023 
00024 <span class="comment">//------- Define constants -------//</span>
00025 
00026 <span class="keyword">enum</span> {
00027     <a class="code" href="Oopt1_8cpp.html#a32a6">REPORT_X1</a> = <a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a> + 15,
00028     <a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a> = <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a> + 25,
00029     <a class="code" href="Oopt1_8cpp.html#a32a8">REPORT_X2</a> = <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a> - 15,
00030     <a class="code" href="Oopt1_8cpp.html#a32a9">REPORT_Y2</a> = <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a> - 60
00031 };
00032 
00033 <span class="keyword">enum</span> {
00034     <a class="code" href="Oopt1_8cpp.html#a33a10">SEPARATOR_1</a> = <a class="code" href="Oopt1_8cpp.html#a32a6">REPORT_X1</a> + 250,
00035     <a class="code" href="Oopt1_8cpp.html#a33a11">SEPARATOR_2</a> = <a class="code" href="Oopt1_8cpp.html#a32a6">REPORT_X1</a> + 500,
00036     <a class="code" href="Oopt1_8cpp.html#a33a12">SEPARATOR_3</a> = <a class="code" href="Oopt1_8cpp.html#a32a6">REPORT_X1</a> + 620
00037 };
00038 
00039 <span class="keyword">enum</span> {
00040     <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> = 25,
00041     <a class="code" href="Oopt1_8cpp.html#a34a14">HEADING_HEIGHT</a> = 30,
00042     <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> = <a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a> + <a class="code" href="Oopt1_8cpp.html#a34a14">HEADING_HEIGHT</a> + 20,
00043     <a class="code" href="Oopt1_8cpp.html#a34a16">DESCRIPTION_OFFSET</a> = <a class="code" href="Oopt1_8cpp.html#a32a6">REPORT_X1</a> + 30,
00044     <a class="code" href="Oopt1_8cpp.html#a34a17">SLIDER_OFFSET</a> = 1,
00045     <a class="code" href="Oopt1_8cpp.html#a34a18">DESCRIPTION_INDENT</a> = 20,
00046     <a class="code" href="Oopt1_8cpp.html#a34a19">TARGET_OFFSET</a> = <a class="code" href="Oopt1_8cpp.html#a33a10">SEPARATOR_1</a> + 15,
00047     <a class="code" href="Oopt1_8cpp.html#a34a20">TARGET_WIDTH</a> = <a class="code" href="Oopt1_8cpp.html#a33a11">SEPARATOR_2</a> - <a class="code" href="Oopt1_8cpp.html#a33a10">SEPARATOR_1</a> - 30,
00048     <a class="code" href="Oopt1_8cpp.html#a34a21">TARGET_HEIGHT</a> = 10,
00049     <a class="code" href="Oopt1_8cpp.html#a34a22">PREF_BUTTON_WIDTH</a> = 16,
00050     <a class="code" href="Oopt1_8cpp.html#a34a23">PREF_BUTTON_HEIGHT</a> = 16,
00051     <a class="code" href="Oopt1_8cpp.html#a34a24">PREF_BUTTON_DISTANCE</a> = 10,
00052     <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> = 0,
00053     <a class="code" href="Oopt1_8cpp.html#a34a26">PREF_BUTTON_OFFSET1</a> = <a class="code" href="Oopt1_8cpp.html#a33a11">SEPARATOR_2</a> + 15,
00054     <a class="code" href="Oopt1_8cpp.html#a34a27">PREF_BUTTON_OFFSET2</a> = <a class="code" href="Oopt1_8cpp.html#a34a26">PREF_BUTTON_OFFSET1</a> + <a class="code" href="Oopt1_8cpp.html#a34a22">PREF_BUTTON_WIDTH</a> + <a class="code" href="Oopt1_8cpp.html#a34a24">PREF_BUTTON_DISTANCE</a>,
00055     <a class="code" href="Oopt1_8cpp.html#a34a28">PREF_BUTTON_OFFSET3</a> = <a class="code" href="Oopt1_8cpp.html#a34a27">PREF_BUTTON_OFFSET2</a> + <a class="code" href="Oopt1_8cpp.html#a34a22">PREF_BUTTON_WIDTH</a> + <a class="code" href="Oopt1_8cpp.html#a34a24">PREF_BUTTON_DISTANCE</a>,
00056     <a class="code" href="Oopt1_8cpp.html#a34a29">PREF_BUTTON_OFFSET4</a> = <a class="code" href="Oopt1_8cpp.html#a34a28">PREF_BUTTON_OFFSET3</a> + <a class="code" href="Oopt1_8cpp.html#a34a22">PREF_BUTTON_WIDTH</a> + <a class="code" href="Oopt1_8cpp.html#a34a24">PREF_BUTTON_DISTANCE</a>,
00057     <a class="code" href="Oopt1_8cpp.html#a34a30">RESULT_OFFSET</a> = <a class="code" href="Oopt1_8cpp.html#a33a12">SEPARATOR_3</a> + 20,
00058     <a class="code" href="Oopt1_8cpp.html#a34a31">RESULT_LENGTH</a> = 50
00059 };
00060 
00061 <span class="comment">//-------- define static vars -----------//</span>
00062 
00063 <span class="keyword">static</span> <a class="code" href="classText.html">Text</a> result_text[<a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a> + <a class="code" href="Ofinance_8h.html#a109a69">EXPENSE_POLICY_COUNT</a>];
00064 <span class="keyword">static</span> <a class="code" href="classButton.html">Button</a> help_button_array[<a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a> + <a class="code" href="Ofinance_8h.html#a109a69">EXPENSE_POLICY_COUNT</a>];
00065 
00066 <span class="keyword">static</span> <span class="keywordtype">char</span> *title[] = {
00067     <span class="stringliteral">"Description"</span>,
00068     <span class="stringliteral">"Target"</span>,
00069     <span class="stringliteral">"      Preference"</span>,
00070     <span class="stringliteral">"Result(%)"</span>
00071 };
00072 
00073 <span class="keyword">static</span> <span class="keywordtype">char</span> *heading[] = {
00074     <span class="stringliteral">"Revenue policies"</span>,
00075     <span class="stringliteral">"Cost rise and net budget change"</span>
00076 };
00077 
00078 <span class="keyword">static</span> <span class="keywordtype">char</span> *pref_label[] = {
00079     <span class="stringliteral">"1"</span>, <span class="stringliteral">"2"</span>, <span class="stringliteral">"3"</span>, <span class="stringliteral">"R"</span>
00080 };
00081 
00082 <span class="keyword">static</span> <span class="keywordtype">char</span> *optimize_label = <span class="stringliteral">"Optimize"</span>;
00083 
00084 <span class="comment">//------- Begin of function Optimization::init_stage_1 -----------//</span>
00086 <span class="comment">void Optimization::init_stage_1() {</span>
00087     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a> + <a class="code" href="Ofinance_8h.html#a109a69">EXPENSE_POLICY_COUNT</a>; i++) {
00088         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a>; j++) {
00089             opt1_button_group_up_bitmap[i * <a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> + j] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00090             opt1_button_group_down_bitmap[i * <a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> + j] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00091         }
00092     }
00093 }
00094 
00095 <span class="comment">//--------- End of function Optimization::init_stage_1 -----------//</span>
00096 
00097 <span class="comment">//------- Begin of function Optimization::deinit_stage_1 ---------//</span>
00099 <span class="comment">void Optimization::deinit_stage_1() {</span>
00100     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a> + <a class="code" href="Ofinance_8h.html#a109a69">EXPENSE_POLICY_COUNT</a>; i++) {
00101         <span class="keyword">delete</span> opt1_button_group_array[i];
00102 
00103         <span class="keywordflow">if</span>(opt1_button_group_array[i]) {
00104             opt1_button_group_array[i]=<a class="code" href="OHELP_8H.html#a0">NULL</a>;
00105         }
00106 
00107         opt1_slider_group[i].deinit();
00108 
00109         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a>; j++) {
00110             <a class="code" href="ALL_8H.html#a8">mem_del</a>(opt1_button_group_up_bitmap[i * <a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> + j]);
00111             <a class="code" href="ALL_8H.html#a8">mem_del</a>(opt1_button_group_down_bitmap[i * <a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> + j]);
00112             opt1_button_group_up_bitmap[i * <a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> + j] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00113             opt1_button_group_down_bitmap[i * <a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> + j] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00114         }
00115 
00116         <span class="comment">//              opt1_button_group_array[i]-&gt;button_pressed=2;</span>
00117         result_text[i].<a class="code" href="classText.html#a26">deinit</a>();
00118         <span class="comment">// ###### begin Gilbert 28/04/2001 #######//</span>
00119         help_button_array[i].<a class="code" href="classButton.html#a2">deinit</a>();
00120         <span class="comment">// ###### end Gilbert 28/04/2001 #######//</span>
00121     }
00122     stage_init_flag = 0;
00123 }
00124 
00125 <span class="comment">//--------- End of function Optimization::deinit_stage_1 -------//</span>
00126 
00127 <span class="comment">//------- Begin of function Optimization::report_stage_1 -------//</span>
<a name="l00129"></a><a class="code" href="classOptimization.html#a7">00129</a> <span class="comment">void Optimization::report_stage_1(int refreshFlag) {</span>
00130     <span class="keywordflow">if</span> (refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a> || refresh_optimization_screen ) {
00131         user_interface.brighten(<a class="code" href="Oopt1_8cpp.html#a32a6">REPORT_X1</a>+100, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="Oopt1_8cpp.html#a32a8">REPORT_X2</a>-100, <a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>);
00132         user_interface.brighten(<a class="code" href="Oopt1_8cpp.html#a32a6">REPORT_X1</a>+4, <a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>+4, <a class="code" href="Oopt1_8cpp.html#a32a8">REPORT_X2</a>-2, <a class="code" href="Oopt1_8cpp.html#a32a9">REPORT_Y2</a>-2);
00133         user_interface.rect(<a class="code" href="Oopt1_8cpp.html#a32a6">REPORT_X1</a>+100, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="Oopt1_8cpp.html#a32a8">REPORT_X2</a>-100, <a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>);
00134         <span class="comment">//              font_charts.center_put( REPORT_X1, ZOOM_Y1, REPORT_X2, REPORT_Y1, "Stage 1 : Overall Revenue and Expenditure" );</span>
00135         font_charts.center_put( <a class="code" href="Oopt1_8cpp.html#a32a6">REPORT_X1</a>, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="Oopt1_8cpp.html#a32a8">REPORT_X2</a>, <a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>, <span class="stringliteral">"Revenue and Expenditure"</span> );
00136 
00137         <span class="comment">// current stage not init'ed</span>
00138         <span class="keywordflow">if</span> (stage_init_flag != 1 || refresh_optimization_screen ) {
00139             deinit();
00140             <a class="code" href="classButtonGroup.html">ButtonGroup</a> *buttonGroupPtr;
00141             <span class="keywordtype">double</span> *targetValue, *lowerBound, *upperBound, *importWeight, lowerLimit, upperLimit;
00142             <span class="keywordtype">int</span> pressedButton;
00143 
00144             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a> + <a class="code" href="Ofinance_8h.html#a109a69">EXPENSE_POLICY_COUNT</a>; i++) {
00145                 opt1_button_group_array[i] = <span class="keyword">new</span> <a class="code" href="classButtonGroup.html">ButtonGroup</a>(<a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a>);
00146 
00147                 <span class="comment">//                              if(finance.revenue_policy_array[i].target_value &gt;= finance.revenue_policy_array[i].upper_limit)</span>
00148                 <span class="comment">//                                      finance.revenue_policy_array[i].target_value = finance.revenue_policy_array[i].upper_limit;</span>
00149                 <span class="comment">//                              else if(finance.revenue_policy_array[i].target_value &lt;= finance.revenue_policy_array[i].lower_limit)</span>
00150                 <span class="comment">//                                      finance.revenue_policy_array[i].target_value = finance.revenue_policy_array[i].lower_limit;</span>
00151 
00152                 <span class="comment">//##### begin fred 980904#####//</span>
00153                 targetValue = (i &lt; <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? &amp;(finance.revenue_policy_array[i].target_value) : &amp;(finance.expense_policy_array[i - <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>].target_value);
00154                 lowerBound = (i &lt; <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? &amp;(finance.revenue_policy_array[i].lower_bound) : &amp;(finance.expense_policy_array[i - <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>].lower_bound);
00155                 upperBound = (i &lt; <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? &amp;(finance.revenue_policy_array[i].upper_bound) : &amp;(finance.expense_policy_array[i - <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>].upper_bound);
00156                 importWeight = (i &lt; <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? &amp;(finance.revenue_policy_array[i].import_weight) : &amp;(finance.expense_policy_array[i - <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>].import_weight);
00157                 lowerLimit = (i &lt; <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? (finance.revenue_policy_array[i].lower_limit) : (finance.expense_policy_array[i - <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>].lower_limit);
00158                 upperLimit = (i &lt; <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? (finance.revenue_policy_array[i].upper_limit) : (finance.expense_policy_array[i - <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>].upper_limit);
00159 
00160                 <span class="comment">//                              opt1_slider_group[i].init(</span>
00161                 <span class="comment">//                                      TARGET_OFFSET, SLIDER_OFFSET + FIRST_LINE_OFFSET + LINE_SPACING * (i + ((i &gt;= REVENUE_POLICY_COUNT) ? 2 : 1)),</span>
00162                 <span class="comment">//                                      TARGET_WIDTH, TARGET_HEIGHT, targetValue, lowerBound, upperBound, *targetValue-(*targetValue-*lowerBound)*2, *targetValue+(*upperBound-*targetValue)*2);</span>
00163 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00164 <span class="preprocessor"></span>                <span class="keywordflow">if</span> ( *targetValue &gt; *upperBound )
00165                     *targetValue = *upperBound;
00166 <span class="preprocessor">#endif</span>
00167 <span class="preprocessor"></span>
00168                 opt1_slider_group[i].init(
00169                     <a class="code" href="Oopt1_8cpp.html#a34a19">TARGET_OFFSET</a>, <a class="code" href="Oopt1_8cpp.html#a34a17">SLIDER_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1)),
00170                     <a class="code" href="Oopt1_8cpp.html#a34a20">TARGET_WIDTH</a>, <a class="code" href="Oopt1_8cpp.html#a34a21">TARGET_HEIGHT</a>, targetValue, lowerBound, upperBound, lowerLimit, upperLimit,
00171                     1,<a class="code" href="COLOR_8H.html#a25">V_YELLOW</a>,<a class="code" href="COLOR_8H.html#a20">V_GREEN</a>,24);                 <span class="comment">//## chea 110809 change by b.massy</span>
00172                 <span class="comment">//##### end fred 980904#####//</span>
00173 
00174 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00175 <span class="preprocessor"></span>                <span class="keywordflow">if</span> ( i == 0 ) {
00176                     <span class="keywordflow">if</span> ( *upperBound &lt; 5.0 )
00177                         opt1_slider_group[i].lock_max = 1;
00178                 }
00179 
00180                 <span class="comment">// lock indirect cost rate's upper bound</span>
00181 
00182                 <span class="keywordflow">if</span>( i == <a class="code" href="Ofinance_8h.html#a108a68">PL_INDIRECT_COST_RATE</a> ) {
00183                     opt1_slider_group[i].lock_max = 1;
00184                 }
00185 <span class="preprocessor">#endif</span>
00186 <span class="preprocessor"></span>
00187                 user_interface.create_button_bitmap(
00188                     <a class="code" href="Oopt1_8cpp.html#a34a26">PREF_BUTTON_OFFSET1</a>-2,
00189                     <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1))-2,
00190                     <a class="code" href="Oopt1_8cpp.html#a34a26">PREF_BUTTON_OFFSET1</a> + <a class="code" href="Oopt1_8cpp.html#a34a22">PREF_BUTTON_WIDTH</a>,
00191                     <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1)) + <a class="code" href="Oopt1_8cpp.html#a34a23">PREF_BUTTON_HEIGHT</a>,
00192                     pref_label[0], &amp;opt1_button_group_up_bitmap[<a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> * i], &amp;opt1_button_group_down_bitmap[<a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> * i], &amp;vga_back);
00193                 user_interface.create_button_bitmap(
00194                     <a class="code" href="Oopt1_8cpp.html#a34a27">PREF_BUTTON_OFFSET2</a>-2,
00195                     <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1))-2,
00196                     <a class="code" href="Oopt1_8cpp.html#a34a27">PREF_BUTTON_OFFSET2</a> + <a class="code" href="Oopt1_8cpp.html#a34a22">PREF_BUTTON_WIDTH</a>,
00197                     <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1)) + <a class="code" href="Oopt1_8cpp.html#a34a23">PREF_BUTTON_HEIGHT</a>,
00198                     pref_label[1], &amp;opt1_button_group_up_bitmap[<a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> * i + 1], &amp;opt1_button_group_down_bitmap[<a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> * i + 1], &amp;vga_back);
00199                 user_interface.create_button_bitmap(
00200                     <a class="code" href="Oopt1_8cpp.html#a34a28">PREF_BUTTON_OFFSET3</a>-2,
00201                     <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1))-2,
00202                     <a class="code" href="Oopt1_8cpp.html#a34a28">PREF_BUTTON_OFFSET3</a> + <a class="code" href="Oopt1_8cpp.html#a34a22">PREF_BUTTON_WIDTH</a>,
00203                     <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1)) + <a class="code" href="Oopt1_8cpp.html#a34a23">PREF_BUTTON_HEIGHT</a>,
00204                     pref_label[2], &amp;opt1_button_group_up_bitmap[<a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> * i + 2], &amp;opt1_button_group_down_bitmap[<a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> * i + 2], &amp;vga_back);
00205                 user_interface.create_button_bitmap(
00206                     <a class="code" href="Oopt1_8cpp.html#a34a29">PREF_BUTTON_OFFSET4</a>-2,
00207                     <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1))-2,
00208                     <a class="code" href="Oopt1_8cpp.html#a34a29">PREF_BUTTON_OFFSET4</a> + <a class="code" href="Oopt1_8cpp.html#a34a22">PREF_BUTTON_WIDTH</a>,
00209                     <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1)) + <a class="code" href="Oopt1_8cpp.html#a34a23">PREF_BUTTON_HEIGHT</a>,
00210                     pref_label[3], &amp;opt1_button_group_up_bitmap[<a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> * i + 3], &amp;opt1_button_group_down_bitmap[<a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> * i + 3], &amp;vga_back);
00211                 buttonGroupPtr = opt1_button_group_array[i];
00212 
00213                 <span class="comment">//                              pressedButton = int(*importWeight * 2.0) - 1;</span>
00214                 <span class="keywordflow">if</span>(*importWeight==<a class="code" href="Ofinanc2_8h.html#a0">OPT_LOW_WEIGHT</a>)
00215                     pressedButton =0;
00216                 <span class="keywordflow">if</span>(*importWeight==<a class="code" href="Ofinanc2_8h.html#a1">OPT_MID_WEIGHT</a>)
00217                     pressedButton =1;
00218                 <span class="keywordflow">if</span>(*importWeight==<a class="code" href="Ofinanc2_8h.html#a2">OPT_HIGH_WEIGHT</a>)
00219                     pressedButton =2;
00220 
00221                 <span class="keywordflow">if</span>(((i &lt; <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ?
00222                     (finance.revenue_policy_array[i].required_flag) :
00223                     (finance.expense_policy_array[i - <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>].required_flag) )) {
00224                     pressedButton = 3;
00225                     opt1_slider_group[i].enable_flag=0;
00226                 }
00227                 <span class="comment">//                              else</span>
00228                 <span class="comment">//                              {</span>
00229                 <span class="comment">//                                      if(pressedButton==3)</span>
00230                 <span class="comment">//                                              pressedButton = 1;</span>
00231                 <span class="comment">//                                      opt1_slider_group[i].enable_flag=1;</span>
00232                 <span class="comment">//                              }</span>
00233 
00234                 (*buttonGroupPtr)[0].create_bitmapW(
00235                     <a class="code" href="Oopt1_8cpp.html#a34a26">PREF_BUTTON_OFFSET1</a>-2,
00236                     <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1))-2,
00237                     <a class="code" href="Oopt1_8cpp.html#a34a26">PREF_BUTTON_OFFSET1</a> + <a class="code" href="Oopt1_8cpp.html#a34a22">PREF_BUTTON_WIDTH</a>,
00238                     <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1)) + <a class="code" href="Oopt1_8cpp.html#a34a23">PREF_BUTTON_HEIGHT</a>,
00239                     ((pressedButton == 0) ? opt1_button_group_down_bitmap[<a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> * i] : opt1_button_group_up_bitmap[<a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> * i]) + 4);
00240                 (*buttonGroupPtr)[1].create_bitmapW(
00241                     <a class="code" href="Oopt1_8cpp.html#a34a27">PREF_BUTTON_OFFSET2</a>-2,
00242                     <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1))-2,
00243                     <a class="code" href="Oopt1_8cpp.html#a34a27">PREF_BUTTON_OFFSET2</a> + <a class="code" href="Oopt1_8cpp.html#a34a22">PREF_BUTTON_WIDTH</a>,
00244                     <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1)) + <a class="code" href="Oopt1_8cpp.html#a34a23">PREF_BUTTON_HEIGHT</a>,
00245                     ((pressedButton == 1) ? opt1_button_group_down_bitmap[<a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> * i + 1] : opt1_button_group_up_bitmap[<a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> * i + 1]) + 4);
00246                 (*buttonGroupPtr)[2].create_bitmapW(
00247                     <a class="code" href="Oopt1_8cpp.html#a34a28">PREF_BUTTON_OFFSET3</a>-2,
00248                     <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1))-2,
00249                     <a class="code" href="Oopt1_8cpp.html#a34a28">PREF_BUTTON_OFFSET3</a> + <a class="code" href="Oopt1_8cpp.html#a34a22">PREF_BUTTON_WIDTH</a>,
00250                     <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1)) + <a class="code" href="Oopt1_8cpp.html#a34a23">PREF_BUTTON_HEIGHT</a>,
00251                     ((pressedButton == 2) ? opt1_button_group_down_bitmap[<a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> * i + 2] : opt1_button_group_up_bitmap[<a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> * i + 2]) + 4);
00252                 (*buttonGroupPtr)[3].create_bitmapW(
00253                     <a class="code" href="Oopt1_8cpp.html#a34a29">PREF_BUTTON_OFFSET4</a>-2,
00254                     <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1))-2,
00255                     <a class="code" href="Oopt1_8cpp.html#a34a29">PREF_BUTTON_OFFSET4</a> + <a class="code" href="Oopt1_8cpp.html#a34a22">PREF_BUTTON_WIDTH</a>,
00256                     <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1)) + <a class="code" href="Oopt1_8cpp.html#a34a23">PREF_BUTTON_HEIGHT</a>,
00257                     ((pressedButton == 3) ? opt1_button_group_down_bitmap[<a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> * i + 3] : opt1_button_group_up_bitmap[<a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> * i + 3]) + 4);
00258 
00259                 buttonGroupPtr-&gt;<a class="code" href="classButtonGroup.html#m1">button_pressed</a> = pressedButton;
00260 
00261                 <span class="keywordflow">if</span>(user_interface.backgd_flag==1)
00262                     help_button_array[i].<a class="code" href="classButton.html#a10">create_text</a>(<a class="code" href="Oopt1_8cpp.html#a32a6">REPORT_X1</a>+10,
00263                                                      <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1)),
00264                                                      <a class="code" href="Oopt1_8cpp.html#a32a6">REPORT_X1</a>+28,
00265                                                      <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1))+18,
00266                                                      <span class="stringliteral">"?"</span>);
00267             }
00268 
00269             stage_init_flag = 1;
00270         }
00271 
00272         user_interface.h_line(<a class="code" href="Oopt1_8cpp.html#a32a6">REPORT_X1</a>, <a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>+<a class="code" href="Oopt1_8cpp.html#a34a14">HEADING_HEIGHT</a>, <a class="code" href="Oopt1_8cpp.html#a32a8">REPORT_X2</a>-<a class="code" href="Oopt1_8cpp.html#a32a6">REPORT_X1</a>);
00273         user_interface.v_line(<a class="code" href="Oopt1_8cpp.html#a33a10">SEPARATOR_1</a>-1, <a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>+1, <a class="code" href="Oopt1_8cpp.html#a32a9">REPORT_Y2</a>-<a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>-2);
00274         user_interface.v_line(<a class="code" href="Oopt1_8cpp.html#a33a11">SEPARATOR_2</a>-1, <a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>+1, <a class="code" href="Oopt1_8cpp.html#a32a9">REPORT_Y2</a>-<a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>-2);
00275         user_interface.v_line(<a class="code" href="Oopt1_8cpp.html#a33a12">SEPARATOR_3</a>-1, <a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>+1, <a class="code" href="Oopt1_8cpp.html#a32a9">REPORT_Y2</a>-<a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>-2);
00276         user_interface.rect(<a class="code" href="Oopt1_8cpp.html#a32a6">REPORT_X1</a>, <a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>, <a class="code" href="Oopt1_8cpp.html#a32a8">REPORT_X2</a>, <a class="code" href="Oopt1_8cpp.html#a32a9">REPORT_Y2</a>, 2);
00277 
00278         font_chartsm.center_put( <a class="code" href="Oopt1_8cpp.html#a32a6">REPORT_X1</a>+1, <a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>+1,
00279                                  <a class="code" href="Oopt1_8cpp.html#a33a10">SEPARATOR_1</a>-1, <a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>+1+<a class="code" href="Oopt1_8cpp.html#a34a14">HEADING_HEIGHT</a>, title[0] );
00280         font_chartsm.center_put( <a class="code" href="Oopt1_8cpp.html#a33a10">SEPARATOR_1</a>+1, <a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>+1,
00281                                  <a class="code" href="Oopt1_8cpp.html#a33a11">SEPARATOR_2</a>-1, <a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>+1+<a class="code" href="Oopt1_8cpp.html#a34a14">HEADING_HEIGHT</a>, title[1] );
00282         font_chartsm.center_put( <a class="code" href="Oopt1_8cpp.html#a33a11">SEPARATOR_2</a>+1, <a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>+1,
00283                                  <a class="code" href="Oopt1_8cpp.html#a33a12">SEPARATOR_3</a>-1, <a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>+1+<a class="code" href="Oopt1_8cpp.html#a34a14">HEADING_HEIGHT</a>, title[2] );
00284         font_chartsm.center_put( <a class="code" href="Oopt1_8cpp.html#a33a12">SEPARATOR_3</a>+1, <a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>+1,
00285                                  <a class="code" href="Oopt1_8cpp.html#a32a8">REPORT_X2</a>-1, <a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>+1+<a class="code" href="Oopt1_8cpp.html#a34a14">HEADING_HEIGHT</a>, title[3] );
00286 
00287         <span class="keywordflow">if</span>(user_interface.backgd_flag==1)
00288             image_interface.put_back(<a class="code" href="Oopt1_8cpp.html#a33a11">SEPARATOR_2</a>+9,<a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>+7,<span class="stringliteral">"QUEST_UP"</span>);
00289 
00290         <span class="comment">//              font_chartsm.put( DESCRIPTION_OFFSET, FIRST_LINE_OFFSET, heading[0]);</span>
00291         <span class="comment">//              font_chartsm.put( DESCRIPTION_OFFSET, FIRST_LINE_OFFSET + (REVENUE_POLICY_COUNT + 1) * LINE_SPACING, heading[1]);</span>
00292 
00293         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a> + <a class="code" href="Ofinance_8h.html#a109a69">EXPENSE_POLICY_COUNT</a>; i++) {
00294             font_chartsm.put(
00295                 <a class="code" href="Oopt1_8cpp.html#a34a16">DESCRIPTION_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a18">DESCRIPTION_INDENT</a>,
00296                 <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1)),
00297                 game_str_res.opt_stage1_str(i) );
00298             <span class="keywordflow">if</span>(user_interface.backgd_flag==1)
00299                 image_interface.put_back(<a class="code" href="Oopt1_8cpp.html#a32a6">REPORT_X1</a>+10,
00300                                          <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1))
00301                                          ,<span class="stringliteral">"QUEST_UP"</span>);
00302 
00303             opt1_slider_group[i].paint();
00304             opt1_button_group_array[i]-&gt;paint(opt1_button_group_array[i]-&gt;button_pressed);
00305             opt1_slider_group[i].result_flag=optimization.is_optimized[0];
00306             opt1_slider_group[i].result_value = (i &lt; <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? finance.revenue_policy_array[i].result_value : finance.expense_policy_array[i - <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>].result_value;
00307             <span class="comment">//                  opt1_slider_group[i].result_value=(double)((int)(opt1_slider_group[i].result_value*100.0)/100);</span>
00308             result_text[i].<a class="code" href="classText.html#a2">init</a>(
00309                 <a class="code" href="Oopt1_8cpp.html#a34a30">RESULT_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a31">RESULT_LENGTH</a> - 50,
00310                 <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1)),
00311                 &amp;(opt1_slider_group[i].result_value),24); <span class="comment">//## chea 110899 change by b.massy add 24(1dec)</span>
00312         }
00313 
00314         refresh_optimization_screen = 0;
00315     }
00316     <span class="keywordflow">else</span> {                                          <span class="comment">// refreshFlag == INFO_REFRESH</span>
00317         vga.use_back();
00318         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a> + <a class="code" href="Ofinance_8h.html#a109a69">EXPENSE_POLICY_COUNT</a>; i++) {
00319             opt1_slider_group[i].result_flag=optimization.is_optimized[0]; {
00320                 <span class="comment">//                      if (optimization.is_optimized[0]==1)</span>
00321                 opt1_slider_group[i].result_value = (i &lt; <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? finance.revenue_policy_array[i].result_value : finance.expense_policy_array[i - <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>].result_value;
00322 
00323                 <span class="comment">// chwg0513</span>
00324                 <span class="keywordflow">if</span>(i &lt; <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) {
00325                     <span class="keywordflow">if</span>(finance.revenue_policy_array[i].required_flag) {
00326                         opt1_slider_group[i].enable_flag=0;
00327                         opt1_button_group_array[i]-&gt;push(3);
00328                         <span class="keywordtype">double</span> *importWeight = &amp;(finance.revenue_policy_array[i].import_weight);
00329                         *importWeight = <a class="code" href="Ofinanc2_8h.html#a1">OPT_MID_WEIGHT</a>;
00330                     }
00331                     <span class="comment">//## chea 031299 11.2.3 to make the opt bar enable again this is when a bar is locked use in report and will release here</span>
00332                     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(finance.revenue_policy_array[i].required_flag == 0 &amp;&amp; opt1_slider_group[i].enable_flag ==0) {
00333                         opt1_slider_group[i].enable_flag=1;
00334                         opt1_button_group_array[i]-&gt;push(1);
00335                         <span class="keywordtype">double</span> *importWeight = &amp;(finance.revenue_policy_array[i].import_weight);
00336                         *importWeight = <a class="code" href="Ofinanc2_8h.html#a1">OPT_MID_WEIGHT</a>;
00337                     }
00338 
00339                     <span class="comment">//                                  else</span>
00340                     <span class="comment">//                                  {</span>
00341                     <span class="comment">//                                          if(opt1_button_group_array[i]-&gt;button_pressed==3)</span>
00342                     <span class="comment">//                                                  opt1_button_group_array[i]-&gt;push(1);</span>
00343                     <span class="comment">//</span>
00344                     <span class="comment">//                                          opt1_slider_group[i].enable_flag=1;</span>
00345                     <span class="comment">//                                  }</span>
00346                 }
00347                 <span class="keywordflow">else</span> {
00348                     <span class="keywordflow">if</span>(finance.expense_policy_array[i - <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>].required_flag) {
00349                         opt1_slider_group[i].enable_flag=0;
00350                         opt1_button_group_array[i]-&gt;push(3);
00351                         <span class="keywordtype">double</span> *importWeight = &amp;(finance.expense_policy_array[i - <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>].import_weight);
00352                         *importWeight = <a class="code" href="Ofinanc2_8h.html#a1">OPT_MID_WEIGHT</a>;
00353                     }
00354                     <span class="comment">//## chea 031299 11.2.3 to make the opt bar enable again this is when a bar is locked use in report and will release here</span>
00355                     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(finance.expense_policy_array[i - <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>].required_flag == 0 &amp;&amp; opt1_slider_group[i].enable_flag ==0) {
00356                         opt1_slider_group[i].enable_flag=1;
00357                         opt1_button_group_array[i]-&gt;push(1);
00358                         <span class="keywordtype">double</span> *importWeight = &amp;(finance.expense_policy_array[i - <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>].import_weight);
00359                         *importWeight = <a class="code" href="Ofinanc2_8h.html#a1">OPT_MID_WEIGHT</a>;
00360                     }
00361 
00362                     <span class="comment">//                                  else</span>
00363                     <span class="comment">//                                  {       if(opt1_button_group_array[i]-&gt;button_pressed==3)</span>
00364                     <span class="comment">//                                                  opt1_button_group_array[i]-&gt;push(1);</span>
00365                     <span class="comment">//                                          opt1_slider_group[i].enable_flag=1;</span>
00366                     <span class="comment">//                                  }</span>
00367                 }
00368 
00369                 result_text[i].<a class="code" href="classText.html#a24">paint</a>();
00370                 vga.blt_buf(<a class="code" href="Oopt1_8cpp.html#a34a30">RESULT_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a31">RESULT_LENGTH</a> - 50,
00371                             <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1)),
00372                             <a class="code" href="Oopt1_8cpp.html#a34a30">RESULT_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a31">RESULT_LENGTH</a>,
00373                             <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1))+16);
00374             }
00375             opt1_slider_group[i].refresh();
00376         }
00377     }
00378 }
00379 
00380 <span class="comment">//---------- End of function Optimization::report_stage_1 ------//</span>
00381 
00382 <span class="comment">//-------- Begin of function Optimization::detect_stage_1 ------//</span>
<a name="l00384"></a><a class="code" href="classOptimization.html#a10">00384</a> <span class="comment">int Optimization::detect_stage_1() {</span>
00385     <span class="keywordflow">if</span> (stage_init_flag != 1)
00386         <span class="keywordflow">return</span> 0;
00387 
00388     help.set_help(<a class="code" href="Oopt1_8cpp.html#a34a19">TARGET_OFFSET</a>, <a class="code" href="Oopt1_8cpp.html#a34a17">SLIDER_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a>,
00389                   <a class="code" href="Oopt1_8cpp.html#a34a19">TARGET_OFFSET</a>+<a class="code" href="Oopt1_8cpp.html#a34a20">TARGET_WIDTH</a>,<a class="code" href="Oopt1_8cpp.html#a32a9">REPORT_Y2</a>-20,<span class="stringliteral">"H8.1.1."</span>);
00390     help.set_help(<a class="code" href="Oopt1_8cpp.html#a34a19">TARGET_OFFSET</a>, <a class="code" href="Oopt1_8cpp.html#a34a17">SLIDER_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a>,
00391                   <a class="code" href="Oopt1_8cpp.html#a34a19">TARGET_OFFSET</a>+30,<a class="code" href="Oopt1_8cpp.html#a32a9">REPORT_Y2</a>-20,<span class="stringliteral">"H8.1.2."</span>);
00392     help.set_help(<a class="code" href="Oopt1_8cpp.html#a34a19">TARGET_OFFSET</a>+<a class="code" href="Oopt1_8cpp.html#a34a20">TARGET_WIDTH</a>-30, <a class="code" href="Oopt1_8cpp.html#a34a17">SLIDER_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a>,
00393                   <a class="code" href="Oopt1_8cpp.html#a34a19">TARGET_OFFSET</a>+<a class="code" href="Oopt1_8cpp.html#a34a20">TARGET_WIDTH</a>,<a class="code" href="Oopt1_8cpp.html#a32a9">REPORT_Y2</a>-20,<span class="stringliteral">"H8.1.3."</span>);
00394     help.set_help(  <a class="code" href="Oopt1_8cpp.html#a33a11">SEPARATOR_2</a>, <a class="code" href="Oopt1_8cpp.html#a34a17">SLIDER_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a>,
00395                     <a class="code" href="Oopt1_8cpp.html#a33a12">SEPARATOR_3</a>,<a class="code" href="Oopt1_8cpp.html#a32a9">REPORT_Y2</a>-20,<span class="stringliteral">"H8.1.4."</span>);
00396     <span class="keywordtype">int</span> i, j;
00397 
00398     vga.use_back();
00399 
00400     <span class="comment">//--------- detect sliders ---------//</span>
00401 
00402     <span class="keywordflow">if</span> (mouse.in_area( <a class="code" href="Oopt1_8cpp.html#a33a10">SEPARATOR_1</a>, <a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>+1+<a class="code" href="Oopt1_8cpp.html#a34a14">HEADING_HEIGHT</a>,
00403                        <a class="code" href="Oopt1_8cpp.html#a33a11">SEPARATOR_2</a>, <a class="code" href="Oopt1_8cpp.html#a32a9">REPORT_Y2</a> )) {
00404         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a> + <a class="code" href="Ofinance_8h.html#a109a69">EXPENSE_POLICY_COUNT</a>; i++) {
00405             <span class="keywordflow">if</span>(!((i &lt; <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ?
00406                  (finance.revenue_policy_array[i].required_flag) :
00407                  (finance.expense_policy_array[i - <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>].required_flag))) {
00408                 <span class="keywordflow">if</span> (opt1_slider_group[i].detect()) {
00409                     optimization.is_optimize_slider_modified[0]=0;
00410                     <span class="keywordflow">return</span> 1;
00411                 }
00412             }
00413         }
00414     }
00415 
00416     <span class="comment">//-------- detect "Preference Help" button ---------//</span>
00417 
00418     <span class="keywordflow">if</span> (mouse.single_click(<a class="code" href="Oopt1_8cpp.html#a33a11">SEPARATOR_2</a>+9,<a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>+7,<a class="code" href="Oopt1_8cpp.html#a33a11">SEPARATOR_2</a>+27,<a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>+25)) {
00419         <a class="code" href="classString.html">String</a> str;
00420         str  = <a class="code" href="Gamedef_8h.html#a4">DIR_RES</a>;
00421         str += <span class="stringliteral">"SCORE"</span>;
00422 
00423         <a class="code" href="classResTxt.html">ResTxt</a> rs;
00424         rs.<a class="code" href="classResTxt.html#a2">init</a>(str);
00425         image_interface.put_back(<a class="code" href="Oopt1_8cpp.html#a33a11">SEPARATOR_2</a>+9,<a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>+7,<span class="stringliteral">"QUEST_DN"</span>);
00426         vga.blt_buf(<a class="code" href="Oopt1_8cpp.html#a33a11">SEPARATOR_2</a>+9,<a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>+7,<a class="code" href="Oopt1_8cpp.html#a33a11">SEPARATOR_2</a>+27,<a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>+25);
00427         sys.back_view_mode=sys.view_mode;
00428         help_if.help_textlist.topic_id=rs.<a class="code" href="classResTxt.html#a7">locate_topic</a>(<span class="stringliteral">"Preference"</span>);
00429         <span class="keywordflow">if</span>(help_if.help_textlist.topic_id&gt;0) {
00430             help_if.help_textlist.add_history(help_if.help_textlist.topic_id);
00431             sys.set_view_mode(<a class="code" href="Osys_8h.html#a45a31">MODE_HELP_DESC</a>);
00432             sys.redraw_all_flag = 1;
00433             audio.play_wav(<span class="stringliteral">"BEEPS-1"</span>,audio.int_to_DsVolume(config.sound_effect_volume));
00434         }
00435         <span class="keywordflow">return</span> 1;
00436     }
00437 
00438     vga.use_front();
00439 
00440     <span class="comment">//--------- if click on a pushed "R" to reset it ----------//</span>
00441 
00442     <span class="comment">// Unlock line if the state is IMPLEMENT</span>
00443     <span class="keywordflow">for</span> (i = 0; i &lt;<a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a> + <a class="code" href="Ofinance_8h.html#a109a69">EXPENSE_POLICY_COUNT</a>; i++) {
00444         <span class="keywordflow">if</span> (mouse.single_click(
00445             <a class="code" href="Oopt1_8cpp.html#a34a29">PREF_BUTTON_OFFSET4</a>-2,
00446             <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1))-2,
00447             <a class="code" href="Oopt1_8cpp.html#a34a29">PREF_BUTTON_OFFSET4</a> + <a class="code" href="Oopt1_8cpp.html#a34a22">PREF_BUTTON_WIDTH</a>,
00448             <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1)) + <a class="code" href="Oopt1_8cpp.html#a34a23">PREF_BUTTON_HEIGHT</a>
00449             )) {
00450             <span class="comment">//------ click on a revenue item --------//</span>
00451 
00452             <span class="keywordflow">if</span>(i &lt; <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) {
00453                 <span class="keywordflow">if</span>( finance.revenue_policy_array[i].applied_flag!=<a class="code" href="Ofinanc2_8h.html#a38a8">P_IMPLEMENT</a> ) {
00454                     <span class="keywordflow">if</span>(finance.revenue_policy_array[i].required_flag) {
00455                         finance.revenue_policy_array[i].required_flag=0;
00456                         opt1_slider_group[i].enable_flag=1;
00457                         opt1_slider_group[i].refresh();
00458 
00459                         finance.revenue_policy_array[i].reset_constraint_policy();
00460 
00461                         opt1_button_group_array[i]-&gt;push(1);
00462 
00463                         <span class="comment">//## chea 041099 try to release the opt button</span>
00464                         optimization.is_optimize_slider_modified[0]=0;
00465 
00466                         <span class="keywordtype">double</span> *importWeight = &amp;(finance.revenue_policy_array[i].import_weight);
00467                         *importWeight = <a class="code" href="Ofinanc2_8h.html#a1">OPT_MID_WEIGHT</a>;
00468 
00469                         sys.redraw_all_flag=1;
00470                         <span class="keywordflow">return</span> 1;
00471                     }
00472                 }
00473             }
00474             <span class="keywordflow">else</span> {                                      <span class="comment">//------ click on an expense item --------//</span>
00475                 <span class="keywordflow">if</span>(finance.expense_policy_array[i - <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>].applied_flag!=<a class="code" href="Ofinanc2_8h.html#a38a8">P_IMPLEMENT</a>) {
00476                     <span class="keywordflow">if</span>(finance.expense_policy_array[i - <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>].required_flag) {
00477                         finance.expense_policy_array[i - <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>].required_flag=0;
00478                         opt1_slider_group[i].enable_flag=1;
00479                         opt1_slider_group[i].refresh();
00480                         <span class="comment">//## fred 990528</span>
00481                         finance.expense_policy_array[i-<a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>].reset_constraint_policy();
00482                         <span class="comment">//##</span>
00483                         opt1_button_group_array[i]-&gt;push(1);
00484 
00485                         <span class="comment">//## chea 041099 try to release the opt button</span>
00486                         optimization.is_optimize_slider_modified[0]=0;
00487 
00488                         <span class="keywordtype">double</span> *importWeight = &amp;(finance.expense_policy_array[i - <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>].import_weight);
00489                         *importWeight = <a class="code" href="Ofinanc2_8h.html#a1">OPT_MID_WEIGHT</a>;
00490                         sys.redraw_all_flag=1;
00491                         <span class="keywordflow">return</span> 1;
00492                     }
00493                 }
00494             }
00495         }
00496     }
00497 
00498     <span class="comment">//----------- click on Preference 1, 2, 3 or R --------------//</span>
00499 
00500     <span class="keywordflow">if</span> (mouse.single_click( <a class="code" href="Oopt1_8cpp.html#a33a11">SEPARATOR_2</a>, <a class="code" href="Oopt1_8cpp.html#a32a7">REPORT_Y1</a>+1+<a class="code" href="Oopt1_8cpp.html#a34a14">HEADING_HEIGHT</a>,
00501                             <a class="code" href="Oopt1_8cpp.html#a33a12">SEPARATOR_3</a>, <a class="code" href="Oopt1_8cpp.html#a32a9">REPORT_Y2</a> )) {
00502         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a> + <a class="code" href="Ofinance_8h.html#a109a69">EXPENSE_POLICY_COUNT</a>; i++) {
00503             <span class="keywordflow">if</span>(!((i &lt; <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ?
00504                  (finance.revenue_policy_array[i].required_flag) :
00505                  (finance.expense_policy_array[i - <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>].required_flag))) {
00506                 <span class="keywordflow">if</span>  ( (j = opt1_button_group_array[i]-&gt;detect()) &gt;= 0) {
00507                     <span class="comment">//## chea 041099 try to release the opt button</span>
00508                     optimization.is_optimize_slider_modified[0]=0;
00509 
00510                     <span class="keywordflow">if</span>(j==3) {
00511                         <span class="keywordflow">if</span>(i &lt; <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) {
00512                             finance.revenue_policy_array[i].required_flag=1;
00513                             finance.revenue_policy_array[i].set_constraint_policy();
00514                         }
00515                         <span class="keywordflow">else</span> {
00516                             finance.expense_policy_array[i - <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>].required_flag=1;
00517                             finance.expense_policy_array[i - <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>].set_constraint_policy();
00518                         }
00519                         opt1_slider_group[i].enable_flag=0;
00520                         opt1_slider_group[i].refresh();
00521 
00522                         sys.redraw_all_flag=1;
00523                     }
00524 
00525                     <a class="code" href="classButtonGroup.html">ButtonGroup</a> *buttonGroupPtr = opt1_button_group_array[i];
00526                     vga.use_back();
00527                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a>; k++) {
00528                         (*buttonGroupPtr)[k].body_ptr =
00529                             (<span class="keywordtype">void</span> *) ((k==j)?(opt1_button_group_down_bitmap[i*<a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a>+k] + 4):(opt1_button_group_up_bitmap[i*<a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a>+k] + 4));
00530                     }
00531                     buttonGroupPtr-&gt;<a class="code" href="classButtonGroup.html#a3">paint</a>(buttonGroupPtr-&gt;<a class="code" href="classButtonGroup.html#m1">button_pressed</a>);
00532                     vga.blt_buf(<a class="code" href="Oopt1_8cpp.html#a34a26">PREF_BUTTON_OFFSET1</a>, <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1)), <a class="code" href="Oopt1_8cpp.html#a34a26">PREF_BUTTON_OFFSET1</a> + <a class="code" href="Oopt1_8cpp.html#a34a22">PREF_BUTTON_WIDTH</a>, <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1)) + <a class="code" href="Oopt1_8cpp.html#a34a23">PREF_BUTTON_HEIGHT</a>);
00533                     vga.blt_buf(<a class="code" href="Oopt1_8cpp.html#a34a27">PREF_BUTTON_OFFSET2</a>, <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1)), <a class="code" href="Oopt1_8cpp.html#a34a27">PREF_BUTTON_OFFSET2</a> + <a class="code" href="Oopt1_8cpp.html#a34a22">PREF_BUTTON_WIDTH</a>, <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1)) + <a class="code" href="Oopt1_8cpp.html#a34a23">PREF_BUTTON_HEIGHT</a>);
00534                     vga.blt_buf(<a class="code" href="Oopt1_8cpp.html#a34a28">PREF_BUTTON_OFFSET3</a>, <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1)), <a class="code" href="Oopt1_8cpp.html#a34a28">PREF_BUTTON_OFFSET3</a> + <a class="code" href="Oopt1_8cpp.html#a34a22">PREF_BUTTON_WIDTH</a>, <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1)) + <a class="code" href="Oopt1_8cpp.html#a34a23">PREF_BUTTON_HEIGHT</a>);
00535                     vga.blt_buf(<a class="code" href="Oopt1_8cpp.html#a34a29">PREF_BUTTON_OFFSET4</a>, <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1)), <a class="code" href="Oopt1_8cpp.html#a34a29">PREF_BUTTON_OFFSET4</a> + <a class="code" href="Oopt1_8cpp.html#a34a22">PREF_BUTTON_WIDTH</a>, <a class="code" href="Oopt1_8cpp.html#a34a25">PREF_BUTTON_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1)) + <a class="code" href="Oopt1_8cpp.html#a34a23">PREF_BUTTON_HEIGHT</a>);
00536 
00537                     <span class="keywordtype">double</span> *importWeight = (i &lt; <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? &amp;(finance.revenue_policy_array[i].import_weight) : &amp;(finance.expense_policy_array[i - <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>].import_weight);
00538                     <span class="keywordflow">if</span>(j==0)
00539                         *importWeight = <a class="code" href="Ofinanc2_8h.html#a0">OPT_LOW_WEIGHT</a>;
00540                     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(j==1)
00541                         *importWeight = <a class="code" href="Ofinanc2_8h.html#a1">OPT_MID_WEIGHT</a>;
00542                     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(j==2)
00543                         *importWeight = <a class="code" href="Ofinanc2_8h.html#a2">OPT_HIGH_WEIGHT</a>;
00544 
00545                     <span class="comment">//                                  *importWeight = double(j + 1) / 2.0;</span>
00546                     <span class="keywordflow">return</span> 1;
00547                 }
00548             }
00549         }
00550     }
00551 
00552     <span class="comment">//------- click on the help of an item ---------//</span>
00553 
00554     vga.use_back();
00555 
00556     <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a> + <a class="code" href="Ofinance_8h.html#a109a69">EXPENSE_POLICY_COUNT</a>; i++) {
00557         <span class="keywordflow">if</span>(help_button_array[i].<a class="code" href="classButton.html#a21">detect</a>()) {
00558             <a class="code" href="classString.html">String</a> str;
00559             str  = <a class="code" href="Gamedef_8h.html#a4">DIR_RES</a>;
00560             str += <span class="stringliteral">"SCORE"</span>;
00561 
00562             <a class="code" href="classResTxt.html">ResTxt</a> rs;
00563             rs.<a class="code" href="classResTxt.html#a2">init</a>(str);
00564 
00565             <span class="comment">// ## chwg1203 begin ////////////////////////</span>
00566             image_interface.put_back(<a class="code" href="Oopt1_8cpp.html#a32a6">REPORT_X1</a>+10,
00567                                      <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1))
00568                                      ,<span class="stringliteral">"QUEST_DN"</span>);
00569             vga.blt_buf(
00570                 <a class="code" href="Oopt1_8cpp.html#a32a6">REPORT_X1</a>+10,
00571                 <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1)),
00572                 <a class="code" href="Oopt1_8cpp.html#a32a6">REPORT_X1</a>+30,
00573                 <a class="code" href="Oopt1_8cpp.html#a34a15">FIRST_LINE_OFFSET</a> + <a class="code" href="Oopt1_8cpp.html#a34a13">LINE_SPACING</a> * (i + ((i &gt;= <a class="code" href="Ofinance_8h.html#a107a64">REVENUE_POLICY_COUNT</a>) ? 2 : 1))+20
00574                 );
00575             sys.back_view_mode=sys.view_mode;
00576             help_if.help_textlist.topic_id=rs.<a class="code" href="classResTxt.html#a7">locate_topic</a>(game_str_res.opt_stage1_str(i));
00577 
00578             <span class="keywordflow">if</span>(help_if.help_textlist.topic_id&gt;0) {
00579                 help_if.help_textlist.add_history(help_if.help_textlist.topic_id);
00580                 sys.set_view_mode(<a class="code" href="Osys_8h.html#a45a31">MODE_HELP_DESC</a>);
00581                 sys.redraw_all_flag = 1;
00582                 audio.play_wav(<span class="stringliteral">"BEEPS-1"</span>,audio.int_to_DsVolume(config.sound_effect_volume));
00583             }
00584             <span class="keywordflow">return</span> 1;
00585         }
00586     }
00587 
00588     <span class="keywordflow">return</span> 0;
00589 }
00590 
00591 <span class="comment">//---------- End of function Optimization::detect_stage_1 ------//</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:38:09 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
