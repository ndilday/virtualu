<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>NEWMAT7.CPP Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>NEWMAT7.CPP</h1><a href="NEWMAT7_8CPP.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Owner: Fred</span>
00002 <span class="comment">//$$ newmat7.cpp     Invert, solve, binary operations</span>
00003 
00004 <span class="comment">// Copyright (C) 1991,2,3,4: R B Davies</span>
00005 
00006 <span class="preprocessor">#include "include.h"</span>
00007 
00008 <span class="preprocessor">#include "newmat.h"</span>
00009 <span class="preprocessor">#include "newmatrc.h"</span>
00010 
00011 <span class="preprocessor">#ifdef use_namespace</span>
00012 <span class="preprocessor"></span><span class="keyword">namespace </span>NEWMAT {
00013 <span class="preprocessor">#endif</span>
00014 <span class="preprocessor"></span>
00015 <span class="preprocessor">#ifdef DO_REPORT</span>
00016 <span class="preprocessor"></span><span class="preprocessor">#define REPORT { static ExeCounter ExeCount(__LINE__,7); ++ExeCount; }</span>
00017 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00018"></a><a class="code" href="NEWMAT7_8CPP.html#a0">00018</a> <span class="preprocessor"></span><span class="preprocessor">#define REPORT {}</span>
00019 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00020 <span class="preprocessor"></span>
00021     <span class="comment">/***************************** solve routines ******************************/</span>
00022 
<a name="l00023"></a><a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a27">00023</a>     <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* GeneralMatrix::MakeSolver() {
00024         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00025             <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gm = <span class="keyword">new</span> <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#l6">CroutMatrix</a>(*<span class="keyword">this</span>);
00026         <a class="code" href="namespaceNEWMAT.html#a19">MatrixErrorNoSpace</a>(gm); gm-&gt;ReleaseAndDelete(); <span class="keywordflow">return</span> gm;
00027     }
00028 
<a name="l00029"></a><a class="code" href="classNEWMAT_1_1Matrix.html#a11">00029</a>     <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* Matrix::MakeSolver() {
00030         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00031             <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gm = <span class="keyword">new</span> <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#l6">CroutMatrix</a>(*<span class="keyword">this</span>);
00032         <a class="code" href="namespaceNEWMAT.html#a19">MatrixErrorNoSpace</a>(gm); gm-&gt;ReleaseAndDelete(); <span class="keywordflow">return</span> gm;
00033     }
00034 
<a name="l00035"></a><a class="code" href="classNEWMAT_1_1CroutMatrix.html#a6">00035</a>     <span class="keywordtype">void</span> CroutMatrix::Solver(<a class="code" href="classMatrixColX.html">MatrixColX</a>&amp; mcout, <span class="keyword">const</span> <a class="code" href="classMatrixColX.html">MatrixColX</a>&amp; mcin) {
00036         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00037             <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = mcin.<a class="code" href="classMatrixRowCol.html#m1">skip</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* el = mcin.<a class="code" href="classMatrixRowCol.html#m5">data</a>-<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* el1 = el;
00038             <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) *el++ = 0.0;
00039             el += mcin.<a class="code" href="classMatrixRowCol.html#m2">storage</a>; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a> - mcin.<a class="code" href="classMatrixRowCol.html#m1">skip</a> - mcin.<a class="code" href="classMatrixRowCol.html#m2">storage</a>;
00040             <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) *el++ = 0.0;
00041             <a class="code" href="classNEWMAT_1_1CroutMatrix.html#a2">lubksb</a>(el1, mcout.<a class="code" href="classMatrixRowCol.html#m1">skip</a>);
00042     }
00043 
00044     <span class="comment">// Do we need check for entirely zero output?</span>
00045 
<a name="l00046"></a><a class="code" href="classNEWMAT_1_1UpperTriangularMatrix.html#a12">00046</a>     <span class="keywordtype">void</span> UpperTriangularMatrix::Solver(<a class="code" href="classMatrixColX.html">MatrixColX</a>&amp; mcout,
00047                                        <span class="keyword">const</span> <a class="code" href="classMatrixColX.html">MatrixColX</a>&amp; mcin) {
00048         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00049             <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = mcin.<a class="code" href="classMatrixRowCol.html#m1">skip</a>-mcout.<a class="code" href="classMatrixRowCol.html#m1">skip</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* elx = mcin.<a class="code" href="classMatrixRowCol.html#m5">data</a>-<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>;
00050         <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>-- &gt; 0) *elx++ = 0.0;
00051         <span class="keywordtype">int</span> nr = mcin.<a class="code" href="classMatrixRowCol.html#m1">skip</a>+mcin.<a class="code" href="classMatrixRowCol.html#m2">storage</a>;
00052         elx = mcin.<a class="code" href="classMatrixRowCol.html#m5">data</a>+mcin.<a class="code" href="classMatrixRowCol.html#m2">storage</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* el = elx;
00053         <span class="keywordtype">int</span> j = mcout.<a class="code" href="classMatrixRowCol.html#m1">skip</a>+mcout.<a class="code" href="classMatrixRowCol.html#m2">storage</a>-nr; <span class="keywordtype">int</span> nc = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n2">ncols</a>-nr; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = nr-mcout.<a class="code" href="classMatrixRowCol.html#m1">skip</a>;
00054         <span class="keywordflow">while</span> (j-- &gt; 0) *elx++ = 0.0;
00055         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* Ael = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a> + (nr*(2*<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n2">ncols</a>-nr+1))/2; j = 0;
00056         <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>-- &gt; 0) {
00057             elx = el; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum = 0.0; <span class="keywordtype">int</span> jx = j++; Ael -= nc;
00058             <span class="keywordflow">while</span> (jx--) sum += *(--Ael) * *(--elx);
00059             elx--; *elx = (*elx - sum) / *(--Ael);
00060         }
00061     }
00062 
<a name="l00063"></a><a class="code" href="classNEWMAT_1_1LowerTriangularMatrix.html#a12">00063</a>     <span class="keywordtype">void</span> LowerTriangularMatrix::Solver(<a class="code" href="classMatrixColX.html">MatrixColX</a>&amp; mcout,
00064                                        <span class="keyword">const</span> <a class="code" href="classMatrixColX.html">MatrixColX</a>&amp; mcin) {
00065         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00066             <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = mcin.<a class="code" href="classMatrixRowCol.html#m1">skip</a>-mcout.<a class="code" href="classMatrixRowCol.html#m1">skip</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* elx = mcin.<a class="code" href="classMatrixRowCol.html#m5">data</a>-<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>;
00067         <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>-- &gt; 0) *elx++ = 0.0;
00068         <span class="keywordtype">int</span> nc = mcin.<a class="code" href="classMatrixRowCol.html#m1">skip</a>; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = nc+mcin.<a class="code" href="classMatrixRowCol.html#m2">storage</a>; elx = mcin.<a class="code" href="classMatrixRowCol.html#m5">data</a>+mcin.<a class="code" href="classMatrixRowCol.html#m2">storage</a>;
00069         <span class="keywordtype">int</span> nr = mcout.<a class="code" href="classMatrixRowCol.html#m1">skip</a>+mcout.<a class="code" href="classMatrixRowCol.html#m2">storage</a>; <span class="keywordtype">int</span> j = nr-<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>; <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = nr-nc;
00070         <span class="keywordflow">while</span> (j-- &gt; 0) *elx++ = 0.0;
00071         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* el = mcin.<a class="code" href="classMatrixRowCol.html#m5">data</a>; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* Ael = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a> + (nc*(nc+1))/2; j = 0;
00072         <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>-- &gt; 0) {
00073             elx = el; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> sum = 0.0; <span class="keywordtype">int</span> jx = j++; Ael += nc;
00074             <span class="keywordflow">while</span> (jx--) sum += *Ael++ * *elx++;
00075             *elx = (*elx - sum) / *Ael++;
00076         }
00077     }
00078 
00079     <span class="comment">/******************* carry out binary operations *************************/</span>
00080 
00081     <span class="keyword">static</span> GeneralMatrix*
00082     GeneralAdd(GeneralMatrix*,GeneralMatrix*,AddedMatrix*,MatrixType);
00083     <span class="keyword">static</span> GeneralMatrix*
00084     GeneralSub(GeneralMatrix*,GeneralMatrix*,SubtractedMatrix*,MatrixType);
00085     <span class="keyword">static</span> GeneralMatrix*
00086     GeneralMult(GeneralMatrix*,GeneralMatrix*,MultipliedMatrix*,MatrixType);
00087     <span class="keyword">static</span> GeneralMatrix*
00088     GeneralSolv(GeneralMatrix*,GeneralMatrix*,BaseMatrix*,MatrixType);
00089     <span class="keyword">static</span> GeneralMatrix*
00090     GeneralSP(GeneralMatrix*,GeneralMatrix*,SPMatrix*,MatrixType);
00091     <span class="keyword">static</span> GeneralMatrix*
00092     GeneralElmDivide(GeneralMatrix*,GeneralMatrix*,ElmDivideMatrix*,MatrixType);
00093 
<a name="l00094"></a><a class="code" href="classNEWMAT_1_1AddedMatrix.html#a0">00094</a>     <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* AddedMatrix::Evaluate(<a class="code" href="classNEWMAT_1_1MatrixType.html">MatrixType</a> mt) {
00095         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00096             <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>=((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>*&amp;)<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n0">bm1</a>)-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a0">Evaluate</a>();
00097         <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>=((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>*&amp;)<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n2">bm2</a>)-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a0">Evaluate</a>();
00098 <span class="preprocessor">#ifdef TEMPS_DESTROYED_QUICKLY</span>
00099 <span class="preprocessor"></span>        <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gmx;
00100         Try { gmx = GeneralAdd(<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>,<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>,<span class="keyword">this</span>,mt); }
00101         CatchAll { <span class="keyword">delete</span> <span class="keyword">this</span>; ReThrow; }
00102         <span class="keyword">delete</span> <span class="keyword">this</span>; <span class="keywordflow">return</span> gmx;
00103 <span class="preprocessor">#else</span>
00104 <span class="preprocessor"></span>        <span class="keywordflow">return</span> GeneralAdd(<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>,<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>,<span class="keyword">this</span>,mt);
00105 <span class="preprocessor">#endif</span>
00106 <span class="preprocessor"></span>    }
00107 
<a name="l00108"></a><a class="code" href="classNEWMAT_1_1SubtractedMatrix.html#a0">00108</a>     <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* SubtractedMatrix::Evaluate(<a class="code" href="classNEWMAT_1_1MatrixType.html">MatrixType</a> mt) {
00109         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00110             <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>=((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>*&amp;)<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n0">bm1</a>)-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a0">Evaluate</a>();
00111         <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>=((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>*&amp;)<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n2">bm2</a>)-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a0">Evaluate</a>();
00112 <span class="preprocessor">#ifdef TEMPS_DESTROYED_QUICKLY</span>
00113 <span class="preprocessor"></span>        <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gmx;
00114         Try { gmx = GeneralSub(<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>,<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>,<span class="keyword">this</span>,mt); }
00115         CatchAll { <span class="keyword">delete</span> <span class="keyword">this</span>; ReThrow; }
00116         <span class="keyword">delete</span> <span class="keyword">this</span>; <span class="keywordflow">return</span> gmx;
00117 <span class="preprocessor">#else</span>
00118 <span class="preprocessor"></span>        <span class="keywordflow">return</span> GeneralSub(<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>,<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>,<span class="keyword">this</span>,mt);
00119 <span class="preprocessor">#endif</span>
00120 <span class="preprocessor"></span>    }
00121 
<a name="l00122"></a><a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#a0">00122</a>     <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* MultipliedMatrix::Evaluate(<a class="code" href="classNEWMAT_1_1MatrixType.html">MatrixType</a> mt) {
00123         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00124             <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a> = ((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>*&amp;)<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n2">bm2</a>)-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a0">Evaluate</a>();
00125         <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a> = <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a0">Evaluate</a>(<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a1">Type</a>().<a class="code" href="classNEWMAT_1_1MatrixType.html#a16">MultRHS</a>());   <span class="comment">// no symmetric on RHS</span>
00126         <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>=((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>*&amp;)<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n0">bm1</a>)-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a0">Evaluate</a>();
00127 <span class="preprocessor">#ifdef TEMPS_DESTROYED_QUICKLY</span>
00128 <span class="preprocessor"></span>        <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gmx;
00129         Try { gmx = GeneralMult(<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>, <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>, <span class="keyword">this</span>, mt); }
00130         CatchAll { <span class="keyword">delete</span> <span class="keyword">this</span>; ReThrow; }
00131         <span class="keyword">delete</span> <span class="keyword">this</span>; <span class="keywordflow">return</span> gmx;
00132 <span class="preprocessor">#else</span>
00133 <span class="preprocessor"></span>        <span class="keywordflow">return</span> GeneralMult(<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>, <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>, <span class="keyword">this</span>, mt);
00134 <span class="preprocessor">#endif</span>
00135 <span class="preprocessor"></span>    }
00136 
<a name="l00137"></a><a class="code" href="classNEWMAT_1_1SolvedMatrix.html#a0">00137</a>     <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* SolvedMatrix::Evaluate(<a class="code" href="classNEWMAT_1_1MatrixType.html">MatrixType</a> mt) {
00138         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00139             <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>=((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>*&amp;)<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n0">bm1</a>)-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a0">Evaluate</a>();
00140         <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>=((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>*&amp;)<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n2">bm2</a>)-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a0">Evaluate</a>();
00141 <span class="preprocessor">#ifdef TEMPS_DESTROYED_QUICKLY</span>
00142 <span class="preprocessor"></span>        <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gmx;
00143         Try { gmx = GeneralSolv(<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>,<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>,<span class="keyword">this</span>,mt); }
00144         CatchAll { <span class="keyword">delete</span> <span class="keyword">this</span>; ReThrow; }
00145         <span class="keyword">delete</span> <span class="keyword">this</span>; <span class="keywordflow">return</span> gmx;
00146 <span class="preprocessor">#else</span>
00147 <span class="preprocessor"></span>        <span class="keywordflow">return</span> GeneralSolv(<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>,<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>,<span class="keyword">this</span>,mt);
00148 <span class="preprocessor">#endif</span>
00149 <span class="preprocessor"></span>    }
00150 
<a name="l00151"></a><a class="code" href="classNEWMAT_1_1SPMatrix.html#a0">00151</a>     <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* SPMatrix::Evaluate(<a class="code" href="classNEWMAT_1_1MatrixType.html">MatrixType</a> mt) {
00152         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00153             <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>=((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>*&amp;)<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n0">bm1</a>)-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a0">Evaluate</a>();
00154         <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>=((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>*&amp;)<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n2">bm2</a>)-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a0">Evaluate</a>();
00155 <span class="preprocessor">#ifdef TEMPS_DESTROYED_QUICKLY</span>
00156 <span class="preprocessor"></span>        <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gmx;
00157         Try { gmx = GeneralSP(<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>,<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>,<span class="keyword">this</span>,mt); }
00158         CatchAll { <span class="keyword">delete</span> <span class="keyword">this</span>; ReThrow; }
00159         <span class="keyword">delete</span> <span class="keyword">this</span>; <span class="keywordflow">return</span> gmx;
00160 <span class="preprocessor">#else</span>
00161 <span class="preprocessor"></span>        <span class="keywordflow">return</span> GeneralSP(<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>,<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>,<span class="keyword">this</span>,mt);
00162 <span class="preprocessor">#endif</span>
00163 <span class="preprocessor"></span>    }
00164 
<a name="l00165"></a><a class="code" href="classNEWMAT_1_1ElmDivideMatrix.html#a0">00165</a>     <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* ElmDivideMatrix::Evaluate(<a class="code" href="classNEWMAT_1_1MatrixType.html">MatrixType</a> mt) {
00166         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00167             <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>=((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>*&amp;)<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n0">bm1</a>)-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a0">Evaluate</a>();
00168         <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>=((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>*&amp;)<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n2">bm2</a>)-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a0">Evaluate</a>();
00169 <span class="preprocessor">#ifdef TEMPS_DESTROYED_QUICKLY</span>
00170 <span class="preprocessor"></span>        <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gmx;
00171         Try { gmx = GeneralElmDivide(<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>,<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>,<span class="keyword">this</span>,mt); }
00172         CatchAll { <span class="keyword">delete</span> <span class="keyword">this</span>; ReThrow; }
00173         <span class="keyword">delete</span> <span class="keyword">this</span>; <span class="keywordflow">return</span> gmx;
00174 <span class="preprocessor">#else</span>
00175 <span class="preprocessor"></span>        <span class="keywordflow">return</span> GeneralElmDivide(<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>,<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>,<span class="keyword">this</span>,mt);
00176 <span class="preprocessor">#endif</span>
00177 <span class="preprocessor"></span>    }
00178 
00179     <span class="comment">// routines for adding or subtracting matrices of identical storage structure</span>
00180 
00181     <span class="keyword">static</span> <span class="keywordtype">void</span> Add(GeneralMatrix* gm, GeneralMatrix* gm1, GeneralMatrix* gm2) {
00182         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00183             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s1=gm1-&gt;Store(); <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s2=gm2-&gt;Store();
00184         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s=gm-&gt;Store(); <span class="keywordtype">int</span> i=gm-&gt;Storage() &gt;&gt; 2;
00185         <span class="keywordflow">while</span> (i--) {
00186             *s++ = *s1++ + *s2++; *s++ = *s1++ + *s2++;
00187             *s++ = *s1++ + *s2++; *s++ = *s1++ + *s2++;
00188         }
00189         i=gm-&gt;Storage() &amp; 3; <span class="keywordflow">while</span> (i--) *s++ = *s1++ + *s2++;
00190     }
00191 
00192     <span class="keyword">static</span> <span class="keywordtype">void</span> Add(GeneralMatrix* gm, GeneralMatrix* gm2) {
00193         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00194             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s2=gm2-&gt;Store(); <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s=gm-&gt;Store(); <span class="keywordtype">int</span> i=gm-&gt;Storage() &gt;&gt; 2;
00195             <span class="keywordflow">while</span> (i--)
00196             { *s++ += *s2++; *s++ += *s2++; *s++ += *s2++; *s++ += *s2++; }
00197             i=gm-&gt;Storage() &amp; 3; <span class="keywordflow">while</span> (i--) *s++ += *s2++;
00198     }
00199 
00200     <span class="keyword">static</span> <span class="keywordtype">void</span> Subtract(GeneralMatrix* gm, GeneralMatrix* gm1, GeneralMatrix* gm2) {
00201         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00202             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s1=gm1-&gt;Store(); <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s2=gm2-&gt;Store();
00203         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s=gm-&gt;Store(); <span class="keywordtype">int</span> i=gm-&gt;Storage() &gt;&gt; 2;
00204         <span class="keywordflow">while</span> (i--) {
00205             *s++ = *s1++ - *s2++; *s++ = *s1++ - *s2++;
00206             *s++ = *s1++ - *s2++; *s++ = *s1++ - *s2++;
00207         }
00208         i=gm-&gt;Storage() &amp; 3; <span class="keywordflow">while</span> (i--) *s++ = *s1++ - *s2++;
00209     }
00210 
00211     <span class="keyword">static</span> <span class="keywordtype">void</span> Subtract(GeneralMatrix* gm, GeneralMatrix* gm2) {
00212         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00213             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s2=gm2-&gt;Store(); <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s=gm-&gt;Store(); <span class="keywordtype">int</span> i=gm-&gt;Storage() &gt;&gt; 2;
00214             <span class="keywordflow">while</span> (i--)
00215             { *s++ -= *s2++; *s++ -= *s2++; *s++ -= *s2++; *s++ -= *s2++; }
00216             i=gm-&gt;Storage() &amp; 3; <span class="keywordflow">while</span> (i--) *s++ -= *s2++;
00217     }
00218 
00219     <span class="keyword">static</span> <span class="keywordtype">void</span> ReverseSubtract(GeneralMatrix* gm, GeneralMatrix* gm2) {
00220         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00221             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s2=gm2-&gt;Store(); <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s=gm-&gt;Store(); <span class="keywordtype">int</span> i=gm-&gt;Storage() &gt;&gt; 2;
00222             <span class="keywordflow">while</span> (i--) {
00223                 *s = *s2++ - *s; s++; *s = *s2++ - *s; s++;
00224                 *s = *s2++ - *s; s++; *s = *s2++ - *s; s++;
00225             }
00226             i=gm-&gt;Storage() &amp; 3; <span class="keywordflow">while</span> (i--) { *s = *s2++ - *s; s++; }
00227     }
00228 
00229     <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespaceNEWMAT.html#a46">SP</a>(GeneralMatrix* gm, GeneralMatrix* gm1, GeneralMatrix* gm2) {
00230         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00231             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s1=gm1-&gt;Store(); <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s2=gm2-&gt;Store();
00232         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s=gm-&gt;Store(); <span class="keywordtype">int</span> i=gm-&gt;Storage() &gt;&gt; 2;
00233         <span class="keywordflow">while</span> (i--) {
00234             *s++ = *s1++ * *s2++; *s++ = *s1++ * *s2++;
00235             *s++ = *s1++ * *s2++; *s++ = *s1++ * *s2++;
00236         }
00237         i=gm-&gt;Storage() &amp; 3; <span class="keywordflow">while</span> (i--) *s++ = *s1++ * *s2++;
00238     }
00239 
00240     <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespaceNEWMAT.html#a46">SP</a>(GeneralMatrix* gm, GeneralMatrix* gm2) {
00241         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00242             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s2=gm2-&gt;Store(); <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s=gm-&gt;Store(); <span class="keywordtype">int</span> i=gm-&gt;Storage() &gt;&gt; 2;
00243             <span class="keywordflow">while</span> (i--)
00244             { *s++ *= *s2++; *s++ *= *s2++; *s++ *= *s2++; *s++ *= *s2++; }
00245             i=gm-&gt;Storage() &amp; 3; <span class="keywordflow">while</span> (i--) *s++ *= *s2++;
00246     }
00247 
00248     <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespaceNEWMAT.html#a47">ElmDivide</a>(GeneralMatrix* gm, GeneralMatrix* gm1, GeneralMatrix* gm2) {
00249         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00250             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s1=gm1-&gt;Store(); <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s2=gm2-&gt;Store();
00251         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s=gm-&gt;Store(); <span class="keywordtype">int</span> i=gm-&gt;Storage() &gt;&gt; 2;
00252         <span class="keywordflow">while</span> (i--) {
00253             *s++ = *s1++ / *s2++; *s++ = *s1++ / *s2++;
00254             *s++ = *s1++ / *s2++; *s++ = *s1++ / *s2++;
00255         }
00256         i=gm-&gt;Storage() &amp; 3; <span class="keywordflow">while</span> (i--) *s++ = *s1++ / *s2++;
00257     }
00258 
00259     <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespaceNEWMAT.html#a47">ElmDivide</a>(GeneralMatrix* gm, GeneralMatrix* gm2) {
00260         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00261             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s2=gm2-&gt;Store(); <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s=gm-&gt;Store(); <span class="keywordtype">int</span> i=gm-&gt;Storage() &gt;&gt; 2;
00262             <span class="keywordflow">while</span> (i--)
00263             { *s++ /= *s2++; *s++ /= *s2++; *s++ /= *s2++; *s++ /= *s2++; }
00264             i=gm-&gt;Storage() &amp; 3; <span class="keywordflow">while</span> (i--) *s++ /= *s2++;
00265     }
00266 
00267     <span class="comment">// routines for adding or subtracting matrices of different storage structure</span>
00268 
00269     <span class="keyword">static</span> <span class="keywordtype">void</span> AddDS(GeneralMatrix* gm, GeneralMatrix* gm1, GeneralMatrix* gm2) {
00270         <span class="keywordtype">int</span> nr = gm-&gt;Nrows();
00271         <a class="code" href="classMatrixRow.html">MatrixRow</a> mr1(gm1, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>); <a class="code" href="classMatrixRow.html">MatrixRow</a> mr2(gm2, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>);
00272         <a class="code" href="classMatrixRow.html">MatrixRow</a> mr(gm, <a class="code" href="NEWMATRC_8H.html#a6a2">StoreOnExit</a>+<a class="code" href="NEWMATRC_8H.html#a6a3">DirectPart</a>);
00273         <span class="keywordflow">while</span> (nr--) { mr.<a class="code" href="classMatrixRowCol.html#a4">Add</a>(mr1,mr2); mr1.<a class="code" href="classMatrixRow.html#a2">Next</a>(); mr2.<a class="code" href="classMatrixRow.html#a2">Next</a>(); mr.<a class="code" href="classMatrixRow.html#a2">Next</a>(); }
00274     }
00275 
00276     <span class="keyword">static</span> <span class="keywordtype">void</span> AddDS(GeneralMatrix* gm, GeneralMatrix* gm2) {
00277         <span class="comment">// Add into first argument</span>
00278         <span class="keywordtype">int</span> nr = gm-&gt;Nrows();
00279         <a class="code" href="classMatrixRow.html">MatrixRow</a> mr(gm, <a class="code" href="NEWMATRC_8H.html#a6a2">StoreOnExit</a>+<a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>+<a class="code" href="NEWMATRC_8H.html#a6a3">DirectPart</a>);
00280         <a class="code" href="classMatrixRow.html">MatrixRow</a> mr2(gm2, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>);
00281         <span class="keywordflow">while</span> (nr--) { mr.<a class="code" href="classMatrixRowCol.html#a4">Add</a>(mr2); mr.<a class="code" href="classMatrixRow.html#a2">Next</a>(); mr2.<a class="code" href="classMatrixRow.html#a2">Next</a>(); }
00282     }
00283 
00284     <span class="keyword">static</span> <span class="keywordtype">void</span> SubtractDS
00285     (GeneralMatrix* gm, GeneralMatrix* gm1, GeneralMatrix* gm2) {
00286         <span class="keywordtype">int</span> nr = gm-&gt;Nrows();
00287         <a class="code" href="classMatrixRow.html">MatrixRow</a> mr1(gm1, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>); <a class="code" href="classMatrixRow.html">MatrixRow</a> mr2(gm2, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>);
00288         <a class="code" href="classMatrixRow.html">MatrixRow</a> mr(gm, <a class="code" href="NEWMATRC_8H.html#a6a2">StoreOnExit</a>+<a class="code" href="NEWMATRC_8H.html#a6a3">DirectPart</a>);
00289         <span class="keywordflow">while</span> (nr--) { mr.<a class="code" href="classMatrixRowCol.html#a9">Sub</a>(mr1,mr2); mr1.<a class="code" href="classMatrixRow.html#a2">Next</a>(); mr2.<a class="code" href="classMatrixRow.html#a2">Next</a>(); mr.<a class="code" href="classMatrixRow.html#a2">Next</a>(); }
00290     }
00291 
00292     <span class="keyword">static</span> <span class="keywordtype">void</span> SubtractDS(GeneralMatrix* gm, GeneralMatrix* gm2) {
00293         <span class="keywordtype">int</span> nr = gm-&gt;Nrows();
00294         <a class="code" href="classMatrixRow.html">MatrixRow</a> mr(gm, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>+<a class="code" href="NEWMATRC_8H.html#a6a2">StoreOnExit</a>+<a class="code" href="NEWMATRC_8H.html#a6a3">DirectPart</a>);
00295         <a class="code" href="classMatrixRow.html">MatrixRow</a> mr2(gm2, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>);
00296         <span class="keywordflow">while</span> (nr--) { mr.<a class="code" href="classMatrixRowCol.html#a9">Sub</a>(mr2); mr.<a class="code" href="classMatrixRow.html#a2">Next</a>(); mr2.<a class="code" href="classMatrixRow.html#a2">Next</a>(); }
00297     }
00298 
00299     <span class="keyword">static</span> <span class="keywordtype">void</span> ReverseSubtractDS(GeneralMatrix* gm, GeneralMatrix* gm2) {
00300         <span class="keywordtype">int</span> nr = gm-&gt;Nrows();
00301         <a class="code" href="classMatrixRow.html">MatrixRow</a> mr(gm, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>+<a class="code" href="NEWMATRC_8H.html#a6a2">StoreOnExit</a>+<a class="code" href="NEWMATRC_8H.html#a6a3">DirectPart</a>);
00302         <a class="code" href="classMatrixRow.html">MatrixRow</a> mr2(gm2, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>);
00303         <span class="keywordflow">while</span> (nr--) { mr.<a class="code" href="classMatrixRowCol.html#a11">RevSub</a>(mr2); mr2.<a class="code" href="classMatrixRow.html#a2">Next</a>(); mr.<a class="code" href="classMatrixRow.html#a2">Next</a>(); }
00304     }
00305 
00306     <span class="keyword">static</span> <span class="keywordtype">void</span> SPDS(GeneralMatrix* gm, GeneralMatrix* gm1, GeneralMatrix* gm2) {
00307         <span class="keywordtype">int</span> nr = gm-&gt;Nrows();
00308         <a class="code" href="classMatrixRow.html">MatrixRow</a> mr1(gm1, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>); <a class="code" href="classMatrixRow.html">MatrixRow</a> mr2(gm2, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>);
00309         <a class="code" href="classMatrixRow.html">MatrixRow</a> mr(gm, <a class="code" href="NEWMATRC_8H.html#a6a2">StoreOnExit</a>+<a class="code" href="NEWMATRC_8H.html#a6a3">DirectPart</a>);
00310         <span class="keywordflow">while</span> (nr--) { mr.<a class="code" href="classMatrixRowCol.html#a13">Multiply</a>(mr1,mr2); mr1.<a class="code" href="classMatrixRow.html#a2">Next</a>(); mr2.<a class="code" href="classMatrixRow.html#a2">Next</a>(); mr.<a class="code" href="classMatrixRow.html#a2">Next</a>(); }
00311     }
00312 
00313     <span class="keyword">static</span> <span class="keywordtype">void</span> SPDS(GeneralMatrix* gm, GeneralMatrix* gm2) {
00314         <span class="comment">// SP into first argument</span>
00315         <span class="keywordtype">int</span> nr = gm-&gt;Nrows();
00316         <a class="code" href="classMatrixRow.html">MatrixRow</a> mr(gm, <a class="code" href="NEWMATRC_8H.html#a6a2">StoreOnExit</a>+<a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>+<a class="code" href="NEWMATRC_8H.html#a6a3">DirectPart</a>);
00317         <a class="code" href="classMatrixRow.html">MatrixRow</a> mr2(gm2, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>);
00318         <span class="keywordflow">while</span> (nr--) { mr.<a class="code" href="classMatrixRowCol.html#a13">Multiply</a>(mr2); mr.<a class="code" href="classMatrixRow.html#a2">Next</a>(); mr2.<a class="code" href="classMatrixRow.html#a2">Next</a>(); }
00319     }
00320 
00321 <span class="preprocessor">#ifdef __GNUG__</span>
00322 <span class="preprocessor"></span>    <span class="keywordtype">void</span> AddedMatrix::SelectVersion
00323     (MatrixType mtx, <span class="keywordtype">int</span>&amp; c1, <span class="keywordtype">int</span>&amp; c2) <span class="keyword">const</span>
00324 <span class="preprocessor">#else</span>
00325 <span class="preprocessor"></span>        <span class="keywordtype">void</span> AddedMatrix::SelectVersion
<a name="l00326"></a><a class="code" href="classNEWMAT_1_1AddedMatrix.html#a2">00326</a>     (<a class="code" href="classNEWMAT_1_1MatrixType.html">MatrixType</a> mtx, <span class="keywordtype">bool</span>&amp; c1, <span class="keywordtype">bool</span>&amp; c2) <span class="keyword">const</span>
00327 <span class="preprocessor">#endif</span>
00328 <span class="preprocessor"></span>    {
00329         <span class="comment">// for determining version of add and subtract routines</span>
00330         <span class="comment">// will need to modify if further matrix structures are introduced</span>
00331         <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html">MatrixBandWidth</a> bw1 = gm1-&gt;BandWidth();
00332         <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html">MatrixBandWidth</a> bw2 = gm2-&gt;BandWidth();
00333         <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html">MatrixBandWidth</a> bwx(-1); <span class="keywordflow">if</span> (mtx.IsBand()) bwx = bw1 + bw2;
00334         c1 = (mtx == gm1-&gt;Type()) &amp;&amp; (bwx == bw1);
00335         c2 = (mtx == gm2-&gt;Type()) &amp;&amp; (bwx == bw2);
00336     }
00337 
00338     <span class="keyword">static</span> GeneralMatrix* GeneralAdd(GeneralMatrix* gm1, GeneralMatrix* gm2,
00339                                      AddedMatrix* am, MatrixType mtx) {
00340         <a class="code" href="classTracer.html">Tracer</a> tr(<span class="stringliteral">"GeneralAdd"</span>);
00341         <span class="keywordtype">int</span> nr=gm1-&gt;Nrows(); <span class="keywordtype">int</span> nc=gm1-&gt;Ncols();
00342         <span class="keywordflow">if</span> (nr!=gm2-&gt;Nrows() || nc!=gm2-&gt;Ncols())
00343             Throw(IncompatibleDimensionsException(*gm1, *gm2));
00344         <a class="code" href="namespaceNEWMAT.html#a45">Compare</a>(gm1-&gt;Type() + gm2-&gt;Type(),mtx);
00345 <span class="preprocessor">#ifdef __GNUG__</span>
00346 <span class="preprocessor"></span>        <span class="keywordtype">int</span> c1,c2; am-&gt;SelectVersion(mtx,c1,c2);
00347 <span class="preprocessor">#else</span>
00348 <span class="preprocessor"></span>        <span class="keywordtype">bool</span> c1,c2; am-&gt;SelectVersion(mtx,c1,c2);     <span class="comment">// causes problems for g++</span>
00349 <span class="preprocessor">#endif</span>
00350 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (c1 &amp;&amp; c2) {
00351             <span class="keywordflow">if</span> (gm1-&gt;reuse()) { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a> Add(gm1,gm2); gm2-&gt;tDelete(); <span class="keywordflow">return</span> gm1; }
00352             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (gm2-&gt;reuse()) { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a> Add(gm2,gm1); <span class="keywordflow">return</span> gm2; }
00353             <span class="keywordflow">else</span> {
00354                 <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a> GeneralMatrix* gmx = gm1-&gt;Type().New(nr,nc,am);
00355                 gmx-&gt;ReleaseAndDelete(); Add(gmx,gm1,gm2); <span class="keywordflow">return</span> gmx;
00356             }
00357         }
00358         <span class="keywordflow">else</span> {
00359             <span class="keywordflow">if</span> (c1 &amp;&amp; gm1-&gt;reuse() )                    <span class="comment">// must have type test first</span>
00360             { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a> AddDS(gm1,gm2); gm2-&gt;tDelete(); <span class="keywordflow">return</span> gm1; }
00361             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c2 &amp;&amp; gm2-&gt;reuse() )
00362             { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a> AddDS(gm2,gm1); <span class="keywordflow">if</span> (!c1) gm1-&gt;tDelete(); <span class="keywordflow">return</span> gm2; }
00363             <span class="keywordflow">else</span> {
00364                 <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00365                     GeneralMatrix* gmx = mtx.New(nr,nc,am); AddDS(gmx,gm1,gm2);
00366                 <span class="keywordflow">if</span> (!c1) gm1-&gt;tDelete(); <span class="keywordflow">if</span> (!c2) gm2-&gt;tDelete();
00367                 gmx-&gt;ReleaseAndDelete(); <span class="keywordflow">return</span> gmx;
00368             }
00369         }
00370     }
00371 
00372     <span class="keyword">static</span> GeneralMatrix* GeneralSub(GeneralMatrix* gm1, GeneralMatrix* gm2,
00373                                      SubtractedMatrix* sm, MatrixType mtx) {
00374         <a class="code" href="classTracer.html">Tracer</a> tr(<span class="stringliteral">"GeneralSub"</span>);
00375         <a class="code" href="namespaceNEWMAT.html#a45">Compare</a>(gm1-&gt;Type() + gm2-&gt;Type(),mtx);
00376         <span class="keywordtype">int</span> nr=gm1-&gt;Nrows(); <span class="keywordtype">int</span> nc=gm1-&gt;Ncols();
00377         <span class="keywordflow">if</span> (nr!=gm2-&gt;Nrows() || nc!=gm2-&gt;Ncols())
00378             Throw(IncompatibleDimensionsException(*gm1, *gm2));
00379 <span class="preprocessor">#ifdef __GNUG__</span>
00380 <span class="preprocessor"></span>        <span class="keywordtype">int</span> c1,c2; sm-&gt;SelectVersion(mtx,c1,c2);
00381 <span class="preprocessor">#else</span>
00382 <span class="preprocessor"></span>        <span class="keywordtype">bool</span> c1,c2; sm-&gt;SelectVersion(mtx,c1,c2);     <span class="comment">// causes problems for g++</span>
00383 <span class="preprocessor">#endif</span>
00384 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (c1 &amp;&amp; c2) {
00385             <span class="keywordflow">if</span> (gm1-&gt;reuse())
00386             { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a> Subtract(gm1,gm2); gm2-&gt;tDelete(); <span class="keywordflow">return</span> gm1; }
00387             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (gm2-&gt;reuse()) { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a> ReverseSubtract(gm2,gm1); <span class="keywordflow">return</span> gm2; }
00388             <span class="keywordflow">else</span> {
00389                 <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00390                     GeneralMatrix* gmx = gm1-&gt;Type().New(nr,nc,sm);
00391                 gmx-&gt;ReleaseAndDelete(); Subtract(gmx,gm1,gm2); <span class="keywordflow">return</span> gmx;
00392             }
00393         }
00394         <span class="keywordflow">else</span> {
00395             <span class="keywordflow">if</span> ( c1 &amp;&amp; gm1-&gt;reuse() )
00396             { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>  SubtractDS(gm1,gm2); gm2-&gt;tDelete(); <span class="keywordflow">return</span> gm1; }
00397             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( c2 &amp;&amp; gm2-&gt;reuse() ) {
00398                 <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00399                     ReverseSubtractDS(gm2,gm1); <span class="keywordflow">if</span> (!c1) gm1-&gt;tDelete(); <span class="keywordflow">return</span> gm2;
00400             }
00401             <span class="keywordflow">else</span> {
00402                 <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00403                     GeneralMatrix* gmx = mtx.New(nr,nc,sm); SubtractDS(gmx,gm1,gm2);
00404                 <span class="keywordflow">if</span> (!c1) gm1-&gt;tDelete(); <span class="keywordflow">if</span> (!c2) gm2-&gt;tDelete();
00405                 gmx-&gt;ReleaseAndDelete(); <span class="keywordflow">return</span> gmx;
00406             }
00407         }
00408     }
00409 
00410     <span class="keyword">static</span> GeneralMatrix* GeneralMult1(GeneralMatrix* gm1, GeneralMatrix* gm2,
00411                                        MultipliedMatrix* mm, MatrixType mtx) {
00412         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00413             <a class="code" href="classTracer.html">Tracer</a> tr(<span class="stringliteral">"GeneralMult1"</span>);
00414         <span class="keywordtype">int</span> nr=gm1-&gt;Nrows(); <span class="keywordtype">int</span> nc=gm2-&gt;Ncols();
00415         <span class="keywordflow">if</span> (gm1-&gt;Ncols() !=gm2-&gt;Nrows())
00416             Throw(IncompatibleDimensionsException(*gm1, *gm2));
00417         GeneralMatrix* gmx = mtx.New(nr,nc,mm);
00418 
00419         <a class="code" href="classMatrixCol.html">MatrixCol</a> mcx(gmx, <a class="code" href="NEWMATRC_8H.html#a6a2">StoreOnExit</a>+<a class="code" href="NEWMATRC_8H.html#a6a3">DirectPart</a>);
00420         <a class="code" href="classMatrixCol.html">MatrixCol</a> mc2(gm2, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>);
00421         <span class="keywordflow">while</span> (nc--) {
00422             <a class="code" href="classMatrixRow.html">MatrixRow</a> mr1(gm1, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>, mcx.<a class="code" href="classMatrixRowCol.html#a29">Skip</a>());
00423             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* el = mcx.<a class="code" href="classMatrixRowCol.html#a28">Data</a>();                      <span class="comment">// pointer to an element</span>
00424             <span class="keywordtype">int</span> n = mcx.<a class="code" href="classMatrixRowCol.html#a30">Storage</a>();
00425             <span class="keywordflow">while</span> (n--) { *(el++) = <a class="code" href="namespaceNEWMAT.html#a42">DotProd</a>(mr1,mc2); mr1.<a class="code" href="classMatrixRow.html#a2">Next</a>(); }
00426             mc2.<a class="code" href="classMatrixCol.html#a3">Next</a>(); mcx.<a class="code" href="classMatrixCol.html#a3">Next</a>();
00427         }
00428         gmx-&gt;ReleaseAndDelete(); gm1-&gt;tDelete(); gm2-&gt;tDelete(); <span class="keywordflow">return</span> gmx;
00429     }
00430 
00431     <span class="keyword">static</span> GeneralMatrix* GeneralMult2(GeneralMatrix* gm1, GeneralMatrix* gm2,
00432                                        MultipliedMatrix* mm, MatrixType mtx) {
00433         <span class="comment">// version that accesses by row only - not good for thin matrices</span>
00434         <span class="comment">// or column vectors in right hand term. Needs fixing</span>
00435         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00436             <a class="code" href="classTracer.html">Tracer</a> tr(<span class="stringliteral">"GeneralMult2"</span>);
00437         <span class="keywordtype">int</span> nr=gm1-&gt;Nrows(); <span class="keywordtype">int</span> nc=gm2-&gt;Ncols();
00438         <span class="keywordflow">if</span> (gm1-&gt;Ncols() !=gm2-&gt;Nrows())
00439             Throw(IncompatibleDimensionsException(*gm1, *gm2));
00440         GeneralMatrix* gmx = mtx.New(nr,nc,mm);
00441 
00442         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* el = gmx-&gt;Store(); <span class="keywordtype">int</span> n = gmx-&gt;Storage();
00443         <span class="keywordflow">while</span> (n--) *el++ = 0.0;
00444         <a class="code" href="classMatrixRow.html">MatrixRow</a> mrx(gmx, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>+<a class="code" href="NEWMATRC_8H.html#a6a2">StoreOnExit</a>+<a class="code" href="NEWMATRC_8H.html#a6a3">DirectPart</a>);
00445         <a class="code" href="classMatrixRow.html">MatrixRow</a> mr1(gm1, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>);
00446         <span class="keywordflow">while</span> (nr--) {
00447             <a class="code" href="classMatrixRow.html">MatrixRow</a> mr2(gm2, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>, mr1.<a class="code" href="classMatrixRowCol.html#a29">Skip</a>());
00448             el = mr1.<a class="code" href="classMatrixRowCol.html#a28">Data</a>();                            <span class="comment">// pointer to an element</span>
00449             n = mr1.<a class="code" href="classMatrixRowCol.html#a30">Storage</a>();
00450             <span class="keywordflow">while</span> (n--) { mrx.<a class="code" href="classMatrixRowCol.html#a5">AddScaled</a>(mr2, *el++); mr2.<a class="code" href="classMatrixRow.html#a2">Next</a>(); }
00451             mr1.<a class="code" href="classMatrixRow.html#a2">Next</a>(); mrx.<a class="code" href="classMatrixRow.html#a2">Next</a>();
00452         }
00453         gmx-&gt;ReleaseAndDelete(); gm1-&gt;tDelete(); gm2-&gt;tDelete(); <span class="keywordflow">return</span> gmx;
00454     }
00455 
00456     <span class="keyword">static</span> GeneralMatrix* mmMult(GeneralMatrix* gm1, GeneralMatrix* gm2) {
00457         <span class="comment">// matrix multiplication for type Matrix only</span>
00458         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00459             <a class="code" href="classTracer.html">Tracer</a> tr(<span class="stringliteral">"MatrixMult"</span>);
00460 
00461         <span class="keywordtype">int</span> nr=gm1-&gt;Nrows(); <span class="keywordtype">int</span> ncr=gm1-&gt;Ncols(); <span class="keywordtype">int</span> nc=gm2-&gt;Ncols();
00462         <span class="keywordflow">if</span> (ncr != gm2-&gt;Nrows()) Throw(IncompatibleDimensionsException(*gm1,*gm2));
00463 
00464         <a class="code" href="classMatrix.html">Matrix</a>* gm = <span class="keyword">new</span> <a class="code" href="classMatrix.html">Matrix</a>(nr,nc); <a class="code" href="namespaceNEWMAT.html#a19">MatrixErrorNoSpace</a>(gm);
00465 
00466         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s1=gm1-&gt;Store(); <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s2=gm2-&gt;Store(); <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s=gm-&gt;Store();
00467 
00468         <span class="keywordflow">if</span> (ncr) {
00469             <span class="keywordflow">while</span> (nr--) {
00470                 <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s2x = s2; <span class="keywordtype">int</span> j = ncr;
00471                 <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* sx = s; <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> f = *s1++; <span class="keywordtype">int</span> k = nc;
00472                 <span class="keywordflow">while</span> (k--) *sx++ = f * *s2x++;
00473                 <span class="keywordflow">while</span> (--j)
00474                 { sx = s; f = *s1++; k = nc; <span class="keywordflow">while</span> (k--) *sx++ += f * *s2x++; }
00475                 s = sx;
00476             }
00477         }
00478         <span class="keywordflow">else</span> *gm = 0.0;
00479 
00480         gm-&gt;ReleaseAndDelete(); gm1-&gt;tDelete(); gm2-&gt;tDelete(); <span class="keywordflow">return</span> gm;
00481     }
00482 
00483     <span class="keyword">static</span> GeneralMatrix* GeneralMult(GeneralMatrix* gm1, GeneralMatrix* gm2,
00484                                       MultipliedMatrix* mm, MatrixType mtx) {
00485         <span class="keywordflow">if</span> ( <a class="code" href="NEWMAT1_8CPP.html#a0">Rectangular</a>(gm1-&gt;Type(), gm2-&gt;Type(), mtx)) <span class="keywordflow">return</span> mmMult(gm1, gm2);
00486         <span class="keywordflow">else</span> {
00487             <a class="code" href="namespaceNEWMAT.html#a45">Compare</a>(gm1-&gt;Type() * gm2-&gt;Type(),mtx);
00488             <span class="keywordtype">int</span> nr = gm2-&gt;Nrows(); <span class="keywordtype">int</span> nc = gm2-&gt;Ncols();
00489             <span class="keywordflow">if</span> (nc &lt;= 5 &amp;&amp; nr &gt; nc) <span class="keywordflow">return</span> GeneralMult1(gm1, gm2, mm, mtx);
00490             <span class="keywordflow">else</span> <span class="keywordflow">return</span> GeneralMult2(gm1, gm2, mm, mtx);
00491         }
00492     }
00493 
00494 <span class="preprocessor">#ifdef __GNUG__</span>
00495 <span class="preprocessor"></span>    <span class="keywordtype">void</span> SPMatrix::SelectVersion
00496     (MatrixType mtx, <span class="keywordtype">int</span>&amp; c1, <span class="keywordtype">int</span>&amp; c2) <span class="keyword">const</span>
00497 <span class="preprocessor">#else</span>
00498 <span class="preprocessor"></span>        <span class="keywordtype">void</span> SPMatrix::SelectVersion
<a name="l00499"></a><a class="code" href="classNEWMAT_1_1SPMatrix.html#a2">00499</a>     (<a class="code" href="classNEWMAT_1_1MatrixType.html">MatrixType</a> mtx, <span class="keywordtype">bool</span>&amp; c1, <span class="keywordtype">bool</span>&amp; c2) <span class="keyword">const</span>
00500 <span class="preprocessor">#endif</span>
00501 <span class="preprocessor"></span>    {
00502         <span class="comment">// for determining version of SP routines</span>
00503         <span class="comment">// will need to modify if further matrix structures are introduced</span>
00504         <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html">MatrixBandWidth</a> bw1 = gm1-&gt;BandWidth();
00505         <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html">MatrixBandWidth</a> bw2 = gm2-&gt;BandWidth();
00506         <a class="code" href="classNEWMAT_1_1MatrixBandWidth.html">MatrixBandWidth</a> bwx(-1);  <span class="keywordflow">if</span> (mtx.IsBand()) bwx = bw1.<a class="code" href="classNEWMAT_1_1MatrixBandWidth.html#a4">minimum</a>(bw2);
00507         c1 = (mtx == gm1-&gt;Type()) &amp;&amp; (bwx == bw1);
00508         c2 = (mtx == gm2-&gt;Type()) &amp;&amp; (bwx == bw2);
00509     }
00510 
00511     <span class="keyword">static</span> GeneralMatrix* GeneralSP(GeneralMatrix* gm1, GeneralMatrix* gm2,
00512                                     SPMatrix* am, MatrixType mtx) {
00513         <a class="code" href="classTracer.html">Tracer</a> tr(<span class="stringliteral">"GeneralSP"</span>);
00514         <span class="keywordtype">int</span> nr=gm1-&gt;Nrows(); <span class="keywordtype">int</span> nc=gm1-&gt;Ncols();
00515         <span class="keywordflow">if</span> (nr!=gm2-&gt;Nrows() || nc!=gm2-&gt;Ncols())
00516             Throw(IncompatibleDimensionsException(*gm1, *gm2));
00517         <a class="code" href="namespaceNEWMAT.html#a45">Compare</a>(gm1-&gt;Type().SP(gm2-&gt;Type()),mtx);
00518 <span class="preprocessor">#ifdef __GNUG__</span>
00519 <span class="preprocessor"></span>        <span class="keywordtype">int</span> c1,c2; am-&gt;SelectVersion(mtx,c1,c2);
00520 <span class="preprocessor">#else</span>
00521 <span class="preprocessor"></span>        <span class="keywordtype">bool</span> c1,c2; am-&gt;SelectVersion(mtx,c1,c2);     <span class="comment">// causes problems for g++</span>
00522 <span class="preprocessor">#endif</span>
00523 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (c1 &amp;&amp; c2) {
00524             <span class="keywordflow">if</span> (gm1-&gt;reuse()) { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a> <a class="code" href="namespaceNEWMAT.html#a46">SP</a>(gm1,gm2); gm2-&gt;tDelete(); <span class="keywordflow">return</span> gm1; }
00525             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (gm2-&gt;reuse()) { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a> <a class="code" href="namespaceNEWMAT.html#a46">SP</a>(gm2,gm1); <span class="keywordflow">return</span> gm2; }
00526             <span class="keywordflow">else</span> {
00527                 <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a> GeneralMatrix* gmx = gm1-&gt;Type().New(nr,nc,am);
00528                 gmx-&gt;ReleaseAndDelete(); <a class="code" href="namespaceNEWMAT.html#a46">SP</a>(gmx,gm1,gm2); <span class="keywordflow">return</span> gmx;
00529             }
00530         }
00531         <span class="keywordflow">else</span> {
00532             <span class="keywordflow">if</span> (c1 &amp;&amp; gm1-&gt;reuse() )                    <span class="comment">// must have type test first</span>
00533             { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a> SPDS(gm1,gm2); gm2-&gt;tDelete(); <span class="keywordflow">return</span> gm1; }
00534             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c2 &amp;&amp; gm2-&gt;reuse() )
00535             { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a> SPDS(gm2,gm1); <span class="keywordflow">if</span> (!c1) gm1-&gt;tDelete(); <span class="keywordflow">return</span> gm2; }
00536             <span class="keywordflow">else</span> {
00537                 <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00538                     GeneralMatrix* gmx = mtx.New(nr,nc,am); SPDS(gmx,gm1,gm2);
00539                 <span class="keywordflow">if</span> (!c1) gm1-&gt;tDelete(); <span class="keywordflow">if</span> (!c2) gm2-&gt;tDelete();
00540                 gmx-&gt;ReleaseAndDelete(); <span class="keywordflow">return</span> gmx;
00541             }
00542         }
00543     }
00544 
00545     <span class="comment">// fred 0512</span>
00546     <span class="keyword">static</span> GeneralMatrix* GeneralElmDivide(GeneralMatrix* gm1, GeneralMatrix* gm2,
00547                                            ElmDivideMatrix* am, MatrixType mtx) {
00548         <a class="code" href="classTracer.html">Tracer</a> tr(<span class="stringliteral">"GeneralElmDivide"</span>);
00549         <span class="keywordtype">int</span> nr=gm1-&gt;Nrows(); <span class="keywordtype">int</span> nc=gm1-&gt;Ncols();
00550         <span class="keywordflow">if</span> (nr!=gm2-&gt;Nrows() || nc!=gm2-&gt;Ncols())
00551             Throw(IncompatibleDimensionsException(*gm1, *gm2));
00552         <a class="code" href="namespaceNEWMAT.html#a45">Compare</a>(gm1-&gt;Type().SP(gm2-&gt;Type()),mtx);     <span class="comment">// BUG keep using SP's?</span>
00553 <span class="preprocessor">#ifdef __GNUG__</span>
00554 <span class="preprocessor"></span>        <span class="keywordtype">int</span> c1,c2; am-&gt;SelectVersion(mtx,c1,c2);
00555 <span class="preprocessor">#else</span>
00556 <span class="preprocessor"></span>        <span class="keywordtype">bool</span> c1,c2; am-&gt;SelectVersion(mtx,c1,c2);     <span class="comment">// causes problems for g++</span>
00557 <span class="preprocessor">#endif</span>
00558 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (c1 &amp;&amp; c2) {
00559             <span class="keywordflow">if</span> (gm1-&gt;reuse()) { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a> <a class="code" href="namespaceNEWMAT.html#a47">ElmDivide</a>(gm1,gm2); gm2-&gt;tDelete(); <span class="keywordflow">return</span> gm1; }
00560             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (gm2-&gt;reuse()) { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a> <a class="code" href="namespaceNEWMAT.html#a47">ElmDivide</a>(gm2,gm1); <span class="keywordflow">return</span> gm2; }
00561             <span class="keywordflow">else</span> {
00562                 <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a> GeneralMatrix* gmx = gm1-&gt;Type().New(nr,nc,am);
00563                 gmx-&gt;ReleaseAndDelete(); <a class="code" href="namespaceNEWMAT.html#a47">ElmDivide</a>(gmx,gm1,gm2); <span class="keywordflow">return</span> gmx;
00564             }
00565         }
00566         <span class="keywordflow">else</span> {
00567             <span class="keywordflow">return</span> gm1;                                 <span class="comment">// BUG here</span>
00568             <span class="comment">/*</span>
00569 <span class="comment">              if (c1 &amp;&amp; gm1-&gt;reuse() )               // must have type test first</span>
00570 <span class="comment">              {</span>
00571 <span class="comment">              //REPORT SPDS(gm1,gm2); gm2-&gt;tDelete(); return gm1;</span>
00572 <span class="comment">              }</span>
00573 <span class="comment">              else if (c2 &amp;&amp; gm2-&gt;reuse() )</span>
00574 <span class="comment">              {</span>
00575 <span class="comment">              //REPORT SPDS(gm2,gm1); if (!c1) gm1-&gt;tDelete(); return gm2;</span>
00576 <span class="comment">              }</span>
00577 <span class="comment">              else</span>
00578 <span class="comment">              {</span>
00579 <span class="comment">              REPORT</span>
00580 <span class="comment">              GeneralMatrix* gmx = mtx.New(nr,nc,am); SPDS(gmx,gm1,gm2);</span>
00581 <span class="comment">              if (!c1) gm1-&gt;tDelete(); if (!c2) gm2-&gt;tDelete();</span>
00582 <span class="comment">              gmx-&gt;ReleaseAndDelete(); return gmx;</span>
00583 <span class="comment">              }*/</span>
00584         }
00585     }
00586 
00587     <span class="keyword">static</span> GeneralMatrix* GeneralSolv(GeneralMatrix* gm1, GeneralMatrix* gm2,
00588                                       BaseMatrix* sm, MatrixType mtx) {
00589         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00590             <a class="code" href="classTracer.html">Tracer</a> tr(<span class="stringliteral">"GeneralSolv"</span>);
00591         <a class="code" href="namespaceNEWMAT.html#a45">Compare</a>(gm1-&gt;Type().i() * gm2-&gt;Type(),mtx);
00592         <span class="keywordtype">int</span> nr=gm1-&gt;Nrows(); <span class="keywordtype">int</span> nc=gm2-&gt;Ncols();
00593         <span class="keywordflow">if</span> (gm1-&gt;Ncols() != gm2-&gt;Nrows())
00594             Throw(IncompatibleDimensionsException(*gm1, *gm2));
00595         GeneralMatrix* gmx = mtx.New(nr,nc,sm); <a class="code" href="namespaceNEWMAT.html#a19">MatrixErrorNoSpace</a>(gmx);
00596         <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* r = <span class="keyword">new</span> <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> [nr]; <a class="code" href="namespaceNEWMAT.html#a19">MatrixErrorNoSpace</a>(r);
00597 <span class="preprocessor">#ifndef ATandT</span>
00598 <span class="preprocessor"></span>        <a class="code" href="MYEXCEPT_8H.html#a1">MONITOR_REAL_NEW</a>(<span class="stringliteral">"Make   (GenSolv)"</span>,nr,r)
00599             <span class="comment">// deleted for ATandT, to balance deletion below</span>
00600 #endif
00601             GeneralMatrix* gms = gm1-&gt;MakeSolver();
00602         Try {
00603             <span class="comment">// copy to and from r</span>
00604             <a class="code" href="classMatrixColX.html">MatrixColX</a> mcx(gmx, r, <a class="code" href="NEWMATRC_8H.html#a6a2">StoreOnExit</a>+<a class="code" href="NEWMATRC_8H.html#a6a3">DirectPart</a>);
00605             <span class="comment">// this must be inside Try so mcx is destroyed before gmx</span>
00606             <a class="code" href="classMatrixColX.html">MatrixColX</a> mc2(gm2, r, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>);
00607             <span class="keywordflow">while</span> (nc--) { gms-&gt;Solver(mcx, mc2); mcx.<a class="code" href="classMatrixColX.html#a2">Next</a>(); mc2.<a class="code" href="classMatrixColX.html#a2">Next</a>(); }
00608         }
00609         CatchAll {
00610             gms-&gt;tDelete();
00611             <span class="keyword">delete</span> gmx;                                 <span class="comment">// &lt;--------------------</span>
00612             gm2-&gt;tDelete();
00613 <span class="preprocessor">#ifndef ATandT</span>
00614 <span class="preprocessor"></span>            <a class="code" href="MYEXCEPT_8H.html#a3">MONITOR_REAL_DELETE</a>(<span class="stringliteral">"Delete (GenSolv)"</span>,nr,r)
00615                 <span class="comment">// ATandT version 2.1 gives an internal error</span>
00616 #endif
00617                 <span class="keyword">delete</span> [] r;
00618             ReThrow;
00619         }
00620         gms-&gt;tDelete(); gmx-&gt;ReleaseAndDelete(); gm2-&gt;tDelete();
00621 <span class="preprocessor">#ifndef ATandT</span>
00622 <span class="preprocessor"></span>        <a class="code" href="MYEXCEPT_8H.html#a3">MONITOR_REAL_DELETE</a>(<span class="stringliteral">"Delete (GenSolv)"</span>,nr,r)
00623             <span class="comment">// ATandT version 2.1 gives an internal error</span>
00624 #endif
00625             <span class="keyword">delete</span> [] r;
00626         <span class="keywordflow">return</span> gmx;
00627     }
00628 
<a name="l00629"></a><a class="code" href="classNEWMAT_1_1InvertedMatrix.html#a2">00629</a>     <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* InvertedMatrix::Evaluate(<a class="code" href="classNEWMAT_1_1MatrixType.html">MatrixType</a> mtx) {
00630         <span class="comment">// Matrix Inversion - use solve routines</span>
00631         <a class="code" href="classTracer.html">Tracer</a> tr(<span class="stringliteral">"InvertedMatrix::Evaluate"</span>);
00632         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00633             <a class="code" href="classNEWMAT_1_1NegatedMatrix.html#n1">gm</a>=((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>*&amp;)<a class="code" href="classNEWMAT_1_1NegatedMatrix.html#n0">bm</a>)-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a0">Evaluate</a>();
00634         <span class="keywordtype">int</span> n = <a class="code" href="classNEWMAT_1_1NegatedMatrix.html#n1">gm</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a2">Nrows</a>(); <a class="code" href="classNEWMAT_1_1DiagonalMatrix.html">DiagonalMatrix</a> I(n); I=1.0;
00635 <span class="preprocessor">#ifdef TEMPS_DESTROYED_QUICKLY</span>
00636 <span class="preprocessor"></span>        <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gmx;
00637         Try {
00638             <a class="code" href="namespaceNEWMAT.html#a45">Compare</a>(<a class="code" href="classNEWMAT_1_1NegatedMatrix.html#n1">gm</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a1">Type</a>().<a class="code" href="classNEWMAT_1_1MatrixType.html#a13">i</a>(),mtx);
00639             <a class="code" href="classNEWMAT_1_1SkipConversionCheck.html">SkipConversionCheck</a> SCC;                    <span class="comment">// otherwise inverting</span>
00640             <span class="comment">// symmetric causes a problem</span>
00641             gmx = GeneralSolv(<a class="code" href="classNEWMAT_1_1NegatedMatrix.html#n1">gm</a>,&amp;I,<span class="keyword">this</span>,mtx);
00642         }
00643         CatchAll { <span class="keyword">delete</span> <span class="keyword">this</span>; ReThrow; }
00644         <span class="keyword">delete</span> <span class="keyword">this</span>; <span class="keywordflow">return</span> gmx;
00645 <span class="preprocessor">#else</span>
00646 <span class="preprocessor"></span>        <a class="code" href="namespaceNEWMAT.html#a45">Compare</a>(<a class="code" href="classNEWMAT_1_1NegatedMatrix.html#n1">gm</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a1">Type</a>().<a class="code" href="classNEWMAT_1_1MatrixType.html#a13">i</a>(),mtx);
00647         <a class="code" href="classNEWMAT_1_1SkipConversionCheck.html">SkipConversionCheck</a> SCC;                      <span class="comment">// otherwise inverting</span>
00648         <span class="comment">// symmetric causes a problem</span>
00649         <span class="keywordflow">return</span> GeneralSolv(<a class="code" href="classNEWMAT_1_1NegatedMatrix.html#n1">gm</a>,&amp;I,<span class="keyword">this</span>,mtx);
00650 <span class="preprocessor">#endif</span>
00651 <span class="preprocessor"></span>    }
00652 
00653     <span class="comment">/*************************** norm functions ****************************/</span>
00654 
<a name="l00655"></a><a class="code" href="classNEWMAT_1_1BaseMatrix.html#a33">00655</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> BaseMatrix::Norm1()<span class="keyword"> const </span>{
00656         <span class="comment">// maximum of sum of absolute values of a column</span>
00657         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00658             <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gm = ((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp;)*<span class="keyword">this</span>).Evaluate();
00659         <span class="keywordtype">int</span> nc = gm-&gt;Ncols(); <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> value = 0.0;
00660         <a class="code" href="classMatrixCol.html">MatrixCol</a> mc(gm, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>);
00661         <span class="keywordflow">while</span> (nc--)
00662         { <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> v = mc.<a class="code" href="classMatrixRowCol.html#a23">SumAbsoluteValue</a>(); <span class="keywordflow">if</span> (value &lt; v) value = v; mc.<a class="code" href="classMatrixCol.html#a3">Next</a>(); }
00663         gm-&gt;tDelete(); <span class="keywordflow">return</span> value;
00664     }
00665 
<a name="l00666"></a><a class="code" href="classNEWMAT_1_1BaseMatrix.html#a34">00666</a>     <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> BaseMatrix::NormInfinity()<span class="keyword"> const </span>{
00667         <span class="comment">// maximum of sum of absolute values of a row</span>
00668         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00669             <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gm = ((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp;)*<span class="keyword">this</span>).Evaluate();
00670         <span class="keywordtype">int</span> nr = gm-&gt;Nrows(); <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> value = 0.0;
00671         <a class="code" href="classMatrixRow.html">MatrixRow</a> mr(gm, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>);
00672         <span class="keywordflow">while</span> (nr--)
00673         { <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a> v = mr.<a class="code" href="classMatrixRowCol.html#a23">SumAbsoluteValue</a>(); <span class="keywordflow">if</span> (value &lt; v) value = v; mr.<a class="code" href="classMatrixRow.html#a2">Next</a>(); }
00674         gm-&gt;tDelete(); <span class="keywordflow">return</span> value;
00675     }
00676 
00677     <span class="comment">/********************** Concatenation and stacking *************************/</span>
00678 
<a name="l00679"></a><a class="code" href="classNEWMAT_1_1ConcatenatedMatrix.html#a1">00679</a>     <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* ConcatenatedMatrix::Evaluate(<a class="code" href="classNEWMAT_1_1MatrixType.html">MatrixType</a> mtx) {
00680         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00681             <a class="code" href="classTracer.html">Tracer</a> tr(<span class="stringliteral">"Concatenate"</span>);
00682 <span class="preprocessor">#ifdef TEMPS_DESTROYED_QUICKLY</span>
00683 <span class="preprocessor"></span>        Try {
00684             <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a> = ((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>*&amp;)<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n2">bm2</a>)-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a0">Evaluate</a>();
00685             <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a> = ((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>*&amp;)<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n0">bm1</a>)-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a0">Evaluate</a>();
00686             <a class="code" href="namespaceNEWMAT.html#a45">Compare</a>(<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a1">Type</a>() | <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a1">Type</a>(),mtx);
00687             <span class="keywordtype">int</span> nr=<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a2">Nrows</a>(); <span class="keywordtype">int</span> nc = <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a3">Ncols</a>() + <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a3">Ncols</a>();
00688             <span class="keywordflow">if</span> (nr != <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a2">Nrows</a>())
00689                 Throw(<a class="code" href="classNEWMAT_1_1IncompatibleDimensionsException.html">IncompatibleDimensionsException</a>(*<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>, *<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>));
00690             <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gmx = mtx.<a class="code" href="classNEWMAT_1_1MatrixType.html#a19">New</a>(nr,nc,<span class="keyword">this</span>);
00691             <a class="code" href="classMatrixRow.html">MatrixRow</a> mr1(<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>); <a class="code" href="classMatrixRow.html">MatrixRow</a> mr2(<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>);
00692             <a class="code" href="classMatrixRow.html">MatrixRow</a> mr(gmx, <a class="code" href="NEWMATRC_8H.html#a6a2">StoreOnExit</a>+<a class="code" href="NEWMATRC_8H.html#a6a3">DirectPart</a>);
00693             <span class="keywordflow">while</span> (nr--) { mr.<a class="code" href="classMatrixRowCol.html#a12">ConCat</a>(mr1,mr2); mr1.<a class="code" href="classMatrixRow.html#a2">Next</a>(); mr2.<a class="code" href="classMatrixRow.html#a2">Next</a>(); mr.<a class="code" href="classMatrixRow.html#a2">Next</a>(); }
00694             gmx-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a14">ReleaseAndDelete</a>(); <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a7">tDelete</a>(); <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a7">tDelete</a>(); <span class="keyword">delete</span> <span class="keyword">this</span>;
00695             <span class="keywordflow">return</span> gmx;
00696         }
00697         CatchAll  { <span class="keyword">delete</span> <span class="keyword">this</span>; ReThrow; }
00698 <span class="preprocessor">#ifndef UseExceptions</span>
00699 <span class="preprocessor"></span>        <span class="keywordflow">return</span> 0;
00700 <span class="preprocessor">#endif</span>
00701 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00702 <span class="preprocessor"></span>        <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a> = ((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>*&amp;)<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n2">bm2</a>)-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a0">Evaluate</a>();
00703         <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a> = ((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>*&amp;)<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n0">bm1</a>)-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a0">Evaluate</a>();
00704         <a class="code" href="namespaceNEWMAT.html#a45">Compare</a>(<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a1">Type</a>() | <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a1">Type</a>(),mtx);
00705         <span class="keywordtype">int</span> nr=<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a2">Nrows</a>(); <span class="keywordtype">int</span> nc = <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a3">Ncols</a>() + <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a3">Ncols</a>();
00706         <span class="keywordflow">if</span> (nr != <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a2">Nrows</a>())
00707             Throw(<a class="code" href="classNEWMAT_1_1IncompatibleDimensionsException.html">IncompatibleDimensionsException</a>(*<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>, *<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>));
00708         <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gmx = mtx.<a class="code" href="classNEWMAT_1_1MatrixType.html#a19">New</a>(nr,nc,<span class="keyword">this</span>);
00709         <a class="code" href="classMatrixRow.html">MatrixRow</a> mr1(<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>); <a class="code" href="classMatrixRow.html">MatrixRow</a> mr2(<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>);
00710         <a class="code" href="classMatrixRow.html">MatrixRow</a> mr(gmx, <a class="code" href="NEWMATRC_8H.html#a6a2">StoreOnExit</a>+<a class="code" href="NEWMATRC_8H.html#a6a3">DirectPart</a>);
00711         <span class="keywordflow">while</span> (nr--) { mr.<a class="code" href="classMatrixRowCol.html#a12">ConCat</a>(mr1,mr2); mr1.<a class="code" href="classMatrixRow.html#a2">Next</a>(); mr2.<a class="code" href="classMatrixRow.html#a2">Next</a>(); mr.<a class="code" href="classMatrixRow.html#a2">Next</a>(); }
00712         gmx-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a14">ReleaseAndDelete</a>(); <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a7">tDelete</a>(); <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a7">tDelete</a>(); <span class="keywordflow">return</span> gmx;
00713 <span class="preprocessor">#endif</span>
00714 <span class="preprocessor"></span>    }
00715 
<a name="l00716"></a><a class="code" href="classNEWMAT_1_1StackedMatrix.html#a0">00716</a>     <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* StackedMatrix::Evaluate(<a class="code" href="classNEWMAT_1_1MatrixType.html">MatrixType</a> mtx) {
00717         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00718             <a class="code" href="classTracer.html">Tracer</a> tr(<span class="stringliteral">"Stack"</span>);
00719 <span class="preprocessor">#ifdef TEMPS_DESTROYED_QUICKLY</span>
00720 <span class="preprocessor"></span>        Try {
00721             <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a> = ((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>*&amp;)<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n2">bm2</a>)-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a0">Evaluate</a>();
00722             <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a> = ((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>*&amp;)<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n0">bm1</a>)-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a0">Evaluate</a>();
00723             <a class="code" href="namespaceNEWMAT.html#a45">Compare</a>(<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a1">Type</a>() &amp; <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a1">Type</a>(),mtx);
00724             <span class="keywordtype">int</span> nc=<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a3">Ncols</a>();
00725             <span class="keywordtype">int</span> nr1 = <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a2">Nrows</a>(); <span class="keywordtype">int</span> nr2 = <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a2">Nrows</a>();
00726             <span class="keywordflow">if</span> (nc != <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a3">Ncols</a>())
00727                 Throw(<a class="code" href="classNEWMAT_1_1IncompatibleDimensionsException.html">IncompatibleDimensionsException</a>(*<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>, *<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>));
00728             <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gmx = mtx.<a class="code" href="classNEWMAT_1_1MatrixType.html#a19">New</a>(nr1+nr2,nc,<span class="keyword">this</span>);
00729             <a class="code" href="classMatrixRow.html">MatrixRow</a> mr1(<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>); <a class="code" href="classMatrixRow.html">MatrixRow</a> mr2(<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>);
00730             <a class="code" href="classMatrixRow.html">MatrixRow</a> mr(gmx, <a class="code" href="NEWMATRC_8H.html#a6a2">StoreOnExit</a>+<a class="code" href="NEWMATRC_8H.html#a6a3">DirectPart</a>);
00731             <span class="keywordflow">while</span> (nr1--) { mr.<a class="code" href="classMatrixRowCol.html#a15">Copy</a>(mr1); mr1.<a class="code" href="classMatrixRow.html#a2">Next</a>(); mr.<a class="code" href="classMatrixRow.html#a2">Next</a>(); }
00732             <span class="keywordflow">while</span> (nr2--) { mr.<a class="code" href="classMatrixRowCol.html#a15">Copy</a>(mr2); mr2.<a class="code" href="classMatrixRow.html#a2">Next</a>(); mr.<a class="code" href="classMatrixRow.html#a2">Next</a>(); }
00733             gmx-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a14">ReleaseAndDelete</a>(); <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a7">tDelete</a>(); <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a7">tDelete</a>(); <span class="keyword">delete</span> <span class="keyword">this</span>;
00734             <span class="keywordflow">return</span> gmx;
00735         }
00736         CatchAll  { <span class="keyword">delete</span> <span class="keyword">this</span>; ReThrow; }
00737 <span class="preprocessor">#ifndef UseExceptions</span>
00738 <span class="preprocessor"></span>        <span class="keywordflow">return</span> 0;
00739 <span class="preprocessor">#endif</span>
00740 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00741 <span class="preprocessor"></span>        <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a> = ((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>*&amp;)<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n2">bm2</a>)-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a0">Evaluate</a>();
00742         <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a> = ((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>*&amp;)<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n0">bm1</a>)-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a0">Evaluate</a>();
00743         <a class="code" href="namespaceNEWMAT.html#a45">Compare</a>(<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a1">Type</a>() &amp; <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a1">Type</a>(),mtx);
00744         <span class="keywordtype">int</span> nc=<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a3">Ncols</a>();
00745         <span class="keywordtype">int</span> nr1 = <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a2">Nrows</a>(); <span class="keywordtype">int</span> nr2 = <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a2">Nrows</a>();
00746         <span class="keywordflow">if</span> (nc != <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a3">Ncols</a>())
00747             Throw(<a class="code" href="classNEWMAT_1_1IncompatibleDimensionsException.html">IncompatibleDimensionsException</a>(*<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>, *<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>));
00748         <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gmx = mtx.<a class="code" href="classNEWMAT_1_1MatrixType.html#a19">New</a>(nr1+nr2,nc,<span class="keyword">this</span>);
00749         <a class="code" href="classMatrixRow.html">MatrixRow</a> mr1(<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>); <a class="code" href="classMatrixRow.html">MatrixRow</a> mr2(<a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>, <a class="code" href="NEWMATRC_8H.html#a6a1">LoadOnEntry</a>);
00750         <a class="code" href="classMatrixRow.html">MatrixRow</a> mr(gmx, <a class="code" href="NEWMATRC_8H.html#a6a2">StoreOnExit</a>+<a class="code" href="NEWMATRC_8H.html#a6a3">DirectPart</a>);
00751         <span class="keywordflow">while</span> (nr1--) { mr.<a class="code" href="classMatrixRowCol.html#a15">Copy</a>(mr1); mr1.<a class="code" href="classMatrixRow.html#a2">Next</a>(); mr.<a class="code" href="classMatrixRow.html#a2">Next</a>(); }
00752         <span class="keywordflow">while</span> (nr2--) { mr.<a class="code" href="classMatrixRowCol.html#a15">Copy</a>(mr2); mr2.<a class="code" href="classMatrixRow.html#a2">Next</a>(); mr.<a class="code" href="classMatrixRow.html#a2">Next</a>(); }
00753         gmx-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a14">ReleaseAndDelete</a>(); <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n1">gm1</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a7">tDelete</a>(); <a class="code" href="classNEWMAT_1_1MultipliedMatrix.html#n3">gm2</a>-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a7">tDelete</a>(); <span class="keywordflow">return</span> gmx;
00754 <span class="preprocessor">#endif</span>
00755 <span class="preprocessor"></span>    }
00756 
00757     <span class="comment">// ************************* equality of matrices ******************** //</span>
00758 
00759     <span class="keyword">static</span> <span class="keywordtype">bool</span> RealEqual(<a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s1, <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s2, <span class="keywordtype">int</span> n) {
00760         <span class="keywordtype">int</span> i = n &gt;&gt; 2;
00761         <span class="keywordflow">while</span> (i--) {
00762             <span class="keywordflow">if</span> (*s1++ != *s2++) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="keywordflow">if</span> (*s1++ != *s2++) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00763             <span class="keywordflow">if</span> (*s1++ != *s2++) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="keywordflow">if</span> (*s1++ != *s2++) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00764         }
00765         i = n &amp; 3; <span class="keywordflow">while</span> (i--) <span class="keywordflow">if</span> (*s1++ != *s2++) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00766         <span class="keywordflow">return</span> <span class="keyword">true</span>;
00767     }
00768 
00769     <span class="keyword">static</span> <span class="keywordtype">bool</span> intEqual(<span class="keywordtype">int</span>* s1, <span class="keywordtype">int</span>* s2, <span class="keywordtype">int</span> n) {
00770         <span class="keywordtype">int</span> i = n &gt;&gt; 2;
00771         <span class="keywordflow">while</span> (i--) {
00772             <span class="keywordflow">if</span> (*s1++ != *s2++) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="keywordflow">if</span> (*s1++ != *s2++) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00773             <span class="keywordflow">if</span> (*s1++ != *s2++) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="keywordflow">if</span> (*s1++ != *s2++) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00774         }
00775         i = n &amp; 3; <span class="keywordflow">while</span> (i--) <span class="keywordflow">if</span> (*s1++ != *s2++) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00776         <span class="keywordflow">return</span> <span class="keyword">true</span>;
00777     }
00778 
<a name="l00779"></a><a class="code" href="namespaceNEWMAT.html#a21">00779</a>     <span class="keywordtype">bool</span> <a class="code" href="namespaceNEWMAT.html#a20">operator==</a>(<span class="keyword">const</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp; A, <span class="keyword">const</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp; B) {
00780         <a class="code" href="classTracer.html">Tracer</a> tr(<span class="stringliteral">"BaseMatrix =="</span>);
00781         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00782             <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gmA = ((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp;)A).Evaluate();
00783         <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gmB = ((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp;)B).Evaluate();
00784 
00785         <span class="keywordflow">if</span> (gmA == gmB)                               <span class="comment">// same matrix</span>
00786         { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a> gmA-&gt;tDelete(); <span class="keywordflow">return</span> <span class="keyword">true</span>; }
00787 
00788         <span class="keywordflow">if</span> ( gmA-&gt;Nrows() != gmB-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a2">Nrows</a>() || gmA-&gt;Ncols() != gmB-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a3">Ncols</a>() )
00789             <span class="comment">// different dimensions</span>
00790         { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a> gmA-&gt;tDelete(); gmB-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a7">tDelete</a>(); <span class="keywordflow">return</span> <span class="keyword">false</span>; }
00791 
00792         <span class="comment">// check for CroutMatrix or BandLUMatrix</span>
00793         <a class="code" href="classNEWMAT_1_1MatrixType.html">MatrixType</a> AType = gmA-&gt;Type(); <a class="code" href="classNEWMAT_1_1MatrixType.html">MatrixType</a> BType = gmB-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a1">Type</a>();
00794         <span class="keywordflow">if</span> (AType.<a class="code" href="classNEWMAT_1_1MatrixType.html#a24">CannotConvert</a>() || BType.<a class="code" href="classNEWMAT_1_1MatrixType.html#a24">CannotConvert</a>() ) {
00795             <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00796                 <span class="keywordtype">bool</span> bx = gmA-&gt;IsEqual(*gmB);
00797             gmA-&gt;tDelete(); gmB-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a7">tDelete</a>();
00798             <span class="keywordflow">return</span> bx;
00799         }
00800 
00801         <span class="comment">// is matrix storage the same</span>
00802         <span class="comment">// will need to modify if further matrix structures are introduced</span>
00803         <span class="keywordflow">if</span> (AType == BType &amp;&amp; gmA-&gt;BandWidth() == gmB-&gt;<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a35">BandWidth</a>()) {
00804             <span class="comment">// compare store</span>
00805             <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00806                 <span class="keywordtype">bool</span> bx = RealEqual(gmA-&gt;Store(),gmB-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a5">Store</a>(),gmA-&gt;Storage());
00807             gmA-&gt;tDelete(); gmB-&gt;<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a7">tDelete</a>();
00808             <span class="keywordflow">return</span> bx;
00809         }
00810 
00811         <span class="comment">// matrix storage different - just subtract</span>
00812         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>  <span class="keywordflow">return</span> <a class="code" href="namespaceNEWMAT.html#a28">IsZero</a>(*gmA-*gmB);
00813     }
00814 
<a name="l00815"></a><a class="code" href="namespaceNEWMAT.html#a20">00815</a>     <span class="keywordtype">bool</span> <a class="code" href="namespaceNEWMAT.html#a20">operator==</a>(<span class="keyword">const</span> <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp; A, <span class="keyword">const</span> <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp; B) {
00816         <a class="code" href="classTracer.html">Tracer</a> tr(<span class="stringliteral">"GeneralMatrix =="</span>);
00817         <span class="comment">// May or may not call tDeletes</span>
00818         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00819 
00820             <span class="keywordflow">if</span> (&amp;A == &amp;B)                               <span class="comment">// same matrix</span>
00821             { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a> <span class="keywordflow">return</span> <span class="keyword">true</span>; }
00822 
00823         <span class="keywordflow">if</span> ( A.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a2">Nrows</a>() != B.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a2">Nrows</a>() || A.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a3">Ncols</a>() != B.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a3">Ncols</a>() ) {
00824             <span class="comment">// different dimensions</span>
00825             <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a> <span class="keywordflow">return</span> <span class="keyword">false</span>;
00826         }
00827 
00828         <span class="comment">// check for CroutMatrix or BandLUMatrix</span>
00829         <a class="code" href="classNEWMAT_1_1MatrixType.html">MatrixType</a> AType = A.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a1">Type</a>(); <a class="code" href="classNEWMAT_1_1MatrixType.html">MatrixType</a> BType = B.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a1">Type</a>();
00830         <span class="keywordflow">if</span> (AType.<a class="code" href="classNEWMAT_1_1MatrixType.html#a24">CannotConvert</a>() || BType.<a class="code" href="classNEWMAT_1_1MatrixType.html#a24">CannotConvert</a>() )
00831         { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>  <span class="keywordflow">return</span> A.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a45">IsEqual</a>(B); }
00832 
00833         <span class="comment">// is matrix storage the same</span>
00834         <span class="comment">// will need to modify if further matrix structures are introduced</span>
00835         <span class="keywordflow">if</span> (AType == BType &amp;&amp; A.<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a35">BandWidth</a>() == B.<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a35">BandWidth</a>())
00836         { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a> <span class="keywordflow">return</span> RealEqual(A.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a5">Store</a>(),B.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a5">Store</a>(),A.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a4">Storage</a>()); }
00837 
00838         <span class="comment">// matrix storage different - just subtract</span>
00839         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>  <span class="keywordflow">return</span> <a class="code" href="namespaceNEWMAT.html#a28">IsZero</a>(A-B);
00840     }
00841 
<a name="l00842"></a><a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a11">00842</a>     <span class="keywordtype">bool</span> GeneralMatrix::IsZero()<span class="keyword"> const </span>{
00843         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00844             <a class="code" href="namespaceRBD__COMMON.html#a0">Real</a>* s=<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>; <span class="keywordtype">int</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n3">storage</a> &gt;&gt; 2;
00845         <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) {
00846             <span class="keywordflow">if</span> (*s++) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="keywordflow">if</span> (*s++) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00847             <span class="keywordflow">if</span> (*s++) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="keywordflow">if</span> (*s++) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00848         }
00849         <a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a> = <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n3">storage</a> &amp; 3; <span class="keywordflow">while</span> (<a class="code" href="classNEWMAT_1_1BaseMatrix.html#a13">i</a>--) <span class="keywordflow">if</span> (*s++) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00850         <span class="keywordflow">return</span> <span class="keyword">true</span>;
00851     }
00852 
<a name="l00853"></a><a class="code" href="namespaceNEWMAT.html#a28">00853</a>     <span class="keywordtype">bool</span> <a class="code" href="namespaceNEWMAT.html#a28">IsZero</a>(<span class="keyword">const</span> <a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp; A) {
00854         <a class="code" href="classTracer.html">Tracer</a> tr(<span class="stringliteral">"BaseMatrix::IsZero"</span>);
00855         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00856             <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>* gm1 = 0; <span class="keywordtype">bool</span> bx;
00857         Try { gm1=((<a class="code" href="classNEWMAT_1_1BaseMatrix.html">BaseMatrix</a>&amp;)A).Evaluate(); bx = gm1-&gt;IsZero(); }
00858         CatchAll { <span class="keywordflow">if</span> (gm1) gm1-&gt;tDelete(); ReThrow; }
00859         gm1-&gt;tDelete();
00860         <span class="keywordflow">return</span> bx;
00861     }
00862 
00863     <span class="comment">// IsEqual functions - insist matrices are of same type</span>
00864     <span class="comment">// as well as equal values to be equal</span>
00865 
<a name="l00866"></a><a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a45">00866</a>     <span class="keywordtype">bool</span> GeneralMatrix::IsEqual(<span class="keyword">const</span> <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp; A)<span class="keyword"> const </span>{
00867         <a class="code" href="classTracer.html">Tracer</a> tr(<span class="stringliteral">"GeneralMatrix IsEqual"</span>);
00868         <span class="keywordflow">if</span> (A.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a1">Type</a>() != <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a1">Type</a>())                       <span class="comment">// not same types</span>
00869         { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a> <span class="keywordflow">return</span> <span class="keyword">false</span>; }
00870         <span class="keywordflow">if</span> (&amp;A == <span class="keyword">this</span>)                             <span class="comment">// same matrix</span>
00871         { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>  <span class="keywordflow">return</span> <span class="keyword">true</span>; }
00872         <span class="keywordflow">if</span> (A.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a> != <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a> || A.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n2">ncols</a> != <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n2">ncols</a>)
00873             <span class="comment">// different dimensions</span>
00874         { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a> <span class="keywordflow">return</span> <span class="keyword">false</span>; }
00875         <span class="comment">// is matrix storage the same - compare store</span>
00876         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00877             <span class="keywordflow">return</span> RealEqual(A.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>,<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>,<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n3">storage</a>);
00878     }
00879 
<a name="l00880"></a><a class="code" href="classNEWMAT_1_1CroutMatrix.html#a13">00880</a>     <span class="keywordtype">bool</span> CroutMatrix::IsEqual(<span class="keyword">const</span> <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp; A)<span class="keyword"> const </span>{
00881         <a class="code" href="classTracer.html">Tracer</a> tr(<span class="stringliteral">"CroutMatrix IsEqual"</span>);
00882         <span class="keywordflow">if</span> (A.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a1">Type</a>() != <a class="code" href="classNEWMAT_1_1CroutMatrix.html#a1">Type</a>())                       <span class="comment">// not same types</span>
00883         { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a> <span class="keywordflow">return</span> <span class="keyword">false</span>; }
00884         <span class="keywordflow">if</span> (&amp;A == <span class="keyword">this</span>)                             <span class="comment">// same matrix</span>
00885         { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>  <span class="keywordflow">return</span> <span class="keyword">true</span>; }
00886         <span class="keywordflow">if</span> (A.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a> != <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a> || A.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n2">ncols</a> != <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n2">ncols</a>)
00887             <span class="comment">// different dimensions</span>
00888         { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a> <span class="keywordflow">return</span> <span class="keyword">false</span>; }
00889         <span class="comment">// is matrix storage the same - compare store</span>
00890         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00891             <span class="keywordflow">return</span> RealEqual(A.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>,<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>,<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n3">storage</a>)
00892             &amp;&amp; intEqual(((<a class="code" href="classNEWMAT_1_1CroutMatrix.html">CroutMatrix</a>&amp;)A).indx, indx, <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>);
00893     }
00894 
<a name="l00895"></a><a class="code" href="classNEWMAT_1_1BandLUMatrix.html#a13">00895</a>     <span class="keywordtype">bool</span> BandLUMatrix::IsEqual(<span class="keyword">const</span> <a class="code" href="classNEWMAT_1_1GeneralMatrix.html">GeneralMatrix</a>&amp; A)<span class="keyword"> const </span>{
00896         <a class="code" href="classTracer.html">Tracer</a> tr(<span class="stringliteral">"BandLUMatrix IsEqual"</span>);
00897         <span class="keywordflow">if</span> (A.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a1">Type</a>() != <a class="code" href="classNEWMAT_1_1BandLUMatrix.html#a1">Type</a>())                       <span class="comment">// not same types</span>
00898         { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>  <span class="keywordflow">return</span> <span class="keyword">false</span>; }
00899         <span class="keywordflow">if</span> (&amp;A == <span class="keyword">this</span>)                             <span class="comment">// same matrix</span>
00900         { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>  <span class="keywordflow">return</span> <span class="keyword">true</span>; }
00901         <span class="keywordflow">if</span> ( A.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a2">Nrows</a>() != <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a> || A.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a3">Ncols</a>() != <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n2">ncols</a>
00902              || ((<a class="code" href="classNEWMAT_1_1BandLUMatrix.html">BandLUMatrix</a>&amp;)A).m1 != m1 || ((<a class="code" href="classNEWMAT_1_1BandLUMatrix.html">BandLUMatrix</a>&amp;)A).m2 != m2 )
00903             <span class="comment">// different dimensions</span>
00904         { <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>  <span class="keywordflow">return</span> <span class="keyword">false</span>; }
00905 
00906         <span class="comment">// matrix storage the same - compare store</span>
00907         <a class="code" href="NEWMAT7_8CPP.html#a0">REPORT</a>
00908             <span class="keywordflow">return</span> RealEqual(A.<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#a5">Store</a>(),<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n4">store</a>,<a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n3">storage</a>)
00909             &amp;&amp; RealEqual(((<a class="code" href="classNEWMAT_1_1BandLUMatrix.html">BandLUMatrix</a>&amp;)A).store2,store2,storage2)
00910             &amp;&amp; intEqual(((<a class="code" href="classNEWMAT_1_1BandLUMatrix.html">BandLUMatrix</a>&amp;)A).indx, indx, <a class="code" href="classNEWMAT_1_1GeneralMatrix.html#n1">nrows</a>);
00911     }
00912 
00913 <span class="preprocessor">#ifdef use_namespace</span>
00914 <span class="preprocessor"></span>}
00915 <span class="preprocessor">#endif</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:37:10 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
