<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Oradiov.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Oradiov.cpp</h1><a href="Oradiov_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : ORADIOV.CPP</span>
00002 <span class="comment">//Description : Object RadioButton</span>
00003 <span class="comment">//Owner           : Kevin(ho)</span>
00004 <span class="preprocessor">#include &lt;<a class="code" href="ALL_8H.html">ALL.H</a>&gt;</span>
00005 <span class="preprocessor">#include &lt;OINFO.H&gt;</span>
00006 <span class="preprocessor">#include &lt;<a class="code" href="OVGA_8H.html">OVGA.H</a>&gt;</span>
00007 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00008 <span class="preprocessor">#include &lt;OFONT.H&gt;</span>
00009 <span class="preprocessor">#include &lt;OMOUSE.H&gt;</span>
00010 <span class="preprocessor">#include &lt;<a class="code" href="ORADIOV_8H.html">ORADIOV.H</a>&gt;</span>
00011 <span class="preprocessor">#include &lt;OAUDIO.H&gt;</span>
00012 <span class="preprocessor">#include &lt;OCONFIG.H&gt;</span>
00013 <span class="comment">//--------- Define macro constant -----------//</span>
00014 
00015 <span class="keyword">enum</span> {  <a class="code" href="Oradiov_8cpp.html#a3a1">BUTTON_DESC_DISTANCE</a> = 8  };
00016 <span class="keyword">enum</span> {  <a class="code" href="Oradiov_8cpp.html#a4a2">BUTTON_RADIUS</a> = 6       };
00017 
00018 <span class="comment">//-------------- Define static vars ------------//</span>
00019 
00020 <span class="keyword">static</span> <span class="keywordtype">char</span> paint_flag = 0;
00021 
00022 <span class="comment">//-------- Begin of function RadioButton::RadioButton ----//</span>
<a name="l00024"></a><a class="code" href="classRadioButtonVert.html#a0">00024</a> <span class="comment">RadioButtonVert::RadioButtonVert() {</span>
00025 }
00026 
00027 <span class="comment">//---------- End of function RadioButton::RadioButton ----//</span>
00028 
00029 <span class="comment">//-------- Begin of function RadioButton::~RadioButton ---//</span>
<a name="l00031"></a><a class="code" href="classRadioButtonVert.html#a1">00031</a> <span class="comment">RadioButtonVert::~RadioButtonVert() {</span>
00032     deinit();
00033 }
00034 
00035 <span class="comment">//---------- End of function RadioButton::~RadioButton ---//</span>
00036 
00037 <span class="comment">//-------- Begin of function RadioButton::init --------//</span>
<a name="l00046"></a><a class="code" href="classRadioButtonVert.html#a2">00046</a> <span class="comment">void RadioButtonVert::init( int x1, int y1, int x2, int y2,</span>
00047                             <span class="keywordtype">int</span> optionNum, <span class="keywordtype">int</span> *selNum, <span class="keywordtype">char</span> **optionDesc, <span class="keywordtype">int</span> buttonColor ) {
00048     <a class="code" href="ALL_8H.html#a0">err_when</a>(optionNum &lt;= 0);
00049 
00050     font_ptr = &amp;font_chartsm;
00051 
00052     radio_button_x1 = x1;
00053     radio_button_y1 = y1;
00054     radio_button_x2 = x2;
00055     radio_button_y2 = y2;
00056     <span class="comment">//  radio_button_y1 = (y1 + y2 - font_ptr-&gt;font_height) / 2;</span>
00057     <span class="comment">//  radio_button_y2 = (y1 + y2 + font_ptr-&gt;font_height) / 2;</span>
00058     radio_button_width = 4*<a class="code" href="Oradiov_8cpp.html#a4a2">BUTTON_RADIUS</a>;
00059     paragraph_width = (x2 - x1)-radio_button_width;
00060     paragraph_height = (y2 - y1)/optionNum;
00061     option_num = optionNum;
00062     sel_num = selNum;
00063     option_desc = optionDesc;
00064     button_color = buttonColor;
00065 
00066     radio_button_x = x1+2*<a class="code" href="Oradiov_8cpp.html#a4a2">BUTTON_RADIUS</a>;
00067     radio_button_bitmap = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00068 
00069     init_flag = 1;
00070 
00071     paint();
00072 }
00073 
00074 <span class="comment">//------------- End of function RadioButton::init -----------//</span>
00075 
00076 <span class="comment">//-------- Begin of function RadioButton::deinit ------------//</span>
<a name="l00078"></a><a class="code" href="classRadioButtonVert.html#a3">00078</a> <span class="comment">void RadioButtonVert::deinit() {</span>
00079     <span class="keywordflow">if</span> (init_flag) {
00080         <span class="keywordflow">if</span> (radio_button_bitmap) {
00081             <a class="code" href="ALL_8H.html#a8">mem_del</a>(radio_button_bitmap);
00082             radio_button_bitmap = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00083         }
00084 
00085         init_flag = 0;
00086     }
00087 }
00088 
00089 <span class="comment">//------------- End of function RadioButton::deinit ---------//</span>
00090 
00091 <span class="comment">//----------- Begin of function RadioButton::paint ----------//</span>
<a name="l00093"></a><a class="code" href="classRadioButtonVert.html#a4">00093</a> <span class="comment">void RadioButtonVert::paint() {</span>
00094     <a class="code" href="ALL_8H.html#a0">err_when</a>(*sel_num &gt; option_num || *sel_num &lt; 0);
00095 
00096     <span class="comment">//  vga.use_back();</span>
00097 
00098     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; option_num; i++) {
00099         <span class="keywordtype">short</span> y = radio_button_y1 + i * paragraph_height;
00100 
00101         font_ptr-&gt;put_paragraph(radio_button_x+<a class="code" href="Oradiov_8cpp.html#a3a1">BUTTON_DESC_DISTANCE</a>,y,radio_button_x2, y+paragraph_height, option_desc[i] );
00102     }
00103 
00104     radio_button_bitmap = vga_back.save_area(radio_button_x1, radio_button_y1,
00105                                              radio_button_x2, radio_button_y2, radio_button_bitmap);
00106 
00107     paint_flag = 1;
00108     refresh();
00109 }
00110 
00111 <span class="comment">//------------- End of function RadioButton::paint ----------//</span>
00112 
00113 <span class="comment">//----------- Begin of function RadioButton::refresh --------//</span>
<a name="l00115"></a><a class="code" href="classRadioButtonVert.html#a5">00115</a> <span class="comment">void RadioButtonVert::refresh() {</span>
00116     <a class="code" href="ALL_8H.html#a0">err_when</a>(*sel_num &gt; option_num || *sel_num &lt; 0);
00117 
00118     vga_back.rest_area(radio_button_bitmap, 0, 0);
00119 
00120     <span class="comment">//  vga.use_back();</span>
00121 
00122     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; option_num; i++) {
00123         <span class="comment">/*              short y = radio_button_y1 + i * paragraph_height;</span>
00124 <span class="comment">                        circle( radio_button_x1+BUTTON_RADIUS, y+BUTTON_RADIUS,</span>
00125 <span class="comment">                        BUTTON_RADIUS, button_color, 0);</span>
00126 <span class="comment">                        if (i == *sel_num)</span>
00127 <span class="comment">                        circle(radio_button_x1+BUTTON_RADIUS, y+BUTTON_RADIUS,</span>
00128 <span class="comment">                        BUTTON_RADIUS-2,button_color, 1);</span>
00129 <span class="comment">        */</span>
00130         <span class="keywordtype">short</span> y = radio_button_y1 + i * paragraph_height;
00131 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00132 <span class="preprocessor"></span>        image_interface.put_back(radio_button_x1+<a class="code" href="Oradiov_8cpp.html#a4a2">BUTTON_RADIUS</a>-7, y+<a class="code" href="Oradiov_8cpp.html#a4a2">BUTTON_RADIUS</a>-6,<span class="stringliteral">"RRED"</span>);
00133         <span class="keywordflow">if</span> (i == *sel_num)
00134             image_interface.put_back(radio_button_x1+<a class="code" href="Oradiov_8cpp.html#a4a2">BUTTON_RADIUS</a>-7, y+<a class="code" href="Oradiov_8cpp.html#a4a2">BUTTON_RADIUS</a>-6,<span class="stringliteral">"RGOLD"</span>);
00135 <span class="preprocessor">#else</span>
00136 <span class="preprocessor"></span>        image_interface.put_back(radio_button_x1+<a class="code" href="Oradiov_8cpp.html#a4a2">BUTTON_RADIUS</a>-7, y+<a class="code" href="Oradiov_8cpp.html#a4a2">BUTTON_RADIUS</a>-6,<span class="stringliteral">"RGOLD"</span>);
00137         <span class="keywordflow">if</span> (i == *sel_num)
00138             image_interface.put_back(radio_button_x1+<a class="code" href="Oradiov_8cpp.html#a4a2">BUTTON_RADIUS</a>-7, y+<a class="code" href="Oradiov_8cpp.html#a4a2">BUTTON_RADIUS</a>-6,<span class="stringliteral">"RRED"</span>);
00139 <span class="preprocessor">#endif</span>
00140 <span class="preprocessor"></span>    }
00141 
00142     <span class="comment">//  vga.use_front();</span>
00143     <span class="keywordflow">if</span> (!paint_flag)
00144         vga.blt_buf(radio_button_x1, radio_button_y1, radio_button_x2, radio_button_y2);
00145     <span class="keywordflow">else</span>
00146         paint_flag = 0;
00147 }
00148 
00149 <span class="comment">//------------- End of function RadioButton::refresh ---------//</span>
00150 
00151 <span class="comment">//----------- Begin of function RadioButton::fill --------------//</span>
00156 <span class="comment">void RadioButtonVert::fill(short x, short y, int color) {</span>
00157     <a class="code" href="ALL_8H.html#a0">err_when</a>(x &gt; <a class="code" href="OVGA_8H.html#a0">VGA_WIDTH</a> || y &gt; <a class="code" href="OVGA_8H.html#a1">VGA_HEIGHT</a> || x &lt; 0 || y &lt; 0);
00158 
00159     vga_back.draw_pixel( x, y, color );
00160 
00161     <span class="comment">//----- recursively fill neighbouring pixels -----//</span>
00162 
00163     <span class="keywordflow">if</span> (x &gt; 0 &amp;&amp; *vga_back.buf_ptr(x-1, y) != vga_back.translate_color(color)) {
00164         fill(x-1, y, color);
00165     }
00166 
00167     <span class="keywordflow">if</span> (x &lt; <a class="code" href="OVGA_8H.html#a0">VGA_WIDTH</a> &amp;&amp; *vga_back.buf_ptr(x+1, y) != vga_back.translate_color(color)) {
00168         fill(x+1, y, color);
00169     }
00170 
00171     <span class="keywordflow">if</span> (y &gt; 0 &amp;&amp; *vga_back.buf_ptr(x, y-1) != vga_back.translate_color(color)) {
00172         fill(x, y-1, color);
00173     }
00174 
00175     <span class="keywordflow">if</span> (y &lt; <a class="code" href="OVGA_8H.html#a1">VGA_HEIGHT</a> &amp;&amp; *vga_back.buf_ptr(x, y+1) != vga_back.translate_color(color)) {
00176         fill(x, y+1, color);
00177     }
00178 }
00179 
00180 <span class="comment">//------------- End of function RadioButton::fill --------------//</span>
00181 
00182 <span class="comment">//----------- Begin of function RadioButton::circle ------------//</span>
00189 <span class="comment">void RadioButtonVert::circle(short x, short y, int radius, int color, char fill_flag) {</span>
00190     <span class="keywordtype">int</span> d = 3 - 2 * radius;
00191     <span class="keywordtype">int</span> a = 0;
00192     <span class="keywordtype">int</span> b = radius;
00193 
00194     <span class="keywordflow">while</span> (a != b) {
00195         vga_back.draw_pixel( x+a, y+b, color );
00196         vga_back.draw_pixel( x-a, y+b, color );
00197         vga_back.draw_pixel( x+a, y-b, color );
00198         vga_back.draw_pixel( x-a, y-b, color );
00199         vga_back.draw_pixel( x+b, y+a, color );
00200         vga_back.draw_pixel( x-b, y+a, color );
00201         vga_back.draw_pixel( x+b, y-a, color );
00202         vga_back.draw_pixel( x-b, y-a, color );
00203 
00204         <span class="keywordflow">if</span> (d &lt; 0)
00205             d += 4 * a + 6;
00206         <span class="keywordflow">else</span>
00207             d += 4 * (a - b--) + 10;
00208 
00209         ++a;
00210     }
00211     vga_back.draw_pixel( x+a, y+a, color );
00212     vga_back.draw_pixel( x+a, y-a, color );
00213     vga_back.draw_pixel( x-a, y+a, color );
00214     vga_back.draw_pixel( x-a, y-a, color );
00215 
00216     <span class="keywordflow">if</span> (fill_flag) {
00217         fill(x, y, color);
00218     }
00219 }
00220 
00221 <span class="comment">//------------- End of function RadioButton::circle ------------//</span>
00222 
00223 <span class="comment">//----------- Begin of function RadioButton::detect ------------//</span>
<a name="l00228"></a><a class="code" href="classRadioButtonVert.html#a6">00228</a> <span class="comment">int RadioButtonVert::detect() {</span>
00229     <span class="keywordflow">if</span> (!init_flag)
00230         <span class="keywordflow">return</span> 0;
00231 
00232     <span class="comment">//---- Variable update? ----//</span>
00233 
00234     <span class="keywordflow">if</span> (mouse.single_click( radio_button_x1, radio_button_y1,
00235                             radio_button_x2, radio_button_y2 )) {
00236         <span class="keywordtype">short</span> y,x=radio_button_x;
00237         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; option_num; i++) {
00238             y = radio_button_y1 + i * paragraph_height;
00239             <span class="keywordflow">if</span> (mouse.single_click( radio_button_x1, y, radio_button_x2 , y+paragraph_height )) {
00240                 *sel_num = i;
00241                 audio.play_wav(<span class="stringliteral">"BEEPS-1"</span>,audio.int_to_DsVolume(config.sound_effect_volume));
00242                 <span class="keywordflow">return</span> 1;
00243             }
00244         }
00245     }
00246 
00247     <span class="keywordflow">return</span> 0;
00248 }
00249 
00250 <span class="comment">//------------- End of function RadioButton::detect ------------//</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:38:17 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
