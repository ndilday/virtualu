<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>OGAMGEN.CPP Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>OGAMGEN.CPP</h1><a href="OGAMGEN_8CPP.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : OGAMGEN.CPP</span>
00002 <span class="comment">//Description : Game Generator</span>
00003 
00004 <span class="preprocessor">#include &lt;<a class="code" href="OVGA_8H.html">OVGA.H</a>&gt;</span>
00005 <span class="preprocessor">#include &lt;<a class="code" href="OBOX_8H.html">OBOX.H</a>&gt;</span>
00006 <span class="preprocessor">#include &lt;OFONT.H&gt;</span>
00007 <span class="preprocessor">#include &lt;OMOUSE.H&gt;</span>
00008 <span class="preprocessor">#include &lt;OBUTTON.H&gt;</span>
00009 <span class="preprocessor">#include &lt;OLISTBOX.H&gt;</span>
00010 <span class="preprocessor">#include &lt;<a class="code" href="OPOWER_8H.html">OPOWER.H</a>&gt;</span>
00011 <span class="preprocessor">#include &lt;<a class="code" href="OWORLD_8H.html">OWORLD.H</a>&gt;</span>
00012 <span class="preprocessor">#include &lt;OITEMRES.H&gt;</span>
00013 <span class="preprocessor">#include &lt;OPERSON.H&gt;</span>
00014 <span class="preprocessor">#include &lt;OGRPRES.H&gt;</span>
00015 <span class="preprocessor">#include &lt;<a class="code" href="OGAMESET_8H.html">OGAMESET.H</a>&gt;</span>
00016 <span class="preprocessor">#include &lt;<a class="code" href="OGAME_8H.html">OGAME.H</a>&gt;</span>
00017 <span class="preprocessor">#include &lt;<a class="code" href="OHELPIF_8H.html">OHELPIF.H</a>&gt;</span>
00018 
00019 <span class="comment">//--------- Define constant ------------//</span>
00020 
00021 <span class="keyword">enum</span> {
00022     <a class="code" href="OGAMGEN_8CPP.html#a28a10">GEN_WIN_X1</a> = 45,
00023     <a class="code" href="OGAMGEN_8CPP.html#a28a11">GEN_WIN_Y1</a> = 30,
00024     <a class="code" href="OGAMGEN_8CPP.html#a28a12">GEN_WIN_X2</a> = 595,
00025     <a class="code" href="OGAMGEN_8CPP.html#a28a13">GEN_WIN_Y2</a> = 445
00026 };
00027 
00028 <span class="keyword">enum</span> {
00029     <a class="code" href="OGAMGEN_8CPP.html#a29a14">GEN_HEADER_X1</a> = <a class="code" href="OGAMGEN_8CPP.html#a28a10">GEN_WIN_X1</a>+10,
00030     <a class="code" href="OGAMGEN_8CPP.html#a29a15">GEN_HEADER_Y1</a> = <a class="code" href="OGAMGEN_8CPP.html#a28a11">GEN_WIN_Y1</a>+10,
00031     <a class="code" href="OGAMGEN_8CPP.html#a29a16">GEN_HEADER_X2</a> = <a class="code" href="OGAMGEN_8CPP.html#a29a14">GEN_HEADER_X1</a>+363,
00032     <a class="code" href="OGAMGEN_8CPP.html#a29a17">GEN_HEADER_Y2</a> = <a class="code" href="OGAMGEN_8CPP.html#a28a11">GEN_WIN_Y1</a>+107
00033 };
00034 
00035 <span class="keyword">enum</span> {
00036     <a class="code" href="OGAMGEN_8CPP.html#a30a18">GEN_TYPE_X1</a> = <a class="code" href="OGAMGEN_8CPP.html#a29a16">GEN_HEADER_X2</a>+10,
00037     <a class="code" href="OGAMGEN_8CPP.html#a30a19">GEN_TYPE_Y1</a> = <a class="code" href="OGAMGEN_8CPP.html#a29a15">GEN_HEADER_Y1</a>,
00038     <a class="code" href="OGAMGEN_8CPP.html#a30a20">GEN_TYPE_X2</a> = <a class="code" href="OGAMGEN_8CPP.html#a28a12">GEN_WIN_X2</a>-10,
00039     <a class="code" href="OGAMGEN_8CPP.html#a30a21">GEN_TYPE_Y2</a> = <a class="code" href="OGAMGEN_8CPP.html#a29a17">GEN_HEADER_Y2</a>
00040 };
00041 
00042 <span class="keyword">enum</span> {
00043     <a class="code" href="OGAMGEN_8CPP.html#a31a22">GEN_BODY_X1</a> = <a class="code" href="OGAMGEN_8CPP.html#a28a10">GEN_WIN_X1</a>+10,
00044     <a class="code" href="OGAMGEN_8CPP.html#a31a23">GEN_BODY_Y1</a> = <a class="code" href="OGAMGEN_8CPP.html#a29a17">GEN_HEADER_Y2</a>+10,
00045     <a class="code" href="OGAMGEN_8CPP.html#a31a24">GEN_BODY_X2</a> = <a class="code" href="OGAMGEN_8CPP.html#a28a12">GEN_WIN_X2</a>-10,
00046     <a class="code" href="OGAMGEN_8CPP.html#a31a25">GEN_BODY_Y2</a> = <a class="code" href="OGAMGEN_8CPP.html#a28a13">GEN_WIN_Y2</a>-32
00047 };
00048 
00049 <span class="comment">//-------- Define game settings ---------//</span>
00050 
00051 <span class="keyword">enum</span> { <a class="code" href="OGAMGEN_8CPP.html#a32a26">OPTION_TYPE_NUM</a> = 2 };
00052 
00053 <span class="keyword">static</span> <span class="keywordtype">char</span>* option_des_array[] = {
00054     <span class="stringliteral">"Institution"</span>,                                  <span class="comment">// 1</span>
00055     <span class="stringliteral">"Characteristics"</span>,                              <span class="comment">// 2</span>
00056 };
00057 
00058 <span class="keyword">static</span> <span class="keywordtype">char</span>* screen_code_array[] = {
00059     <span class="stringliteral">"G_INST"</span>,                                       <span class="comment">// 1</span>
00060     <span class="stringliteral">"G_CHAR"</span>,                                       <span class="comment">// 2</span>
00061 };
00062 
00063 <span class="keyword">static</span> <span class="keywordtype">short</span>  normal_option_array[] = { 1, 2 };
00064 <span class="keyword">static</span> <span class="keywordtype">short</span>  disp_option_array[]   = { 1, 2 };
00065 
00066 <span class="comment">//-------- Define static variables ---------//</span>
00067 
00068 <span class="keyword">static</span> <a class="code" href="classButton.html">Button</a>  button_reset, button_ok, button_cancel;
00069 <span class="keyword">static</span> ListBox type_list;
00070 <span class="keyword">static</span> <span class="keywordtype">short</span>   gen_mode;
00071 <span class="keyword">static</span> <span class="keywordtype">short</span>   option_type;
00072 
00073 <span class="keyword">static</span> <span class="keywordtype">void</span>    disp_type_rec(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>);
00074 
00075 <span class="comment">//------- Begin of function Game::generator -------//</span>
<a name="l00085"></a><a class="code" href="classGame.html#a9">00085</a> <span class="comment">int Game::generator(int genMode) {</span>
00086     <span class="comment">//----- the settings available to change -----//</span>
00087 
00088     <span class="keywordtype">int</span> optionNum;
00089 
00090     <span class="keywordflow">switch</span>(genMode) {
00091     <span class="keywordflow">case</span> GEN_MODE_NEW:
00092         avail_option_array = normal_option_array;
00093         optionNum = 2;
00094         <span class="keywordflow">break</span>;
00095 
00096     <span class="keywordflow">case</span> GEN_MODE_DISP:
00097         avail_option_array = disp_option_array;
00098         optionNum = 2;
00099         <span class="keywordflow">break</span>;
00100     }
00101 
00102     gen_mode = genMode;
00103 
00104   <span class="comment">//--------- paint window -------------//</span>
00105 
00106     power.open_report( <a class="code" href="OGAMGEN_8CPP.html#a28a10">GEN_WIN_X1</a>, <a class="code" href="OGAMGEN_8CPP.html#a28a11">GEN_WIN_Y1</a>, <a class="code" href="OGAMGEN_8CPP.html#a28a12">GEN_WIN_X2</a>, <a class="code" href="OGAMGEN_8CPP.html#a28a13">GEN_WIN_Y2</a> );
00107 
00108     <span class="comment">//---------- Window Title ------------//</span>
00109 
00110     vga.d3_panel_down( <a class="code" href="OGAMGEN_8CPP.html#a29a14">GEN_HEADER_X1</a>, <a class="code" href="OGAMGEN_8CPP.html#a29a15">GEN_HEADER_Y1</a>, <a class="code" href="OGAMGEN_8CPP.html#a30a18">GEN_TYPE_X1</a>-10, <a class="code" href="OGAMGEN_8CPP.html#a29a17">GEN_HEADER_Y2</a>, 2 );
00111 
00112     icon_title.put( <a class="code" href="OGAMGEN_8CPP.html#a29a14">GEN_HEADER_X1</a>+2, <a class="code" href="OGAMGEN_8CPP.html#a29a15">GEN_HEADER_Y1</a>+2, <span class="stringliteral">"GAMESET"</span> );
00113 
00114   <span class="comment">//-------- option type selection --------------//</span>
00115 
00116     type_list.init(<a class="code" href="OGAMGEN_8CPP.html#a30a18">GEN_TYPE_X1</a>, <a class="code" href="OGAMGEN_8CPP.html#a30a19">GEN_TYPE_Y1</a>, <a class="code" href="OGAMGEN_8CPP.html#a30a20">GEN_TYPE_X2</a>, <a class="code" href="OGAMGEN_8CPP.html#a30a21">GEN_TYPE_Y2</a>,
00117                    optionNum, disp_type_rec );
00118 
00119     type_list.open(option_type);
00120 
00121   <span class="comment">//---------- create buttons --------------//</span>
00122 
00123     <span class="keywordflow">if</span>( gen_mode==GEN_MODE_DISP ) {
00124         button_ok.<a class="code" href="classButton.html#a11">paint_text</a>( <a class="code" href="OGAMGEN_8CPP.html#a28a10">GEN_WIN_X1</a>+250, <a class="code" href="OGAMGEN_8CPP.html#a28a13">GEN_WIN_Y2</a>-25, <span class="stringliteral">"Ok"</span> );
00125     }
00126     <span class="keywordflow">else</span> {
00127         <span class="keywordtype">int</span> x = <a class="code" href="OGAMGEN_8CPP.html#a28a10">GEN_WIN_X1</a> + 168;
00128 
00129         button_reset.<a class="code" href="classButton.html#a11">paint_text</a>( x+53 , <a class="code" href="OGAMGEN_8CPP.html#a28a13">GEN_WIN_Y2</a>-25, <span class="stringliteral">"Reset"</span> );
00130 
00131         button_ok     .<a class="code" href="classButton.html#a11">paint_text</a>( x+105, <a class="code" href="OGAMGEN_8CPP.html#a28a13">GEN_WIN_Y2</a>-25, <span class="stringliteral">"Ok"</span>      );
00132         button_cancel .<a class="code" href="classButton.html#a11">paint_text</a>( x+145, <a class="code" href="OGAMGEN_8CPP.html#a28a13">GEN_WIN_Y2</a>-25, <span class="stringliteral">"Cancel"</span>  );
00133     }
00134 
00135     <span class="comment">//------------ detect loop ---------------//</span>
00136 
00137     <span class="keywordtype">int</span> rc=1;
00138 
00139     gen_disp();
00140 
00141     <span class="keywordflow">while</span>( !button_ok.<a class="code" href="classButton.html#a21">detect</a>(<a class="code" href="KEY_8H.html#a3">KEY_RETURN</a>) ) {
00142         mouse.get_event();
00143 
00144         <span class="comment">//--------- detect option type ----------//</span>
00145 
00146         <span class="keywordflow">if</span>( type_list.detect() &gt; 0 ) {
00147             option_type = type_list.recno();
00148             gen_disp();
00149         }
00150 
00151         <span class="comment">//---------- detect controls ------------//</span>
00152 
00153         <span class="keywordflow">if</span>( gen_mode == GEN_MODE_DISP ) {             <span class="comment">// if display only</span>
00154             <span class="keywordflow">if</span>( mouse.single_click(1) )                 <span class="comment">// right button to quit</span>
00155                 <span class="keywordflow">break</span>;
00156         }
00157         <span class="keywordflow">else</span> {
00158             <span class="comment">//-------- detect option body ---------//</span>
00159 
00160             gen_detect();
00161 
00162             <span class="comment">//-------- detect cancel button ---------//</span>
00163 
00164             <span class="keywordflow">if</span>( button_cancel.<a class="code" href="classButton.html#a21">detect</a>(<a class="code" href="KEY_8H.html#a2">KEY_ESC</a>) ) {
00165                 rc = 0;
00166                 <span class="keywordflow">break</span>;
00167             }
00168 
00169             <span class="comment">//---- set all game settings to their default values ----//</span>
00170 
00171             <span class="keywordflow">if</span>( button_reset.<a class="code" href="classButton.html#a21">detect</a>() ) {
00172                 <span class="keywordflow">if</span>( box.ask( <span class="stringliteral">"Reset all settings to their default values ?"</span> ) ) {
00173                     default_setting();
00174                     gen_disp();
00175                 }
00176             }
00177         }
00178     }
00179 
00180     <span class="comment">//------------------------------------------------//</span>
00181 
00182     power.close_report();
00183 
00184     <span class="keywordflow">return</span> rc;
00185 }
00186 
00187 <span class="comment">//-------- End of function Game::generator -------//</span>
00188 
00189 <span class="comment">//------- Begin of function Game::gen_disp -------//</span>
<a name="l00193"></a><a class="code" href="classGame.html#a10">00193</a> <span class="comment">void Game::gen_disp(int refreshFlag) {</span>
00194     <span class="comment">// 1 use texture background</span>
00195     <span class="keywordflow">if</span>( refreshFlag==<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a> &amp;&amp; avail_option_array[option_type-1]!=1 )
00196         vga.d3_panel_down( <a class="code" href="OGAMGEN_8CPP.html#a31a22">GEN_BODY_X1</a>, <a class="code" href="OGAMGEN_8CPP.html#a31a23">GEN_BODY_Y1</a>, <a class="code" href="OGAMGEN_8CPP.html#a31a24">GEN_BODY_X2</a>, <a class="code" href="OGAMGEN_8CPP.html#a31a25">GEN_BODY_Y2</a>, 2, 1, <span class="stringliteral">"T_GAMGEN"</span> );
00197 
00198     <span class="keywordflow">switch</span>( avail_option_array[option_type-1] ) {
00199     <span class="keywordflow">case</span> 1:                                       <span class="comment">// Institution</span>
00200         <span class="comment">// 1-display and generate the map, rather than only generate it</span>
00201         gen_institution( <a class="code" href="OGAMGEN_8CPP.html#a31a22">GEN_BODY_X1</a>, <a class="code" href="OGAMGEN_8CPP.html#a31a23">GEN_BODY_Y1</a>, <a class="code" href="OGAMGEN_8CPP.html#a31a24">GEN_BODY_X2</a>, <a class="code" href="OGAMGEN_8CPP.html#a31a25">GEN_BODY_Y2</a>, 1 );
00202         <span class="keywordflow">break</span>;
00203 
00204     <span class="keywordflow">case</span> 2:                                       <span class="comment">// Characteristics</span>
00205         gen_characteristics( <a class="code" href="OGAMGEN_8CPP.html#a31a22">GEN_BODY_X1</a>, <a class="code" href="OGAMGEN_8CPP.html#a31a23">GEN_BODY_Y1</a>, <a class="code" href="OGAMGEN_8CPP.html#a31a24">GEN_BODY_X2</a>, <a class="code" href="OGAMGEN_8CPP.html#a31a25">GEN_BODY_Y2</a>, gen_mode );
00206         <span class="keywordflow">break</span>;
00207     }
00208 }
00209 
00210 <span class="comment">//-------- End of function Game::gen_disp -------//</span>
00211 
00212 <span class="comment">//------- Begin of function Game::gen_detect -------//</span>
<a name="l00214"></a><a class="code" href="classGame.html#a11">00214</a> <span class="comment">void Game::gen_detect() {</span>
00215     <span class="keywordflow">switch</span>( avail_option_array[option_type-1] ) {
00216     <span class="keywordflow">case</span> 1:                                       <span class="comment">// Institution</span>
00217         gen_institution_detect();
00218         <span class="keywordflow">break</span>;
00219 
00220     <span class="keywordflow">case</span> 2:                                       <span class="comment">// Characteristics</span>
00221         gen_characteristics_detect();
00222         <span class="keywordflow">break</span>;
00223     }
00224 }
00225 
00226 <span class="comment">//-------- End of function Game::gen_detect -------//</span>
00227 
00228 <span class="comment">//-------- Begin of static function disp_type_rec --------//</span>
00229 <span class="comment">//</span>
00230 <span class="keyword">static</span> <span class="keywordtype">void</span> disp_type_rec(<span class="keywordtype">int</span> recNo, <span class="keywordtype">int</span> x1, <span class="keywordtype">int</span> y1, <span class="keywordtype">int</span> x2) {
00231     <span class="keywordtype">int</span> optionId = avail_option_array[recNo-1];
00232 
00233     font_std.put( x1, y1, option_des_array[optionId-1], -1, 0, x2 );
00234 }
00235 
00236 <span class="comment">//----------- End of static function disp_type_rec -----------//</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:37:43 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
