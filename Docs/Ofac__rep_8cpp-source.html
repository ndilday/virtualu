<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Ofac_rep.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Ofac_rep.cpp</h1><a href="Ofac__rep_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : OFAC_REP.CPP</span>
00002 <span class="comment">//Description : Faculty Report</span>
00003 
00004 <span class="preprocessor">#include &lt;<a class="code" href="KEY_8H.html">KEY.H</a>&gt;</span>
00005 <span class="preprocessor">#include &lt;<a class="code" href="OVGA_8H.html">OVGA.H</a>&gt;</span>
00006 <span class="preprocessor">#include &lt;OFONT.H&gt;</span>
00007 <span class="preprocessor">#include &lt;<a class="code" href="OWORLD_8H.html">OWORLD.H</a>&gt;</span>
00008 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00009 <span class="preprocessor">#include &lt;OINFO.H&gt;</span>
00010 <span class="preprocessor">#include &lt;OMOUSE.H&gt;</span>
00011 <span class="preprocessor">#include &lt;OIFACE.H&gt;</span>
00012 <span class="preprocessor">#include &lt;OBUTTON.H&gt;</span>
00013 <span class="preprocessor">#include &lt;ODEPT.H&gt;</span>
00014 <span class="preprocessor">#include &lt;<a class="code" href="OVBROW98_8H.html">OVBROW98.H</a>&gt;</span>
00015 <span class="preprocessor">#include &lt;OSPINNER.H&gt;</span>
00016 <span class="preprocessor">#include &lt;OGAMESTR.H&gt;</span>
00017 <span class="preprocessor">#include &lt;OFACULTY.H&gt;</span>
00018 <span class="preprocessor">#include &lt;<a class="code" href="OFPHOTO_8H.html">OFPHOTO.H</a>&gt;</span>
00019 <span class="preprocessor">#include &lt;OFACURES.H&gt;</span>
00020 <span class="preprocessor">#include &lt;<a class="code" href="OBOX_8H.html">OBOX.H</a>&gt;</span>
00021 <span class="preprocessor">#include &lt;<a class="code" href="OTEXT_8H.html">OTEXT.H</a>&gt;</span>
00022 <span class="preprocessor">#include &lt;OAUDIO.H&gt;</span>
00023 <span class="preprocessor">#include &lt;OCONFIG.H&gt;</span>
00024 <span class="preprocessor">#include &lt;STDIO.H&gt;</span>
00025 <span class="preprocessor">#include &lt;<a class="code" href="ALL_8H.html">ALL.H</a>&gt;</span>
00026 <span class="preprocessor">#include &lt;OPSCHOOL.H&gt;</span>
00027 
00028 <span class="comment">//---------- Define constant ------------//</span>
00029 
00030 <span class="keyword">enum</span> {
00031     <a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a> = <a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>+15,
00032     <a class="code" href="Ofac__rep_8cpp.html#a43a21">REPORT_Y1</a> = <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>+15,
00033     <a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a> = <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-15,
00034     <a class="code" href="Ofac__rep_8cpp.html#a43a23">REPORT_Y2</a> = <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-40,
00035 };
00036 
00037 <span class="keyword">enum</span> { <a class="code" href="Ofac__rep_8cpp.html#a44a24">FACULTY_REC_HEIGHT</a> = 84, <a class="code" href="Ofac__rep_8cpp.html#a44a25">RESEARCH_REC_HEIGHT</a> = 16 };
00038 
00039 <span class="comment">//--------- Define report modes ----------//</span>
00040 
00041 <span class="keyword">enum</span> {                                            <span class="comment">// the bg image id</span>
00042     <a class="code" href="Ofac__rep_8cpp.html#a45a26">BG_PIC_ID</a> = 4
00043 };
00044 
00045 <span class="keyword">enum</span> { <a class="code" href="Ofac__rep_8cpp.html#a46a27">REPORT_TYPE_COUNT</a> = 2 };
00046 <span class="keyword">enum</span> { <a class="code" href="Ofac__rep_8cpp.html#a47a28">REPORT_TYPE_LIST</a>, <a class="code" href="Ofac__rep_8cpp.html#a47a29">REPORT_TYPE_DETAIL</a>, <a class="code" href="Ofac__rep_8cpp.html#a47a30">REPORT_RETIRE</a> };
00047 
00048 <span class="keyword">enum</span> { <a class="code" href="Ofac__rep_8cpp.html#a48a31">REPORT_MODE1_COUNT</a> = 3 };
00049 <span class="keyword">enum</span> {                                            <span class="comment">//### fred 1023</span>
00050     <a class="code" href="Ofac__rep_8cpp.html#a49a32">REPORT_MODE1_BASIC</a>, <a class="code" href="Ofac__rep_8cpp.html#a49a33">REPORT_MODE1_ACTIVITY</a>, <a class="code" href="Ofac__rep_8cpp.html#a49a34">REPORT_MODE1_ASSEST</a>
00051 };
00052 
00053 <span class="keyword">enum</span> { <a class="code" href="Ofac__rep_8cpp.html#a50a35">REPORT_MODE2_COUNT</a> = 2 };
00054 <span class="keyword">enum</span> { <a class="code" href="Ofac__rep_8cpp.html#a51a36">REPORT_MODE2_STD</a>, <a class="code" href="Ofac__rep_8cpp.html#a51a37">REPORT_MODE2_RESEARCH</a> };
00055 
00056 <span class="keyword">enum</span> { <a class="code" href="Ofac__rep_8cpp.html#a52a38">BUTTON_Y1</a>=<a class="code" href="Ofac__rep_8cpp.html#a43a23">REPORT_Y2</a>+10 };
00057 <span class="keyword">enum</span> { <a class="code" href="Ofac__rep_8cpp.html#a53a39">BUTTON_WIDTH</a>=90, <a class="code" href="Ofac__rep_8cpp.html#a53a40">BUTTON_HEIGHT</a>=20 };
00058 
00059 <span class="comment">//-------- define static vars -----------//</span>
00060 
00061 <span class="keyword">static</span> <span class="keywordtype">int</span>        last_faculty_count=0;
00062 <span class="keyword">static</span> <span class="keywordtype">int</span>        last_research_count=0;
00063 <span class="keyword">static</span> <a class="code" href="classVBrowse98.html">VBrowse98</a>    browse_faculty, browse_research;
00064 <span class="keyword">static</span> <a class="code" href="classDepartment.html">Department</a>*  cur_dept_ptr;                 <span class="comment">// the department whose faculty we are looking at</span>
00065 
00066 <span class="keyword">static</span> <a class="code" href="classButtonGroup.html">ButtonGroup</a>  button_type(<a class="code" href="Ofac__rep_8cpp.html#a46a27">REPORT_TYPE_COUNT</a>);
00067 <span class="keyword">static</span> <a class="code" href="classButtonGroup.html">ButtonGroup</a>  button_mode1_array(<a class="code" href="Ofac__rep_8cpp.html#a48a31">REPORT_MODE1_COUNT</a>);
00068 <span class="keyword">static</span> <a class="code" href="classButtonGroup.html">ButtonGroup</a>  button_mode2_array(<a class="code" href="Ofac__rep_8cpp.html#a50a35">REPORT_MODE2_COUNT</a>);
00069 <span class="keyword">static</span> <a class="code" href="classButton.html">Button</a>     button_prev, button_next, mode_fac_sum_button;
00070 <span class="keyword">static</span> <a class="code" href="classButton.html">Button</a>     button_retire, button_retire_cancel, button_retire_offer;
00071 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00072 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="classButton.html">Button</a>     button_dismiss;
00073 <span class="preprocessor">#endif</span>
00074 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="classSpinner.html">Spinner</a>      retire_spinner;
00075 
00076 <span class="keyword">static</span> <span class="keywordtype">char</span>* reportMode1StrArray[] = {            <span class="comment">//### fred 1023</span>
00077     <span class="stringliteral">"Basic"</span>, <span class="stringliteral">"Activity"</span>, <span class="stringliteral">"Assets"</span>
00078 };
00079 <span class="keyword">static</span> <span class="keywordtype">char</span>* reportMode2StrArray[] = { <span class="stringliteral">"Standard"</span>, <span class="stringliteral">"Extended"</span> };
00080 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00081 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="classButton.html">Button</a>     button_back;
00082 <span class="keywordtype">float</span> spinner1=25.0;
00083 <span class="preprocessor">#else</span>
00084 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">float</span> spinner1=25.0;
00085 <span class="preprocessor">#endif</span>
00086 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="classText.html">Text</a>  retire_result_txt;
00087 <span class="keyword">static</span> <span class="keywordtype">int</span> offerDollar;
00088 <span class="comment">//------ declare static functions -------//</span>
00089 
00090 <span class="keyword">static</span> <span class="keywordtype">void</span>   disp_faculty_rec(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>);
00091 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00092 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">void</span>   disp_display_faculty_rec(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>);
00093 <span class="preprocessor">#endif</span>
00094 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">void</span>   disp_research_rec(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>);
00095 
00096 <span class="comment">//----- Begin of function FacultyRes::report ------//</span>
<a name="l00102"></a><a class="code" href="classFacultyRes.html#a5">00102</a> <span class="comment">void FacultyRes::report(int refreshFlag) {</span>
00103     <span class="comment">//---- determine the department for display the faculty records ----//</span>
00104     <span class="keywordtype">int</span> deptRecno=1;
00105 
00106     <span class="keywordflow">if</span>( department_array.selected_recno )
00107         deptRecno = department_array.selected_recno;
00108     cur_dept_ptr = department_array[deptRecno];
00109 
00110     <span class="comment">// fix in version 2, infinite loop if report_faculty_recno is 0</span>
00111     <span class="keywordflow">if</span>( report_faculty_recno &lt;= 0)
00112         report_faculty_recno = 1;
00113 
00114     <span class="comment">// begin chwg080999 avoiding (facultyPtr-&gt;faculty_recno==0)</span>
00115     <a class="code" href="classFaculty.html">Faculty</a>* facultyPtr = cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m0">faculty_array</a>.<a class="code" href="classFacultyArray.html#a9">get_unpacked_faculty</a>(report_faculty_recno);
00116     <span class="keywordflow">while</span>((facultyPtr-&gt;<a class="code" href="classFaculty.html#m0">faculty_recno</a>==0)&amp;&amp;(report_faculty_recno!=1))
00117         facultyPtr = cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m0">faculty_array</a>.<a class="code" href="classFacultyArray.html#a9">get_unpacked_faculty</a>(--report_faculty_recno);
00118     <span class="comment">// end chwg080999</span>
00119 
00120     <span class="comment">//------ paint the background -------//</span>
00121     vga.use_back();
00122 
00123     <span class="keywordflow">if</span>( refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a> ) {
00124         user_interface.bg_img(<a class="code" href="Ofac__rep_8cpp.html#a45a26">BG_PIC_ID</a>, &amp;vga_back);
00125 
00126         <span class="keywordflow">if</span>( report_type==<a class="code" href="Ofac__rep_8cpp.html#a47a28">REPORT_TYPE_LIST</a> ) {
00127             user_interface.brighten(<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+100,<a class="code" href="Ofac__rep_8cpp.html#a43a21">REPORT_Y1</a>-13,<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+630,<a class="code" href="Ofac__rep_8cpp.html#a43a21">REPORT_Y1</a>+10);
00128             user_interface.rect(<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+100,<a class="code" href="Ofac__rep_8cpp.html#a43a21">REPORT_Y1</a>-13,<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+630,<a class="code" href="Ofac__rep_8cpp.html#a43a21">REPORT_Y1</a>+10,1);
00129             font_charts.put(<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+300,<a class="code" href="Ofac__rep_8cpp.html#a43a21">REPORT_Y1</a>-8,<span class="stringliteral">"Faculty Directory"</span>);
00130         }
00131 
00132         report_paint_button(refreshFlag);
00133     }
00134     <span class="keywordflow">else</span> {
00135         <span class="comment">//              report_paint_button(refreshFlag);</span>
00136     }
00137 
00138     <span class="comment">//----------- If it's in the list mode -------------//</span>
00139     <span class="keywordflow">if</span>( report_type==<a class="code" href="Ofac__rep_8cpp.html#a47a28">REPORT_TYPE_LIST</a> ) {
00140         <span class="keywordflow">if</span>( refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a> ) {
00141             browse_faculty.<a class="code" href="classVBrowse98.html#a2">init</a>( <a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>, <a class="code" href="Ofac__rep_8cpp.html#a43a21">REPORT_Y1</a>+10, <a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>, <a class="code" href="Ofac__rep_8cpp.html#a43a23">REPORT_Y2</a>+10,
00142                                  0, <a class="code" href="Ofac__rep_8cpp.html#a44a24">FACULTY_REC_HEIGHT</a>,
00143                                  cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m0">faculty_array</a>.<a class="code" href="classFacultyArray.html#m1">faculty_count</a>,
00144                                  disp_faculty_rec, <a class="code" href="OHELP_8H.html#a0">NULL</a> ,1 );
00145             browse_faculty.<a class="code" href="classVBrowse98.html#a4">open</a>(report_faculty_recno,cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m0">faculty_array</a>.<a class="code" href="classFacultyArray.html#m1">faculty_count</a>);
00146         }
00147         <span class="keywordflow">else</span> {                                        <span class="comment">// refreshFlag == INFO_UPDATE</span>
00148             <span class="comment">//                  browse_faculty.refresh(-1, cur_dept_ptr-&gt;faculty_array.faculty_count);</span>
00149         }
00150         report_faculty_recno = browse_faculty.<a class="code" href="classVBrowse98.html#a6">recno</a>();
00151     }
00152     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( report_type==<a class="code" href="Ofac__rep_8cpp.html#a47a29">REPORT_TYPE_DETAIL</a>) {
00153         <span class="comment">//------- if it's in detailed mode --------//</span>
00154         <span class="keywordflow">if</span>( cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m0">faculty_array</a>.<a class="code" href="classFacultyArray.html#m1">faculty_count</a> &gt; 0 ) {
00155             <span class="keywordflow">switch</span>( faculty_res.report_det_mode ) {
00156             <span class="keywordflow">case</span> <a class="code" href="Ofac__rep_8cpp.html#a51a36">REPORT_MODE2_STD</a>:
00157                 facultyPtr-&gt;<a class="code" href="classFaculty.html#a16">disp_detail_std</a>(refreshFlag);
00158                 <span class="keywordflow">break</span>;
00159             }
00160         }
00161     }
00162     last_faculty_count = cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m0">faculty_array</a>.<a class="code" href="classFacultyArray.html#m1">faculty_count</a>;
00163 
00164     <span class="keywordflow">if</span>( report_type==<a class="code" href="Ofac__rep_8cpp.html#a47a30">REPORT_RETIRE</a> ) {
00165         <span class="keywordflow">if</span>( refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a> ) {
00166             <span class="keywordflow">switch</span>( faculty_res.report_det_mode ) {
00167             <span class="keywordflow">case</span> <a class="code" href="Ofac__rep_8cpp.html#a51a36">REPORT_MODE2_STD</a>:
00168                 facultyPtr-&gt;<a class="code" href="classFaculty.html#a16">disp_detail_std</a>(refreshFlag);
00169                 <span class="keywordflow">break</span>;
00170             }
00171 
00172             <span class="comment">//                  user_interface.darken(ZOOM_X1, ZOOM_Y1, ZOOM_X2, ZOOM_Y2);</span>
00173             user_interface.darken(<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>, <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>);
00174             info.disp_column_bitmap(&amp;vga_back);
00175             user_interface.bar(200,200,600,400,<a class="code" href="COLOR_8H.html#a17">V_WHITE</a>);
00176             user_interface.brighten(200,200,600,400);
00177             user_interface.rect(200,200,600,400);
00178 
00179             button_retire_offer.<a class="code" href="classButton.html#a10">create_text</a>(250,370,400,390,<span class="stringliteral">"Make offer"</span>,1);
00180             button_retire_offer.<a class="code" href="classButton.html#a20">paint</a>();
00181             button_retire_cancel.<a class="code" href="classButton.html#a10">create_text</a>(450,370,550,390,<span class="stringliteral">"Cancel"</span>,1);
00182             button_retire_cancel.<a class="code" href="classButton.html#a20">paint</a>();
00183 
00184             font_chartsm.put(260,220,<span class="stringliteral">"How much would you offer to "</span>);
00185             font_chart_blue_sm.put(430,220,facultyPtr-&gt;<a class="code" href="classFaculty.html#a0">name</a>());
00186             font_chartsm.put(260,240,<span class="stringliteral">"for retirement?"</span>);
00187 
00188             <span class="comment">//                  retire_spinner.init(260, 275, 360, 305, &amp;spinner1, 25.0, 300.0, 5.0,0,NULL,23);</span>
00189 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00190 <span class="preprocessor"></span>            <span class="keywordflow">if</span> ( facultyPtr-&gt;<a class="code" href="classFaculty.html#m6">rank_level</a> == <a class="code" href="Ofaculty_8h.html#a27a12">LONG_TERM_ADJUNCT</a> ) {
00191                 <span class="keywordtype">int</span> yearCount  = (info.game_date-facultyPtr-&gt;<a class="code" href="classFaculty.html#m9">start_teaching_date</a>) / 365;
00192                 <span class="keywordtype">int</span> monthCount = ((info.game_date-facultyPtr-&gt;<a class="code" href="classFaculty.html#m9">start_teaching_date</a>) % 365) / 30;
00193                 <span class="keywordtype">int</span> remainYear;
00194 
00195                 <span class="keywordflow">if</span> ( monthCount )
00196                     remainYear = 5-yearCount%5-1;
00197                 <span class="keywordflow">else</span>
00198                     remainYear = 5-yearCount%5;
00199 
00200                 <span class="keywordtype">int</span> x = remainYear;
00201 
00202                 <span class="keywordflow">if</span> ( spinner1 != (float)x*10 )
00203                     spinner1 = (float)x*10;
00204             }
00205             <span class="keywordflow">else</span> {
00206                 spinner1 = 100.0;
00207             }
00208 <span class="preprocessor">#endif</span>
00209 <span class="preprocessor"></span>
00210 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00211 <span class="preprocessor"></span>            <span class="comment">//## chea 230999</span>
00212             retire_spinner.<a class="code" href="classSpinner.html#a2">init</a>(260, 275, 360, 305, &amp;spinner1, 10.0, 300.0, 5.0,0,<a class="code" href="OHELP_8H.html#a0">NULL</a>,25);
00213 <span class="preprocessor">#else</span>
00214 <span class="preprocessor"></span>            <span class="comment">//## chea 230999</span>
00215             retire_spinner.<a class="code" href="classSpinner.html#a2">init</a>(260, 275, 360, 305, &amp;spinner1, 25.0, 300.0, 5.0,0,<a class="code" href="OHELP_8H.html#a0">NULL</a>,25);
00216 <span class="preprocessor">#endif</span>
00217 <span class="preprocessor"></span>            retire_spinner.<a class="code" href="classSpinner.html#a4">paint</a>();
00218             font_chartsm.put(380,285,<span class="stringliteral">"of annual salary"</span>);
00219             font_chart_blue_sm.put(480,285,m.format(facultyPtr-&gt;<a class="code" href="classFaculty.html#m11">salary</a>,2));
00220 
00221             font_chartsm.put(260,315,<span class="stringliteral">"="</span>);
00222             offerDollar=(int)(facultyPtr-&gt;<a class="code" href="classFaculty.html#m11">salary</a>*(*(retire_spinner.<a class="code" href="classSpinner.html#m7">var_ptr</a>))/100);
00223             <span class="comment">//                  font_chart_blue_sm.put(270,315,m.format(offerDollar,1));  //## chea 230999  don't why this is here</span>
00224             <span class="comment">//                  font_chart_blue_sm.put(270,315,m.format(offerDollar,2));  //## chea 230999  don't why this is here</span>
00225             <span class="comment">//                  retire_result_txt.put(280,315,&amp;offerDollar,1);</span>
00226             <span class="comment">//## chea 230999</span>
00227             retire_result_txt.<a class="code" href="classText.html#a11">put</a>(280,315,&amp;offerDollar,2);
00228         }
00229         <span class="keywordflow">else</span> {
00230             offerDollar=(int)(facultyPtr-&gt;<a class="code" href="classFaculty.html#m11">salary</a>*(*(retire_spinner.<a class="code" href="classSpinner.html#m7">var_ptr</a>))/100);
00231             retire_spinner.<a class="code" href="classSpinner.html#a5">refresh</a>();
00232             retire_result_txt.<a class="code" href="classText.html#a25">refresh</a>();
00233         }
00234     }
00235     vga.blt_buf(<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>, <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>);
00236 }
00237 
00238 <span class="comment">//------- End of function FacultyRes::report ------//</span>
00239 
00240 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00241 <span class="preprocessor"></span><span class="comment">// --- Begin of function FacultyRes::report_faculty_hired --- //</span>
00242 <span class="comment">//</span>
00243 <span class="keywordtype">void</span>  FacultyRes::report_faculty_hired(<span class="keywordtype">int</span> refreshFlag) {
00244     <span class="comment">//---- determine the department for display the faculty records ----//</span>
00245     <span class="keywordtype">int</span> deptRecno=1;
00246 
00247     <span class="keywordflow">if</span>( department_array.selected_recno )
00248         deptRecno = department_array.selected_recno;
00249     cur_dept_ptr = department_array[deptRecno];
00250 
00251     <span class="comment">//------ paint the background -------//</span>
00252     vga.use_back();
00253 
00254     <span class="keywordflow">if</span>( refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a> ) {
00255         user_interface.bg_img(<a class="code" href="Ofac__rep_8cpp.html#a45a26">BG_PIC_ID</a>, &amp;vga_back);
00256 
00257         <span class="keywordflow">if</span>( <a class="code" href="classFacultyRes.html#m1">report_type</a>==<a class="code" href="Ofac__rep_8cpp.html#a47a28">REPORT_TYPE_LIST</a> ) {
00258             user_interface.brighten(<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+100,<a class="code" href="Ofac__rep_8cpp.html#a43a21">REPORT_Y1</a>-13,<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+630,<a class="code" href="Ofac__rep_8cpp.html#a43a21">REPORT_Y1</a>+10);
00259             user_interface.rect(<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+100,<a class="code" href="Ofac__rep_8cpp.html#a43a21">REPORT_Y1</a>-13,<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+630,<a class="code" href="Ofac__rep_8cpp.html#a43a21">REPORT_Y1</a>+10,1);
00260             <span class="keywordflow">if</span> ( is_year_end_report )
00261                 font_charts.center_put(<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+100,<a class="code" href="Ofac__rep_8cpp.html#a43a21">REPORT_Y1</a>-13,<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+630,<a class="code" href="Ofac__rep_8cpp.html#a43a21">REPORT_Y1</a>+10,<span class="stringliteral">"Faculty Changes &amp; Adjustments Report"</span>);
00262             <span class="keywordflow">else</span>
00263                 font_charts.center_put(<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+100,<a class="code" href="Ofac__rep_8cpp.html#a43a21">REPORT_Y1</a>-13,<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+630,<a class="code" href="Ofac__rep_8cpp.html#a43a21">REPORT_Y1</a>+10,<span class="stringliteral">"Faculty Hires, Promotions, and Departures"</span>);
00264         }
00265     }
00266     <span class="keywordflow">else</span> {
00267         <span class="comment">//              report_paint_button(refreshFlag);</span>
00268     }
00269 
00270     <span class="comment">// paint the Back button</span>
00271     <span class="keywordtype">int</span> x=<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+350, y=<a class="code" href="Ofac__rep_8cpp.html#a52a38">BUTTON_Y1</a>;
00272     button_back.<a class="code" href="classButton.html#a10">create_text</a>( x-30, y, x+<a class="code" href="Ofac__rep_8cpp.html#a53a39">BUTTON_WIDTH</a>, y+<a class="code" href="Ofac__rep_8cpp.html#a53a40">BUTTON_HEIGHT</a>, <span class="stringliteral">"Back"</span>);
00273     button_back.<a class="code" href="classButton.html#a20">paint</a>();
00274 
00275     <span class="comment">// if no details to show</span>
00276     <span class="keywordflow">if</span> ( cur_dept_ptr-&gt;display_faculty_array.size() == 0 ) {
00277         vga.blt_buf(<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>, <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>);
00278         <span class="keywordflow">return</span>;
00279     }
00280 
00281     <span class="comment">// begin chwg080999 avoiding (facultyPtr-&gt;faculty_recno==0)</span>
00282     <a class="code" href="classFaculty.html">Faculty</a>* facultyPtr = (<a class="code" href="classFaculty.html">Faculty</a>*) cur_dept_ptr-&gt;display_faculty_array.get(<a class="code" href="classFacultyRes.html#m4">report_faculty_recno</a>);
00283     <span class="comment">// end chwg080999</span>
00284 
00285     <span class="keywordflow">if</span>( refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a> ) {
00286         <span class="keywordflow">if</span> ( is_year_end_report ) {
00287             browse_faculty.<a class="code" href="classVBrowse98.html#a2">init</a>( <a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>, <a class="code" href="Ofac__rep_8cpp.html#a43a21">REPORT_Y1</a>+10, <a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>, <a class="code" href="Ofac__rep_8cpp.html#a43a23">REPORT_Y2</a>+10,
00288                                  0, <a class="code" href="Ofac__rep_8cpp.html#a44a24">FACULTY_REC_HEIGHT</a>,
00289                                  cur_dept_ptr-&gt;cur_faculty_array.size(),
00290                                  disp_display_faculty_rec, <a class="code" href="OHELP_8H.html#a0">NULL</a> ,1 );
00291             browse_faculty.<a class="code" href="classVBrowse98.html#a4">open</a>(<a class="code" href="classFacultyRes.html#m4">report_faculty_recno</a>,cur_dept_ptr-&gt;cur_faculty_array.size());
00292         }
00293         <span class="keywordflow">else</span> {
00294             browse_faculty.<a class="code" href="classVBrowse98.html#a2">init</a>( <a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>, <a class="code" href="Ofac__rep_8cpp.html#a43a21">REPORT_Y1</a>+10, <a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>, <a class="code" href="Ofac__rep_8cpp.html#a43a23">REPORT_Y2</a>+10,
00295                                  0, <a class="code" href="Ofac__rep_8cpp.html#a44a24">FACULTY_REC_HEIGHT</a>,
00296                                  cur_dept_ptr-&gt;display_faculty_array.size(),
00297                                  disp_display_faculty_rec, <a class="code" href="OHELP_8H.html#a0">NULL</a> ,1 );
00298             browse_faculty.<a class="code" href="classVBrowse98.html#a4">open</a>(<a class="code" href="classFacultyRes.html#m4">report_faculty_recno</a>,cur_dept_ptr-&gt;display_faculty_array.size());
00299         }
00300     }
00301     <span class="keywordflow">else</span> {                                          <span class="comment">// refreshFlag == INFO_UPDATE</span>
00302         <span class="comment">//                      browse_faculty.refresh(-1, cur_dept_ptr-&gt;faculty_array.faculty_count);</span>
00303     }
00304     <a class="code" href="classFacultyRes.html#m4">report_faculty_recno</a> = browse_faculty.<a class="code" href="classVBrowse98.html#a6">recno</a>();
00305 
00306     last_faculty_count = cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m0">faculty_array</a>.<a class="code" href="classFacultyArray.html#m1">faculty_count</a>;
00307     vga.blt_buf(<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>, <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>);
00308 }
00309 
00310 <span class="comment">//</span>
00311 <span class="comment">// --- End of function FacultyRes::report_faculty_hired --- //</span>
00312 <span class="preprocessor">#endif</span>
00313 <span class="preprocessor"></span>
00314 <span class="comment">//------- Begin of function FacultyRes::report_paint_button ------//</span>
00315 
00316 <span class="keywordtype">void</span> FacultyRes::report_paint_button(<span class="keywordtype">int</span> refreshFlag) {
00317     <span class="comment">//-------- paint type buttons ------------//</span>
00318     <span class="keywordtype">int</span> x=<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+50, y=<a class="code" href="Ofac__rep_8cpp.html#a52a38">BUTTON_Y1</a>;
00319     button_type[0].create_text( x, y, x+<a class="code" href="Ofac__rep_8cpp.html#a53a39">BUTTON_WIDTH</a>, y+<a class="code" href="Ofac__rep_8cpp.html#a53a40">BUTTON_HEIGHT</a>, <span class="stringliteral">"List"</span> );
00320     <span class="comment">//  button_type[0].set_key( 'L' );</span>
00321 
00322     x+=<a class="code" href="Ofac__rep_8cpp.html#a53a39">BUTTON_WIDTH</a>+10;
00323     button_type[1].create_text( x, y, x+<a class="code" href="Ofac__rep_8cpp.html#a53a39">BUTTON_WIDTH</a>, y+<a class="code" href="Ofac__rep_8cpp.html#a53a40">BUTTON_HEIGHT</a>, <span class="stringliteral">"Detail"</span> );
00324     <span class="comment">//  button_type[1].set_key( 'D' );</span>
00325     button_type.<a class="code" href="classButtonGroup.html#a3">paint</a>(<a class="code" href="classFacultyRes.html#m1">report_type</a>);
00326 
00327     mode_fac_sum_button.<a class="code" href="classButton.html#a10">create_text</a>(  <a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+<a class="code" href="Ofac__rep_8cpp.html#a53a39">BUTTON_WIDTH</a>*2+80, <a class="code" href="Ofac__rep_8cpp.html#a52a38">BUTTON_Y1</a>,
00328                                       <a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+<a class="code" href="Ofac__rep_8cpp.html#a53a39">BUTTON_WIDTH</a>*3+80, <a class="code" href="Ofac__rep_8cpp.html#a52a38">BUTTON_Y1</a>+<a class="code" href="Ofac__rep_8cpp.html#a53a40">BUTTON_HEIGHT</a>,<span class="stringliteral">"Back"</span>,1);
00329     mode_fac_sum_button.<a class="code" href="classButton.html#a20">paint</a>();
00330 
00331     <span class="comment">//---------- list mode -----------//</span>
00332 
00333     <span class="keywordflow">if</span>( <a class="code" href="classFacultyRes.html#m1">report_type</a>==<a class="code" href="Ofac__rep_8cpp.html#a47a28">REPORT_TYPE_LIST</a> ) {
00334         x=<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+<a class="code" href="Ofac__rep_8cpp.html#a53a39">BUTTON_WIDTH</a>*3+110;
00335         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0 ; i&lt;<a class="code" href="Ofac__rep_8cpp.html#a48a31">REPORT_MODE1_COUNT</a> ; i++, x+=<a class="code" href="Ofac__rep_8cpp.html#a53a39">BUTTON_WIDTH</a>+10 ) {
00336             button_mode1_array[i].create_text( x, y, x+<a class="code" href="Ofac__rep_8cpp.html#a53a39">BUTTON_WIDTH</a>, y+<a class="code" href="Ofac__rep_8cpp.html#a53a40">BUTTON_HEIGHT</a>, reportMode1StrArray[i], 0 );
00337             <span class="comment">//                  button_mode1_array[i].set_key( '1' + i );</span>
00338         }
00339 
00340         button_mode1_array.<a class="code" href="classButtonGroup.html#a3">paint</a>(<a class="code" href="classFacultyRes.html#m2">report_list_mode</a>);
00341     }
00342     <span class="keywordflow">else</span> {                                          <span class="comment">//------- detail mode ---------//</span>
00343         <a class="code" href="classFaculty.html">Faculty</a>* facultyPtr;
00344         facultyPtr = cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m0">faculty_array</a>.<a class="code" href="classFacultyArray.html#a9">get_unpacked_faculty</a>(<a class="code" href="classFacultyRes.html#m4">report_faculty_recno</a>);
00345         <span class="keywordflow">if</span>( facultyPtr-&gt;<a class="code" href="classFaculty.html#a1">age</a>()&gt;=55) {
00346 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00347 <span class="preprocessor"></span>            x=<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+<a class="code" href="Ofac__rep_8cpp.html#a53a39">BUTTON_WIDTH</a>*3+90;
00348 <span class="preprocessor">#else</span>
00349 <span class="preprocessor"></span>            x=<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+<a class="code" href="Ofac__rep_8cpp.html#a53a39">BUTTON_WIDTH</a>*3+135;
00350 <span class="preprocessor">#endif</span>
00351 <span class="preprocessor"></span>            button_retire.<a class="code" href="classButton.html#a10">create_text</a>(x, y, x+<a class="code" href="Ofac__rep_8cpp.html#a53a39">BUTTON_WIDTH</a>+30, y+<a class="code" href="Ofac__rep_8cpp.html#a53a40">BUTTON_HEIGHT</a>,<span class="stringliteral">"Retirement"</span>,1);
00352             button_retire.<a class="code" href="classButton.html#a20">paint</a>();
00353         }
00354 
00355 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00356 <span class="preprocessor"></span>        <span class="keywordflow">if</span> ( facultyPtr-&gt;<a class="code" href="classFaculty.html#m6">rank_level</a> != <a class="code" href="Ofaculty_8h.html#a27a10">ASSOC_PROF</a> &amp;&amp; facultyPtr-&gt;<a class="code" href="classFaculty.html#m6">rank_level</a> != <a class="code" href="Ofaculty_8h.html#a27a11">FULL_PROF</a> ) {
00357             button_dismiss.<a class="code" href="classButton.html#a10">create_text</a>( <a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+<a class="code" href="Ofac__rep_8cpp.html#a53a39">BUTTON_WIDTH</a>*3+230, <a class="code" href="Ofac__rep_8cpp.html#a52a38">BUTTON_Y1</a>,
00358                                         <a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+<a class="code" href="Ofac__rep_8cpp.html#a53a39">BUTTON_WIDTH</a>*4+230, <a class="code" href="Ofac__rep_8cpp.html#a52a38">BUTTON_Y1</a>+<a class="code" href="Ofac__rep_8cpp.html#a53a40">BUTTON_HEIGHT</a>,<span class="stringliteral">"Dismiss"</span>,1);
00359             <span class="keywordflow">if</span> ( facultyPtr-&gt;is_dismissed )
00360                 button_dismiss.<a class="code" href="classButton.html#a26">disable</a>();
00361             button_dismiss.<a class="code" href="classButton.html#a20">paint</a>();
00362         }
00363 <span class="preprocessor">#endif</span>
00364 <span class="preprocessor"></span>
00365         <span class="keywordflow">if</span>( <a class="code" href="classFacultyRes.html#m4">report_faculty_recno</a> &gt; 1 )
00366             image_interface.put_back(<a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-90,<a class="code" href="Ofac__rep_8cpp.html#a52a38">BUTTON_Y1</a>,<span class="stringliteral">"L-ARW-UP"</span>);
00367         <span class="keywordflow">else</span>
00368             image_interface.put_back(<a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-90,<a class="code" href="Ofac__rep_8cpp.html#a52a38">BUTTON_Y1</a>,<span class="stringliteral">"L-ARW-DB"</span>);
00369 
00370         <span class="keywordflow">if</span>( <a class="code" href="classFacultyRes.html#m4">report_faculty_recno</a> &lt; cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m0">faculty_array</a>.<a class="code" href="classFacultyArray.html#m1">faculty_count</a> )
00371             image_interface.put_back(<a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-40,<a class="code" href="Ofac__rep_8cpp.html#a52a38">BUTTON_Y1</a>,<span class="stringliteral">"R-ARW-UP"</span>);
00372         <span class="keywordflow">else</span>
00373             image_interface.put_back(<a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-40,<a class="code" href="Ofac__rep_8cpp.html#a52a38">BUTTON_Y1</a>,<span class="stringliteral">"R-ARW-DB"</span>);
00374     }
00375 }
00376 
00377 <span class="comment">//------- End of function FacultyRes::report_paint_button ------//</span>
00378 
00379 <span class="comment">//----- Begin of function FacultyRes::report_detect ------//</span>
<a name="l00381"></a><a class="code" href="classFacultyRes.html#a6">00381</a> <span class="comment">void FacultyRes::report_detect() {</span>
00382     <span class="comment">//------- detect type buttons --------//</span>
00383 
00384     <span class="keywordflow">if</span>( report_type==<a class="code" href="Ofac__rep_8cpp.html#a47a28">REPORT_TYPE_LIST</a> ||
00385         report_type==<a class="code" href="Ofac__rep_8cpp.html#a47a29">REPORT_TYPE_DETAIL</a> ) {
00386         vga.use_front();
00387         <span class="keywordflow">if</span>( button_type.<a class="code" href="classButtonGroup.html#a4">detect</a>() &gt;= 0 ) {
00388             report_type = button_type.<a class="code" href="classButtonGroup.html#m1">button_pressed</a>;
00389             sys.redraw_all_flag = 1;
00390         }
00391     }
00392 
00393     <span class="comment">//------- list mode ----------//</span>
00394     <span class="keywordflow">if</span>( report_type==<a class="code" href="Ofac__rep_8cpp.html#a47a28">REPORT_TYPE_LIST</a> ) {
00395         browse_faculty.<a class="code" href="classVBrowse98.html#a8">detect</a>();
00396 
00397         <span class="keywordflow">if</span>( button_mode1_array.<a class="code" href="classButtonGroup.html#a4">detect</a>() &gt;= 0 ) {
00398             report_list_mode = button_mode1_array.<a class="code" href="classButtonGroup.html#m1">button_pressed</a>;
00399             sys.redraw_all_flag = 1;
00400         }
00401     }
00402     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( report_type==<a class="code" href="Ofac__rep_8cpp.html#a47a29">REPORT_TYPE_DETAIL</a> ) {
00403         <span class="comment">//------- detail mode ----------//</span>
00404         vga.use_back();
00405         browse_research.<a class="code" href="classVBrowse98.html#a8">detect</a>();
00406 
00407         vga.use_front();
00408         <a class="code" href="classFaculty.html">Faculty</a>* facultyPtr;
00409         facultyPtr = cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m0">faculty_array</a>.<a class="code" href="classFacultyArray.html#a9">get_unpacked_faculty</a>(report_faculty_recno);
00410         <span class="keywordflow">if</span>( facultyPtr-&gt;<a class="code" href="classFaculty.html#a1">age</a>()&gt;=55) {
00411             <span class="keywordflow">if</span>( button_retire.<a class="code" href="classButton.html#a21">detect</a>() ) {
00412                 report_type=<a class="code" href="Ofac__rep_8cpp.html#a47a30">REPORT_RETIRE</a>;
00413                 sys.redraw_all_flag = 1;
00414             }
00415         }
00416 
00417 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00418 <span class="preprocessor"></span>        <span class="keywordflow">if</span> ( facultyPtr-&gt;<a class="code" href="classFaculty.html#m6">rank_level</a> != <a class="code" href="Ofaculty_8h.html#a27a10">ASSOC_PROF</a> &amp;&amp; facultyPtr-&gt;<a class="code" href="classFaculty.html#m6">rank_level</a> != <a class="code" href="Ofaculty_8h.html#a27a11">FULL_PROF</a> ) {
00419             <span class="comment">// need to ask player to confirm</span>
00420             <span class="keywordflow">if</span> ( button_dismiss.<a class="code" href="classButton.html#a21">detect</a>() ) {
00421                 <span class="keywordtype">char</span> displayText[128];
00422                 <span class="keywordtype">short</span> okCancel=0;
00423 
00424                 <span class="comment">// Normal</span>
00425                 <span class="keywordflow">if</span> ( player_school.behavioral_response_speed == <a class="code" href="Gamedef_8h.html#a73a22">INPUT_LOW</a> ) {
00426                     <span class="keywordflow">if</span> ( facultyPtr-&gt;<a class="code" href="classFaculty.html#m6">rank_level</a> == <a class="code" href="Ofaculty_8h.html#a27a13">SHORT_TERM_ADJUNCT</a> ) {
00427                         sprintf( displayText, <span class="stringliteral">"The contract for %s will be terminated at the end of this year."</span>, facultyPtr-&gt;<a class="code" href="classFaculty.html#a0">name</a>() );
00428                         facultyPtr-&gt;dismiss_trimester = <a class="code" href="Gamedef_8h.html#a78a35">TRIMESTER_PER_YEAR</a> - player_school.cur_trimester;
00429                     }
00430                     <span class="keywordflow">else</span>
00431                         <span class="keywordflow">if</span> ( facultyPtr-&gt;<a class="code" href="classFaculty.html#m6">rank_level</a> == <a class="code" href="Ofaculty_8h.html#a27a12">LONG_TERM_ADJUNCT</a> ) {
00432                             <span class="keywordtype">int</span> yearCount  = (info.game_date-facultyPtr-&gt;<a class="code" href="classFaculty.html#m9">start_teaching_date</a>) / 365;
00433                             <span class="keywordtype">int</span> monthCount = ((info.game_date-facultyPtr-&gt;<a class="code" href="classFaculty.html#m9">start_teaching_date</a>) % 365) / 30;
00434                             <span class="keywordtype">int</span> remainYear;
00435 
00436                             <span class="keywordflow">if</span> ( monthCount )
00437                                 remainYear = 5-yearCount%5-1;
00438                             <span class="keywordflow">else</span>
00439                                 remainYear = 5-yearCount%5;
00440 
00441                             sprintf( displayText, <span class="stringliteral">"The contract for %s will be terminated at the end of year %d."</span>, facultyPtr-&gt;<a class="code" href="classFaculty.html#a0">name</a>(), remainYear+info.financial_year() );
00442                             facultyPtr-&gt;dismiss_trimester = (remainYear+1)*<a class="code" href="Gamedef_8h.html#a78a35">TRIMESTER_PER_YEAR</a>-player_school.cur_trimester;
00443                         }
00444                         <span class="keywordflow">else</span>
00445                             <span class="keywordflow">if</span> ( facultyPtr-&gt;<a class="code" href="classFaculty.html#m6">rank_level</a> == <a class="code" href="Ofaculty_8h.html#a27a9">ASST_PROF</a> ) {
00446                                 <span class="keywordtype">int</span> yearCount  = (info.game_date-facultyPtr-&gt;<a class="code" href="classFaculty.html#m9">start_teaching_date</a>) / 365;
00447                                 <span class="keywordtype">int</span> monthCount = ((info.game_date-facultyPtr-&gt;<a class="code" href="classFaculty.html#m9">start_teaching_date</a>) % 365) / 30;
00448                                 <span class="keywordtype">int</span> remainYear;
00449 
00450                                 <span class="keywordflow">if</span> ( monthCount )
00451                                     remainYear = 3-yearCount%3-1;
00452                                 <span class="keywordflow">else</span>
00453                                     remainYear = 3-yearCount%3;
00454 
00455                                 sprintf( displayText, <span class="stringliteral">"The contract for %s will be terminated at the end of year %d."</span>, facultyPtr-&gt;<a class="code" href="classFaculty.html#a0">name</a>(), remainYear+info.financial_year() );
00456                                 facultyPtr-&gt;dismiss_trimester = (remainYear+1)*<a class="code" href="Gamedef_8h.html#a78a35">TRIMESTER_PER_YEAR</a>-player_school.cur_trimester;
00457                             }
00458                 }
00459                 <span class="keywordflow">else</span>
00460                     <span class="comment">// Faster speed</span>
00461                     <span class="keywordflow">if</span> ( player_school.behavioral_response_speed == <a class="code" href="Gamedef_8h.html#a73a23">INPUT_MEDIUM</a> ) {
00462                         sprintf( displayText, <span class="stringliteral">"The contract for %s will be terminated at the end of this year."</span>, facultyPtr-&gt;<a class="code" href="classFaculty.html#a0">name</a>() );
00463                         facultyPtr-&gt;dismiss_trimester = <a class="code" href="Gamedef_8h.html#a78a35">TRIMESTER_PER_YEAR</a>-player_school.cur_trimester;
00464                     }
00465                     <span class="keywordflow">else</span>
00466                         <span class="comment">// Lightspeed</span>
00467                         <span class="keywordflow">if</span> ( player_school.behavioral_response_speed == <a class="code" href="Gamedef_8h.html#a73a24">INPUT_HIGH</a> ) {
00468                             sprintf( displayText, <span class="stringliteral">"The contract for %s will be terminated at the end of this trimester."</span>, facultyPtr-&gt;<a class="code" href="classFaculty.html#a0">name</a>() );
00469                             facultyPtr-&gt;dismiss_trimester = 1;
00470                         }
00471 
00472                 <span class="keywordflow">if</span> ( box.ask( displayText ) ) {
00473                     facultyPtr-&gt;<a class="code" href="classFaculty.html#m35">satisfaction_index</a> *= 0.1;
00474                     facultyPtr-&gt;is_dismissed = 1;
00475                     sys.redraw_all_flag = 1;
00476                 }
00477             }
00478         }
00479 <span class="preprocessor">#endif</span>
00480 <span class="preprocessor"></span>
00481         <span class="keywordflow">if</span>(mouse.single_click(<a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-90,<a class="code" href="Ofac__rep_8cpp.html#a52a38">BUTTON_Y1</a>,<a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-65,<a class="code" href="Ofac__rep_8cpp.html#a52a38">BUTTON_Y1</a>+25)) {
00482             <span class="keywordflow">if</span>( --report_faculty_recno &lt; 1 ) {
00483                 report_faculty_recno = 1;
00484                 audio.play_wav(<span class="stringliteral">"BEEPS-N1"</span>,audio.int_to_DsVolume(config.sound_effect_volume));
00485             }
00486             <span class="keywordflow">if</span>(report_faculty_recno &gt; 1) {
00487                 image_interface.put_back(<a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-90,<a class="code" href="Ofac__rep_8cpp.html#a52a38">BUTTON_Y1</a>,<span class="stringliteral">"L-ARW-DN"</span>);
00488                 vga.blt_buf(<a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-90,<a class="code" href="Ofac__rep_8cpp.html#a52a38">BUTTON_Y1</a>,<a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-65,<a class="code" href="Ofac__rep_8cpp.html#a52a38">BUTTON_Y1</a>+25);
00489                 audio.play_wav(<span class="stringliteral">"BEEPS-1"</span>,audio.int_to_DsVolume(config.sound_effect_volume));
00490             }
00491             sys.redraw_all_flag=1;
00492         }
00493 
00494         <span class="keywordflow">if</span>(mouse.single_click(<a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-40,<a class="code" href="Ofac__rep_8cpp.html#a52a38">BUTTON_Y1</a>,<a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-15,<a class="code" href="Ofac__rep_8cpp.html#a52a38">BUTTON_Y1</a>+25)) {
00495             <span class="keywordflow">if</span>( ++report_faculty_recno &gt; cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m0">faculty_array</a>.<a class="code" href="classFacultyArray.html#m1">faculty_count</a> ) {
00496                 report_faculty_recno = cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m0">faculty_array</a>.<a class="code" href="classFacultyArray.html#m1">faculty_count</a>;
00497                 audio.play_wav(<span class="stringliteral">"BEEPS-N1"</span>,audio.int_to_DsVolume(config.sound_effect_volume));
00498             }
00499             <span class="keywordflow">if</span>(report_faculty_recno &lt; cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m0">faculty_array</a>.<a class="code" href="classFacultyArray.html#m1">faculty_count</a>) {
00500                 image_interface.put_back(<a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-40,<a class="code" href="Ofac__rep_8cpp.html#a52a38">BUTTON_Y1</a>,<span class="stringliteral">"R-ARW-DN"</span>);
00501                 vga.blt_buf(<a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-40,<a class="code" href="Ofac__rep_8cpp.html#a52a38">BUTTON_Y1</a>,<a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-15,<a class="code" href="Ofac__rep_8cpp.html#a52a38">BUTTON_Y1</a>+25);
00502                 audio.play_wav(<span class="stringliteral">"BEEPS-1"</span>,audio.int_to_DsVolume(config.sound_effect_volume));
00503             }
00504             sys.redraw_all_flag=1;
00505         }
00506     }
00507     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( report_type==<a class="code" href="Ofac__rep_8cpp.html#a47a30">REPORT_RETIRE</a> ) {
00508         vga.use_front();
00509         <span class="keywordflow">if</span>(retire_spinner.<a class="code" href="classSpinner.html#a6">detect</a>()) {
00510         }
00511 
00512         <span class="keywordflow">if</span>( button_retire_offer.<a class="code" href="classButton.html#a21">detect</a>() ) {
00513             <a class="code" href="classFaculty.html">Faculty</a>* facultyPtr;
00514             <a class="code" href="classString.html">String</a> str1;
00515             <span class="keywordtype">int</span> rc;
00516 
00517             facultyPtr = cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m0">faculty_array</a>.<a class="code" href="classFacultyArray.html#a9">get_unpacked_faculty</a>(report_faculty_recno);
00518             str1 = facultyPtr-&gt;<a class="code" href="classFaculty.html#a0">name</a>();
00519 
00520             <span class="keywordflow">if</span>(cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m0">faculty_array</a>.<a class="code" href="classFacultyArray.html#a10">is_deleted</a>(report_faculty_recno))
00521                 rc=2;
00522             <span class="keywordflow">else</span> {
00523                 <span class="keywordtype">int</span> offerDollar=(int)(facultyPtr-&gt;<a class="code" href="classFaculty.html#m11">salary</a>*(*(retire_spinner.<a class="code" href="classSpinner.html#m7">var_ptr</a>))/100);
00524                 rc=facultyPtr-&gt;<a class="code" href="classFaculty.html#a21">think_accept_retire</a>(offerDollar);
00525             }
00526 
00527             <span class="keywordflow">if</span>(rc==1)
00528                 str1 += <span class="stringliteral">"  accepts the retirement offer. "</span>;
00529             <span class="keywordflow">else</span>
00530                 str1 += <span class="stringliteral">"  rejects the retirement offer. "</span>;
00531             box.msg(str1);
00532 
00533             report_type=<a class="code" href="Ofac__rep_8cpp.html#a47a29">REPORT_TYPE_DETAIL</a>;
00534             sys.redraw_all_flag = 1;
00535         }
00536         <span class="keywordflow">if</span>( button_retire_cancel.<a class="code" href="classButton.html#a21">detect</a>() ) {
00537             report_type=<a class="code" href="Ofac__rep_8cpp.html#a47a29">REPORT_TYPE_DETAIL</a>;
00538             sys.redraw_all_flag = 1;
00539         }
00540     }
00541 }
00542 
00543 <span class="comment">//------- End of function FacultyRes::report_detect ------//</span>
00544 
00545 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00546 <span class="preprocessor"></span><span class="comment">// --- Begin of function FacultyRes::report_hired_detect --- //</span>
00547 <span class="comment">//</span>
00548 <span class="keywordtype">int</span> FacultyRes::report_hired_detect() {
00549     <span class="keywordflow">if</span> (button_back.<a class="code" href="classButton.html#a21">detect</a>()) {
00550         <span class="keywordflow">if</span> ( faculty_res.is_year_end_report ) {
00551             button_back.<a class="code" href="classButton.html#a24">push</a>();
00552             sys.redraw_all_flag = 1;
00553             <span class="keywordflow">return</span> 1;
00554         }
00555         <span class="keywordflow">else</span> {
00556             button_back.<a class="code" href="classButton.html#a24">push</a>();
00557             <a class="code" href="classFacultyRes.html#m9">current_report_type</a> = last_report_type;     <span class="comment">// REPORT_TYPE_INSTITUTION_TURNOVER</span>
00558             <span class="comment">//                  current_report_mode = 0;</span>
00559             sys.redraw_all_flag = 1;
00560         }
00561     }
00562     browse_faculty.<a class="code" href="classVBrowse98.html#a8">detect</a>();
00563     <span class="keywordflow">return</span> 0;
00564 }
00565 
00566 <span class="comment">//</span>
00567 <span class="comment">// --- End of function FacultyRes::report_hired_detect --- //</span>
00568 <span class="preprocessor">#endif</span>
00569 <span class="preprocessor"></span>
00570 <span class="comment">//-------- Begin of static function disp_faculty_rec --------//</span>
00571 <span class="comment">//</span>
00572 <span class="keyword">static</span> <span class="keywordtype">void</span> disp_faculty_rec(<span class="keywordtype">int</span> recNo, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> refreshFlag) {
00573     <a class="code" href="classFaculty.html">Faculty</a>* facultyPtr = cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m0">faculty_array</a>.<a class="code" href="classFacultyArray.html#a9">get_unpacked_faculty</a>(recNo);
00574 
00575     vga_back.d3_panel_down( x, y, x+browse_faculty.<a class="code" href="classVBrowse98.html#m4">rec_width</a>-6, y+browse_faculty.<a class="code" href="classVBrowse98.html#m3">rec_height</a>-1, 1 );
00576 
00577     <span class="comment">//--------- display the faculty portrait ---------//</span>
00578 
00579     <span class="comment">// 0-don't paint centre</span>
00580     vga_back.d3_panel_down( x+5, y+8, x+<a class="code" href="OFPHOTO_8H.html#a3a1">FACULTY_PHOTO_WIDTH</a>+6, y+<a class="code" href="OFPHOTO_8H.html#a3a2">FACULTY_PHOTO_HEIGHT</a>+9, 1, 0 );
00581 
00582     vga_back.put_bitmap( x+6, y+9, faculty_photo_res[facultyPtr-&gt;<a class="code" href="classFaculty.html#m2">photo_id</a>]-&gt;bitmap_ptr);
00583 
00584     <span class="comment">// 0=don't paint centre</span>
00585     vga_back.d3_panel_down( x+74, y+4, x+browse_faculty.<a class="code" href="classVBrowse98.html#m4">rec_width</a>-10, y+browse_faculty.<a class="code" href="classVBrowse98.html#m3">rec_height</a>-6, 1, 0 );
00586 
00587     <span class="comment">//------------ display info -------------//</span>
00588 
00589     <span class="keywordflow">switch</span>( faculty_res.report_list_mode ) {
00590     <span class="keywordflow">case</span> <a class="code" href="Ofac__rep_8cpp.html#a49a32">REPORT_MODE1_BASIC</a>:
00591 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00592 <span class="preprocessor"></span>        facultyPtr-&gt;<a class="code" href="classFaculty.html#a13">disp_summary_basic</a>(x+79, y+7, x+350, refreshFlag,0);
00593 <span class="preprocessor">#else</span>
00594 <span class="preprocessor"></span>        facultyPtr-&gt;<a class="code" href="classFaculty.html#a13">disp_summary_basic</a>(x+79, y+7, x+350, refreshFlag);
00595 <span class="preprocessor">#endif</span>
00596 <span class="preprocessor"></span>        <span class="keywordflow">break</span>;
00597 
00598     <span class="keywordflow">case</span> <a class="code" href="Ofac__rep_8cpp.html#a49a33">REPORT_MODE1_ACTIVITY</a>:
00599         facultyPtr-&gt;<a class="code" href="classFaculty.html#a14">disp_summary_activity</a>(x+79, y+7, x+350, refreshFlag);
00600         <span class="keywordflow">break</span>;
00601 
00602     <span class="keywordflow">case</span> <a class="code" href="Ofac__rep_8cpp.html#a49a34">REPORT_MODE1_ASSEST</a>:                     <span class="comment">//### fred 1023</span>
00603         facultyPtr-&gt;<a class="code" href="classFaculty.html#a15">disp_summary_assess</a>(x+79, y+7, x+350, refreshFlag);
00604         <span class="keywordflow">break</span>;
00605     }
00606 }
00607 
00608 <span class="comment">//-------- End of static function disp_faculty_rec --------//</span>
00609 
00610 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00611 <span class="preprocessor"></span><span class="comment">//-------- Begin of static function disp_display_faculty_rec --------//</span>
00612 <span class="comment">//</span>
00613 <span class="keyword">static</span> <span class="keywordtype">void</span> disp_display_faculty_rec(<span class="keywordtype">int</span> recNo, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> refreshFlag) {
00614     <a class="code" href="classFaculty.html">Faculty</a>* facultyPtr;
00615     <span class="keywordflow">if</span> ( faculty_res.is_year_end_report )
00616         facultyPtr = (<a class="code" href="classFaculty.html">Faculty</a>*) cur_dept_ptr-&gt;cur_faculty_array.get(recNo);
00617     <span class="keywordflow">else</span>
00618         facultyPtr = (<a class="code" href="classFaculty.html">Faculty</a>*) cur_dept_ptr-&gt;display_faculty_array.get(recNo);
00619 
00620     <span class="keywordflow">if</span> (( facultyPtr-&gt;employ_status == 0 ) &amp;&amp; (faculty_res.is_year_end_report ))
00621         <span class="keywordflow">return</span>;
00622 
00623     vga_back.d3_panel_down( x, y, x+browse_faculty.<a class="code" href="classVBrowse98.html#m4">rec_width</a>-6, y+browse_faculty.<a class="code" href="classVBrowse98.html#m3">rec_height</a>-1, 1 );
00624 
00625     <span class="comment">//--------- display the faculty portrait ---------//</span>
00626 
00627     <span class="comment">// 0-don't paint centre</span>
00628     vga_back.d3_panel_down( x+5, y+8, x+<a class="code" href="OFPHOTO_8H.html#a3a1">FACULTY_PHOTO_WIDTH</a>+6, y+<a class="code" href="OFPHOTO_8H.html#a3a2">FACULTY_PHOTO_HEIGHT</a>+9, 1, 0 );
00629 
00630     vga_back.put_bitmap( x+6, y+9, faculty_photo_res[facultyPtr-&gt;<a class="code" href="classFaculty.html#m2">photo_id</a>]-&gt;bitmap_ptr);
00631 
00632     <span class="comment">// 0=don't paint centre</span>
00633     vga_back.d3_panel_down( x+74, y+4, x+browse_faculty.<a class="code" href="classVBrowse98.html#m4">rec_width</a>-10, y+browse_faculty.<a class="code" href="classVBrowse98.html#m3">rec_height</a>-6, 1, 0 );
00634 
00635     <span class="comment">//------------ display info -------------//</span>
00636 
00637     facultyPtr-&gt;<a class="code" href="classFaculty.html#a13">disp_summary_basic</a>(x+79, y+7, x+350, refreshFlag,1);
00638 }
00639 
00640 <span class="comment">//-------- End of static function disp_display_faculty_rec --------//</span>
00641 <span class="preprocessor">#endif</span>
00642 <span class="preprocessor"></span>
00643 <span class="comment">//------ Begin of function Faculty::disp_summary_basic -------//</span>
00645 <span class="comment">#if(GAME_VERSION&gt;=200)</span>
00646 <span class="keywordtype">void</span> <a class="code" href="classFaculty.html#a13">Faculty::disp_summary_basic</a>(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> xColumn2, <span class="keywordtype">int</span> refreshFlag, <span class="keywordtype">int</span> displayModeFlag)
00647 #<span class="keywordflow">else</span>
<a name="l00648"></a><a class="code" href="classFaculty.html#a13">00648</a>     <span class="keywordtype">void</span> <a class="code" href="classFaculty.html#a13">Faculty::disp_summary_basic</a>(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> xColumn2, <span class="keywordtype">int</span> refreshFlag)
00649 #endif
00650 {
00651     <span class="keywordtype">int</span> x2=x+97;
00652 
00653     <span class="comment">//--------------- display fields -----------//</span>
00654 
00655     font_chartsm.field( x, y   , <span class="stringliteral">"Name"</span>         , x2, name(), xColumn2-1, refreshFlag );
00656     font_chartsm.field( x, y+17, <span class="stringliteral">"Gender/ethnicity"</span>, x2, game_str_res.gender_ethnic_str(gender_ethnic_group), xColumn2-1, refreshFlag );
00657     font_chartsm.field( x, y+34, <span class="stringliteral">"Age"</span>        , x2, age(), 1, xColumn2-1, refreshFlag );
00658     font_chartsm.field( x, y+51, <span class="stringliteral">"Rank"</span>      , x2, game_str_res.rank_str(rank_level), xColumn2-1, refreshFlag );
00659 
00660     x =xColumn2;
00661     x2=x+162;
00662 
00663     font_chartsm.field( x, y   , <span class="stringliteral">"Salary"</span>           , x2, salary, 2, <a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-30, refreshFlag );
00664     <span class="comment">//  font_chartsm.field( x, y+17, "Employed period"  , x2, employed_period(), REPORT_X2-30, refreshFlag );</span>
00665 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00666 <span class="preprocessor"></span>    <span class="keywordflow">if</span> ( displayModeFlag ) {
00667         <span class="keywordtype">char</span> employStr[123];
00668         <span class="keywordflow">if</span> ( employ_status == 0 )
00669             strcpy(employStr,<span class="stringliteral">"0 years"</span>);
00670         <span class="keywordflow">else</span>
00671             strcpy(employStr,employed_period());
00672         font_chartsm.field( x, y+17, <span class="stringliteral">"Time in rank"</span> , x2, employStr, <a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-30, refreshFlag );
00673     }
00674     <span class="keywordflow">else</span>
00675         font_chartsm.field( x, y+17, <span class="stringliteral">"Time in rank"</span> , x2, employed_period(), <a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-30, refreshFlag );
00676 <span class="preprocessor">#else</span>
00677 <span class="preprocessor"></span>    font_chartsm.field( x, y+17, <span class="stringliteral">"Time in rank"</span> , x2, employed_period(), <a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-30, refreshFlag );
00678 <span class="preprocessor">#endif</span>
00679 <span class="preprocessor"></span><span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00680 <span class="preprocessor"></span>    <span class="keywordflow">if</span> ( displayModeFlag ) {
00681         <span class="keywordtype">char</span> statusStr[123];
00682         <span class="keywordflow">switch</span>(employ_status) {
00683         <span class="keywordflow">case</span> 0: strcpy(statusStr,<span class="stringliteral">"New hire"</span>); <span class="keywordflow">break</span>;
00684         <span class="keywordflow">case</span> 1: strcpy(statusStr,<span class="stringliteral">"Departure"</span>); <span class="keywordflow">break</span>;
00685         <span class="keywordflow">case</span> 2: strcpy(statusStr,<span class="stringliteral">"Promotion"</span>); <span class="keywordflow">break</span>;
00686         <span class="keywordflow">default</span>: strcpy(statusStr,<span class="stringliteral">""</span>);
00687         }
00688         font_chartsm.field( x, y+34, <span class="stringliteral">"Status change"</span>, x2, statusStr, <a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-30, refreshFlag );
00689     }
00690     <span class="keywordflow">else</span>
00691         font_chartsm.field( x, y+34, <span class="stringliteral">"Off-duty trimester"</span>, x2, game_str_res.trimester_str(off_duty_trimester), <a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-30, refreshFlag );
00692 <span class="preprocessor">#else</span>
00693 <span class="preprocessor"></span>    font_chartsm.field( x, y+34, <span class="stringliteral">"Off-duty trimester"</span>, x2, game_str_res.trimester_str(off_duty_trimester), <a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-30, refreshFlag );
00694 <span class="preprocessor">#endif</span>
00695 <span class="preprocessor"></span>    font_chartsm.field( x, y+51, <span class="stringliteral">"Satisfaction index"</span>, x2, (<span class="keywordtype">int</span>) satisfaction_index, 3, <a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-30, refreshFlag );
00696 
00697     <span class="keywordflow">if</span>( faculty_res.report_type==<a class="code" href="Ofac__rep_8cpp.html#a47a28">REPORT_TYPE_LIST</a>) {
00698         x2+=140;
00699         <span class="keywordtype">int</span> h1,h2,h3;
00700         h1=(int)(21*performance_teaching/100);
00701         h2=(int)(21*performance_scholarship/100);
00702         h3=(int)(21*performance_research/100);
00703         vga_back.bar(x2-1,y+62-h3-h2-h1,x2+13,y+64,<a class="code" href="COLOR_8H.html#a15">V_BLACK</a>);
00704         vga_back.v_indicator(x2, y+63-h3-h2-h1, x2+12, y+63-h3-h2, performance_teaching, performance_teaching, <a class="code" href="COLOR_8H.html#a2">VGA_RED</a> );
00705         vga_back.v_indicator(x2, y+63-h3-h2, x2+12, y+63-h3, performance_scholarship, performance_scholarship, <a class="code" href="COLOR_8H.html#a1">VGA_YELLOW</a> );
00706         vga_back.v_indicator(x2, y+63-h3, x2+12, y+63, performance_research, performance_research, <a class="code" href="COLOR_8H.html#a3">VGA_SEA_GREEN</a> );
00707     }
00708 }
00709 
00710 <span class="comment">//-------- End of function Faculty::disp_summary_basic -------//</span>
00711 
00712 <span class="comment">//------ Begin of function Faculty::disp_summary_activity -------//</span>
<a name="l00714"></a><a class="code" href="classFaculty.html#a14">00714</a> <span class="comment">void Faculty::disp_summary_activity(int x, int y, int xColumn2, int refreshFlag) {</span>
00715     <span class="keywordtype">int</span> x2=x+200;
00716 
00717     <span class="comment">//--------------- display fields -----------//</span>
00718     font_chartsm.field( x, y   , <span class="stringliteral">"Teaching load"</span>,   x2, hour_str(teaching_contact_hour), xColumn2-1, refreshFlag );
00719     font_chartsm.field( x, y+17, <span class="stringliteral">"Course preparation"</span>, x2, hour_str(discretionary_hour_array[<a class="code" href="Ofaculty_8h.html#a29a15">DT_COURSE_PREPARATION</a>]), xColumn2-1, refreshFlag );
00720     font_chartsm.field( x, y+34, <span class="stringliteral">"Out-of-class student contact"</span>, x2, hour_str(discretionary_hour_array[<a class="code" href="Ofaculty_8h.html#a29a16">DT_OUT_OF_CLASS_STUDENT_CONTACT</a>]), xColumn2-1, refreshFlag );
00721     font_chartsm.field( x, y+51, <span class="stringliteral">"Educational development"</span>, x2, hour_str(discretionary_hour_array[<a class="code" href="Ofaculty_8h.html#a29a17">DT_EDUCATIONAL_DEVELOPMENT</a>]), xColumn2-1, refreshFlag );
00722     x=xColumn2;
00723     x2=x+210;
00724     font_chartsm.field( x, y   , <span class="stringliteral">"Research"</span>, x2, hour_str(discretionary_hour_array[<a class="code" href="Ofaculty_8h.html#a29a18">DT_RESEARCH</a>]), <a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-30, refreshFlag  );
00725     font_chartsm.field( x, y+17, <span class="stringliteral">"Scholarship"</span>, x2, hour_str(discretionary_hour_array[<a class="code" href="Ofaculty_8h.html#a29a19">DT_SCHOLARSHIP</a>]), <a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-30, refreshFlag  );
00726     font_chartsm.field( x, y+34, <span class="stringliteral">"Institutional and public service"</span>, x2, hour_str(discretionary_hour_array[<a class="code" href="Ofaculty_8h.html#a29a20">DT_INSTITUTIONAL_AND_PUBLIC_SERVICE</a>]), <a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-30, refreshFlag  );
00727     font_chartsm.field( x, y+51, <span class="stringliteral">"Total"</span>, x2, hour_str(total_hour()), <a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-30, refreshFlag  );
00728 }
00729 
00730 <span class="comment">//-------- End of function Faculty::disp_summary_activity -------//</span>
00731 
00732 <span class="comment">//------ Begin of function Faculty::disp_summary_assess -------//</span>
<a name="l00734"></a><a class="code" href="classFaculty.html#a15">00734</a> <span class="comment">void Faculty::disp_summary_assess(int x, int y, int xColumn2, int refreshFlag) {</span>
00735     <span class="keywordtype">int</span> x2=x+135;
00736 
00737     <span class="comment">//--------------- display fields -----------//</span>
00738 
00739     <span class="keywordtype">int</span> x3=x2+39;
00740 
00741     font_chartsm.field( x, y   , <span class="stringliteral">"Talent: Teaching"</span>   , x2, (<span class="keywordtype">int</span>) talent_teaching, 3, x3, refreshFlag );
00742     font_chartsm.field( x, y+17, <span class="stringliteral">"Talent: Scholarship"</span>, x2, (<span class="keywordtype">int</span>) talent_scholarship, 3, x3, refreshFlag);
00743     font_chartsm.field( x, y+34, <span class="stringliteral">"Talent: Research"</span>   , x2, (<span class="keywordtype">int</span>) talent_research, 3, x3, refreshFlag );
00744 
00745     x3++;
00746     <span class="keywordtype">int</span> x4 = xColumn2-5;
00747 
00748     vga_back.indicator( x3, y+3 , x4, y+14, talent_teaching   , 100, <a class="code" href="COLOR_8H.html#a2">VGA_RED</a> , -2);
00749     vga_back.indicator( x3, y+20, x4, y+31, talent_scholarship, 100, <a class="code" href="COLOR_8H.html#a1">VGA_YELLOW</a> , -2);
00750     vga_back.indicator( x3, y+37, x4, y+48, talent_research   , 100, <a class="code" href="COLOR_8H.html#a3">VGA_SEA_GREEN</a> , -2);
00751 
00752     <span class="comment">//--------------------------------------------------//</span>
00753 
00754     x =xColumn2;
00755     x2=x+170;
00756 
00757     x3=x2+39;
00758 
00759     font_chartsm.field( x, y   , <span class="stringliteral">"Performance: Teaching"</span>   , x2, (<span class="keywordtype">int</span>) performance_teaching, 3, x3, refreshFlag  );
00760     font_chartsm.field( x, y+17, <span class="stringliteral">"Performance: Scholarship"</span>, x2, (<span class="keywordtype">int</span>) performance_scholarship, 3, x3, refreshFlag  );
00761     font_chartsm.field( x, y+34, <span class="stringliteral">"Performance: Research"</span>   , x2, (<span class="keywordtype">int</span>) performance_research, 3, x3, refreshFlag  );
00762     font_chartsm.field( x, y+51, <span class="stringliteral">"Satisfaction index"</span>      , x2, (<span class="keywordtype">int</span>) satisfaction_index, 3, x3, refreshFlag  );
00763 
00764     x3++;
00765     x4=<a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-30;
00766 
00767     vga_back.indicator( x3, y+3 , x4, y+14, performance_teaching   , 100, <a class="code" href="COLOR_8H.html#a2">VGA_RED</a> , -2);
00768     vga_back.indicator( x3, y+20, x4, y+31, performance_scholarship, 100, <a class="code" href="COLOR_8H.html#a1">VGA_YELLOW</a> , -2);
00769     vga_back.indicator( x3, y+37, x4, y+48, performance_research   , 100, <a class="code" href="COLOR_8H.html#a3">VGA_SEA_GREEN</a> , -2);
00770     vga_back.indicator( x3, y+54, x4, y+65, satisfaction_index     , 100, <a class="code" href="COLOR_8H.html#a9">VGA_VIOLET</a> , -2);
00771 }
00772 
00773 <span class="comment">//-------- End of function Faculty::disp_summary_assess -------//</span>
00774 
00775 <span class="comment">//------ Begin of function Faculty::disp_detail_std -------//</span>
<a name="l00777"></a><a class="code" href="classFaculty.html#a16">00777</a> <span class="comment">void Faculty::disp_detail_std(int refreshFlag) {</span>
00778     <span class="keywordtype">int</span> x=<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>, y=<a class="code" href="Ofac__rep_8cpp.html#a43a21">REPORT_Y1</a>;
00779 
00780     vga_back.d3_panel_down( <a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>, <a class="code" href="Ofac__rep_8cpp.html#a43a21">REPORT_Y1</a>, <a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>, <a class="code" href="Ofac__rep_8cpp.html#a43a23">REPORT_Y2</a>, 2);
00781 
00782     <span class="comment">//--------- display the faculty portrait ---------//</span>
00783     <span class="comment">// 0-don't paint centre</span>
00784     vga_back.d3_panel_down( x+5, y+8, x+<a class="code" href="OFPHOTO_8H.html#a3a1">FACULTY_PHOTO_WIDTH</a>+6, y+<a class="code" href="OFPHOTO_8H.html#a3a2">FACULTY_PHOTO_HEIGHT</a>+9, 1, 0 );
00785     <span class="comment">//## fred 990414 //BUGHERE photo_id == 0</span>
00786     vga_back.put_bitmap( x+6, y+9, faculty_photo_res[photo_id]-&gt;bitmap_ptr );
00787 
00788     <span class="comment">//---------- display details ----------//</span>
00789 
00790     x+=73;
00791     y+=5;
00792 
00793     <span class="keywordtype">int</span> xColumn2 = x+270;
00794 
00795 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00796 <span class="preprocessor"></span>    disp_summary_basic(x, y, xColumn2, refreshFlag, 0 );
00797 <span class="preprocessor">#else</span>
00798 <span class="preprocessor"></span>    disp_summary_basic(x, y, xColumn2, refreshFlag );
00799 <span class="preprocessor">#endif</span>
00800 <span class="preprocessor"></span>
00801     x=<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+5;
00802 
00803     user_interface.h_line(<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>, y+72, <a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+1, 2 );
00804 
00805     y+=77;
00806 
00807     disp_summary_activity(x, y, xColumn2, refreshFlag );
00808 
00809     user_interface.h_line(<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>, y+72, <a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+1, 2 );
00810 
00811     y+=77;
00812 
00813     disp_summary_assess(x, y, xColumn2, refreshFlag );
00814 
00815     user_interface.h_line(<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>, y+72, <a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+1, 2 );
00816 
00817     y+=77;
00818 
00819     <span class="comment">//--------------------------------------------//</span>
00820 
00821     disp_research_proposal(y, refreshFlag);
00822 }
00823 
00824 <span class="comment">//-------- End of function Faculty::disp_detail_std -------//</span>
00825 
00826 <span class="comment">//------ Begin of function Faculty::disp_research_proposal -------//</span>
<a name="l00828"></a><a class="code" href="classFaculty.html#a17">00828</a> <span class="comment">void Faculty::disp_research_proposal(int y, int refreshFlag) {</span>
00829     <span class="keywordtype">int</span> x=<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+5;
00830 
00831     <span class="comment">//------ display browser heading -------//</span>
00832 
00833     font_chartsm.put( x+10   , y, <span class="stringliteral">"Sponsored research project dollars"</span> );
00834     font_chartsm.put( x+355, y, <span class="stringliteral">"Status"</span> );
00835     font_chartsm.put( x+500, y, <span class="stringliteral">"Months to status change"</span> );
00836 
00837     y+=17;
00838 
00839     <span class="keywordflow">if</span>( refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a> ) {
00840         <span class="comment">//----------- create browser -----------//</span>
00841         user_interface.rect(<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+5, y-20, <a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-5, <a class="code" href="Ofac__rep_8cpp.html#a43a23">REPORT_Y2</a>-25);
00842 
00843         browse_research.<a class="code" href="classVBrowse98.html#a2">init</a>( <a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+5, y, <a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-5, <a class="code" href="Ofac__rep_8cpp.html#a43a23">REPORT_Y2</a>-25, 0, <a class="code" href="Ofac__rep_8cpp.html#a44a25">RESEARCH_REC_HEIGHT</a>,
00844                               research_proposal_count, disp_research_rec, <a class="code" href="OHELP_8H.html#a0">NULL</a>, 0 );
00845 
00846         browse_research.<a class="code" href="classVBrowse98.html#a4">open</a>(faculty_res.report_research_recno,research_proposal_count);
00847     }
00848     <span class="keywordflow">else</span> {                                          <span class="comment">// refreshFlag == INFO_UPDATE</span>
00849         <span class="comment">//              if( research_proposal_count != last_research_count )      // no. of sharepersons are changed, refresh it</span>
00850         <span class="comment">//              browse_research.paint();</span>
00851         <span class="comment">//              else</span>
00852         <span class="comment">//                      browse_research.update();                // update only</span>
00853     }
00854     user_interface.rect(<a class="code" href="Ofac__rep_8cpp.html#a43a20">REPORT_X1</a>+5, y-20, <a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-5, <a class="code" href="Ofac__rep_8cpp.html#a43a23">REPORT_Y2</a>-25);
00855     browse_research.<a class="code" href="classVBrowse98.html#a12">paint</a>();
00856     browse_research.<a class="code" href="classVBrowse98.html#a10">refresh</a>(-1, research_proposal_count);
00857     faculty_res.report_research_recno = browse_research.<a class="code" href="classVBrowse98.html#a6">recno</a>();
00858 
00859     last_research_count = research_proposal_count;
00860 
00861     <span class="comment">//---------- display total ------------//</span>
00862 
00863     y=<a class="code" href="Ofac__rep_8cpp.html#a43a23">REPORT_Y2</a>-20;
00864 
00865     font_chartsm.field( x, y, <span class="stringliteral">"Total projects"</span>, x+110, research_proposal_count, 1, x+195, refreshFlag );
00866     x+=340;
00867 
00868     <span class="comment">//## chea 221199</span>
00869     <span class="comment">//  font_chartsm.field( x, y, "Total monthly expenditures", x+195, research_month_expense * 1000, 2, REPORT_X2-5, refreshFlag );            // it's in the thousand unit</span>
00870     <span class="comment">// it's in the thousand unit</span>
00871     font_chartsm.field( x, y, <span class="stringliteral">"Total monthly expenditures"</span>, x+195, research_month_expense , 2, <a class="code" href="Ofac__rep_8cpp.html#a43a22">REPORT_X2</a>-5, refreshFlag );
00872 
00873 }
00874 
00875 <span class="comment">//-------- End of function Faculty::disp_research_proposal -------//</span>
00876 
00877 <span class="comment">//-------- Begin of static function disp_research_rec --------//</span>
00878 <span class="comment">//</span>
00879 <span class="keyword">static</span> <span class="keywordtype">void</span> disp_research_rec(<span class="keywordtype">int</span> recNo, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> refreshFlag) {
00880     <a class="code" href="classFaculty.html">Faculty</a>* facultyPtr = cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m0">faculty_array</a>.<a class="code" href="classFacultyArray.html#a9">get_unpacked_faculty</a>(faculty_res.report_faculty_recno);
00881 
00882     <a class="code" href="structResearchProposal.html">ResearchProposal</a>* researchProposal = facultyPtr-&gt;<a class="code" href="classFaculty.html#m18">research_proposal_array</a> + recNo - 1;
00883 
00884     x+=2;
00885     y+=1;
00886 
00887     <span class="comment">//## chea 221199</span>
00888     <span class="comment">//  font_chartsm.disp(x      , y, (int) researchProposal-&gt;total_dollars *1000, 2, x+200 );  //## chea 161199 1.8.3</span>
00889     font_chartsm.disp(x  , y, (<span class="keywordtype">int</span>) researchProposal-&gt;<a class="code" href="structResearchProposal.html#m0">total_dollars</a> , 2, x+200 );
00890     font_chartsm.disp(x+350, y, researchProposal-&gt;<a class="code" href="structResearchProposal.html#m2">status</a>==<a class="code" href="Ofaculty_8h.html#a31a24">RESEARCH_PROPOSED</a> ? <span class="stringliteral">"Proposed"</span> : <span class="stringliteral">"Active"</span>, x+495 );
00891     font_chartsm.disp(x+500, y, (researchProposal-&gt;<a class="code" href="structResearchProposal.html#m3">date_to_next_status</a>-info.game_date)/30, 1, x+550 );
00892 }
00893 
00894 <span class="comment">//-------- End of static function disp_research_rec --------//</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:37:29 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
