<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Oinve_if.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Oinve_if.cpp</h1><a href="Oinve__if_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : OINVE_IF.CPP</span>
00002 <span class="comment">//Description : Investment (Investment and Alumni Affairs Office) class</span>
00003 <span class="comment">// owner                        : Kevin(Ho)</span>
00004 <span class="comment">// Notes:       Steps to introduce a new class of user interface</span>
00005 <span class="comment">//                              1.      construct the new class</span>
00006 <span class="comment">//                              2.      in sys.h, add the new MODE, e.g. MODE_ADMISSIONS_AND_FINANCIAL_OFFICE</span>
00007 <span class="comment">//                              3.      include the new header file in cc.cpp, osysdisp.cpp, osysdet.cpp</span>
00008 <span class="comment">//                              4.      in cc.cpp, declare a global object of the new class, with the name matching the 'extern' statement in the header file</span>
00009 <span class="comment">//                              5.      in osysdisp.cpp, under switch(view_mode), add the redirection to the display function</span>
00010 <span class="comment">//                              6.      in osysdet.cpp, under Sys::detect_view, add the redirection to the detect function</span>
00011 <span class="comment">//                              7.      in osysdet.cpp, under Sys::process_key, add the new hot key (optional)</span>
00012 <span class="comment">//                              8.      in osysdet.cpp, under Sys::detect_button, modify if necessary (see the comments there)</span>
00013 <span class="comment">//                              9.      the deinit function (AdmOffice::deinit()) can be called when the view_mode in 'sys' object is switched</span>
00014 <span class="comment">//                                      the function frees memory occupied by this object</span>
00015 <span class="comment">//                                      the report function would re-allocate memory when it is called (note the report_init_flag)</span>
00016 <span class="comment">//                                      notice the beginning section of Sys::disp_frame()</span>
00017 <span class="comment">// Kevin 0723</span>
00018 
00019 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00020 <span class="preprocessor">#include &lt;<a class="code" href="OSTR_8H.html">OSTR.H</a>&gt;</span>
00021 <span class="preprocessor">#include &lt;OMISC.H&gt;</span>
00022 <span class="preprocessor">#include &lt;<a class="code" href="OHELP_8H.html">OHELP.H</a>&gt;</span>
00023 <span class="preprocessor">#include &lt;<a class="code" href="OGRPHYR_8H.html">OGRPHYR.H</a>&gt;</span>
00024 <span class="preprocessor">#include &lt;<a class="code" href="OGRPHMTH_8H.html">OGRPHMTH.H</a>&gt;</span>
00025 <span class="preprocessor">#include &lt;<a class="code" href="OGAMESET_8H.html">OGAMESET.H</a>&gt;</span>
00026 <span class="preprocessor">#include &lt;OWORLDMT.H&gt;</span>
00027 <span class="preprocessor">#include &lt;OINVEST.H&gt;</span>
00028 <span class="preprocessor">#include &lt;ODEVELOP.H&gt;</span>
00029 <span class="preprocessor">#include &lt;<a class="code" href="OVGA_8H.html">OVGA.H</a>&gt;</span>
00030 <span class="preprocessor">#include &lt;OIFACE.H&gt;</span>
00031 <span class="preprocessor">#include &lt;OINFO.H&gt;</span>
00032 <span class="preprocessor">#include &lt;<a class="code" href="COLOR_8H.html">COLOR.H</a>&gt;</span>
00033 <span class="preprocessor">#include &lt;OFONT.H&gt;</span>
00034 <span class="preprocessor">#include &lt;OGAMESTR.H&gt;</span>
00035 <span class="preprocessor">#include &lt;OMOUSE.H&gt;</span>
00036 <span class="preprocessor">#include &lt;OBUTTON.H&gt;</span>
00037 <span class="preprocessor">#include &lt;<a class="code" href="OVALSLDR_8H.html">OVALSLDR.H</a>&gt;</span>
00038 <span class="preprocessor">#include &lt;OSPINNER.H&gt;</span>
00039 <span class="preprocessor">#include &lt;<a class="code" href="OPIECHRT_8H.html">OPIECHRT.H</a>&gt;</span>
00040 <span class="preprocessor">#include &lt;OFINANCE.H&gt;</span>
00041 <span class="preprocessor">#include &lt;<a class="code" href="OTEXT_8H.html">OTEXT.H</a>&gt;</span>
00042 <span class="preprocessor">#include &lt;<a class="code" href="ORADIOV_8H.html">ORADIOV.H</a>&gt;</span>
00043 <span class="preprocessor">#include &lt;<a class="code" href="ORADIO_8H.html">ORADIO.H</a>&gt;</span>
00044 <span class="preprocessor">#include &lt;<a class="code" href="OBOX_8H.html">OBOX.H</a>&gt;</span>
00045 <span class="preprocessor">#include &lt;STDIO.H&gt;</span>
00046 
00047 <span class="comment">//------- Define constants -------//</span>
00048 
00049 <span class="keyword">enum</span> {                                            <span class="comment">// the 'sub' view-modes</span>
00050     <a class="code" href="Oinve__if_8cpp.html#a79a32">MODE_INVESTMENT</a> = 0,
00051     <a class="code" href="Oinve__if_8cpp.html#a79a33">MODE_FINANCIAL</a> = 1,
00052 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00053 <span class="preprocessor"></span>    MODE_TRANSFER = 2,
00054 <span class="preprocessor">#endif</span>
00055 <span class="preprocessor"></span>};
00056 
00057 <span class="keyword">enum</span> {                                            <span class="comment">// the bg image id</span>
00058     <a class="code" href="Oinve__if_8cpp.html#a80a34">BG_PIC_ID</a> = 2
00059 };
00060 
00061 <span class="keyword">enum</span> {                                            <span class="comment">// screen coordinates</span>
00062     <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a> = <a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>+15,
00063     <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a> = <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>+15,
00064     <a class="code" href="Oinve__if_8cpp.html#a81a37">REPORT_X2</a> = <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-15,
00065     <a class="code" href="Oinve__if_8cpp.html#a81a38">REPORT_Y2</a> = <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-55
00066 };
00067 
00068 <span class="keyword">enum</span> {
00069     <a class="code" href="Oinve__if_8cpp.html#a82a39">BOTTOM_BUTTON_X1</a> = <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+200,
00070     <a class="code" href="Oinve__if_8cpp.html#a82a40">BOTTOM_BUTTON_Y1</a> = <a class="code" href="Oinve__if_8cpp.html#a81a38">REPORT_Y2</a>+15,
00071     <a class="code" href="Oinve__if_8cpp.html#a82a41">BOTTOM_BUTTON_X2</a> = <a class="code" href="Oinve__if_8cpp.html#a81a37">REPORT_X2</a>-80,
00072     <a class="code" href="Oinve__if_8cpp.html#a82a42">BOTTOM_BUTTON_Y2</a> = <a class="code" href="Oinve__if_8cpp.html#a81a38">REPORT_Y2</a>+40
00073 };
00074 
00075 <span class="keyword">enum</span> {
00076     <a class="code" href="Oinve__if_8cpp.html#a83a43">BOTTOM_BUTTON_WIDTH</a> = 125,
00077     <a class="code" href="Oinve__if_8cpp.html#a83a44">BOTTOM_BUTTON_HEIGHT</a> = 25,
00078     <a class="code" href="Oinve__if_8cpp.html#a83a45">BOTTOM_BUTTON_DISTANCE</a>
00079     = (<a class="code" href="Oinve__if_8cpp.html#a82a41">BOTTOM_BUTTON_X2</a>-<a class="code" href="Oinve__if_8cpp.html#a82a39">BOTTOM_BUTTON_X1</a>-<a class="code" href="Oinve__if_8cpp.html#a83a43">BOTTOM_BUTTON_WIDTH</a>*2)/3
00080 };
00081 
00082 <span class="comment">// begin kevin 0723</span>
00083 <span class="keyword">enum</span> {
00084     <a class="code" href="Oinve__if_8cpp.html#a84a46">MODE_INVESTMENT_GRAPH_WIDTH</a> = 150,
00085     <a class="code" href="Oinve__if_8cpp.html#a84a47">MODE_INVESTMENT_GRAPH_HEIGHT</a> = 150,
00086     <a class="code" href="Oinve__if_8cpp.html#a84a48">MODE_INVESTMENT_LEGEND_HEIGHT</a> = 26,
00087     <a class="code" href="Oinve__if_8cpp.html#a84a49">MODE_INVESTMENT_LEGEND_WIDTH</a> = 370,
00088 };
00089 
00090 <span class="comment">// end kevin 0723</span>
00091 
00092 <span class="keyword">enum</span> {
00093     <a class="code" href="Oinve__if_8cpp.html#a85a50">MODE_FINANCIAL_BOX1_HEIGHT</a> = 100,
00094     <a class="code" href="Oinve__if_8cpp.html#a85a51">MODE_FINANCIAL_BOX2_HEIGHT</a> = 245,
00095     <a class="code" href="Oinve__if_8cpp.html#a85a52">MODE_FINANCIAL_GRAPH_WIDTH</a> = 400,
00096     <a class="code" href="Oinve__if_8cpp.html#a85a53">MODE_FINANCIAL_GRAPH_HEIGHT</a> = 170,
00097     <a class="code" href="Oinve__if_8cpp.html#a85a54">MODE_FINANCIAL_LEGEND_HEIGHT</a> = 26,
00098     <a class="code" href="Oinve__if_8cpp.html#a85a55">MODE_FINANCIAL_LEGEND_WIDTH</a> = 400,
00099 
00100     <a class="code" href="Oinve__if_8cpp.html#a85a56">MODE_FINANCIAL_TAB1</a> = 15,
00101     <a class="code" href="Oinve__if_8cpp.html#a85a57">MODE_FINANCIAL_TAB2</a> = 280,
00102     <a class="code" href="Oinve__if_8cpp.html#a85a58">MODE_FINANCIAL_TAB3</a> = 360,
00103     <a class="code" href="Oinve__if_8cpp.html#a85a59">MODE_FINANCIAL_TAB4</a> = 440,
00104     <a class="code" href="Oinve__if_8cpp.html#a85a60">MODE_FINANCIAL_TAB5</a> = 520,
00105     <a class="code" href="Oinve__if_8cpp.html#a85a61">MODE_FINANCIAL_TAB6</a> = 600,
00106 };
00107 
00108 <span class="keyword">enum</span> {
00109     <a class="code" href="Oinve__if_8cpp.html#a86a62">FINANCIAL_BUTTON_X1</a> = <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a59">MODE_FINANCIAL_TAB4</a>,
00110     <a class="code" href="Oinve__if_8cpp.html#a86a63">FINANCIAL_BUTTON_Y1</a> = <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a50">MODE_FINANCIAL_BOX1_HEIGHT</a>+165,
00111     <a class="code" href="Oinve__if_8cpp.html#a86a64">FINANCIAL_BUTTON_X2</a> = <a class="code" href="Oinve__if_8cpp.html#a81a37">REPORT_X2</a>,
00112     <a class="code" href="Oinve__if_8cpp.html#a86a65">FINANCIAL_BUTTON_Y2</a> = <a class="code" href="Oinve__if_8cpp.html#a81a38">REPORT_Y2</a>
00113 };
00114 
00115 <span class="keyword">enum</span> {
00116     <a class="code" href="Oinve__if_8cpp.html#a87a66">FINANCIAL_BUTTON_WIDTH</a> = 200,
00117     <a class="code" href="Oinve__if_8cpp.html#a87a67">FINANCIAL_BUTTON_HEIGHT</a> = 22,
00118     <a class="code" href="Oinve__if_8cpp.html#a87a68">FINANCIAL_BUTTON_DISTANCE</a> = 4
00119 };
00120 
00121 <span class="keyword">enum</span> {                                            <span class="comment">// the 'sub' view-modes</span>
00122     <a class="code" href="Oinve__if_8cpp.html#a88a69">MODE_FINANCIAL_IMPLEMENT</a> = 2,
00123     <a class="code" href="Oinve__if_8cpp.html#a88a70">MODE_FINANCIAL_ANNOUNCE</a> = 1,
00124     <a class="code" href="Oinve__if_8cpp.html#a88a71">MODE_FINANCIAL_CONSIDER</a> = 0,
00125 };
00126 
00127 <span class="comment">//-------- define static vars -----------//</span>
00128 
00129 <span class="keyword">static</span> <span class="keywordtype">char</span> report_init_flag = 0;
00130 <span class="keyword">static</span> <span class="keywordtype">char</span> mode_init_flag = -1;                  <span class="comment">// -1: non of the mode was init'ed</span>
00131 
00132 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00133 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="classButtonGroup.html">ButtonGroup</a> bottom_button_group(3);
00134 <span class="keyword">static</span> <span class="keywordtype">short</span> *bottom_button_up_bitmap[3];
00135 <span class="keyword">static</span> <span class="keywordtype">short</span> *bottom_button_down_bitmap[3];
00136 <span class="preprocessor">#else</span>
00137 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="classButtonGroup.html">ButtonGroup</a> bottom_button_group(2);
00138 <span class="keyword">static</span> <span class="keywordtype">short</span> *bottom_button_up_bitmap[2];
00139 <span class="keyword">static</span> <span class="keywordtype">short</span> *bottom_button_down_bitmap[2];
00140 <span class="preprocessor">#endif</span>
00141 <span class="preprocessor"></span><span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00142 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">char</span> *bottom_button_label[] = {
00143     <span class="stringliteral">"Overview1"</span>, <span class="stringliteral">"Overview2"</span>, <span class="stringliteral">"Funds transfer"</span>
00144 };
00145 <span class="preprocessor">#else</span>
00146 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">char</span> *bottom_button_label[] = {
00147     <span class="stringliteral">"Overview1"</span>, <span class="stringliteral">"Overview2"</span>
00148 };
00149 <span class="preprocessor">#endif</span>
00150 <span class="preprocessor"></span>
00151 <span class="comment">// Notes:       the strings could be moved to Ogamestr.cpp</span>
00152 <span class="comment">// Begin Investment Mode Setting</span>
00153 <span class="comment">// ### begin Gilbert 02/05/2001 #####//</span>
00154 <span class="preprocessor">#ifdef DEBUG</span>
00155 <span class="preprocessor"></span><span class="comment">// check memory overwritten</span>
00156 <a class="code" href="classPieChart.html">PieChart</a> mode_investment_piechart;                <span class="comment">// make global</span>
00157 <span class="preprocessor">#else</span>
00158 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="classPieChart.html">PieChart</a> mode_investment_piechart;
00159 <span class="preprocessor">#endif</span>
00160 <span class="preprocessor"></span><span class="comment">// ### end Gilbert 02/05/2001 #####//</span>
00161 
00162 <span class="keyword">static</span> <a class="code" href="classValueSlider.html">ValueSlider</a> mode_investment_slider1;
00163 <span class="keyword">static</span> <a class="code" href="classValueSlider.html">ValueSlider</a> mode_investment_slider2;
00164 <span class="keyword">static</span> <a class="code" href="classValueSlider.html">ValueSlider</a> mode_investment_slider3;
00165 <span class="keyword">static</span> <a class="code" href="classText.html">Text</a> mode_financial_text;
00166 <span class="keyword">static</span> <a class="code" href="classGraphMonth.html">GraphMonth</a> mode_investment_graph_snp;
00167 <span class="keyword">static</span> <span class="keywordtype">char</span> *mode_investment_legend_label[] = {
00168     <span class="comment">//  "Market index : 60% S&amp;P + 40% bond return  ",</span>
00169     <span class="comment">//## chea 031299 11.1.1</span>
00170     <span class="comment">//  "Endowment performance",</span>
00171     <span class="stringliteral">"Index of Endowment Market Value"</span>,
00172 };
00173 
00174 <span class="comment">//## fred 990507</span>
00175 <span class="comment">// Begin Financial Mode Setting</span>
00176 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00177 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">char</span> *mode_financial_str[] = {
00178     <span class="stringliteral">"Endowment spending"</span>,
00179     <span class="stringliteral">"Total endowment market value"</span>,
00180     <span class="stringliteral">"New gifts to endowment"</span>,
00181     <span class="stringliteral">""</span>,
00182     <span class="stringliteral">"Change"</span>,
00183     <span class="stringliteral">""</span>
00184 };
00185 <span class="preprocessor">#else</span>
00186 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">char</span> *mode_financial_str[] = {
00187     <span class="stringliteral">"Endowment spending"</span>,
00188     <span class="stringliteral">"Endowment market value"</span>,
00189     <span class="stringliteral">"New gifts to endowment"</span>,
00190     <span class="stringliteral">""</span>,
00191     <span class="stringliteral">"Change"</span>,
00192     <span class="stringliteral">""</span>
00193 };
00194 <span class="preprocessor">#endif</span>
00195 <span class="preprocessor"></span><span class="comment">//## fred 990507</span>
00196 
00197 <span class="keyword">static</span> <span class="keywordtype">short</span> *mode_financial_stats_bitmap;
00198 <span class="keyword">static</span> <a class="code" href="classSpinner.html">Spinner</a> financial_spinner_budget;
00199 <span class="keyword">static</span> <a class="code" href="classButtonGroup.html">ButtonGroup</a> financial_button_group(3);
00200 <span class="keyword">static</span> <span class="keywordtype">short</span> *financial_button_up_bitmap[3];
00201 <span class="keyword">static</span> <span class="keywordtype">short</span> *financial_button_down_bitmap[3];
00202 <span class="keyword">static</span> <span class="keywordtype">char</span> *financial_button_label[] = {
00203     <span class="stringliteral">"Consider for next year"</span>, <span class="stringliteral">"Promise for next year"</span>, <span class="stringliteral">"Implement now"</span>
00204 };
00205 <span class="keyword">static</span> <a class="code" href="classRadioButtonVert.html">RadioButtonVert</a> mode_financial_rbv;
00206 <span class="keyword">static</span> <span class="keywordtype">char</span> financial_current_mode = <a class="code" href="Oinve__if_8cpp.html#a88a71">MODE_FINANCIAL_CONSIDER</a>;
00207 <span class="keyword">static</span> <a class="code" href="classGraphYear.html">GraphYear</a> mode_financial_graph_profitloss;
00208 <span class="keyword">static</span> <span class="keywordtype">char</span> *mode_financial_graph_title=<span class="stringliteral">""</span>;
00209 <span class="keyword">static</span> <span class="keywordtype">char</span> *mode_financial_rbvlabel[] = {
00210     <span class="stringliteral">"no smoothing"</span>,
00211     <span class="stringliteral">"3-year smoothing"</span>,
00212     <span class="stringliteral">"5-year smoothing"</span>,
00213 };
00214 <span class="keyword">static</span> <span class="keywordtype">char</span> *mode_financial_legend_label[] = {
00215     <span class="stringliteral">"Endowment spending : projected maximum"</span>,
00216     <span class="stringliteral">"Projected minimum value"</span>,
00217     <span class="stringliteral">"Projected average value"</span>,
00218 };
00219 
00220 <span class="comment">// End Financial Mode Setting</span>
00221 
00222 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00223 <span class="preprocessor"></span><span class="comment">// Begin Fund Transfer</span>
00224 <span class="keyword">static</span> <a class="code" href="classRadioButtonVert.html">RadioButtonVert</a> transfer_from;
00225 <span class="keyword">static</span> <a class="code" href="classRadioButtonVert.html">RadioButtonVert</a> transfer_to;
00226 <span class="keyword">static</span> <a class="code" href="classSpinner.html">Spinner</a> transfer_per_spinner;
00227 <span class="keyword">static</span> <span class="keywordtype">float</span> spinner_val = 0.0;
00228 
00229 <span class="keyword">static</span> <a class="code" href="classButton.html">Button</a> implement_button;
00230 
00231 <span class="keyword">static</span> <span class="keywordtype">char</span> *transfer_label[]= {
00232     <span class="stringliteral">"Operating reserve"</span>,
00233     <span class="stringliteral">"Facilities reserve"</span>,
00234     <span class="stringliteral">"Quasi endowment"</span>,
00235 };
00236 
00237 <span class="keyword">static</span> <span class="keywordtype">int</span> sel_from =0;
00238 <span class="keyword">static</span> <span class="keywordtype">int</span> sel_to = 2;
00239 <span class="preprocessor">#endif</span>
00240 <span class="preprocessor"></span>
00241 <span class="comment">//-------- define static functions ------//</span>
00242 
00243 <span class="comment">// Notes:       the deinit_x functions should deallocate memory used by the</span>
00244 <span class="comment">//                              GraphDoubleBar, ValueSlider, RadioButton, etc. objects</span>
00245 <span class="comment">//                              the functions are called when a mode-switching is triggered</span>
00246 <span class="comment">//      Norris 0716</span>
00247 
00248 <span class="keyword">static</span> <span class="keywordtype">void</span> report_investment(<span class="keywordtype">int</span>);
00249 <span class="keyword">static</span> <span class="keywordtype">void</span> report_financial(<span class="keywordtype">int</span>);
00250 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00251 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">void</span> report_transfer(<span class="keywordtype">int</span>);
00252 <span class="preprocessor">#endif</span>
00253 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">int</span> detect_investment();
00254 <span class="keyword">static</span> <span class="keywordtype">int</span> detect_financial();
00255 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00256 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">int</span> detect_transfer();
00257 <span class="preprocessor">#endif</span>
00258 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">void</span> deinit_investment();
00259 <span class="keyword">static</span> <span class="keywordtype">void</span> deinit_financial();
00260 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00261 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">void</span> deinit_transfer();
00262 <span class="preprocessor">#endif</span>
00263 <span class="preprocessor"></span>
<a name="l00264"></a><a class="code" href="Oinve__if_8cpp.html#a26">00264</a> <span class="keyword">typedef</span> void (*<a class="code" href="Oinve__if_8cpp.html#a26">ReportFP</a>)(<span class="keywordtype">int</span> refreshFlag);
<a name="l00265"></a><a class="code" href="Oinve__if_8cpp.html#a27">00265</a> <span class="keyword">typedef</span> int (*<a class="code" href="Oinve__if_8cpp.html#a27">DetectFP</a>)();
<a name="l00266"></a><a class="code" href="Oinve__if_8cpp.html#a28">00266</a> <span class="keyword">typedef</span> void (*<a class="code" href="Oinve__if_8cpp.html#a28">DeinitFP</a>)();
00267 
00268 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00269 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="Oinve__if_8cpp.html#a26">ReportFP</a> report_func_ptr[] = {
00270     &amp;report_investment,
00271     &amp;report_financial,
00272     &amp;report_transfer
00273 };
00274 
00275 <span class="keyword">static</span> <a class="code" href="Oinve__if_8cpp.html#a27">DetectFP</a> detect_func_ptr[] = {
00276     &amp;detect_investment,
00277     &amp;detect_financial,
00278     &amp;detect_transfer
00279 };
00280 
00281 <span class="keyword">static</span> <a class="code" href="Oinve__if_8cpp.html#a28">DeinitFP</a> deinit_func_ptr[] = {
00282     &amp;deinit_investment,
00283     &amp;deinit_financial,
00284     &amp;deinit_transfer
00285 };
00286 <span class="preprocessor">#else</span>
00287 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="Oinve__if_8cpp.html#a26">ReportFP</a> report_func_ptr[] = {
00288     &amp;report_investment,
00289     &amp;report_financial
00290 };
00291 
00292 <span class="keyword">static</span> <a class="code" href="Oinve__if_8cpp.html#a27">DetectFP</a> detect_func_ptr[] = {
00293     &amp;detect_investment,
00294     &amp;detect_financial
00295 };
00296 
00297 <span class="keyword">static</span> <a class="code" href="Oinve__if_8cpp.html#a28">DeinitFP</a> deinit_func_ptr[] = {
00298     &amp;deinit_investment,
00299     &amp;deinit_financial,
00300 };
00301 <span class="preprocessor">#endif</span>
00302 <span class="preprocessor"></span>
00303 <span class="comment">//------- Begin of function Investment::Investment -----------//</span>
<a name="l00305"></a><a class="code" href="classInvestment.html#a0">00305</a> <span class="comment">Investment::Investment() {</span>
00306     init();
00307 }
00308 
00309 <span class="comment">//--------- End of function Investment::Investment -----------//</span>
00310 
00311 <span class="comment">//------- Begin of function Investment::~Investment -----------//</span>
<a name="l00313"></a><a class="code" href="classInvestment.html#a1">00313</a> <span class="comment">Investment::~Investment() {</span>
00314     deinit();
00315 }
00316 
00317 <span class="comment">//--------- End of function Investment::~Investment -----------//</span>
00318 
00319 <span class="comment">//------- Begin of function Investment::deinit ---------------//</span>
<a name="l00321"></a><a class="code" href="classInvestment.html#a3">00321</a> <span class="comment">void Investment::deinit() {</span>
00322     <span class="comment">//--------- deallocate memory -------------//</span>
00323     <span class="comment">// ##### begin Gilbert 28/04/2001 #####//</span>
00324     bottom_button_group.<a class="code" href="classButtonGroup.html#a2">deinit_buttons</a>();
00325     <span class="comment">// ##### end Gilbert 28/04/2001 #####//</span>
00326     <span class="keywordflow">if</span> (*bottom_button_up_bitmap) {
00327 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00328 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {
00329             <a class="code" href="ALL_8H.html#a8">mem_del</a>(bottom_button_up_bitmap[i]);
00330             <a class="code" href="ALL_8H.html#a8">mem_del</a>(bottom_button_down_bitmap[i]);
00331             bottom_button_up_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00332             bottom_button_down_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00333         }
00334 <span class="preprocessor">#else</span>
00335 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++) {
00336             <a class="code" href="ALL_8H.html#a8">mem_del</a>(bottom_button_up_bitmap[i]);
00337             <a class="code" href="ALL_8H.html#a8">mem_del</a>(bottom_button_down_bitmap[i]);
00338             bottom_button_up_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00339             bottom_button_down_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00340         }
00341 <span class="preprocessor">#endif</span>
00342 <span class="preprocessor"></span>    }
00343 
00344     (*deinit_func_ptr[current_mode])();
00345 
00346     report_init_flag = 0;
00347 }
00348 
00349 <span class="comment">//--------- End of function Investment::deinit ---------------//</span>
00350 
00351 <span class="comment">//------- Begin of function Investment::init -----------------//</span>
<a name="l00353"></a><a class="code" href="classInvestment.html#a2">00353</a> <span class="comment">void Investment::init() {</span>
00354     memset(<span class="keyword">this</span>,0,<span class="keyword">sizeof</span>(<a class="code" href="classInvestment.html">Investment</a>));
00355 
00356 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00357 <span class="preprocessor"></span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {
00358         bottom_button_up_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00359         bottom_button_down_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00360     }
00361 <span class="preprocessor">#else</span>
00362 <span class="preprocessor"></span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++) {
00363         bottom_button_up_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00364         bottom_button_down_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00365     }
00366 <span class="preprocessor">#endif</span>
00367 <span class="preprocessor"></span>    current_mode = <a class="code" href="Oinve__if_8cpp.html#a79a32">MODE_INVESTMENT</a>;
00368 }
00369 
00370 <span class="comment">//--------- End of function Investment::init -----------------//</span>
00371 
00372 <span class="comment">//------- Begin of function Investment::report ---------------//</span>
<a name="l00374"></a><a class="code" href="classInvestment.html#a4">00374</a> <span class="comment">void Investment::report(int refreshFlag) {</span>
00375     vga.use_back();
00376 
00377 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00378 <span class="preprocessor"></span>    <span class="comment">// fix in version 2</span>
00379     sys.is_institution_report = 1;
00380 <span class="preprocessor">#endif</span>
00381 <span class="preprocessor"></span>
00382     <span class="keywordflow">if</span> (refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>) {
00383         <span class="keywordflow">if</span>( report_init_flag )                        <span class="comment">// deinit it first if it has already been initialized</span>
00384             deinit();
00385 
00386         <span class="comment">//------------- paint the background ----------------//</span>
00387         user_interface.bg_img(<a class="code" href="Oinve__if_8cpp.html#a80a34">BG_PIC_ID</a>, &amp;vga_back);
00388 
00389         <span class="comment">//----- initialize the bottom sub-menus buttons -----//</span>
00390         <span class="keywordflow">if</span> (!report_init_flag) {
00391 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00392 <span class="preprocessor"></span>            <span class="keywordtype">short</span> x = <a class="code" href="Oinve__if_8cpp.html#a82a39">BOTTOM_BUTTON_X1</a>-120;
00393             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++, x+=<a class="code" href="Oinve__if_8cpp.html#a83a43">BOTTOM_BUTTON_WIDTH</a>+<a class="code" href="Oinve__if_8cpp.html#a83a45">BOTTOM_BUTTON_DISTANCE</a>) {
00394 
00395                 user_interface.create_button_bitmap(x, <a class="code" href="Oinve__if_8cpp.html#a82a40">BOTTOM_BUTTON_Y1</a>,
00396                                                     x+<a class="code" href="Oinve__if_8cpp.html#a83a43">BOTTOM_BUTTON_WIDTH</a>, <a class="code" href="Oinve__if_8cpp.html#a82a40">BOTTOM_BUTTON_Y1</a>+<a class="code" href="Oinve__if_8cpp.html#a83a44">BOTTOM_BUTTON_HEIGHT</a>,
00397                                                     bottom_button_label[i], &amp;bottom_button_up_bitmap[i],
00398                                                     &amp;bottom_button_down_bitmap[i], &amp;vga_back);
00399 
00400                 bottom_button_group[i].create_bitmapW(x, <a class="code" href="Oinve__if_8cpp.html#a82a40">BOTTOM_BUTTON_Y1</a>,
00401                                                       x+<a class="code" href="Oinve__if_8cpp.html#a83a43">BOTTOM_BUTTON_WIDTH</a>, <a class="code" href="Oinve__if_8cpp.html#a82a40">BOTTOM_BUTTON_Y1</a>+<a class="code" href="Oinve__if_8cpp.html#a83a44">BOTTOM_BUTTON_HEIGHT</a>,
00402                                                       ((i == current_mode) ? bottom_button_down_bitmap[i] : bottom_button_up_bitmap[i])+4);
00403             }
00404 <span class="preprocessor">#else</span>
00405 <span class="preprocessor"></span>            <span class="keywordtype">short</span> x = <a class="code" href="Oinve__if_8cpp.html#a82a39">BOTTOM_BUTTON_X1</a>;
00406             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++, x+=<a class="code" href="Oinve__if_8cpp.html#a83a43">BOTTOM_BUTTON_WIDTH</a>+<a class="code" href="Oinve__if_8cpp.html#a83a45">BOTTOM_BUTTON_DISTANCE</a>) {
00407 
00408                 user_interface.create_button_bitmap(x, <a class="code" href="Oinve__if_8cpp.html#a82a40">BOTTOM_BUTTON_Y1</a>,
00409                                                     x+<a class="code" href="Oinve__if_8cpp.html#a83a43">BOTTOM_BUTTON_WIDTH</a>, <a class="code" href="Oinve__if_8cpp.html#a82a40">BOTTOM_BUTTON_Y1</a>+<a class="code" href="Oinve__if_8cpp.html#a83a44">BOTTOM_BUTTON_HEIGHT</a>,
00410                                                     bottom_button_label[i], &amp;bottom_button_up_bitmap[i],
00411                                                     &amp;bottom_button_down_bitmap[i], &amp;vga_back);
00412 
00413                 bottom_button_group[i].create_bitmapW(x, <a class="code" href="Oinve__if_8cpp.html#a82a40">BOTTOM_BUTTON_Y1</a>,
00414                                                       x+<a class="code" href="Oinve__if_8cpp.html#a83a43">BOTTOM_BUTTON_WIDTH</a>, <a class="code" href="Oinve__if_8cpp.html#a82a40">BOTTOM_BUTTON_Y1</a>+<a class="code" href="Oinve__if_8cpp.html#a83a44">BOTTOM_BUTTON_HEIGHT</a>,
00415                                                       ((i == current_mode) ? bottom_button_down_bitmap[i] : bottom_button_up_bitmap[i])+4);
00416             }
00417 <span class="preprocessor">#endif</span>
00418 <span class="preprocessor"></span>            report_init_flag = 1;
00419         }
00420 
00421         <span class="comment">//----------- paint the bottom button group ---------//</span>
00422         bottom_button_group.<a class="code" href="classButtonGroup.html#a3">paint</a>(current_mode);
00423     }
00424 
00425     <span class="comment">//---- repaint/refresh the display of the current mode ----//</span>
00426     (*report_func_ptr[current_mode])(refreshFlag);
00427 
00428     <span class="keywordflow">if</span> (refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>) {
00429         <span class="comment">//------- blt the back buffer to front buffer -------//</span>
00430         vga.blt_buf(<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>, <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>);
00431     }
00432 
00433     vga.use_front();
00434 }
00435 
00436 <span class="comment">//---------- End of function Investment::report ------------//</span>
00437 
00438 <span class="comment">//-------- Begin of function Investment::detect ------------//</span>
<a name="l00442"></a><a class="code" href="classInvestment.html#a5">00442</a> <span class="comment">int Investment::detect() {</span>
00443     vga.use_back();
00444 
00445     <span class="keywordtype">int</span> rc = detect2();
00446 
00447     vga.use_front();
00448 
00449     <span class="keywordflow">return</span> rc;
00450 }
00451 
00452 <span class="comment">//---------- End of function Investment::detect ------------//</span>
00453 
00454 <span class="comment">//-------- Begin of function Investment::detect2 ------------//</span>
<a name="l00458"></a><a class="code" href="classInvestment.html#a6">00458</a> <span class="comment">int Investment::detect2() {</span>
00459     <span class="keywordflow">if</span> (!report_init_flag)
00460         <span class="keywordflow">return</span> 0;
00461 
00462     <span class="keywordtype">int</span> bottomButtonGroupDetect;
00463     <span class="keywordflow">if</span> ((bottomButtonGroupDetect = bottom_button_group.<a class="code" href="classButtonGroup.html#a4">detect</a>()) &gt;= 0) {
00464         <span class="comment">//---- deinit the modes to free memory ----//</span>
00465         (*deinit_func_ptr[current_mode])();
00466 
00467         <span class="comment">//-------- change display mode ------------//</span>
00468         bottom_button_group[current_mode].body_ptr = (<span class="keywordtype">void</span> *) (bottom_button_up_bitmap[current_mode] + 4);
00469         current_mode = bottomButtonGroupDetect;
00470         bottom_button_group[current_mode].body_ptr = (<span class="keywordtype">void</span> *) (bottom_button_down_bitmap[current_mode] + 4);
00471 
00472         <span class="comment">//-------- post display redraw flag -------//</span>
00473         sys.redraw_all_flag = 1;
00474 
00475         <span class="keywordflow">return</span> 1;
00476     }
00477 
00478     <span class="keywordflow">if</span> ((*detect_func_ptr[current_mode])())
00479         <span class="keywordflow">return</span> 1;
00480 
00481     <span class="keywordflow">return</span> 0;
00482 }
00483 
00484 <span class="comment">//---------- End of function AdmOffice::detect ------------//</span>
00485 
00486 <span class="comment">//-------- Begin of function report_investment -------------//</span>
00488 <span class="comment">static void report_investment(int refreshFlag) {</span>
00489     <span class="comment">// begin Kevin 0723</span>
00490 
00491     <span class="keyword">static</span> <span class="keywordtype">int</span> numSeriesData=HISTORY_MONTH_COUNT;
00492     <span class="keyword">static</span> <span class="keywordtype">int</span> dataArray[] = {18000, 23000, 65000};
00493     <span class="keyword">static</span> <span class="keywordtype">float</span> dataArray2[2*HISTORY_MONTH_COUNT];
00494     <span class="keyword">static</span> <span class="keywordtype">int</span> dataArray3[] = {19000, 20000, 39000};
00495     <span class="keyword">static</span> <span class="keywordtype">float</span> v1=11,v2=0;
00496     <span class="keyword">static</span> <span class="keywordtype">int</span> sliderVar1=0,sliderVar2=0,sliderVar3=0;
00497     <span class="keyword">static</span> <span class="keywordtype">int</span> xStart = 1991, xEnd = 1998;          <span class="comment">//*** temporary ***//</span>
00498     <span class="keyword">static</span> <span class="keywordtype">double</span> total;
00499 
00500     <span class="keyword">const</span> <span class="keyword">static</span> tab1=<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+10;
00501     <span class="keyword">const</span> <span class="keyword">static</span> tab2=<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+360;
00502     <span class="keyword">const</span> <span class="keyword">static</span> tab3=<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+365;
00503     <span class="keyword">const</span> <span class="keyword">static</span> tab4=<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+710;
00504     <span class="keyword">const</span> <span class="keyword">static</span> vtab1=<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>;
00505     <span class="keyword">const</span> <span class="keyword">static</span> vtab2=<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+180;
00506     <span class="keyword">const</span> <span class="keyword">static</span> vtab3=<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+185;
00507     <span class="keyword">const</span> <span class="keyword">static</span> vtab4=<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+345;
00508 
00509     <span class="comment">// ##### Begin Marco ##### //</span>
00510 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00511 <span class="preprocessor"></span>    <span class="keyword">static</span> <span class="keywordtype">int</span> initialSliderVar1=0,initialSliderVar2=0,initialSliderVar3=0;
00512     <span class="comment">//  initialSliderVar1=investment_office.initial_asset_array[0].allocation_percent;</span>
00513     <span class="comment">//  initialSliderVar2=investment_office.initial_asset_array[1].allocation_percent;</span>
00514     <span class="comment">//  initialSliderVar3=investment_office.initial_asset_array[2].allocation_percent;</span>
00515     initialSliderVar1=investment_office.initial_asset_array0_allocation_percent;
00516     initialSliderVar2=investment_office.initial_asset_array1_allocation_percent;
00517     initialSliderVar3=investment_office.initial_asset_array2_allocation_percent;
00518 <span class="preprocessor">#endif</span>
00519 <span class="preprocessor"></span>    <span class="comment">// ##### End Marco ##### //</span>
00520 
00521     sliderVar1=investment_office.asset_array[0].allocation_percent;
00522     sliderVar2=investment_office.asset_array[1].allocation_percent;
00523     sliderVar3=investment_office.asset_array[2].allocation_percent;
00524     dataArray[0]=sliderVar1;
00525     dataArray[1]=sliderVar2;
00526     dataArray[2]=sliderVar3;
00527 
00528     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;HISTORY_MONTH_COUNT;i++) {
00529         <span class="comment">//              dataArray2[i]=investment_office.s_n_p_history[i];</span>
00530         <span class="comment">//              dataArray2[i+HISTORY_MONTH_COUNT]=investment_office.endowment_performance_history[i];</span>
00531         dataArray2[i]=investment_office.endowment_performance_history[i];
00532     }
00533     <span class="keywordflow">if</span> (refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>) {
00534         <span class="comment">/*</span>
00535 <span class="comment">          //            //--------- draw the brightened boxes ------------//</span>
00536 <span class="comment">          for (int i = 0; i &lt; 3; i++)</span>
00537 <span class="comment">          {</span>
00538 <span class="comment">          financial_button_up_bitmap[i] = NULL;</span>
00539 <span class="comment">          financial_button_down_bitmap[i] = NULL;</span>
00540 <span class="comment">          }</span>
00541 <span class="comment"></span>
00542 <span class="comment">          short y = vtab1+85;</span>
00543 <span class="comment">          for (i = 0; i &lt; 3; i++, y+=25)</span>
00544 <span class="comment">          {</span>
00545 <span class="comment">          user_interface.create_button_bitmap(</span>
00546 <span class="comment">          tab3+90,y,</span>
00547 <span class="comment">          tab3+280,y+23,</span>
00548 <span class="comment">          financial_button_label[i], &amp;financial_button_up_bitmap[i],</span>
00549 <span class="comment">          &amp;financial_button_down_bitmap[i], &amp;vga_back);</span>
00550 <span class="comment"></span>
00551 <span class="comment">          financial_button_group[i].create_bitmapW(</span>
00552 <span class="comment">          tab3+90,y,</span>
00553 <span class="comment">          tab3+280,y+23,</span>
00554 <span class="comment">          (financial_button_up_bitmap[i])+4,0);</span>
00555 <span class="comment">          }</span>
00556 <span class="comment">        */</span>
00557         user_interface.brighten(tab1,vtab1+15,tab4,vtab4);
00558         <span class="comment">// ##### Begin Marco ##### //</span>
00559 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00560 <span class="preprocessor"></span>        user_interface.rect(tab1,vtab1+15,tab4,vtab2);<span class="comment">//marco</span>
00561 <span class="preprocessor">#else</span>
00562 <span class="preprocessor"></span>        user_interface.rect(tab1,vtab1+15,tab3,vtab2);
00563         user_interface.rect(tab3-2,vtab1+15,tab4,vtab2);
00564 <span class="preprocessor">#endif</span>
00565 <span class="preprocessor"></span>        <span class="comment">// ##### End Marco ##### //</span>
00566         user_interface.rect(tab1,vtab2-2,tab4,vtab4);
00567         user_interface.rect(  tab1+5,vtab1+25,
00568                               tab1+<a class="code" href="Oinve__if_8cpp.html#a84a46">MODE_INVESTMENT_GRAPH_WIDTH</a>,
00569                               vtab1+<a class="code" href="Oinve__if_8cpp.html#a84a47">MODE_INVESTMENT_GRAPH_HEIGHT</a>+5);
00570         user_interface.brighten(<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+100,<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>-13,<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+630,<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+10);
00571         user_interface.rect(<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+100,<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>-13,<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+630,<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+10,1);
00572         font_charts.put(<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+315,<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>-7,<span class="stringliteral">"Asset Allocation"</span>);
00573 
00574         <span class="keywordflow">if</span> (mode_init_flag != <a class="code" href="Oinve__if_8cpp.html#a79a32">MODE_INVESTMENT</a>) {
00575             <span class="comment">//---------  initialization  -----------//</span>
00576             mode_init_flag= <a class="code" href="Oinve__if_8cpp.html#a79a32">MODE_INVESTMENT</a>;
00577 
00578             <span class="comment">//                  financial_spinner_budget.init(</span>
00579             <span class="comment">//                          tab3+120,vtab1+50,</span>
00580             <span class="comment">//                          tab3+240,vtab1+75,</span>
00581             <span class="comment">//                          &amp;v2,</span>
00582             <span class="comment">//                          -100.0f,100.0f,5.0f,0,NULL,3);</span>
00583 
00584             mode_investment_piechart.<a class="code" href="classPieChart.html#a0">init</a>(
00585                 tab1+5,vtab1+25,
00586                 tab1+<a class="code" href="Oinve__if_8cpp.html#a84a46">MODE_INVESTMENT_GRAPH_WIDTH</a>,
00587                 vtab1+<a class="code" href="Oinve__if_8cpp.html#a84a47">MODE_INVESTMENT_GRAPH_HEIGHT</a>+5,
00588                 3, dataArray, &amp;xStart, &amp;xEnd,
00589                 <a class="code" href="OHELP_8H.html#a0">NULL</a>, <a class="code" href="OHELP_8H.html#a0">NULL</a>, <a class="code" href="OHELP_8H.html#a0">NULL</a>, 1, 1, 0, 23);
00590 
00591             mode_investment_slider1.<a class="code" href="classValueSlider.html#a2">init</a>(
00592                 tab1+180,vtab1+45,
00593                 <a class="code" href="Oinve__if_8cpp.html#a84a46">MODE_INVESTMENT_GRAPH_WIDTH</a>,
00594                 15,
00595                 0,100,&amp;sliderVar1,0,
00596                 (mode_investment_piechart.<a class="code" href="classPieChart.html#m17">series_color</a>)[0],
00597                 3);
00598             mode_investment_slider2.<a class="code" href="classValueSlider.html#a2">init</a>(
00599                 tab1+180,vtab1+100,
00600                 <a class="code" href="Oinve__if_8cpp.html#a84a46">MODE_INVESTMENT_GRAPH_WIDTH</a>,
00601                 15,
00602                 0,100,&amp;sliderVar2,0,
00603                 (mode_investment_piechart.<a class="code" href="classPieChart.html#m17">series_color</a>)[1],
00604                 3);
00605             mode_investment_slider3.<a class="code" href="classValueSlider.html#a2">init</a>(
00606                 tab1+180,vtab1+155,
00607                 <a class="code" href="Oinve__if_8cpp.html#a84a46">MODE_INVESTMENT_GRAPH_WIDTH</a>,
00608                 15,
00609                 0,100,&amp;sliderVar3,0,
00610                 (mode_investment_piechart.<a class="code" href="classPieChart.html#m17">series_color</a>)[2],
00611                 3);
00612 
00613             mode_investment_graph_snp.<a class="code" href="classGraphMonth.html#a2">init</a>(
00614                 tab1,vtab2-2,tab4,vtab4,
00615                 1, &amp;numSeriesData, dataArray2, 2,         <span class="comment">/*2*/</span>
00616                 <span class="comment">//11 //4  //## chea 110899 23 change by b.massy(2dec)</span>
00617                 <a class="code" href="OHELP_8H.html#a0">NULL</a>, <a class="code" href="OHELP_8H.html#a0">NULL</a>, mode_investment_legend_label, 1, 1, 1, 23
00618                 );
00619 
00620             mode_investment_piechart.<a class="code" href="classPieChart.html#a12">paint</a>();
00621             <span class="comment">//                  financial_spinner_budget.paint();</span>
00622             <span class="comment">//                  for( i=0;i&lt;3;i++)</span>
00623             <span class="comment">//                          financial_button_group[i].paint();</span>
00624         }
00625         <span class="keywordflow">else</span> {
00626             <span class="comment">//-------- repaint -----------//</span>
00627             user_interface.brighten(tab1,vtab1+15,tab4,vtab4);
00628             user_interface.rect(tab1,vtab1+15,tab3,vtab2);
00629             user_interface.rect(tab3-2,vtab1+15,tab4,vtab2);
00630             user_interface.rect(tab1,vtab2-2,tab4,vtab4);
00631 
00632             <span class="comment">//-------- paint the buttons -----------//</span>
00633             <span class="comment">//                  financial_spinner_budget.paint();</span>
00634             <span class="comment">//                  for(int i=0;i&lt;3;i++)</span>
00635             <span class="comment">//                          financial_button_group[i].paint();</span>
00636             mode_investment_piechart.<a class="code" href="classPieChart.html#a12">paint</a>();
00637             mode_investment_slider1.<a class="code" href="classValueSlider.html#a6">paint</a>();
00638             mode_investment_slider2.<a class="code" href="classValueSlider.html#a6">paint</a>();
00639             mode_investment_slider3.<a class="code" href="classValueSlider.html#a6">paint</a>();
00640         }
00641         mode_investment_graph_snp.<a class="code" href="classGraphMonth.html#a8">paint</a>();
00642 
00643         <span class="comment">//-------- draw the legend --------------//</span>
00644 
00645         font_chartsm.put(
00646             tab1+190,vtab1+25,
00647             <span class="stringliteral">"Large company stock"</span>);
00648         font_chartsm.put(
00649             tab1+190,vtab1+80,
00650             <span class="stringliteral">"Small company stock"</span>);
00651         font_chartsm.put(
00652             tab1+190,vtab1+135,
00653             <span class="stringliteral">"Bonds"</span>);
00654         user_interface.bar(
00655             tab1+160,vtab1+25,tab1+172,vtab1+37,
00656             ((mode_investment_piechart.<a class="code" href="classPieChart.html#m17">series_color</a>)[0]));
00657         user_interface.bar(
00658             tab1+160,vtab1+80,tab1+172,vtab1+92,
00659             ((mode_investment_piechart.<a class="code" href="classPieChart.html#m17">series_color</a>)[1]));
00660         user_interface.bar(
00661             tab1+160,vtab1+135,tab1+172,vtab1+147,
00662             ((mode_investment_piechart.<a class="code" href="classPieChart.html#m17">series_color</a>)[2]));
00663 
00664         <span class="comment">// #### Begin Marco ##### //</span>
00665 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00666 <span class="preprocessor"></span>        font_chart_purple_sm.put(tab3,
00667                                  vtab1+45,
00668                                  <span class="stringliteral">"Initial : "</span>);
00669         font_chart_purple_sm.put(tab3 + 45,
00670                                  vtab1+45,
00671                                  m.format(initialSliderVar1, 3));
00672 
00673         font_chart_purple_sm.put(tab3,
00674                                  vtab1+100,
00675                                  <span class="stringliteral">"Initial : "</span>);
00676         font_chart_purple_sm.put(tab3 + 45,
00677                                  vtab1+100,
00678                                  m.format(initialSliderVar2, 3));
00679         font_chart_purple_sm.put(tab3,
00680                                  vtab1+155,
00681                                  <span class="stringliteral">"Initial : "</span>);
00682         font_chart_purple_sm.put(tab3 + 45,
00683                                  vtab1+155,
00684                                  m.format(initialSliderVar3, 3));
00685 <span class="preprocessor">#endif</span>
00686 <span class="preprocessor"></span>        <span class="comment">// #### End Marco ##### //</span>
00687     }
00688     <span class="keywordflow">else</span> {                                          <span class="comment">// refreshFlag == INFO_REFRESH</span>
00689 
00690         <span class="comment">//      debugging</span>
00691         <span class="comment">//      top_athletes++;</span>
00692 
00693         <span class="comment">// -------- refresh the stats ----------- //</span>
00694         mode_investment_piechart.<a class="code" href="classPieChart.html#a13">refresh</a>();
00695 
00696         vga.blt_buf(
00697             tab1+5,vtab1+25,
00698             tab1+<a class="code" href="Oinve__if_8cpp.html#a84a46">MODE_INVESTMENT_GRAPH_WIDTH</a>,
00699             vtab1+<a class="code" href="Oinve__if_8cpp.html#a84a47">MODE_INVESTMENT_GRAPH_HEIGHT</a>+5
00700             );
00701 
00702         mode_investment_slider1.<a class="code" href="classValueSlider.html#a7">refresh</a>();
00703         mode_investment_slider2.<a class="code" href="classValueSlider.html#a7">refresh</a>();
00704         mode_investment_slider3.<a class="code" href="classValueSlider.html#a7">refresh</a>();
00705         <span class="comment">//              for(int i=0;i&lt;3;i++)</span>
00706         <span class="comment">//                              financial_button_group[i].paint();</span>
00707         <span class="comment">//              financial_spinner_budget.refresh();</span>
00708 
00709         mode_investment_graph_snp.<a class="code" href="classGraphMonth.html#a9">refresh</a>();
00710         vga.blt_buf(
00711             tab1,vtab2-2,tab4,vtab4
00712             );
00713         <span class="comment">/*              short y = vtab1+85;</span>
00714 <span class="comment">                        for (i = 0; i &lt; 3; i++, y+=25)</span>
00715 <span class="comment">                        {</span>
00716 <span class="comment">                        vga.blt_buf(tab3+90,y,tab3+280,y+23);</span>
00717 <span class="comment">                        }</span>
00718 <span class="comment">        */</span>
00719     }
00720 
00721     <span class="comment">//  vga.blt_buf(REPORT_X1+MODE_FINANCIAL_TAB2, REPORT_Y1,</span>
00722     <span class="comment">//                          REPORT_X2, REPORT_Y1+MODE_FINANCIAL_BOX1_HEIGHT);</span>
00723 
00724     <span class="comment">/*  for(int i=0;i&lt;3;i++)</span>
00725 <span class="comment">        {</span>
00726 <span class="comment">        financial_button_group[i].pop();</span>
00727 <span class="comment">        financial_button_group[i].body_ptr=</span>
00728 <span class="comment">        (void*)(financial_button_up_bitmap[i]+4);</span>
00729 <span class="comment">        }</span>
00730 <span class="comment">    */</span>
00731     <span class="comment">// end Kevin 0723</span>
00732 
00733 }
00734 
00735 <span class="comment">//-------- Begin of function report_FINANCIAL ---------//</span>
00737 <span class="comment">static void report_financial(int refreshFlag) {</span>
00738     <span class="comment">// Notes:   temporary variables for debugging</span>
00739     <span class="comment">//                          to be interfaced with game engine</span>
00740 
00741     <span class="keyword">static</span> <span class="keywordtype">int</span> v11=1000,v12=1999,v13=8888;
00742     <span class="keyword">static</span> <span class="keywordtype">double</span> v21=663.23,v22=123.23,v23=17.23,v24=723.23,v25=13.23;
00743     <span class="keyword">static</span> <span class="keywordtype">double</span> v31=813.83,v32=888.23,v33=13.83,v34=188.23,v35=183.23;
00744     <span class="keyword">static</span> <span class="keywordtype">double</span> v41=88.28,v42=777.23,v43=166.27,v44=777.23,v45=173.23;
00745     <span class="keyword">static</span> <span class="keywordtype">int</span> sliderVar1=0;
00746     <span class="keyword">static</span> <span class="keywordtype">float</span> v1;
00747     <span class="keyword">static</span> <span class="keywordtype">int</span> v2;
00748     <span class="keyword">static</span> <span class="keywordtype">float</span> spinnerVar1=0.0;
00749     <span class="keyword">static</span> <span class="keywordtype">int</span> numSeriesData = <a class="code" href="Oinvest_8h.html#a15a1">P_HISTORY_YEAR_COUNT</a>;<span class="comment">//*** temporary ***//</span>
00750     <span class="keyword">static</span> <span class="keywordtype">int</span> dataArray[3*<a class="code" href="Oinvest_8h.html#a15a1">P_HISTORY_YEAR_COUNT</a>];   <span class="comment">//*** temporary ***//</span>
00751     <span class="keyword">static</span> <span class="keywordtype">int</span> xStart = 1991, xEnd = 1998;          <span class="comment">//*** temporary ***//</span>
00752     <span class="keyword">const</span> <span class="keyword">static</span> tab1=<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+10;
00753     <span class="keyword">const</span> <span class="keyword">static</span> tab2=<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+360;
00754     <span class="keyword">const</span> <span class="keyword">static</span> tab3=<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+365;
00755     <span class="keyword">const</span> <span class="keyword">static</span> tab4=<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+710;
00756     <span class="keyword">const</span> <span class="keyword">static</span> vtab1=<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>;
00757     <span class="keyword">const</span> <span class="keyword">static</span> vtab2=<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+165;
00758     <span class="keyword">const</span> <span class="keyword">static</span> vtab3=<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+170;
00759     <span class="keyword">const</span> <span class="keyword">static</span> vtab4=<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+330;
00760 
00761     <span class="comment">// ##### Begin Marco ##### //</span>
00762 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00763 <span class="preprocessor"></span>    <span class="keyword">static</span> <span class="keywordtype">double</span> initialv21=663.23;
00764     <span class="keyword">static</span> <span class="keywordtype">double</span> initialv31=813.83;
00765     <span class="keyword">static</span> <span class="keywordtype">double</span> initialv41=88.28;
00766 <span class="preprocessor">#endif</span>
00767 <span class="preprocessor"></span>    <span class="comment">// ##### End Marco ##### //</span>
00768 
00769   <span class="comment">//    Communicate with Sim Engine's Output</span>
00770 
00771   <span class="comment">//    dataArray=(float*)development_office.history_value;</span>
00772 
00773     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;numSeriesData;i++) {
00774         dataArray[i]=investment_office.endowment_spending_history[2][i];
00775         dataArray[i+numSeriesData]=investment_office.endowment_spending_history[1][i];
00776         dataArray[i+2*numSeriesData]=investment_office.endowment_spending_history[0][i];
00777     }
00778 
00779     xStart = info.game_year-numSeriesData+1;
00780     xEnd = info.game_year;
00781 
00782     v12=info.financial_year();
00783     v11=v12-1;
00784     v13=v12+1;
00785 
00786   <span class="comment">//## fred 0405</span>
00787     <span class="keywordtype">int</span> x = <a class="code" href="Ofinance_8h.html#a101a37">AC_ENDOWMENT_SPENDING</a>;
00788     v21=finance.revenue_array[x].total;
00789     v23=finance.projected_revenue_array[x].this_year.total;
00790     v22 = finance.calc_change(v23,v21);
00791 
00792     v24=finance.projected_revenue_array[x].change_next_year.total;
00793     v25=finance.projected_revenue_array[x].next_year.total;
00794     <span class="comment">//## fred 0405</span>
00795 
00796     <span class="comment">//## fred 990507</span>
00797     <span class="comment">/*</span>
00798 <span class="comment">      v31=finance.expense_array[5].total;</span>
00799 <span class="comment">      v32=finance.projected_expense_array[5].change_last_year.total;</span>
00800 <span class="comment">      v33=finance.projected_expense_array[5].this_year.total;</span>
00801 <span class="comment">      v34=finance.projected_expense_array[5].change_next_year.total;</span>
00802 <span class="comment">      v35=finance.projected_expense_array[5].next_year.total;</span>
00803 <span class="comment">  */</span>
00804 
00805     {
00806 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00807 <span class="preprocessor"></span>        <span class="keywordtype">double</span> l = finance.last_year.asset_array[<a class="code" href="Ofinance_8h.html#a97a22">AC_ENDOWMENT</a>]+finance.last_year.asset_array[AC_QUASI];
00808         <span class="keywordtype">double</span> t = finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a97a22">AC_ENDOWMENT</a>]+finance.this_year.asset_array[AC_QUASI];
00809         <span class="keywordtype">double</span> n = finance.next_year.asset_array[<a class="code" href="Ofinance_8h.html#a97a22">AC_ENDOWMENT</a>]+finance.this_year.asset_array[AC_QUASI];
00810 <span class="preprocessor">#else</span>
00811 <span class="preprocessor"></span>        <span class="keywordtype">double</span> l = finance.last_year.asset_array[<a class="code" href="Ofinance_8h.html#a97a22">AC_ENDOWMENT</a>];
00812         <span class="keywordtype">double</span> t = finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a97a22">AC_ENDOWMENT</a>];
00813         <span class="keywordtype">double</span> n = finance.next_year.asset_array[<a class="code" href="Ofinance_8h.html#a97a22">AC_ENDOWMENT</a>];
00814 <span class="preprocessor">#endif</span>
00815 <span class="preprocessor"></span>
00816         v31 = l;
00817         v32 = finance.calc_change(t,l);
00818         v33 = t;
00819         v34 = finance.calc_change(n,t);
00820         v35 = n;
00821 
00822         <span class="comment">//              double v41,v42,v43,v44,v45;</span>
00823 
00824         l=development_office.last_year.endowment;
00825         t=development_office.this_year.endowment;
00826         n=development_office.this_year.endowment;     <span class="comment">// since no next_year data in engine, use this_year</span>
00827 
00828         v41 = l;
00829         v42 = finance.calc_change(t,l);
00830         v43 = t;
00831         v44 = finance.calc_change(n,t);
00832         v45 = n;
00833     }
00834 
00835     <span class="comment">//## fred 990507</span>
00836 
00837   <span class="comment">// ##### Begin Marco ##### //</span>
00838 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00839 <span class="preprocessor"></span>    initialv21 = finance.initial_revenue_array[<a class="code" href="Ofinance_8h.html#a101a37">AC_ENDOWMENT_SPENDING</a>].total;
00840     initialv31 = finance.initial_last_year.asset_array[<a class="code" href="Ofinance_8h.html#a97a22">AC_ENDOWMENT</a>];
00841     <span class="comment">//  initialv41 = development_office.initial_last_year.endowment;</span>
00842     initialv41 = development_office.initial_last_year_endowment;
00843 <span class="preprocessor">#endif</span>
00844 <span class="preprocessor"></span>    <span class="comment">// ####### End Marco ##### //</span>
00845 
00847   <span class="comment">//## chea 021299 11.2.2</span>
00848   <span class="comment">//    v1=investment_office.equilibrium_payout_rate;</span>
00849     v1 = (float)finance.revenue_policy_array[<a class="code" href="Ofinance_8h.html#a108a67">PL_ENDOWMENT_SPENDING_RATE</a>].result_value;
00850 
00851     v2=investment_office.degree_smoothing_for_endowment_payout;
00852     <span class="keywordtype">int</span> field_space=5*font_chartsm.max_font_width;
00853 
00854     <span class="keywordflow">if</span> (refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>) {
00855         user_interface.brighten(<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+100,<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>-13,<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+630,<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+8);
00856         user_interface.rect(<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+100,<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>-13,<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+630,<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+8,1);
00857         font_charts.put(<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+310,<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>-8,<span class="stringliteral">"The Endowment"</span>);
00858 
00859         <span class="keywordflow">if</span> (mode_init_flag != <a class="code" href="Oinve__if_8cpp.html#a79a33">MODE_FINANCIAL</a>) {
00860             <span class="comment">//                  spinnerVar1=0.0;</span>
00861             <span class="comment">//                  spinnerVar1=(float)finance.get_policy_var(true, AC_ENDOWMENT_SPENDING)-&gt;target_value;</span>
00862 
00863             mode_init_flag = <a class="code" href="Oinve__if_8cpp.html#a79a33">MODE_FINANCIAL</a>;
00864 
00865             <span class="comment">//--------- draw the brightened boxes ------------//</span>
00866             user_interface.brighten(<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>, <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+10, <a class="code" href="Oinve__if_8cpp.html#a81a37">REPORT_X2</a>, <a class="code" href="Oinve__if_8cpp.html#a81a38">REPORT_Y2</a>);
00867             user_interface.rect(<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>, <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+10, <a class="code" href="Oinve__if_8cpp.html#a81a37">REPORT_X2</a>, <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a50">MODE_FINANCIAL_BOX1_HEIGHT</a>+2);
00868             user_interface.rect(<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>, <a class="code" href="Oinve__if_8cpp.html#a81a38">REPORT_Y2</a>-<a class="code" href="Oinve__if_8cpp.html#a85a51">MODE_FINANCIAL_BOX2_HEIGHT</a>-2, <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a59">MODE_FINANCIAL_TAB4</a>-82, <a class="code" href="Oinve__if_8cpp.html#a81a38">REPORT_Y2</a>);
00869             user_interface.rect(<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a59">MODE_FINANCIAL_TAB4</a>-85, <a class="code" href="Oinve__if_8cpp.html#a81a38">REPORT_Y2</a>-<a class="code" href="Oinve__if_8cpp.html#a85a51">MODE_FINANCIAL_BOX2_HEIGHT</a>-2, <a class="code" href="Oinve__if_8cpp.html#a81a37">REPORT_X2</a>, <a class="code" href="Oinve__if_8cpp.html#a81a38">REPORT_Y2</a>);
00870 
00871             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {
00872                 financial_button_up_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00873                 financial_button_down_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00874             }
00875 
00876             <span class="keywordtype">short</span> y = <a class="code" href="Oinve__if_8cpp.html#a86a63">FINANCIAL_BUTTON_Y1</a>;
00877             <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++, y+=<a class="code" href="Oinve__if_8cpp.html#a87a67">FINANCIAL_BUTTON_HEIGHT</a>+<a class="code" href="Oinve__if_8cpp.html#a87a68">FINANCIAL_BUTTON_DISTANCE</a>) {
00878                 user_interface.create_button_bitmap(<a class="code" href="Oinve__if_8cpp.html#a86a62">FINANCIAL_BUTTON_X1</a>,y,
00879                                                     <a class="code" href="Oinve__if_8cpp.html#a86a62">FINANCIAL_BUTTON_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a87a66">FINANCIAL_BUTTON_WIDTH</a>,y+<a class="code" href="Oinve__if_8cpp.html#a87a67">FINANCIAL_BUTTON_HEIGHT</a>,
00880                                                     financial_button_label[i], &amp;financial_button_up_bitmap[i],
00881                                                     &amp;financial_button_down_bitmap[i], &amp;vga_back);
00882 
00883                 financial_button_group[i].create_bitmapW(<a class="code" href="Oinve__if_8cpp.html#a86a62">FINANCIAL_BUTTON_X1</a>,y,
00884                                                          <a class="code" href="Oinve__if_8cpp.html#a86a62">FINANCIAL_BUTTON_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a87a66">FINANCIAL_BUTTON_WIDTH</a>,y+<a class="code" href="Oinve__if_8cpp.html#a87a67">FINANCIAL_BUTTON_HEIGHT</a>,
00885                                                          (financial_button_up_bitmap[i])+4,0);
00886             }
00887 
00888             financial_spinner_budget.<a class="code" href="classSpinner.html#a2">init</a>(
00889                 <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a60">MODE_FINANCIAL_TAB5</a>-40,
00890                 <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a50">MODE_FINANCIAL_BOX1_HEIGHT</a>+125,
00891                 <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a60">MODE_FINANCIAL_TAB5</a>+80,
00892                 <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a50">MODE_FINANCIAL_BOX1_HEIGHT</a>+155,
00893                 <span class="comment">//### begin zhoubin 02/28/99</span>
00894                 &amp;investment_office.spinner_var1,
00895                 <span class="comment">//### end zhoubin 02/28/99</span>
00896                 <span class="comment">//                              -100.0f,100.0f,0.1f,0,NULL,23);</span>
00897                 <span class="comment">//                              4.0f,10.0f,0.1f,0,NULL,25);  //## chea 170999</span>
00898                 -10.0f,10.0f,0.1f,0,<a class="code" href="OHELP_8H.html#a0">NULL</a>,25);             <span class="comment">//## chea 031299 11.2.3</span>
00899             <span class="comment">//-------- graph title --------------//</span>
00900             mode_financial_graph_profitloss.<a class="code" href="classGraphYear.html#a2">init</a>(
00901                 <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>, <a class="code" href="Oinve__if_8cpp.html#a81a38">REPORT_Y2</a>-<a class="code" href="Oinve__if_8cpp.html#a85a51">MODE_FINANCIAL_BOX2_HEIGHT</a>-2, <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a59">MODE_FINANCIAL_TAB4</a>-82, <a class="code" href="Oinve__if_8cpp.html#a81a38">REPORT_Y2</a>,
00902                 3, &amp;numSeriesData, dataArray, 1,
00903                 <a class="code" href="OHELP_8H.html#a0">NULL</a>, <a class="code" href="OHELP_8H.html#a0">NULL</a>, mode_financial_legend_label, 1, 1, 1, 2);
00904 
00905             <span class="comment">//                  mode_financial_text.put(tab3+280,vtab3+16,&amp;v1,3);  //## chea 180899 12.2.1 ori.</span>
00906             <span class="comment">//                  mode_financial_text.put(tab3+280,vtab3+16,&amp;v22,3);  //## chea 180899 change 12.2.1</span>
00907             <span class="comment">//## chea 021199 change to the same as finance report</span>
00908             mode_financial_text.<a class="code" href="classText.html#a11">put</a>(tab3+280,vtab3+16,&amp;v1,24);
00909 
00910             mode_financial_rbv.<a class="code" href="classRadioButtonVert.html#a2">init</a>(
00911                 <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a59">MODE_FINANCIAL_TAB4</a>+10,
00912                 <a class="code" href="Oinve__if_8cpp.html#a81a38">REPORT_Y2</a>-<a class="code" href="Oinve__if_8cpp.html#a85a51">MODE_FINANCIAL_BOX2_HEIGHT</a>+23,
00913                 <a class="code" href="Oinve__if_8cpp.html#a81a37">REPORT_X2</a>,
00914                 <a class="code" href="Oinve__if_8cpp.html#a81a38">REPORT_Y2</a>-<a class="code" href="Oinve__if_8cpp.html#a85a51">MODE_FINANCIAL_BOX2_HEIGHT</a>+73,
00915                 3,
00916                 &amp;v2,
00917                 mode_financial_rbvlabel,
00918                 <a class="code" href="OHELP_8H.html#a0">NULL</a>
00919                 );
00920         }
00921         <span class="keywordflow">else</span> {
00922             <span class="comment">//--------- draw the brightened boxes ------------//</span>
00923             user_interface.brighten(<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>, <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+10, <a class="code" href="Oinve__if_8cpp.html#a81a37">REPORT_X2</a>, <a class="code" href="Oinve__if_8cpp.html#a81a38">REPORT_Y2</a>);
00924             user_interface.rect(<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>, <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+10, <a class="code" href="Oinve__if_8cpp.html#a81a37">REPORT_X2</a>, <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a50">MODE_FINANCIAL_BOX1_HEIGHT</a>+2);
00925             user_interface.rect(<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>, <a class="code" href="Oinve__if_8cpp.html#a81a38">REPORT_Y2</a>-<a class="code" href="Oinve__if_8cpp.html#a85a51">MODE_FINANCIAL_BOX2_HEIGHT</a>-2, <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a59">MODE_FINANCIAL_TAB4</a>-82, <a class="code" href="Oinve__if_8cpp.html#a81a38">REPORT_Y2</a>);
00926             user_interface.rect(<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a59">MODE_FINANCIAL_TAB4</a>-85, <a class="code" href="Oinve__if_8cpp.html#a81a38">REPORT_Y2</a>-<a class="code" href="Oinve__if_8cpp.html#a85a51">MODE_FINANCIAL_BOX2_HEIGHT</a>-2, <a class="code" href="Oinve__if_8cpp.html#a81a37">REPORT_X2</a>, <a class="code" href="Oinve__if_8cpp.html#a81a38">REPORT_Y2</a>);
00927             <span class="comment">//-------- paint the buttons -----------//</span>
00928             financial_spinner_budget.<a class="code" href="classSpinner.html#a4">paint</a>();
00929             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;3;i++)
00930                 financial_button_group[i].<a class="code" href="classButtonGroup.html#a3">paint</a>();
00931         }
00932 
00933         mode_financial_graph_profitloss.<a class="code" href="classGraphYear.html#a8">paint</a>();
00934 
00935         <span class="comment">//-------- display static strings -----------//</span>
00936         font_chartsm.put(<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a56">MODE_FINANCIAL_TAB1</a>, <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+40, mode_financial_str[0]);
00937         font_chartsm.put(<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a56">MODE_FINANCIAL_TAB1</a>, <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+60, mode_financial_str[1]);
00938         font_chartsm.put(<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a56">MODE_FINANCIAL_TAB1</a>, <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+80, mode_financial_str[2]);
00939         font_chartsm.put(
00940             <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a58">MODE_FINANCIAL_TAB3</a>+25,<a class="code" href="Oinve__if_8cpp.html#a81a38">REPORT_Y2</a>-<a class="code" href="Oinve__if_8cpp.html#a85a51">MODE_FINANCIAL_BOX2_HEIGHT</a>+5,
00941             <span class="stringliteral">"Degree of smoothing for endowment spending"</span>);
00942 
00943         font_chartsm.put(
00944             <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a58">MODE_FINANCIAL_TAB3</a>+25,vtab3+15,
00945             <span class="stringliteral">"Current endowment spending rate"</span>);
00946 
00947         font_chartsm.put(
00948             <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a58">MODE_FINANCIAL_TAB3</a>+25,vtab3+35,
00949             <span class="stringliteral">"Change in endowment spending rate"</span>);
00950 
00951         font_chartsm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a58">MODE_FINANCIAL_TAB3</a>+field_space,
00952                                 <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+15,
00953                                 mode_financial_str[4]);
00954 
00955         font_chartsm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a60">MODE_FINANCIAL_TAB5</a>+field_space,
00956                                 <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+15,
00957                                 mode_financial_str[4]);
00958 
00959         font_chartsm.put_paragraph(
00960             <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a59">MODE_FINANCIAL_TAB4</a>+30,
00961             <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+30+<a class="code" href="Oinve__if_8cpp.html#a85a50">MODE_FINANCIAL_BOX1_HEIGHT</a>,
00962             <a class="code" href="Oinve__if_8cpp.html#a81a37">REPORT_X2</a>,
00963             <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+60+<a class="code" href="Oinve__if_8cpp.html#a85a50">MODE_FINANCIAL_BOX1_HEIGHT</a>,
00964             mode_financial_str[5]);
00965         mode_financial_stats_bitmap=<a class="code" href="OHELP_8H.html#a0">NULL</a>;
00966         mode_financial_stats_bitmap=vga_back.save_area(
00967             <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a57">MODE_FINANCIAL_TAB2</a>, <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>,
00968             <a class="code" href="Oinve__if_8cpp.html#a81a37">REPORT_X2</a>, <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a50">MODE_FINANCIAL_BOX1_HEIGHT</a>,
00969             mode_financial_stats_bitmap);
00970 
00971     }
00972     <span class="keywordflow">else</span> {                                          <span class="comment">// refreshFlag == INFO_REFRESH</span>
00973         <span class="comment">//-------- refresh dynamic data --------------//</span>
00974         <span class="comment">// refresh() == 1. rest()</span>
00975         <span class="comment">//                                              2. draw()</span>
00976         <span class="comment">//                                              3. blit buffer()</span>
00977 
00978         mode_financial_graph_profitloss.<a class="code" href="classGraphYear.html#a9">refresh</a>();
00979         vga.blt_buf(
00980             <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>, <a class="code" href="Oinve__if_8cpp.html#a81a38">REPORT_Y2</a>-<a class="code" href="Oinve__if_8cpp.html#a85a51">MODE_FINANCIAL_BOX2_HEIGHT</a>,
00981             <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a59">MODE_FINANCIAL_TAB4</a>-90, <a class="code" href="Oinve__if_8cpp.html#a81a38">REPORT_Y2</a>
00982             );
00983 
00984         mode_financial_text.<a class="code" href="classText.html#a25">refresh</a>();
00985         mode_financial_rbv.<a class="code" href="classRadioButtonVert.html#a5">refresh</a>();
00986 
00987     }
00988 
00989     financial_spinner_budget.<a class="code" href="classSpinner.html#a5">refresh</a>();
00990     <span class="keywordtype">int</span> pressed=finance.get_policy_var(<span class="keyword">true</span>, <a class="code" href="Ofinance_8h.html#a101a37">AC_ENDOWMENT_SPENDING</a>)-&gt;applied_flag;
00991     <span class="keywordflow">if</span>(pressed==<a class="code" href="Ofinanc2_8h.html#a38a5">P_NONE</a>)
00992         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;3;i++)
00993             financial_button_group[i].<a class="code" href="classButtonGroup.html#a3">paint</a>();
00994     <span class="keywordflow">else</span>
00995         financial_button_group.<a class="code" href="classButtonGroup.html#a3">paint</a>(pressed-1);
00996     <span class="keywordtype">short</span> y = <a class="code" href="Oinve__if_8cpp.html#a86a63">FINANCIAL_BUTTON_Y1</a>;
00997     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++, y+=<a class="code" href="Oinve__if_8cpp.html#a87a67">FINANCIAL_BUTTON_HEIGHT</a>+<a class="code" href="Oinve__if_8cpp.html#a87a68">FINANCIAL_BUTTON_DISTANCE</a>) {
00998         vga.blt_buf(<a class="code" href="Oinve__if_8cpp.html#a86a62">FINANCIAL_BUTTON_X1</a>,y,
00999                     <a class="code" href="Oinve__if_8cpp.html#a86a62">FINANCIAL_BUTTON_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a87a66">FINANCIAL_BUTTON_WIDTH</a>,y+<a class="code" href="Oinve__if_8cpp.html#a87a67">FINANCIAL_BUTTON_HEIGHT</a>);
01000     }
01001 
01002     vga_back.rest_area(mode_financial_stats_bitmap,0,0);
01003     <a class="code" href="classString.html">String</a> *s1,*s2;
01004 
01005     <span class="comment">//show years</span>
01006 
01007     s1=<span class="keyword">new</span> <a class="code" href="classString.html">String</a>(m.format(v11,16));
01008     s2=<span class="keyword">new</span> <a class="code" href="classString.html">String</a>(m.format(v11+1,16));
01009 
01010     font_chartsm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a57">MODE_FINANCIAL_TAB2</a>+field_space,
01011                             <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+15,
01012                             s1-&gt;<a class="code" href="classString.html#m0">str_buf</a>);
01013 
01014     (*s1)=m.format(v12,16);
01015     (*s2)=m.format(v12+1,16);
01016 
01017     font_chartsm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a59">MODE_FINANCIAL_TAB4</a>+field_space,
01018                             <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+15,
01019                             s1-&gt;<a class="code" href="classString.html#m0">str_buf</a>);
01020 
01021     (*s1)=m.format(v13,16);
01022     (*s2)=m.format(v13+1,16);
01023     font_chartsm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a61">MODE_FINANCIAL_TAB6</a>+field_space,
01024                             <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+15,
01025                             s1-&gt;<a class="code" href="classString.html#m0">str_buf</a>);
01026 
01027     <span class="keyword">delete</span> s1,s2;
01028 
01029   <span class="comment">//--------- column: this year -----------//</span>
01030 
01031     font_chartsm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a57">MODE_FINANCIAL_TAB2</a>+field_space,
01032                             <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+40,
01033                             m.format(v21, 2));
01034     font_chartsm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a57">MODE_FINANCIAL_TAB2</a>+field_space,
01035                             <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+60,
01036                             m.format(v31, 2));
01037 
01038     <span class="keywordflow">if</span>((v41)&gt;=0) {
01039         font_chartsm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a57">MODE_FINANCIAL_TAB2</a>+field_space,
01040                                 <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+80,
01041                                 m.format(v41, 2));
01042     }
01043     <span class="keywordflow">else</span> {
01044         font_chart_red_sm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a57">MODE_FINANCIAL_TAB2</a>+field_space,
01045                                      <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+80,
01046                                      m.format(v41, 2));
01047     }
01048 
01049     <span class="comment">//--------- column: this year change -----------//</span>
01050 
01051     font_chartsm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a58">MODE_FINANCIAL_TAB3</a>+field_space,
01052                             <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+40,
01053                             m.format(v22, 24));
01054 
01055     font_chartsm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a58">MODE_FINANCIAL_TAB3</a>+field_space,
01056                             <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+60,
01057                             m.format(v32, 24));
01058 
01059     <span class="keywordflow">if</span>((v42)&gt;=0) {
01060         font_chartsm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a58">MODE_FINANCIAL_TAB3</a>+field_space,
01061                                 <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+80,
01062                                 m.format(v42, 24));
01063     }
01064     <span class="keywordflow">else</span> {
01065         font_chart_red_sm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a58">MODE_FINANCIAL_TAB3</a>+field_space,
01066                                      <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+80,
01067                                      m.format(v42, 24));
01068     }
01069 
01070     <span class="comment">//--------- column: this year -----------//</span>
01071 
01072     font_chartsm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a59">MODE_FINANCIAL_TAB4</a>+field_space,
01073                             <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+40,
01074                             m.format(v23, 2));
01075 
01076     font_chartsm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a59">MODE_FINANCIAL_TAB4</a>+field_space,
01077                             <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+60,
01078                             m.format(v33, 2));
01079 
01080     <span class="keywordflow">if</span>((v43)&gt;=0)
01081         font_chartsm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a59">MODE_FINANCIAL_TAB4</a>+field_space,
01082                                 <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+80,
01083                                 m.format(v43, 2));
01084     <span class="keywordflow">else</span>
01085         font_chart_red_sm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a59">MODE_FINANCIAL_TAB4</a>+field_space,
01086                                      <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+80,
01087                                      m.format(v43, 2));
01088 
01089     <span class="comment">//--------- column: next year change % -----------//</span>
01090 
01091     font_chartsm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a60">MODE_FINANCIAL_TAB5</a>+field_space,
01092                             <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+40,
01093                             m.format(v24, 24));
01094 
01095     font_chartsm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a60">MODE_FINANCIAL_TAB5</a>+field_space,
01096                             <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+60,
01097                             m.format(v34, 24));
01098 
01099     <span class="keywordflow">if</span>((v44)&gt;=0)
01100         font_chartsm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a60">MODE_FINANCIAL_TAB5</a>+field_space,
01101                                 <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+80,
01102                                 m.format(v44, 24));
01103     <span class="keywordflow">else</span>
01104         font_chart_red_sm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a60">MODE_FINANCIAL_TAB5</a>+field_space,
01105                                      <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+80,
01106                                      m.format(v44, 24));
01107 
01108     <span class="comment">//--------- column: next year -----------//</span>
01109 
01110     font_chartsm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a61">MODE_FINANCIAL_TAB6</a>+field_space,
01111                             <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+40,
01112                             <span class="comment">//                          REPORT_X1+MODE_FINANCIAL_TAB6+field_space,</span>
01113                             <span class="comment">//                          REPORT_Y1+40+font_chartsm.max_font_height,</span>
01114                             m.format(v25, 2));
01115     font_chartsm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a61">MODE_FINANCIAL_TAB6</a>+field_space,
01116                             <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+60,
01117                             <span class="comment">//                          REPORT_X1+MODE_FINANCIAL_TAB6+field_space,</span>
01118                             <span class="comment">//                          REPORT_Y1+60+font_chartsm.max_font_height,</span>
01119                             m.format(v35, 2));
01120 
01121     <span class="keywordflow">if</span>((v45)&gt;=0)
01122         font_chartsm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a61">MODE_FINANCIAL_TAB6</a>+field_space,
01123                                 <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+80,
01124                                 <span class="comment">//                              REPORT_X1+MODE_FINANCIAL_TAB6+field_space,</span>
01125                                 <span class="comment">//                              REPORT_Y1+80+font_chartsm.max_font_height,</span>
01126                                 m.format(v45, 2));
01127     <span class="keywordflow">else</span>
01128         font_chart_red_sm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a61">MODE_FINANCIAL_TAB6</a>+field_space,
01129                                      <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+80,
01130                                      <span class="comment">//                         REPORT_X1+MODE_FINANCIAL_TAB6+field_space,</span>
01131                                      <span class="comment">//                         REPORT_Y1+80+font_chart_red_sm.max_font_height,</span>
01132                                      m.format(v45, 2));
01133 
01134     <span class="comment">// ##### Begin Marco ##### //</span>
01135 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01136 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (info.financial_year() &gt; 1) {
01137         font_chart_purple_sm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a57">MODE_FINANCIAL_TAB2</a>,
01138                                         <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+15,
01139                                         <span class="stringliteral">"Yr. 0 (Initial)"</span>);
01140         font_chart_purple_sm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a57">MODE_FINANCIAL_TAB2</a>,
01141                                         <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+40,
01142                                         m.format(initialv21, 2));
01143         font_chart_purple_sm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a57">MODE_FINANCIAL_TAB2</a>,
01144                                         <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+60,
01145                                         m.format(initialv31, 2));
01146         font_chart_purple_sm.right_put( <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a57">MODE_FINANCIAL_TAB2</a>,
01147                                         <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+80,
01148                                         m.format(initialv41, 2));
01149     }
01150 <span class="preprocessor">#endif</span>
01151 <span class="preprocessor"></span>    <span class="comment">// ##### End Marco ##### //</span>
01152 
01153     vga.blt_buf(<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a57">MODE_FINANCIAL_TAB2</a>, <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>,
01154                 <a class="code" href="Oinve__if_8cpp.html#a81a37">REPORT_X2</a>, <a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a50">MODE_FINANCIAL_BOX1_HEIGHT</a>);
01155 
01156     <span class="keywordflow">for</span>(i=0;i&lt;3;i++) {
01157         financial_button_group[i].pop();
01158         financial_button_group[i].body_ptr=
01159             (<span class="keywordtype">void</span>*)(financial_button_up_bitmap[i]+4);
01160     }
01161 }
01162 
01163 <span class="comment">//---------- End of function report_FINANCIAL ---------//</span>
01164 
01165 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01166 <span class="preprocessor"></span><span class="comment">//---------- Begin of function report_TRANSFER -------- //</span>
01167 <span class="keyword">static</span> <span class="keywordtype">void</span> report_transfer(<span class="keywordtype">int</span> refreshFlag) {
01168     <span class="keyword">const</span> <span class="keyword">static</span> tab1=<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+10;
01169     <span class="keyword">const</span> <span class="keyword">static</span> tab2=<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+360;
01170     <span class="keyword">const</span> <span class="keyword">static</span> tab3=<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+365;
01171     <span class="keyword">const</span> <span class="keyword">static</span> tab4=<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+710;
01172     <span class="keyword">const</span> <span class="keyword">static</span> vtab1=<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>;
01173     <span class="keyword">const</span> <span class="keyword">static</span> vtab2=<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+180;
01174     <span class="keyword">const</span> <span class="keyword">static</span> vtab3=<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+185;
01175     <span class="keyword">const</span> <span class="keyword">static</span> vtab4=<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+345;
01176 
01177     <span class="keywordflow">if</span> (refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>) {
01178 
01179         <span class="keywordflow">if</span> ( mode_init_flag != MODE_TRANSFER ) {
01180             mode_init_flag = MODE_TRANSFER;
01181 
01182             user_interface.brighten(tab1,vtab1+15,tab4,vtab4);
01183             <span class="comment">// ##### Begin Marco ##### //</span>
01184 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01185 <span class="preprocessor"></span>            <span class="comment">//marco</span>
01186             user_interface.rect(tab1,vtab1+15,tab4,vtab2);
01187 <span class="preprocessor">#else</span>
01188 <span class="preprocessor"></span>            user_interface.rect(tab1,vtab1+15,tab3,vtab2);
01189             user_interface.rect(tab3-2,vtab1+15,tab4,vtab2);
01190 <span class="preprocessor">#endif</span>
01191 <span class="preprocessor"></span>            <span class="comment">// ##### End Marco ##### //</span>
01192             user_interface.rect(tab1,vtab2-2,tab4,vtab4);
01193             user_interface.brighten(<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+100,<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>-13,<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+630,<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+10);
01194             user_interface.rect(<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+100,<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>-13,<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+630,<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+10,1);
01195             font_charts.put(<a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+195,<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>-7,<span class="stringliteral">"Transfer of funds from the operating reserve"</span>);
01196 
01197             font_chartsm.put( 100, vtab1+20+25, <span class="stringliteral">"Transfer from:"</span> );
01198             font_chartsm.put( 380, vtab1+20+25, <span class="stringliteral">"Transfer to:"</span> );
01199 
01200             transfer_from.<a class="code" href="classRadioButtonVert.html#a2">init</a>(200,vtab1+20+25,320,218,3,&amp;sel_from,transfer_label,<a class="code" href="OHELP_8H.html#a0">NULL</a>);
01201             transfer_to.<a class="code" href="classRadioButtonVert.html#a2">init</a>(460,vtab1+20+25,580,218,3,&amp;sel_to,transfer_label,<a class="code" href="OHELP_8H.html#a0">NULL</a>);
01202 
01203             font_chartsm.put( 140, 280, <span class="stringliteral">"Amount to transfer( percentage of the current source account balance):"</span> );
01204 
01205             transfer_per_spinner.<a class="code" href="classSpinner.html#a2">init</a>(
01206                 140,
01207                 305,
01208                 260,
01209                 335,
01210                 <span class="comment">//### begin zhoubin 02/25/99</span>
01211                 &amp;spinner_val,
01212                 <span class="comment">//### end zhoubin 02/25/99</span>
01213                 <span class="comment">//                              -100.0f,100.0f,0.1f,0,NULL,23);</span>
01214                 0.0f,95.0f,5.0f,0,<a class="code" href="OHELP_8H.html#a0">NULL</a>,25);               <span class="comment">//## chea 170999</span>
01215 
01216             transfer_per_spinner.<a class="code" href="classSpinner.html#a4">paint</a>();
01217 
01218             implement_button.<a class="code" href="classButton.html#a10">create_text</a>( 140,
01219                                           350,
01220                                           260,
01221                                           380,
01222                                           <span class="stringliteral">"Implement now"</span> );
01223 
01224             implement_button.<a class="code" href="classButton.html#a20">paint</a>();
01225         }
01226     }
01227     <span class="keywordflow">else</span> {
01228         transfer_from.<a class="code" href="classRadioButtonVert.html#a5">refresh</a>();
01229         transfer_to.<a class="code" href="classRadioButtonVert.html#a5">refresh</a>();
01230     }
01231 
01232     transfer_per_spinner.<a class="code" href="classSpinner.html#a5">refresh</a>();
01233 }
01234 
01235 <span class="comment">//---------- End of function report_TRANSFER -------- //</span>
01236 <span class="preprocessor">#endif</span>
01237 <span class="preprocessor"></span>
01238 <span class="comment">//-------- Begin of function detect_investment ---------//</span>
01240 <span class="comment">static int detect_investment() {</span>
01241     <span class="keywordflow">if</span> (mode_init_flag != <a class="code" href="Oinve__if_8cpp.html#a79a32">MODE_INVESTMENT</a>)
01242         <span class="keywordflow">return</span> 0;
01243     <span class="keywordtype">double</span> sliderVar1,sliderVar2,sliderVar3,total;
01244 
01245     vga.use_back();
01246     <span class="keywordflow">if</span>(mode_investment_slider1.<a class="code" href="classValueSlider.html#a8">detect</a>()) {
01247         sliderVar1=*(mode_investment_slider1.<a class="code" href="classValueSlider.html#m7">var_ptr</a>);
01248         sliderVar2=*(mode_investment_slider2.<a class="code" href="classValueSlider.html#m7">var_ptr</a>);
01249         sliderVar3=*(mode_investment_slider3.<a class="code" href="classValueSlider.html#m7">var_ptr</a>);
01250         total=sliderVar2+sliderVar3;
01251         <span class="keywordflow">if</span>(total&gt;1E-9) {
01252             *(mode_investment_slider2.<a class="code" href="classValueSlider.html#m7">var_ptr</a>)=
01253                 (int)((100.0-sliderVar1)*(sliderVar2/total));
01254         }
01255         <span class="keywordflow">else</span> {
01256             *(mode_investment_slider2.<a class="code" href="classValueSlider.html#m7">var_ptr</a>)=
01257                 (int)(50-sliderVar1/2);
01258         }
01259         *(mode_investment_slider3.<a class="code" href="classValueSlider.html#m7">var_ptr</a>)=
01260             100-*(mode_investment_slider1.<a class="code" href="classValueSlider.html#m7">var_ptr</a>)-
01261             *(mode_investment_slider2.<a class="code" href="classValueSlider.html#m7">var_ptr</a>);
01262         investment_office.asset_array[0].allocation_percent=*(mode_investment_slider1.<a class="code" href="classValueSlider.html#m7">var_ptr</a>);
01263         investment_office.asset_array[1].allocation_percent=*(mode_investment_slider2.<a class="code" href="classValueSlider.html#m7">var_ptr</a>);
01264         investment_office.asset_array[2].allocation_percent=*(mode_investment_slider3.<a class="code" href="classValueSlider.html#m7">var_ptr</a>);
01265         <span class="keywordflow">return</span> 1;
01266     }
01267     <span class="keywordflow">if</span>(mode_investment_slider2.<a class="code" href="classValueSlider.html#a8">detect</a>()) {
01268         sliderVar1=*(mode_investment_slider1.<a class="code" href="classValueSlider.html#m7">var_ptr</a>);
01269         sliderVar2=*(mode_investment_slider2.<a class="code" href="classValueSlider.html#m7">var_ptr</a>);
01270         sliderVar3=*(mode_investment_slider3.<a class="code" href="classValueSlider.html#m7">var_ptr</a>);
01271         total=sliderVar1+sliderVar3;
01272         <span class="keywordflow">if</span>(total&gt;1E-9) {
01273             *(mode_investment_slider1.<a class="code" href="classValueSlider.html#m7">var_ptr</a>)=
01274                 (int)((100.0-sliderVar2)*(sliderVar1/total));
01275         }
01276         <span class="keywordflow">else</span> {
01277             *(mode_investment_slider1.<a class="code" href="classValueSlider.html#m7">var_ptr</a>)=
01278                 (int)(50-sliderVar2/2);
01279         }
01280         *(mode_investment_slider3.<a class="code" href="classValueSlider.html#m7">var_ptr</a>)=
01281             100-*(mode_investment_slider1.<a class="code" href="classValueSlider.html#m7">var_ptr</a>)-
01282             *(mode_investment_slider2.<a class="code" href="classValueSlider.html#m7">var_ptr</a>);
01283         investment_office.asset_array[0].allocation_percent=*(mode_investment_slider1.<a class="code" href="classValueSlider.html#m7">var_ptr</a>);
01284         investment_office.asset_array[1].allocation_percent=*(mode_investment_slider2.<a class="code" href="classValueSlider.html#m7">var_ptr</a>);
01285         investment_office.asset_array[2].allocation_percent=*(mode_investment_slider3.<a class="code" href="classValueSlider.html#m7">var_ptr</a>);
01286         <span class="keywordflow">return</span> 1;
01287     }
01288     <span class="keywordflow">if</span>(mode_investment_slider3.<a class="code" href="classValueSlider.html#a8">detect</a>()) {
01289         sliderVar1=*(mode_investment_slider1.<a class="code" href="classValueSlider.html#m7">var_ptr</a>);
01290         sliderVar2=*(mode_investment_slider2.<a class="code" href="classValueSlider.html#m7">var_ptr</a>);
01291         sliderVar3=*(mode_investment_slider3.<a class="code" href="classValueSlider.html#m7">var_ptr</a>);
01292         total=sliderVar1+sliderVar2;
01293         <span class="keywordflow">if</span>(total&gt;1E-9) {
01294             *(mode_investment_slider1.<a class="code" href="classValueSlider.html#m7">var_ptr</a>)=
01295                 (int)((100.0-sliderVar3)*(sliderVar1/total));
01296         }
01297         <span class="keywordflow">else</span> {
01298             *(mode_investment_slider1.<a class="code" href="classValueSlider.html#m7">var_ptr</a>)=
01299                 (int)(50-sliderVar3/2);
01300         }
01301         *(mode_investment_slider2.<a class="code" href="classValueSlider.html#m7">var_ptr</a>)=
01302             100-*(mode_investment_slider1.<a class="code" href="classValueSlider.html#m7">var_ptr</a>)-
01303             *(mode_investment_slider3.<a class="code" href="classValueSlider.html#m7">var_ptr</a>);
01304         investment_office.asset_array[0].allocation_percent=*(mode_investment_slider1.<a class="code" href="classValueSlider.html#m7">var_ptr</a>);
01305         investment_office.asset_array[1].allocation_percent=*(mode_investment_slider2.<a class="code" href="classValueSlider.html#m7">var_ptr</a>);
01306         investment_office.asset_array[2].allocation_percent=*(mode_investment_slider3.<a class="code" href="classValueSlider.html#m7">var_ptr</a>);
01307         <span class="keywordflow">return</span> 1;
01308     }
01309 
01310     <span class="keywordflow">return</span> 0;
01311 }
01312 
01313 <span class="comment">//---------- End of function detect_investment ---------//</span>
01314 
01315 <span class="comment">//-------- Begin of function detect_financial ---------//</span>
01317 <span class="comment">static int detect_financial() {</span>
01318     <span class="keywordflow">if</span> (mode_init_flag != <a class="code" href="Oinve__if_8cpp.html#a79a33">MODE_FINANCIAL</a>)
01319         <span class="keywordflow">return</span> 0;
01320     <span class="keyword">const</span> <span class="keyword">static</span> vtab3=<a class="code" href="Oinve__if_8cpp.html#a81a36">REPORT_Y1</a>+170;
01321 
01322     vga.use_front();
01323 
01324     help.set_help(
01325         <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a58">MODE_FINANCIAL_TAB3</a>+25,<a class="code" href="Oinve__if_8cpp.html#a81a38">REPORT_Y2</a>-<a class="code" href="Oinve__if_8cpp.html#a85a51">MODE_FINANCIAL_BOX2_HEIGHT</a>+5,
01326         <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a58">MODE_FINANCIAL_TAB3</a>+305,<a class="code" href="Oinve__if_8cpp.html#a81a38">REPORT_Y2</a>-<a class="code" href="Oinve__if_8cpp.html#a85a51">MODE_FINANCIAL_BOX2_HEIGHT</a>+85,<span class="stringliteral">"A.1.1.1."</span>);
01327     help.set_help(
01328         <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a58">MODE_FINANCIAL_TAB3</a>+25,vtab3+35,
01329         <a class="code" href="Oinve__if_8cpp.html#a81a35">REPORT_X1</a>+<a class="code" href="Oinve__if_8cpp.html#a85a58">MODE_FINANCIAL_TAB3</a>+305,vtab3+55,<span class="stringliteral">"A.1.1.2."</span>);
01330 
01331     <span class="keywordflow">if</span>(mode_financial_rbv.<a class="code" href="classRadioButtonVert.html#a6">detect</a>()) {
01332         investment_office.degree_smoothing_for_endowment_payout=*(mode_financial_rbv.<a class="code" href="classRadioButtonVert.html#m10">sel_num</a>);
01333         <span class="keywordflow">return</span> 1;
01334     }
01335 
01336     <span class="keywordflow">if</span> (financial_spinner_budget.<a class="code" href="classSpinner.html#a6">detect</a>())
01337         <span class="keywordflow">return</span> 1;
01338 
01339     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;3;i++)
01340         <span class="keywordflow">if</span>(financial_button_group[i].<a class="code" href="classButtonGroup.html#a4">detect</a>()) {
01341             financial_button_group[i].body_ptr =
01342                 (<span class="keywordtype">void</span> *) (financial_button_down_bitmap[i] + 4);
01343             <span class="comment">//  Communicate with Sim Engine</span>
01344             <span class="comment">/*PL_ENDOWMENT_SPENDING_RATE*/</span>
01345             finance.change_budget(i,<span class="keyword">true</span>, <a class="code" href="Ofinance_8h.html#a101a37">AC_ENDOWMENT_SPENDING</a>,(*financial_spinner_budget.<a class="code" href="classSpinner.html#m7">var_ptr</a>));
01346             <span class="comment">//##        begin zhoubin 000329</span>
01347             *financial_spinner_budget.<a class="code" href="classSpinner.html#m7">var_ptr</a>=0;
01348             <span class="comment">//##        end zhoubin 000329</span>
01349         }
01350 
01351     <span class="keywordflow">return</span> 0;
01352 }
01353 
01354 <span class="comment">//---------- End of function detect_FINANCIAL ---------//</span>
01355 
01356 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01357 <span class="preprocessor"></span><span class="comment">//-------- Begin of function detect_transfer ---------//</span>
01359 <span class="comment">static int detect_transfer() {</span>
01360     <span class="keywordflow">if</span> (transfer_from.<a class="code" href="classRadioButtonVert.html#a6">detect</a>()) {
01361         sel_from
01362             =*(transfer_from.<a class="code" href="classRadioButtonVert.html#m10">sel_num</a>);
01363         <span class="keywordflow">return</span> 1;
01364     }
01365 
01366     <span class="keywordflow">if</span> (transfer_to.<a class="code" href="classRadioButtonVert.html#a6">detect</a>()) {
01367         sel_to
01368             = *(transfer_to.<a class="code" href="classRadioButtonVert.html#m10">sel_num</a>);
01369         <span class="keywordflow">return</span> 1;
01370     }
01371 
01372     <span class="keywordflow">if</span> ( transfer_per_spinner.<a class="code" href="classSpinner.html#a6">detect</a>() )
01373         <span class="keywordflow">return</span> 1;
01374 
01375     <span class="keywordflow">if</span> ( implement_button.<a class="code" href="classButton.html#a21">detect</a>() ) {
01376         <span class="comment">// if they are the same</span>
01377         <span class="keywordflow">if</span> ( transfer_to.<a class="code" href="classRadioButtonVert.html#m10">sel_num</a> == transfer_from.<a class="code" href="classRadioButtonVert.html#m10">sel_num</a> )
01378             <span class="keywordflow">return</span> 1;
01379 
01380         <span class="keywordtype">char</span> selFrom[123];
01381         <span class="keywordtype">char</span> selTo[123];
01382 
01383         <span class="keywordflow">switch</span>( *transfer_from.<a class="code" href="classRadioButtonVert.html#m10">sel_num</a> ) {
01384         <span class="keywordflow">case</span> 0: strcpy( selFrom, <span class="stringliteral">"Operating reserve"</span> );   <span class="keywordflow">break</span>;
01385         <span class="keywordflow">case</span> 1: strcpy( selFrom, <span class="stringliteral">"Facilities reserve"</span> );  <span class="keywordflow">break</span>;
01386         <span class="keywordflow">case</span> 2: strcpy( selFrom, <span class="stringliteral">"Quasi endowment"</span> );   <span class="keywordflow">break</span>;
01387         }
01388 
01389         <span class="keywordflow">switch</span>( *transfer_to.<a class="code" href="classRadioButtonVert.html#m10">sel_num</a> ) {
01390         <span class="keywordflow">case</span> 0: strcpy( selTo, <span class="stringliteral">"Operating reserve"</span> );   <span class="keywordflow">break</span>;
01391         <span class="keywordflow">case</span> 1: strcpy( selTo, <span class="stringliteral">"Facilities reserve"</span> );  <span class="keywordflow">break</span>;
01392         <span class="keywordflow">case</span> 2: strcpy( selTo, <span class="stringliteral">"Quasi endowment"</span> );   <span class="keywordflow">break</span>;
01393         }
01394 
01395         <span class="keywordtype">int</span> selFromA, selToA;
01396         <span class="keywordtype">int</span> transferMoney;
01397 
01398         <span class="keywordflow">switch</span> (*transfer_from.<a class="code" href="classRadioButtonVert.html#m10">sel_num</a>) {
01399         <span class="keywordflow">case</span> 0:   transferMoney = finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a97a20">AC_OPERATING_RESERVE</a>]*(*(transfer_per_spinner.<a class="code" href="classSpinner.html#m7">var_ptr</a>))/100;
01400             selFromA      = finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a97a20">AC_OPERATING_RESERVE</a>]-transferMoney;
01401             <span class="keywordflow">break</span>;
01402         <span class="keywordflow">case</span> 1:   transferMoney = finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a97a21">AC_CAPITAL_RESERVE</a>]*(*(transfer_per_spinner.<a class="code" href="classSpinner.html#m7">var_ptr</a>))/100;
01403             selFromA      = finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a97a21">AC_CAPITAL_RESERVE</a>]-transferMoney;
01404             <span class="keywordflow">break</span>;
01405         <span class="keywordflow">case</span> 2:   transferMoney = finance.this_year.asset_array[AC_QUASI]*(*(transfer_per_spinner.<a class="code" href="classSpinner.html#m7">var_ptr</a>))/100;
01406             selFromA      = finance.this_year.asset_array[AC_QUASI]-transferMoney;
01407             <span class="keywordflow">break</span>;
01408         }
01409 
01410         <span class="keywordflow">switch</span> (*transfer_to.<a class="code" href="classRadioButtonVert.html#m10">sel_num</a>) {
01411         <span class="keywordflow">case</span> 0:   selToA  = finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a97a20">AC_OPERATING_RESERVE</a>] + transferMoney;
01412             <span class="keywordflow">break</span>;
01413         <span class="keywordflow">case</span> 1:   selToA  = finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a97a21">AC_CAPITAL_RESERVE</a>] + transferMoney;
01414             <span class="keywordflow">break</span>;
01415         <span class="keywordflow">case</span> 2:   selToA  = finance.this_year.asset_array[AC_QUASI] + transferMoney;
01416             <span class="keywordflow">break</span>;
01417         }
01418 
01419         <span class="keywordtype">char</span> askStr[128];
01420         sprintf( askStr, <span class="stringliteral">"Do you want to transfer $%d? After the transfer, the %s will contain $%d and the %s will contain $%d."</span>, transferMoney, selFrom, selFromA, selTo, selToA );
01421 
01422         <span class="keywordflow">if</span> ( !box.ask( askStr ) )
01423             <span class="keywordflow">return</span> 1;
01424 
01425         <span class="keywordflow">switch</span> (*transfer_from.<a class="code" href="classRadioButtonVert.html#m10">sel_num</a>) {
01426         <span class="keywordflow">case</span> 0:   transferMoney = finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a97a20">AC_OPERATING_RESERVE</a>]*(*(transfer_per_spinner.<a class="code" href="classSpinner.html#m7">var_ptr</a>))/100;
01427             finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a97a20">AC_OPERATING_RESERVE</a>] -= transferMoney;
01428             finance.transfer_operating_reserve -= transferMoney;
01429             <span class="keywordflow">break</span>;
01430         <span class="keywordflow">case</span> 1:   transferMoney = finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a97a21">AC_CAPITAL_RESERVE</a>]*(*(transfer_per_spinner.<a class="code" href="classSpinner.html#m7">var_ptr</a>))/100;
01431             finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a97a21">AC_CAPITAL_RESERVE</a>] -= transferMoney;
01432             finance.transfer_capital_reserve -= transferMoney;
01433             <span class="keywordflow">break</span>;
01434         <span class="keywordflow">case</span> 2:   transferMoney = finance.this_year.asset_array[AC_QUASI]*(*(transfer_per_spinner.<a class="code" href="classSpinner.html#m7">var_ptr</a>))/100;
01435             finance.this_year.asset_array[AC_QUASI] -= transferMoney;
01436             finance.transfer_quasi -= transferMoney;
01437             <span class="keywordflow">break</span>;
01438         }
01439 
01440         <span class="keywordflow">switch</span> (*transfer_to.<a class="code" href="classRadioButtonVert.html#m10">sel_num</a>) {
01441         <span class="keywordflow">case</span> 0:   finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a97a20">AC_OPERATING_RESERVE</a>] += transferMoney;
01442             finance.transfer_operating_reserve += transferMoney;
01443             <span class="keywordflow">break</span>;
01444         <span class="keywordflow">case</span> 1:   finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a97a21">AC_CAPITAL_RESERVE</a>] += transferMoney;
01445             finance.transfer_capital_reserve += transferMoney;
01446             <span class="keywordflow">break</span>;
01447         <span class="keywordflow">case</span> 2:   finance.this_year.asset_array[AC_QUASI] += transferMoney;
01448             finance.transfer_quasi += transferMoney;
01449             <span class="keywordflow">break</span>;
01450         }
01451 
01452         sys.redraw_all_flag = 1;
01453         *(transfer_per_spinner.<a class="code" href="classSpinner.html#m7">var_ptr</a>) = 0.0;
01454 
01455         <span class="keywordflow">return</span> 1;
01456     }
01457 
01458     <span class="keywordflow">return</span> 0;
01459 }
01460 
01461 <span class="comment">//</span>
01462 <span class="comment">//-------- End of function detect_transfer ---------//</span>
01463 <span class="preprocessor">#endif</span>
01464 <span class="preprocessor"></span>
01465 <span class="comment">//-------- Begin of function deinit_investment ---------//</span>
01467 <span class="comment">static void deinit_investment() {</span>
01468     <span class="keywordflow">if</span> (mode_init_flag == <a class="code" href="Oinve__if_8cpp.html#a79a32">MODE_INVESTMENT</a>) {
01469         <span class="comment">/*              if (*financial_button_up_bitmap)</span>
01470 <span class="comment">                        {</span>
01471 <span class="comment">                        for (int i = 0; i &lt; 3; i++)</span>
01472 <span class="comment">                        {</span>
01473 <span class="comment">                        mem_del(financial_button_up_bitmap[i]);</span>
01474 <span class="comment">                        mem_del(financial_button_down_bitmap[i]);</span>
01475 <span class="comment">                        financial_button_up_bitmap[i] = NULL;</span>
01476 <span class="comment">                        financial_button_down_bitmap[i] = NULL;</span>
01477 <span class="comment">                        }</span>
01478 <span class="comment">                        }</span>
01479 <span class="comment"></span>
01480 <span class="comment">                        financial_spinner_budget.deinit();</span>
01481 <span class="comment">        */</span>
01482         mode_investment_piechart.<a class="code" href="classPieChart.html#a11">deinit</a>();
01483         mode_investment_slider1.<a class="code" href="classValueSlider.html#a5">deinit</a>();
01484         mode_investment_slider2.<a class="code" href="classValueSlider.html#a5">deinit</a>();
01485         mode_investment_slider3.<a class="code" href="classValueSlider.html#a5">deinit</a>();
01486         mode_investment_graph_snp.<a class="code" href="classGraphMonth.html#a7">deinit</a>();
01487         mode_financial_text.<a class="code" href="classText.html#a26">deinit</a>();
01488         <span class="comment">// reset flag</span>
01489         mode_init_flag = -1;
01490     }
01491 }
01492 
01493 <span class="comment">//---------- End of function deinit_investment ---------//</span>
01494 
01495 <span class="comment">//-------- Begin of function deinit_financial ------//</span>
01497 <span class="comment">static void deinit_financial() {</span>
01498     <span class="keywordflow">if</span> (mode_init_flag == <a class="code" href="Oinve__if_8cpp.html#a79a33">MODE_FINANCIAL</a>) {
01499         <span class="comment">// deallocate memory used by the radio buttons and the value sliders</span>
01500         <span class="keywordflow">if</span>(mode_financial_stats_bitmap) {
01501             <a class="code" href="ALL_8H.html#a8">mem_del</a>(mode_financial_stats_bitmap);
01502             mode_financial_stats_bitmap=<a class="code" href="OHELP_8H.html#a0">NULL</a>;
01503         }
01504 
01505         <span class="comment">// ##### begin Gilbert 28/04/2001 #####//</span>
01506         financial_button_group.<a class="code" href="classButtonGroup.html#a2">deinit_buttons</a>();
01507         <span class="comment">// ##### end Gilbert 28/04/2001 #####//</span>
01508         <span class="keywordflow">if</span> (*financial_button_up_bitmap) {
01509             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {
01510                 <a class="code" href="ALL_8H.html#a8">mem_del</a>(financial_button_up_bitmap[i]);
01511                 <a class="code" href="ALL_8H.html#a8">mem_del</a>(financial_button_down_bitmap[i]);
01512                 financial_button_up_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
01513                 financial_button_down_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
01514             }
01515         }
01516 
01517         <span class="comment">//              mode_financial_slider_budget.deinit();</span>
01518         financial_spinner_budget.<a class="code" href="classSpinner.html#a3">deinit</a>();
01519         mode_financial_graph_profitloss.<a class="code" href="classGraphYear.html#a7">deinit</a>();
01520         mode_financial_rbv.<a class="code" href="classRadioButtonVert.html#a3">deinit</a>();
01521         <span class="comment">// ##### begin Gilbert 28/04/2001 #######//</span>
01522         mode_financial_text.<a class="code" href="classText.html#a26">deinit</a>();
01523         <span class="comment">// ##### end Gilbert 28/04/2001 #######//</span>
01524 
01525         <span class="comment">// reset flag</span>
01526         mode_init_flag = -1;
01527     }
01528 }
01529 
01530 <span class="comment">//---------- End of function deinit_financial ------//</span>
01531 
01532 <span class="comment">//-------- Begin of function deinit_tranfer ---------//</span>
01534 <span class="comment">static void deinit_transfer() {</span>
01535     <span class="keywordflow">if</span> ( mode_init_flag == MODE_TRANSFER ) {
01536         transfer_per_spinner.<a class="code" href="classSpinner.html#a3">deinit</a>();
01537         transfer_from.<a class="code" href="classRadioButtonVert.html#a3">deinit</a>();
01538         transfer_to.<a class="code" href="classRadioButtonVert.html#a3">deinit</a>();
01539 
01540         implement_button.<a class="code" href="classButton.html#a2">deinit</a>();
01541 
01542         <span class="comment">// reset flag</span>
01543         mode_init_flag = -1;
01544     }
01545 }
01546 
01547 <span class="comment">//</span>
01548 <span class="comment">//-------- End of function deinit_tranfer ---------//</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:38:00 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
