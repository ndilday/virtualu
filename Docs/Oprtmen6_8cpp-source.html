<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Oprtmen6.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Oprtmen6.cpp</h1><a href="Oprtmen6_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : OPRTMENU1.CPP</span>
00002 <span class="comment">//Description : Printing Menu Class Implementation</span>
00003 <span class="comment">//Owner           : Kevin(ho)</span>
00004 
00005 <span class="preprocessor">#include &lt;OPRINT.H&gt;</span>
00006 <span class="preprocessor">#include &lt;<a class="code" href="OVGALOCK_8H.html">OVGALOCK.H</a>&gt;</span>
00007 <span class="preprocessor">#include &lt;<a class="code" href="OPRTMENU_8H.html">OPRTMENU.H</a>&gt;</span>
00008 <span class="preprocessor">#include &lt;OWORLDMT.H&gt;</span>
00009 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00010 <span class="preprocessor">#include &lt;<a class="code" href="OBOX_8H.html">OBOX.H</a>&gt;</span>
00011 <span class="preprocessor">#include &lt;<a class="code" href="OVGA_8H.html">OVGA.H</a>&gt;</span>
00012 <span class="preprocessor">#include &lt;OFONT.H&gt;</span>
00013 <span class="preprocessor">#include &lt;OGAMESTR.H&gt;</span>
00014 <span class="preprocessor">#include &lt;OMOUSE.H&gt;</span>
00015 <span class="preprocessor">#include &lt;<a class="code" href="OMOUSE2_8H.html">OMOUSE2.H</a>&gt;</span>
00016 <span class="preprocessor">#include &lt;OIFACE.H&gt;</span>
00017 <span class="preprocessor">#include &lt;OINFO.H&gt;</span>
00018 <span class="preprocessor">#include &lt;OPSCHOOL.H&gt;</span>
00019 <span class="preprocessor">#include &lt;<a class="code" href="OSCHLRES_8H.html">OSCHLRES.H</a>&gt;</span>
00020 <span class="preprocessor">#include &lt;<a class="code" href="OPEERSCH_8H.html">OPEERSCH.H</a>&gt;</span>
00021 <span class="preprocessor">#include &lt;ODEPT.H&gt;</span>
00022 <span class="preprocessor">#include &lt;<a class="code" href="ODATE_8H.html">ODATE.H</a>&gt;</span>
00023 
00024 <span class="keyword">enum</span> {                                            <span class="comment">// screen coordinates</span>
00025     <a class="code" href="Oprtmen6_8cpp.html#a10a2">REPORT_X1</a> = <a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>+15,
00026     <a class="code" href="Oprtmen6_8cpp.html#a10a3">REPORT_Y1</a> = <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>+25,
00027     <a class="code" href="Oprtmen6_8cpp.html#a10a4">REPORT_X2</a> = <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-15,
00028     <a class="code" href="Oprtmen6_8cpp.html#a10a5">REPORT_Y2</a> = <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-55
00029 };
00030 
00031 <span class="keyword">enum</span> {
00032     <a class="code" href="Oprtmen6_8cpp.html#a11a6">PRINT_OPT1</a>=1,
00033     <a class="code" href="Oprtmen6_8cpp.html#a11a7">PRINT_OPT2</a>=2,
00034     <a class="code" href="Oprtmen6_8cpp.html#a11a8">PRINT_OPT3</a>=3,
00035     <a class="code" href="Oprtmen6_8cpp.html#a11a9">PRINT_OPT4</a>=4,
00036 };
00037 
00038 <span class="keyword">static</span> <span class="keywordtype">int</span> filename_count=0;
00039 <span class="keyword">static</span> <a class="code" href="classString.html">String</a> fn;
00040 
<a name="l00041"></a><a class="code" href="classPrintMenu.html#a11">00041</a> <span class="keywordtype">void</span> <a class="code" href="classPrintMenu.html#a11">PrintMenu::printing6</a>() {
00042   box.tell(<span class="stringliteral">"Now printing. \nPlease wait..."</span>);
00043   sys.no_true_output_flag=1;
00044   box.close();
00045   sys.no_true_output_flag=0;
00046 
00050   <span class="keywordflow">if</span>(<a class="code" href="classPrintMenu.html#m0">print_view_mode</a>==<a class="code" href="Osys_8h.html#a45a15">MODE_SCORE_REPORT</a>) {
00051     <span class="keyword">enum</span> {
00052       MODE_OVERALL=0,
00053       MODE_RANK=1,
00054       MODE_OUTPUTS=2,
00055       MODE_GENERAL_INSTITUTIONAL_PERFORMANCE=3,
00056       MODE_ATTITUDES_TOWARD_THE_INSTITUTION=4,
00057       MODE_FINANCE=5,
00058       MODE_MANAGEMENT=6,
00059       MODE_ADMISSION=7, 
00060     };
00061         {
00062       <a class="code" href="classMouseDispCount.html">MouseDispCount</a> mdc;
00063       print.start_print(sys.main_hwnd,sys.app_hinstance);
00064       print.open_page();
00065 
00066       print.dfont(10,<span class="keyword">false</span>,<span class="keyword">false</span>,0);
00067 
00068       print.put_text(<span class="stringliteral">"Insitution : "</span>,30,4);
00069                                                   <span class="comment">//Player Institution</span>
00070       print.put_text(player_school.school_name,44,4);
00071       print.put_text(<span class="stringliteral">"President : "</span>,30,5);
00072       <a class="code" href="classString.html">String</a> str;
00073       str =  player_school.player_first_name;
00074       str += <span class="stringliteral">" "</span>;
00075       str += player_school.player_last_name;
00076       print.put_text(str.<a class="code" href="classString.html#m0">str_buf</a>,44,5);           <span class="comment">//President</span>
00077       print.put_text(<span class="stringliteral">"Date : "</span>,99,5);
00078       <span class="comment">// print.put_text(date.date_str(info.game_date),107,5);                   //date</span>
00079       print.put_text(info.date_str_julian(info.game_date), 107,5 );
00080 
00081       <span class="keywordflow">if</span>(player_school.scenario_id&gt;0) {
00082         print.dfont(10,<span class="keyword">false</span>,<span class="keyword">false</span>,700);
00083         print.put_text(scn_name[player_school.scenario_id-1],50,6);
00084       }
00085 
00086       <span class="keywordflow">if</span>(<a class="code" href="classPrintMenu.html#m1">print_option</a>==1) {
00087         <span class="comment">/*                              int deptRecno = department_array.selected_recno;</span>
00088 <span class="comment">                Department* cur_dept_ptr = department_array[deptRecno];</span>
00089 <span class="comment">                String str1;</span>
00090 <span class="comment">                str1 ="Department : ";</span>
00091 <span class="comment">                str1 +=cur_dept_ptr-&gt;name();</span>
00092 <span class="comment">                str1 +="                                                                                                                              ";</span>
00093 <span class="comment">                print.dfont(12,false,false,0);</span>
00094 <span class="comment">                print.put_text("________________________________________________________________________________________________________________________________________________________________________________________________",20,6);</span>
00095 <span class="comment">                print.dfont(12,false,true,0);</span>
00096 <span class="comment">                print.put_text(str1.str_buf,20,7);</span>
00097 <span class="comment">        */</span>
00098         print.dfont(18,<span class="keyword">false</span>,<span class="keyword">false</span>,700);
00099         print.put_text(<span class="stringliteral">"Virtual U Score Report"</span>,24,1);
00100         print.dfont(10,<span class="keyword">false</span>,<span class="keyword">false</span>,0);
00101 
00102         user_interface.backgd_flag=0;
00103         sys.no_true_output_flag=1;
00104         sys.view_mode=<a class="code" href="Osys_8h.html#a45a15">MODE_SCORE_REPORT</a>;
00105         player_school.score_report_deinit();
00106         player_school.score_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00107         <span class="comment">//First page printing</span>
00108         <span class="comment">//*********************start printing********************</span>
00109 
00110         <span class="comment">//this will print the bmp in the center of the paper and 1/7 down the page</span>
00111         print.put_vga_back_center(<span class="stringliteral">"prn001.bmp"</span>,
00112           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-80,
00113           0.2,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00114         <span class="comment">/*upper left cor. of bitmap*/</span>
00115           );
00116         <span class="comment">// ##### begin Gilbert 28/04/2001 ######?/</span>
00117         <span class="comment">// save memory</span>
00118         player_school.score_report_deinit();
00119         <span class="comment">// ##### end Gilbert 28/04/2001 ######?/</span>
00120         sys.no_true_output_flag=0;
00121         user_interface.backgd_flag=1;
00122       }
00123 
00124       <span class="keywordflow">if</span>(<a class="code" href="classPrintMenu.html#m1">print_option</a>==2) {
00125         <span class="comment">/*                              int deptRecno = department_array.selected_recno;</span>
00126 <span class="comment">                Department* cur_dept_ptr = department_array[deptRecno];</span>
00127 <span class="comment">                String str1;</span>
00128 <span class="comment">                str1 ="Department : ";</span>
00129 <span class="comment">                str1 +=cur_dept_ptr-&gt;name();</span>
00130 <span class="comment">                str1 +="                                                                                                                              ";</span>
00131 <span class="comment">                print.dfont(12,false,false,0);</span>
00132 <span class="comment">                print.put_text("________________________________________________________________________________________________________________________________________________________________________________________________",20,6);</span>
00133 <span class="comment">                print.dfont(12,false,true,0);</span>
00134 <span class="comment">                print.put_text(str1.str_buf,20,7);</span>
00135 <span class="comment">        */</span>
00136         print.dfont(18,<span class="keyword">false</span>,<span class="keyword">false</span>,700);
00137         print.put_text(<span class="stringliteral">"Virtual U Score Report (Detail)"</span>,17,1);
00138         print.dfont(10,<span class="keyword">false</span>,<span class="keyword">false</span>,0);
00139 
00140         user_interface.backgd_flag=0;
00141         sys.no_true_output_flag=1;
00142 
00143         sys.view_mode=<a class="code" href="Osys_8h.html#a45a15">MODE_SCORE_REPORT</a>;
00144         <span class="keywordtype">int</span> report_type_backup=player_school.current_score_report_type;
00145 
00146         player_school.current_score_report_type=MODE_OVERALL;
00147         player_school.score_report_deinit();
00148         player_school.score_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00149         print.put_vga_back_center(<span class="stringliteral">"prn001.bmp"</span>,
00150           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-80,
00151           0.17,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00152           );
00153 
00154         print.dfont(12,<span class="keyword">false</span>,<span class="keyword">true</span>,0);
00155         print.put_text(<span class="stringliteral">"Overall"</span>,25,9);
00156 
00157         player_school.current_score_report_type=MODE_OUTPUTS;
00158         player_school.score_report_deinit();
00159         player_school.score_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00160         print.put_vga_back_center(<span class="stringliteral">"prn002.bmp"</span>,
00161           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-80,
00162           0.4,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00163           );
00164 
00165         print.dfont(12,<span class="keyword">false</span>,<span class="keyword">true</span>,0);
00166         print.put_text(<span class="stringliteral">"Output"</span>,25,23);
00167 
00168         player_school.current_score_report_type=MODE_GENERAL_INSTITUTIONAL_PERFORMANCE;
00169         player_school.score_report_deinit();
00170         player_school.score_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00171         print.put_vga_back_center(<span class="stringliteral">"prn003.bmp"</span>,
00172           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-80,
00173           0.65,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00174           );
00175 
00176         print.dfont(12,<span class="keyword">false</span>,<span class="keyword">true</span>,0);
00177         print.put_text(<span class="stringliteral">"Performance Indicators"</span>,25,37);
00178 
00179         print.end_page();
00180         print.open_page();
00181 
00182         player_school.current_score_report_type=MODE_ATTITUDES_TOWARD_THE_INSTITUTION;
00183         player_school.score_report_deinit();
00184         player_school.score_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00185         print.put_vga_back_center(<span class="stringliteral">"prn004.bmp"</span>,
00186           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-80,
00187           0.05,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00188           );
00189 
00190         print.dfont(12,<span class="keyword">false</span>,<span class="keyword">true</span>,0);
00191         print.put_text(<span class="stringliteral">"Attitudes toward the institution"</span>,25,2);
00192 
00193         player_school.current_score_report_type=MODE_FINANCE;
00194         player_school.score_report_deinit();
00195         player_school.score_report(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00196         print.put_vga_back_center(<span class="stringliteral">"prn005.bmp"</span>,
00197           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-80,
00198           0.3,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00199           );
00200 
00201         print.dfont(12,<span class="keyword">false</span>,<span class="keyword">true</span>,0);
00202         print.put_text(<span class="stringliteral">"Financial Indicators"</span>,25,17);
00203 
00204         print.dfont(9,<span class="keyword">false</span>,<span class="keyword">false</span>,0);
00205         print.put_text(<span class="stringliteral">"________________________________________________________________________________________________________________________________"</span>,15,48);
00206         print.put_text(<span class="stringliteral">"Rank"</span>,35,47);
00207         print.put_text(<span class="stringliteral">"University"</span>,45,47);
00208         print.put_text(<span class="stringliteral">"Current trustee evaluation"</span>,90,47);
00209 
00210         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;school_res.peer_school_count;i++) {
00211           <span class="keywordtype">int</span> idx = school_res.peer_school_rank[i];
00212 
00213           <a class="code" href="classPeerSchool.html">PeerSchool</a> *ps = &amp;(school_res.peer_school_array[idx]);
00214           print.put_text(m.format(i+1,4),35,49+i);
00215           print.put_text(ps-&gt;<a class="code" href="classSchool.html#m0">name</a>,45,49+i);
00216           print.put_text(m.format((<span class="keywordtype">int</span>)ps-&gt;<a class="code" href="classPeerSchool.html#m6">game_score</a>,4),100,49+i);
00217         }
00218 
00219         print.dfont(12,<span class="keyword">false</span>,<span class="keyword">true</span>,0);
00220         print.put_text(<span class="stringliteral">"Rank"</span>,25,34);
00221 
00222         player_school.current_score_report_type=report_type_backup;
00223         <span class="comment">// ##### begin Gilbert 28/04/2001 ######?/</span>
00224         <span class="comment">// save memory</span>
00225         player_school.score_report_deinit();
00226         <span class="comment">// ##### end Gilbert 28/04/2001 ######?/</span>
00227         sys.no_true_output_flag=0;
00228         user_interface.backgd_flag=1;
00229         <span class="comment">// #### begin Gilbert 24/04/2001 #####//</span>
00230         <span class="comment">// repaint after MouseDispCount mdc</span>
00231         <span class="comment">// player_school.score_report(INFO_REPAINT);</span>
00232         <span class="comment">// #### end Gilbert 24/04/2001 #####//</span>
00233       }
00234 
00235       print.end_page();
00236       print.endprint(sys.main_hwnd);
00237     }
00238   }
00240 
00241 }
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:38:13 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
