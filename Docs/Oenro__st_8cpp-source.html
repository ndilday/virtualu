<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Oenro_st.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Oenro_st.cpp</h1><a href="Oenro__st_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename              : OEnroll.cpp</span>
00002 <span class="comment">//Description   : EnrollRes Class Definition</span>
00003 <span class="comment">//Owner                 : Fred</span>
00004 
00005 <span class="comment">// ES library header file</span>
00006 <span class="preprocessor">#include &lt;<a class="code" href="ALL_8H.html">ALL.H</a>&gt;</span>
00007 <span class="preprocessor">#include &lt;<a class="code" href="OGAMESET_8H.html">OGAMESET.H</a>&gt;</span>
00008 <span class="preprocessor">#include &lt;<a class="code" href="OBOX_8H.html">OBOX.H</a>&gt;</span>
00009 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00010 
00011 <span class="comment">// CU header file</span>
00012 <span class="preprocessor">#include &lt;GAMEDEF.H&gt;</span>                              <span class="comment">// enum { NONMINORITY_MALE, NONMINORITY_FEMALE, MINORITY_MALE, MINORITY_FEMALE };</span>
00013 <span class="preprocessor">#include &lt;<a class="code" href="ODEPTRES_8H.html">ODEPTRES.H</a>&gt;</span>
00014 <span class="preprocessor">#include &lt;<a class="code" href="OSCHLRES_8H.html">OSCHLRES.H</a>&gt;</span>
00015 <span class="preprocessor">#include &lt;<a class="code" href="OPEERSCH_8H.html">OPEERSCH.H</a>&gt;</span>
00016 
00017 <span class="preprocessor">#include &lt;OSTUDENT.H&gt;</span>
00018 <span class="preprocessor">#include &lt;OPSCHOOL.H&gt;</span>
00019 <span class="preprocessor">#include &lt;OFINANCE.H&gt;</span>
00020 <span class="preprocessor">#include &lt;ODEPT.H&gt;</span>
00021 <span class="preprocessor">#include &lt;OCHANCE.H&gt;</span>
00022 <span class="preprocessor">#include &lt;OMATH.H&gt;</span>
00023 
00024 <span class="preprocessor">#include "OEnroll.h"</span>
00025 
00026 <span class="comment">//----------- Define static functions -------------//</span>
00027 <span class="keyword">static</span> <span class="keywordtype">bool</span> is_minority_group(<span class="keywordtype">char</span> group) {
00028     <span class="keywordflow">return</span> group == <a class="code" href="Gamedef_8h.html#a75a29">MINORITY_MALE</a> || group == <a class="code" href="Gamedef_8h.html#a75a30">MINORITY_FEMALE</a>;
00029 }
00030 
00031 <span class="keyword">static</span> <span class="keywordtype">bool</span> is_male_group(<span class="keywordtype">char</span> group) {
00032     <span class="keywordflow">return</span> group == <a class="code" href="Gamedef_8h.html#a75a29">MINORITY_MALE</a> || group == <a class="code" href="Gamedef_8h.html#a75a27">NONMINORITY_MALE</a>;
00033 }
00034 
00035 <span class="comment">//----------- Begin of function EnrollRes::update_enroll_history --------//</span>
<a name="l00039"></a><a class="code" href="classEnrollRes.html#a14">00039</a> <span class="comment">void EnrollRes::update_enroll_history(char noShift) {</span>
00040     <span class="comment">//-------------------------------//</span>
00041     <span class="comment">//           calc vars for interface        //</span>
00042     <span class="comment">//-------------------------------//</span>
00043 
00044     <span class="keywordtype">int</span> j;
00045 
00046     <span class="keywordtype">int</span> apps=0, offers=0, matrics=0;
00047     <span class="keywordflow">for</span> (j=0; j&lt;<a class="code" href="Ostudent_8h.html#a0">MAX_STUDENT_LEVEL</a>; j++) {
00048         applications_rate[j] = ( total_matrics[j] ) ? float(total_applications[j]) / total_matrics[j] : 0;
00049 
00050         <span class="comment">//## chea 081099 old idea</span>
00051         <span class="comment">//              cur_yield_rate[j] = ( total_offers[j] ) ? 1.0f-(float(total_matrics[j]) / total_offers[j]) : 0;</span>
00052         <span class="comment">//              cur_yield_rate[j] = ( total_offers[j] ) ? (float(total_matrics[j]) / total_applications[j]) : 0;</span>
00053         <span class="comment">//## chea 221099</span>
00054         cur_yield_rate[j] = ( total_offers[j] ) ? (float(total_matrics[j]) / total_offers[j]) : 0;
00055 
00056         offers_rate[j] = ( total_applications[j] ) ? float(total_offers[j]) / total_applications[j] : 0;
00057 
00058         apps += total_applications[j];
00059         offers += total_offers[j];
00060         matrics += total_matrics[j];
00061 
00062         <a class="code" href="ALL_8H.html#a0">err_when</a>(total_applications[j] &lt; 0 || total_offers[j] &lt; 0 || total_matrics[j] &lt; 0);
00063     }
00064 
00065     <span class="comment">// * 100 for interface display</span>
00066     <span class="comment">//</span>
00067 
00068     overall_yield_rate = (offers) ? float(matrics)/offers * 100: 0;
00069     overall_offers_rate = (apps) ? float(offers)/apps * 100: 0;
00070     overall_apps_rate = (matrics) ? float(apps)/matrics * 100: 0;
00071 
00072   <span class="comment">//------------ calc percent_minority ------------//</span>
00073 
00074     <span class="keywordtype">char</span>  subSeg, seg;
00075     <span class="keywordtype">int</span> newStudentCount, totalMatrics = 0;
00076     <span class="keywordtype">char</span>  sl = 0;
00077     <span class="keywordtype">int</span> percentMinority[<a class="code" href="Ostudent_8h.html#a0">MAX_STUDENT_LEVEL</a>];
00078 
00079     overall_percent_minority_matric = 0;
00080 
00081     memset(percentMinority, 0, <span class="keyword">sizeof</span>(percentMinority));
00082 
00083   <span class="comment">// sl1</span>
00084     <span class="keywordflow">for</span> ( subSeg=0; subSeg&lt;<a class="code" href="Oenroll_8h.html#a31a10">STUDENT_SUBSEGMENT_COUNT</a>; subSeg++ ) {
00085         <span class="keywordflow">for</span> ( seg=0; seg&lt;<a class="code" href="Oenroll_8h.html#a31a9">STUDENT_SEGMENT_COUNT</a>; seg++ ) {
00086             newStudentCount = enroll_data_sl1[subSeg][seg].matrics;
00087 
00088             <span class="comment">// update vars for calc average later</span>
00089             <span class="keywordflow">if</span> ( is_minority_group(subSeg) ) {
00090                 overall_percent_minority_matric += newStudentCount;
00091                 percentMinority[sl] += newStudentCount;
00092             }
00093 
00094             totalMatrics += newStudentCount;
00095         }
00096     }
00097 
00098     <span class="comment">//sl25</span>
00099     <span class="keywordflow">for</span> ( sl=<a class="code" href="Ostudent_8h.html#a32a4">UG_NONTRADITION</a>; sl&lt;<a class="code" href="Ostudent_8h.html#a0">MAX_STUDENT_LEVEL</a>; sl++) {
00100         <span class="keywordtype">char</span> arrSL = sl-1;
00101         <span class="keywordflow">for</span> ( subSeg=0; subSeg&lt;<a class="code" href="Oenroll_8h.html#a31a10">STUDENT_SUBSEGMENT_COUNT</a>; subSeg++ ) {
00102             newStudentCount = enroll_data_sls[arrSL][subSeg].matrics;
00103 
00104             <span class="comment">// update vars for calc average later</span>
00105             <span class="keywordflow">if</span> ( is_minority_group(subSeg) ) {
00106                 overall_percent_minority_matric += newStudentCount;
00107                 percentMinority[arrSL] += newStudentCount;
00108             }
00109 
00110             totalMatrics += newStudentCount;
00111         }
00112     }
00113 
00114     <span class="comment">// calc vars for interface excusively</span>
00115     overall_percent_minority_matric = (totalMatrics &gt; 0) ? overall_percent_minority_matric * 100 / totalMatrics : 0;
00116 
00117     <span class="keywordflow">for</span> ( sl=0; sl&lt;<a class="code" href="Ostudent_8h.html#a0">MAX_STUDENT_LEVEL</a>; sl++)
00118         percentMinority[sl] = (total_matrics[sl] &gt; 0) ? percentMinority[sl] * 100 / total_matrics[sl] : 0;
00119 
00120   <span class="comment">//------------ calculate talent ------------//</span>
00121 
00122   <span class="comment">// sl1-5 talent</span>
00123 
00124     <span class="keywordflow">if</span>( !noShift ) {                                <span class="comment">// do not calculate if noShift is 1, when noShift is one, it is not a normall call, but an event call and we may not have the appropriate inputs to calculate it at this time</span>
00125         talent_average[<a class="code" href="Ostudent_8h.html#a34a13">MAX_STUDENT_LEVEL_TOTAL</a>][<a class="code" href="Ostudent_8h.html#a39a26">ACADEMIC</a>] = 0;
00126 
00127         <span class="keywordflow">for</span> ( sl=0; sl&lt;<a class="code" href="Ostudent_8h.html#a0">MAX_STUDENT_LEVEL</a>; sl++) {
00128             talent_average[<a class="code" href="Ostudent_8h.html#a34a13">MAX_STUDENT_LEVEL_TOTAL</a>][<a class="code" href="Ostudent_8h.html#a39a26">ACADEMIC</a>]  += talent_average[sl][<a class="code" href="Ostudent_8h.html#a39a26">ACADEMIC</a>];
00129             talent_average[sl][<a class="code" href="Ostudent_8h.html#a39a26">ACADEMIC</a>] = (total_matrics[sl] &gt; 0) ? talent_average[sl][<a class="code" href="Ostudent_8h.html#a39a26">ACADEMIC</a>] / total_matrics[sl] :0;
00130         }
00131 
00132         <span class="comment">// sl1 talent</span>
00133 
00134         sl = 0;
00135 
00136         <span class="keywordflow">if</span> ( total_matrics[sl] &gt; 0 ) {
00137             talent_average[sl][<a class="code" href="Ostudent_8h.html#a39a27">EXTRA_CURRI</a>] /= total_matrics[sl];
00138             talent_average[sl][<a class="code" href="Ostudent_8h.html#a39a28">ATHLETIC</a>] /= total_matrics[sl];
00139         }
00140 
00141         talent_average[<a class="code" href="Ostudent_8h.html#a34a13">MAX_STUDENT_LEVEL_TOTAL</a>][<a class="code" href="Ostudent_8h.html#a39a26">ACADEMIC</a>] = (totalMatrics &gt; 0) ? talent_average[<a class="code" href="Ostudent_8h.html#a34a13">MAX_STUDENT_LEVEL_TOTAL</a>][<a class="code" href="Ostudent_8h.html#a39a26">ACADEMIC</a>] / totalMatrics : 0;
00142         talent_average[<a class="code" href="Ostudent_8h.html#a34a13">MAX_STUDENT_LEVEL_TOTAL</a>][<a class="code" href="Ostudent_8h.html#a39a27">EXTRA_CURRI</a>] = talent_average[sl][<a class="code" href="Ostudent_8h.html#a39a27">EXTRA_CURRI</a>];
00143         talent_average[<a class="code" href="Ostudent_8h.html#a34a13">MAX_STUDENT_LEVEL_TOTAL</a>][<a class="code" href="Ostudent_8h.html#a39a28">ATHLETIC</a>] = talent_average[sl][<a class="code" href="Ostudent_8h.html#a39a28">ATHLETIC</a>];
00144     }
00145 
00146     <span class="comment">//-------------------------------//</span>
00147     <span class="comment">// calc vars for graph interface    //</span>
00148     <span class="comment">//-------------------------------//</span>
00149 
00150     <span class="keywordtype">int</span> h, var;
00151 
00152     <span class="keywordflow">if</span>(!noShift) {
00153         <span class="comment">// shift history to "left"</span>
00154         <span class="comment">//</span>
00155         <span class="keywordflow">for</span> ( sl=0; sl&lt;<a class="code" href="Ostudent_8h.html#a34a12">MAX_STUDENT_LEVEL_N_TOTAL</a>; sl++)
00156             <span class="keywordflow">for</span> ( var=0; var&lt;<a class="code" href="Oenroll_8h.html#a34a26">HISTORY_GRAPH_COUNT_GENERAL</a>; var++) {
00157                 <a class="code" href="Gamedef_8h.html#a14">shift_history</a>( matric_history[sl][var], HISTORY_YEAR_COUNT );
00158             }
00159     }
00160     <span class="comment">// update current year values</span>
00161     <span class="comment">//</span>
00162     h = THIS_YEAR;
00163     sl = <a class="code" href="Ostudent_8h.html#a0">MAX_STUDENT_LEVEL</a>;
00164 
00165     <span class="comment">// history_value is int array</span>
00166 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00167 <span class="preprocessor"></span>    matric_history[sl][ER_CREDITS_DEMANDED][h]  = (int) enroll_res.total_applications[<a class="code" href="Ostudent_8h.html#a32a7">DISTANCE_LEARN</a>]*8;
00168     <span class="keywordtype">int</span> totalDLProvided = 0;
00169     <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=department_array.size(); i&gt;0; i-- ) {
00170         <span class="keywordflow">if</span> ( department_array.is_deleted(i) )
00171             <span class="keywordflow">continue</span>;
00172         totalDLProvided += department_array[i]-&gt;distance_credits_provided;
00173     }
00174     matric_history[sl][ER_CREDITS_PROVIDED][h]  = (int) totalDLProvided;
00175 <span class="preprocessor">#endif</span>
00176 <span class="preprocessor"></span>    matric_history[sl][<a class="code" href="Oenroll_8h.html#a34a19">ER_YIELD_RATE</a>][h]    = (int) overall_yield_rate;
00177     matric_history[sl][<a class="code" href="Oenroll_8h.html#a34a20">ER_OFFERS_RATE</a>][h]   = (int) overall_offers_rate;
00178     matric_history[sl][<a class="code" href="Oenroll_8h.html#a34a21">ER_PERCENT_MINORITY</a>][h]= (int) overall_percent_minority_matric;
00179 
00180     <span class="keywordflow">if</span>(!noShift) {
00181         matric_history[sl][<a class="code" href="Oenroll_8h.html#a34a22">ER_ACADEMIC</a>][h]      = talent_average[sl][<a class="code" href="Ostudent_8h.html#a39a26">ACADEMIC</a>];
00182         matric_history[sl][<a class="code" href="Oenroll_8h.html#a34a23">ER_EXTRACURRICULAR</a>][h] = talent_average[sl][<a class="code" href="Ostudent_8h.html#a39a27">EXTRA_CURRI</a>];
00183         matric_history[sl][<a class="code" href="Oenroll_8h.html#a34a24">ER_ATHLETICS</a>][h]     = talent_average[sl][<a class="code" href="Ostudent_8h.html#a39a28">ATHLETIC</a>];
00184     }
00185 
00186     <span class="comment">//----------------------------------//</span>
00187     <span class="comment">//           calc vars for graph: sl1-5     //</span>
00188     <span class="comment">//----------------------------------//</span>
00189 
00190     <span class="keywordflow">for</span> ( sl=0; sl&lt;<a class="code" href="Ostudent_8h.html#a34a13">MAX_STUDENT_LEVEL_TOTAL</a>; sl++) {
00191 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00192 <span class="preprocessor"></span>        matric_history[sl][ER_CREDITS_DEMANDED][h]    = int(enroll_res.total_applications[<a class="code" href="Ostudent_8h.html#a32a7">DISTANCE_LEARN</a>] * 8);
00193         matric_history[sl][ER_CREDITS_PROVIDED][h]    = int(totalDLProvided);
00194 <span class="preprocessor">#endif</span>
00195 <span class="preprocessor"></span>        matric_history[sl][<a class="code" href="Oenroll_8h.html#a34a19">ER_YIELD_RATE</a>][h]    = int(cur_yield_rate[sl] * 100);
00196         matric_history[sl][<a class="code" href="Oenroll_8h.html#a34a20">ER_OFFERS_RATE</a>][h]   = int(offers_rate[sl] * 100);
00197         matric_history[sl][<a class="code" href="Oenroll_8h.html#a34a21">ER_PERCENT_MINORITY</a>][h]= percentMinority[sl];
00198 
00199         <span class="keywordflow">if</span>(!noShift) {
00200             matric_history[sl][<a class="code" href="Oenroll_8h.html#a34a22">ER_ACADEMIC</a>][h]      = talent_average[sl][<a class="code" href="Ostudent_8h.html#a39a26">ACADEMIC</a>];
00201             matric_history[sl][<a class="code" href="Oenroll_8h.html#a34a23">ER_EXTRACURRICULAR</a>][h] = talent_average[sl][<a class="code" href="Ostudent_8h.html#a39a27">EXTRA_CURRI</a>];
00202             matric_history[sl][<a class="code" href="Oenroll_8h.html#a34a24">ER_ATHLETICS</a>][h]     = talent_average[sl][<a class="code" href="Ostudent_8h.html#a39a28">ATHLETIC</a>];
00203         }
00204     }
00205 }
00206 
00207 <span class="comment">//------------- End of function EnrollRes::update_enroll_history --------//</span>
00208 
00209 <span class="comment">//------------- Begin of function EnrollRes::next_day --------//</span>
<a name="l00210"></a><a class="code" href="classEnrollRes.html#a7">00210</a> <span class="keywordtype">void</span> <a class="code" href="classEnrollRes.html#a7">EnrollRes::next_day</a>() {
00211     <span class="comment">//---- update student intake once a year -----//</span>
00212 
00213     <span class="keywordflow">if</span>(info.game_day ==1 &amp;&amp; info.game_month ==9)
00214         <a class="code" href="classEnrollRes.html#a18">update_student_intake</a>();
00215 
00216     <span class="comment">//----  start of a trimester -------/</span>
00217 
00218     <span class="keywordflow">if</span> ( info.game_day == player_school.trimester_array[player_school.cur_trimester].start_day
00219          &amp;&amp; info.game_month == player_school.trimester_array[player_school.cur_trimester].start_month ) {
00220         <a class="code" href="classEnrollRes.html#a8">update_history</a>(UPDATE_TRIMESTER);
00221     }
00222 
00223     <span class="comment">//-------  start of a month ---------//</span>
00224 
00225     <span class="keywordflow">if</span> ( info.game_day == 1 ) {
00226         <a class="code" href="classEnrollRes.html#a8">update_history</a>(UPDATE_MONTH);
00227 
00228         <span class="comment">// start of a year</span>
00229         <span class="keywordflow">if</span> ( info.game_month == finance.fiscal_year_start_month ) {
00230             <a class="code" href="classEnrollRes.html#a8">update_history</a>(UPDATE_YEAR);
00231             <span class="comment">//## chea 160699 for checking end of ban</span>
00232             <span class="keywordflow">if</span>(chance_event.athlete_special_ban_year&gt;0) chance_event.athlete_special_ban_year --;
00233         }
00234     }
00235 }
00236 
00237 <span class="comment">//------------- End of function EnrollRes::next_day --------//</span>
00238 
00239 <span class="comment">//------------- Begin of function EnrollRes::update_student_intake --------//</span>
<a name="l00240"></a><a class="code" href="classEnrollRes.html#a18">00240</a> <span class="keywordtype">void</span> <a class="code" href="classEnrollRes.html#a18">EnrollRes::update_student_intake</a>() {
00241     <span class="comment">//---- for initialization -----//</span>
00242 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00243 <span class="preprocessor"></span>    <span class="keywordflow">if</span>(info.prerun_year == 1 &amp;&amp; info.game_year == 1 )
00244 <span class="preprocessor">#else</span>
00245 <span class="preprocessor"></span>        <span class="keywordflow">if</span>(info.prerun_year == 1)
00246 <span class="preprocessor">#endif</span>
00247 <span class="preprocessor"></span>        {
00248             <span class="comment">//## chea 040999 store the value for the last year target ribbon</span>
00249             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;5 ; i++) {
00250                 <span class="keywordflow">if</span>( i !=3)
00251                     enroll_res.last_year_target_student_intake[i] = enroll_res.target_student_intake[i];
00252             }
00253 
00254             <span class="comment">//## chea 060999 begin make the cal target_student_intake = lastyear student no - grad and drop</span>
00255         }
00256         <span class="keywordflow">else</span> {                                          <span class="comment">//--- for normal running -------------//</span>
00257             <span class="comment">//begin chea make actural student count</span>
00258             <span class="keywordtype">int</span> i,j;
00259             <span class="keywordtype">int</span> thisYearArray[5] = {0,0,0,0,0};
00260 
00261             <a class="code" href="classStudentArray.html">StudentArray</a>* stuArr;
00262             <a class="code" href="classStudent.html">Student</a> *stuPtr;
00263 
00264             <a class="code" href="ALL_8H.html#a0">err_when</a>( department_array.size() == 0 );
00265 
00266             <span class="keywordflow">for</span> ( i=department_array.size(); i&gt;=0; i-- ) {
00267                 <span class="keywordflow">if</span> (i) {
00268                     <span class="keywordflow">if</span> ( department_array.is_deleted(i) )
00269                         <span class="keywordflow">continue</span>;
00270 
00271                     stuArr = &amp;(department_array[i]-&gt;student_array);
00272 
00273                 }
00274                 <span class="keywordflow">else</span>
00275                     stuArr = &amp;(department_res.general_dept.student_array);
00276 
00277                 <span class="comment">// loop student</span>
00278 
00279                 <span class="keywordflow">for</span> (j=stuArr-&gt;<a class="code" href="classDynArray.html#a28">size</a>(); j&gt;0; j--) {
00280                     <span class="keywordflow">if</span> ( stuArr-&gt;<a class="code" href="classStudentArray.html#a9">is_deleted</a>(j) )
00281                         <span class="keywordflow">continue</span>;
00282 
00283                     sys.yield();
00284                     stuPtr = stuArr-&gt;operator[](j);
00285 
00286                     <span class="keywordflow">if</span>(stuPtr-&gt;<a class="code" href="classStudent.html#m2">student_level</a> == 0)
00287                         thisYearArray[0]++;
00288                     <span class="keywordflow">if</span>(stuPtr-&gt;<a class="code" href="classStudent.html#m2">student_level</a> == 1)
00289                         thisYearArray[1]++;
00290                     <span class="keywordflow">if</span>(stuPtr-&gt;<a class="code" href="classStudent.html#m2">student_level</a> == 2)
00291                         thisYearArray[2]++;
00292                     <span class="comment">//                  if(stuPtr-&gt;student_level == 3)</span>
00293                     <span class="comment">//                          thisYearArray[3]++;</span>
00294                     <span class="keywordflow">if</span>(stuPtr-&gt;<a class="code" href="classStudent.html#m2">student_level</a> == 4)
00295                         thisYearArray[4]++;
00296 
00297                 }                                           <span class="comment">// end for j</span>
00298             }
00299             <span class="comment">//end chea make actural student count</span>
00300 
00301             <span class="comment">// BEGIN adjust the intake no.because of the enroll_res.total_applications</span>
00302             <span class="keywordtype">int</span> adjustStuCount[5] = {0,0,0,0,0};
00303             <span class="keywordtype">int</span> count_over =0;
00304             <span class="keywordtype">int</span> t;
00305 
00306 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00307 <span class="preprocessor"></span>            <span class="comment">// calculate data for further calculation</span>
00308             <span class="keywordtype">int</span> bachelorDegree=0, nonUgDegree=0, masterDegree=0, doctorDegree=0;
00309             <span class="keywordtype">int</span> dropoutLocal[<a class="code" href="Ostudent_8h.html#a33a8">DEGREE_TYPE_COUNT</a>+1]={0,0,0,0};
00310             <span class="keywordtype">int</span> nonUgDropouts=0;
00311 
00312             <span class="keywordflow">for</span> ( i=1; i&lt;=department_array.size(); i++ ) {
00313                 <span class="keywordflow">if</span> ( department_array.is_deleted(i) )
00314                     <span class="keywordflow">continue</span>;
00315 
00316                 <a class="code" href="classDepartment.html">Department</a>* deptPtr = department_array[i];
00317 
00318                 <span class="comment">// get total degree numbers</span>
00319                 bachelorDegree += deptPtr-&gt;<a class="code" href="classGeneralDepartment.html#m0">student_array</a>.last_year_degree[0];
00320                 nonUgDegree   += deptPtr-&gt;<a class="code" href="classGeneralDepartment.html#m0">student_array</a>.last_year_degree[1];
00321                 masterDegree  += deptPtr-&gt;<a class="code" href="classGeneralDepartment.html#m0">student_array</a>.last_year_degree[2];
00322                 doctorDegree  += deptPtr-&gt;<a class="code" href="classGeneralDepartment.html#m0">student_array</a>.last_year_degree[3];
00323 
00324                 <span class="comment">// get total dropout numbers</span>
00325                 <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> j=0; j&lt;4; j++ )
00326                     dropoutLocal[j] += deptPtr-&gt;<a class="code" href="classGeneralDepartment.html#m0">student_array</a>.last_year_dropout[j];
00327             }
00328 
00329             <a class="code" href="classGeneralDepartment.html">GeneralDepartment</a>* genDept = &amp;department_res.general_dept;
00330 
00331             <span class="keywordflow">for</span> ( j=0; j&lt;4; j++ )
00332                 dropoutLocal[j] += genDept-&gt;<a class="code" href="classGeneralDepartment.html#m0">student_array</a>.last_year_dropout[j];
00333 
00334             <span class="comment">// Target_intake(t) = target_enrollment - (actual_enrollment(t-1)-Grad(t)-Dropouts(t))</span>
00335             <span class="keywordflow">for</span> (t=0; t&lt;4; t++) {
00336                 adjustStuCount[t] = enroll_res.target_enrollment[t];
00337 
00338                 adjustStuCount[t] -= department_array.student_level_history[t][THIS_YEAR];
00339 
00340                 <span class="keywordflow">switch</span> (t) {
00341                 <span class="keywordflow">case</span> 0: adjustStuCount[t] += bachelorDegree;  <span class="keywordflow">break</span>;
00342                 <span class="keywordflow">case</span> 1: adjustStuCount[t] += nonUgDegree;   <span class="keywordflow">break</span>;
00343                 <span class="keywordflow">case</span> 2: adjustStuCount[t] += masterDegree;    <span class="keywordflow">break</span>;
00344                 <span class="keywordflow">case</span> 3: adjustStuCount[t] += doctorDegree;    <span class="keywordflow">break</span>;
00345                 }
00346 
00347                 adjustStuCount[t] += dropoutLocal[t];
00348             }
00349 
00350             <span class="comment">// set it to 0 if negative</span>
00351             <span class="keywordflow">for</span> (t=0; t&lt;5; t++) {
00352                 <span class="keywordflow">if</span> ( adjustStuCount[t] &lt;= 0 ) {
00353                     adjustStuCount[t] = 0;
00354                 }
00355             }
00356 <span class="preprocessor">#else</span>
00357 <span class="preprocessor"></span>            <span class="comment">// Grad(t) + Drop(t)</span>
00358             <span class="keywordflow">for</span> (t=0; t&lt;5 ; t++) {
00359                 adjustStuCount[t] = department_array.student_level_history[t][THIS_YEAR] - thisYearArray[t];
00360             }
00361 
00362             <span class="keywordflow">for</span> (t=0; t&lt;5 ; t++) {
00363                 <span class="keywordflow">if</span>(adjustStuCount[t] &gt;= enroll_res.total_applications[t]) {
00364                     count_over += (adjustStuCount[t] - enroll_res.total_applications[t]);
00365                     adjustStuCount[t] = enroll_res.total_applications[t];
00366                 }
00367             }
00368 
00369             <span class="comment">// put all the student in trad.</span>
00370             <span class="keywordflow">if</span>((adjustStuCount[0]+count_over) &gt;= enroll_res.total_applications[0])
00371                 adjustStuCount[0] = enroll_res.total_applications[0];
00372             <span class="keywordflow">else</span>
00373                 adjustStuCount[0] += count_over;
00374 
00375             <span class="comment">//adjust player input</span>
00376             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> f=0; f&lt;5 ; f++) {
00377                 <span class="keywordflow">if</span>( f !=3) {
00378                     adjustStuCount[f] += enroll_res.target_student_intake[f] - enroll_res.last_year_target_student_intake[f];
00379 
00380                     <span class="keywordflow">if</span>(adjustStuCount[f] &lt;= 0)
00381                         adjustStuCount[f] = 0;
00382 
00383                     <span class="keywordflow">if</span>(adjustStuCount[f] &gt;= enroll_res.total_applications[f])
00384                         adjustStuCount[f] = enroll_res.total_applications[f];
00385                 }
00386             }
00387             <span class="comment">// fine adjust the target value since the target seem to be a little bit to many</span>
00388             <span class="comment">//if(info.game_year == 2)</span>
00389             <span class="comment">//  adjustStuCount[0] -= 90;</span>
00390             <span class="comment">//if(adjustStuCount[f] &lt;= 0)</span>
00391             <span class="comment">//  adjustStuCount[f] = 0;</span>
00392 
00393             <span class="comment">// fix in version 2</span>
00394             <span class="keywordflow">if</span>(info.game_year == 2) {
00395                 adjustStuCount[0] -= 90;
00396                 <span class="keywordflow">if</span>(adjustStuCount[0] &lt;= 0)
00397                     adjustStuCount[0] = 0;
00398             }
00399 <span class="preprocessor">#endif</span>
00400 <span class="preprocessor"></span>
00401             <span class="comment">// END adjust the intake no.because of the enroll_res.total_applications</span>
00402 
00403             <span class="comment">//## chea make actural student count</span>
00404             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> h=0; h&lt;5 ;h++) {
00405                 enroll_res.target_student_intake[h] = adjustStuCount[h];
00406             }
00407 
00408             <span class="comment">//## chea 040999 store the value for the last year target ribbon</span>
00409 
00410             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> u=0; u&lt;5 ; u++) {
00411                 <span class="keywordflow">if</span>( u !=3)
00412                     enroll_res.last_year_target_student_intake[u] = enroll_res.target_student_intake[u];
00413             }
00414             <span class="comment">//## chea 060999 begin make the cal target_student_intake = lastyear student no - grad and drop</span>
00415         }
00416 }
00417 
00418 <span class="comment">//------------- End of function EnrollRes::update_student_intake --------//</span>
00419 
00420 <span class="comment">//---------- Begin of function Student::update_history -----------//</span>
<a name="l00426"></a><a class="code" href="classEnrollRes.html#a8">00426</a> <span class="comment">void EnrollRes::update_history(char update_flag) {</span>
00427     <span class="keywordflow">switch</span> (update_flag) {
00428     <span class="keywordflow">case</span> UPDATE_MONTH:
00429         <span class="keywordflow">break</span>;
00430 
00431     <span class="keywordflow">case</span> UPDATE_TRIMESTER:
00432         calc_student_count();
00433         <span class="keywordflow">break</span>;
00434 
00435     <span class="keywordflow">case</span> UPDATE_YEAR:
00436         update_income();
00437         sys.yield();
00438         enroll_main();                              <span class="comment">// ***** // which will call update_enroll_history()</span>
00439         <span class="keywordflow">break</span>;
00440 
00441     <span class="keywordflow">case</span> UPDATE_ALL:
00442         update_history(UPDATE_MONTH);
00443         update_history(UPDATE_TRIMESTER);
00444         update_history(UPDATE_YEAR);
00445         <span class="keywordflow">break</span>;
00446     <span class="keywordflow">default</span>:
00447         <a class="code" href="ALL_8H.html#a1">err_here</a>();
00448         <span class="keywordflow">break</span>;
00449     }
00450 }
00451 
00452 <span class="comment">//---------- End of function Student::update_history -----------//</span>
00453 
00454 <span class="comment">//------------- Begin of function EnrollRes::calc_student_count --------//</span>
<a name="l00455"></a><a class="code" href="classEnrollRes.html#a9">00455</a> <span class="keywordtype">void</span> <a class="code" href="classEnrollRes.html#a9">EnrollRes::calc_student_count</a>(<span class="keywordtype">int</span> initFlag) {
00456     <a class="code" href="classEnrollRes.html#m4">total_student_count</a> = 0;
00457     memset(<a class="code" href="classEnrollRes.html#m5">student_count</a>,0,<span class="keyword">sizeof</span>(<a class="code" href="classEnrollRes.html#m5">student_count</a>));
00458     memset(<a class="code" href="classEnrollRes.html#m6">student_female_percent</a>,0,<span class="keyword">sizeof</span>(<a class="code" href="classEnrollRes.html#m6">student_female_percent</a>));
00459     memset(<a class="code" href="classEnrollRes.html#m7">student_minority_percent</a>,0,<span class="keyword">sizeof</span>(<a class="code" href="classEnrollRes.html#m7">student_minority_percent</a>));
00460 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00461 <span class="preprocessor"></span>    memset(student_minority_female_percent, 0, <span class="keyword">sizeof</span>(student_minority_female_percent));
00462     memset(overall_gender_ethnic_group_student_count, 0, <span class="keyword">sizeof</span>(overall_gender_ethnic_group_student_count));
00463 <span class="preprocessor">#endif</span>
00464 <span class="preprocessor"></span>
00465     <span class="keywordtype">int</span> i,j;
00466     <a class="code" href="classStudentArray.html">StudentArray</a>* stuArr;
00467     <a class="code" href="classStudent.html">Student</a> *stuPtr;
00468     <span class="keywordtype">char</span> gender, sl;
00469 
00470     <a class="code" href="ALL_8H.html#a0">err_when</a>( department_array.size() == 0 );
00471     <span class="keywordflow">for</span> ( i=department_array.size(); i&gt;=0; i-- ) {
00472 
00473         <span class="keywordflow">if</span> (i) {
00474             <span class="keywordflow">if</span> ( department_array.is_deleted(i) )
00475                 <span class="keywordflow">continue</span>;
00476 
00477             stuArr = &amp;(department_array[i]-&gt;student_array);
00478         }
00479         <span class="keywordflow">else</span>
00480             stuArr = &amp;(department_res.general_dept.student_array);
00481 
00482         <span class="comment">// loop student</span>
00483         <span class="keywordflow">for</span> (j=stuArr-&gt;<a class="code" href="classDynArray.html#a28">size</a>(); j&gt;0; j--) {
00484             <span class="keywordflow">if</span> ( stuArr-&gt;<a class="code" href="classStudentArray.html#a9">is_deleted</a>(j) )
00485                 <span class="keywordflow">continue</span>;
00486 
00487             sys.yield();
00488 
00489             stuPtr = stuArr-&gt;operator[](j);
00490 
00491             gender = stuPtr-&gt;<a class="code" href="classStudent.html#m3">gender_ethnic_group</a>;
00492             sl = stuPtr-&gt;<a class="code" href="classStudent.html#m2">student_level</a>;
00493 
00494             <a class="code" href="ALL_8H.html#a0">err_when</a>(<a class="code" href="Ostudent_8h.html#a32a3">UG_TRADITION</a>!=0 || sl &lt; UG_TRADITION || sl &gt; <a class="code" href="Ostudent_8h.html#a32a7">DISTANCE_LEARN</a>);
00495 
00496             <a class="code" href="classEnrollRes.html#m5">student_count</a>[sl]++;
00497 
00498             <span class="keywordflow">switch</span> ( gender ) {
00499             <span class="keywordflow">case</span> <a class="code" href="Gamedef_8h.html#a75a27">NONMINORITY_MALE</a>:
00500                 <span class="keywordflow">break</span>;
00501             <span class="keywordflow">case</span> <a class="code" href="Gamedef_8h.html#a75a28">NONMINORITY_FEMALE</a>:
00502                 <a class="code" href="classEnrollRes.html#m6">student_female_percent</a>[sl] ++;
00503                 <span class="keywordflow">break</span>;
00504             <span class="keywordflow">case</span> <a class="code" href="Gamedef_8h.html#a75a29">MINORITY_MALE</a>:
00505                 <a class="code" href="classEnrollRes.html#m7">student_minority_percent</a>[sl] ++;
00506                 <span class="keywordflow">break</span>;
00507             <span class="keywordflow">case</span> <a class="code" href="Gamedef_8h.html#a75a30">MINORITY_FEMALE</a>:
00508                 <a class="code" href="classEnrollRes.html#m6">student_female_percent</a>[sl] ++;
00509                 <a class="code" href="classEnrollRes.html#m7">student_minority_percent</a>[sl] ++;
00510 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00511 <span class="preprocessor"></span>                student_minority_female_percent[sl]++;
00512 <span class="preprocessor">#endif</span>
00513 <span class="preprocessor"></span>                <span class="keywordflow">break</span>;
00514             <span class="keywordflow">default</span>:
00515                 <a class="code" href="ALL_8H.html#a1">err_here</a>();
00516                 <span class="keywordflow">break</span>;
00517             }
00518 
00519 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00520 <span class="preprocessor"></span>            overall_gender_ethnic_group_student_count[gender]++;
00521 <span class="preprocessor">#endif</span>
00522 <span class="preprocessor"></span>        }                                             <span class="comment">// end for j</span>
00523     }
00524 
00525     <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="Ostudent_8h.html#a0">MAX_STUDENT_LEVEL</a>; i++)
00526         <a class="code" href="classEnrollRes.html#m4">total_student_count</a> += <a class="code" href="classEnrollRes.html#m5">student_count</a>[i];
00527 
00528     <a class="code" href="ALL_8H.html#a0">err_when</a>(<a class="code" href="classEnrollRes.html#m4">total_student_count</a> == 0);
00529 
00530     <span class="comment">//--------//</span>
00531     <a class="code" href="classEnrollRes.html#m41">overall_percent_female</a> = 0;
00532     <a class="code" href="classEnrollRes.html#m40">overall_percent_minority</a> = 0;
00533 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00534 <span class="preprocessor"></span>    overall_percent_minority_female = 0;
00535 <span class="preprocessor">#endif</span>
00536 <span class="preprocessor"></span>
00537     <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="Ostudent_8h.html#a0">MAX_STUDENT_LEVEL</a>; i++) {
00538         <a class="code" href="classEnrollRes.html#m41">overall_percent_female</a> += int(<a class="code" href="classEnrollRes.html#m6">student_female_percent</a>[i]);
00539         <a class="code" href="classEnrollRes.html#m40">overall_percent_minority</a> += int(<a class="code" href="classEnrollRes.html#m7">student_minority_percent</a>[i]);
00540 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00541 <span class="preprocessor"></span>        overall_percent_minority_female += int(student_minority_female_percent[i]);
00542 <span class="preprocessor">#endif</span>
00543 <span class="preprocessor"></span>    }
00544 
00545     <a class="code" href="classEnrollRes.html#m41">overall_percent_female</a> = int(<a class="code" href="classEnrollRes.html#m41">overall_percent_female</a> * 100.0f / <a class="code" href="classEnrollRes.html#m4">total_student_count</a>);
00546     <a class="code" href="classEnrollRes.html#m40">overall_percent_minority</a> = int(<a class="code" href="classEnrollRes.html#m40">overall_percent_minority</a> * 100.0f / <a class="code" href="classEnrollRes.html#m4">total_student_count</a>);
00547 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00548 <span class="preprocessor"></span>    overall_percent_minority_female = int(overall_percent_minority_female * 100.0f / <a class="code" href="classEnrollRes.html#m4">total_student_count</a>);
00549 <span class="preprocessor">#endif</span>
00550 <span class="preprocessor"></span>
00551     <span class="comment">//--------//</span>
00552 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00553 <span class="preprocessor"></span>    <span class="comment">// Since version 2.0 no Distance Learning</span>
00554     <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="Ostudent_8h.html#a0">MAX_STUDENT_LEVEL</a>-1; i++)
00555 <span class="preprocessor">#else</span>
00556 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="Ostudent_8h.html#a0">MAX_STUDENT_LEVEL</a>; i++)
00557 <span class="preprocessor">#endif</span>
00558 <span class="preprocessor"></span>        {
00559 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00560 <span class="preprocessor"></span>            <a class="code" href="classEnrollRes.html#m6">student_female_percent</a>[i] = math.safe_divide( 100.0f * <a class="code" href="classEnrollRes.html#m6">student_female_percent</a>[i], (<span class="keywordtype">float</span>)<a class="code" href="classEnrollRes.html#m5">student_count</a>[i] );
00561             <a class="code" href="classEnrollRes.html#m7">student_minority_percent</a>[i] = math.safe_divide( 100.0f * <a class="code" href="classEnrollRes.html#m7">student_minority_percent</a>[i], (<span class="keywordtype">float</span>)<a class="code" href="classEnrollRes.html#m5">student_count</a>[i] );
00562             student_minority_female_percent[i] = math.safe_divide( 100.0f * student_minority_female_percent[i], (<span class="keywordtype">float</span>)<a class="code" href="classEnrollRes.html#m5">student_count</a>[i] );
00563 <span class="preprocessor">#else</span>
00564 <span class="preprocessor"></span>            <a class="code" href="classEnrollRes.html#m6">student_female_percent</a>[i] *= 100.0f / <a class="code" href="classEnrollRes.html#m5">student_count</a>[i];
00565             <a class="code" href="classEnrollRes.html#m7">student_minority_percent</a>[i] *= 100.0f / <a class="code" href="classEnrollRes.html#m5">student_count</a>[i];
00566 <span class="preprocessor">#endif</span>
00567 <span class="preprocessor"></span>        }
00568 }
00569 
00570 <span class="comment">//------------- End of function EnrollRes::calc_student_count --------//</span>
00571 
00572 <span class="comment">//------------- Begin of function EnrollRes::calc_total_aid --------//</span>
00574 <span class="comment">void EnrollRes:: calc_total_aid() {</span>
00575     <span class="comment">//-------------- fin aid for old student------------------------//</span>
00576 
00577     <span class="keywordtype">int</span> i,j, totalAidNewStu=0;
00578     <a class="code" href="classStudentArray.html">StudentArray</a>* stuArr;
00579     <a class="code" href="classStudent.html">Student</a> *stuPtr;
00580 
00581     <a class="code" href="ALL_8H.html#a0">err_when</a>( department_array.size() == 0 );
00582     <span class="keywordflow">for</span> ( i=department_array.size(); i&gt;=0; i-- ) {
00583         <span class="keywordflow">if</span> (i) {
00584             <span class="keywordflow">if</span> ( department_array.is_deleted(i) )
00585                 <span class="keywordflow">continue</span>;
00586 
00587             stuArr = &amp;(department_array[i]-&gt;student_array);
00588         }
00589         <span class="keywordflow">else</span>
00590             stuArr = &amp;(department_res.general_dept.student_array);
00591 
00592         <span class="comment">// loop student</span>
00593         <span class="keywordflow">for</span> (j=stuArr-&gt;<a class="code" href="classDynArray.html#a28">size</a>(); j&gt;0; j--) {
00594             <span class="keywordflow">if</span> ( stuArr-&gt;<a class="code" href="classStudentArray.html#a9">is_deleted</a>(j) )
00595                 <span class="keywordflow">continue</span>;
00596 
00597             stuPtr = stuArr-&gt;operator[](j);
00598 
00599             stuPtr-&gt;<a class="code" href="classStudent.html#m8">financial_aid</a> = int(1000*calc_an_aid(stuPtr));
00600 
00601             <span class="keywordflow">if</span> ( stuPtr-&gt;<a class="code" href="classStudent.html#m6">year_in_program</a> == 1 )
00602                 totalAidNewStu += stuPtr-&gt;<a class="code" href="classStudent.html#m8">financial_aid</a> / 1000;
00603         }
00604     }
00605 
00606     <a class="code" href="ALL_8H.html#a0">err_when</a>( total_aid == totalAidNewStu );        <span class="comment">// adjustRatio == 0</span>
00607 
00608     <span class="comment">//--------------------------------------//</span>
00609 
00610     <span class="comment">// recalc the aids of all *old* student sims =&gt; recalc total_aid</span>
00611     <span class="comment">// refer to last paragraphs in td3.4 section 2.7</span>
00612 
00613     <span class="comment">// have to adjust for returning but not newly-entered sims</span>
00614     <span class="comment">// adjust aid for all sims; refer to td3.4 section 4</span>
00615 
00616     <span class="keywordtype">float</span> budget = (float) school_res.player_peer_school-&gt;financial_aid;
00617 
00618     <span class="keywordflow">if</span> ( !aid_budget_enforced || budget &gt; total_aid )
00619         <span class="keywordflow">return</span>;
00620 
00621     <span class="keywordtype">float</span> adjustRatio = float( budget - totalAidNewStu ) / (total_aid - totalAidNewStu);
00622 
00623     total_aid = budget;
00624 
00625     <span class="keywordflow">if</span> ( adjustRatio &lt; 0 )
00626         adjustRatio = 0;                              <span class="comment">// aid = 0 for all returning sims //askbill if budget - totalAidNewStu &lt; 0</span>
00627 
00628     <a class="code" href="ALL_8H.html#a0">err_when</a>( adjustRatio &gt; 1 );
00629 
00630     <span class="comment">//--------------------------------------//</span>
00631 
00632     memset(fraction_on_aid,0,<span class="keyword">sizeof</span>(fraction_on_aid));
00633     memset(average_aid,0,<span class="keyword">sizeof</span>(average_aid));
00634     <span class="keywordtype">int</span> studentGotAid = 0;
00635 
00636     <span class="keywordflow">for</span> ( i=department_array.size(); i&gt;=0; i-- ) {
00637         <span class="keywordflow">if</span> (i) {
00638             <span class="keywordflow">if</span> ( department_array.is_deleted(i) )
00639                 <span class="keywordflow">continue</span>;
00640 
00641             stuArr = &amp;(department_array[i]-&gt;student_array);
00642         }
00643         <span class="keywordflow">else</span>
00644             stuArr = &amp;(department_res.general_dept.student_array);
00645 
00646         <span class="comment">// loop student</span>
00647         <span class="keywordflow">for</span> (j=stuArr-&gt;<a class="code" href="classDynArray.html#a28">size</a>(); j&gt;0; j--) {
00648             <span class="keywordflow">if</span> ( stuArr-&gt;<a class="code" href="classStudentArray.html#a9">is_deleted</a>(j) )
00649                 <span class="keywordflow">continue</span>;
00650 
00651             stuPtr = stuArr-&gt;operator[](j);
00652 
00653             <span class="comment">// job 1 financial_aid</span>
00654 
00655             <span class="keywordflow">if</span> ( stuPtr-&gt;<a class="code" href="classStudent.html#m6">year_in_program</a> != 1 )
00656                 <span class="comment">//TO add some penalty for morale also!?</span>
00657                 stuPtr-&gt;<a class="code" href="classStudent.html#m8">financial_aid</a> = int(stuPtr-&gt;<a class="code" href="classStudent.html#m8">financial_aid</a>*adjustRatio);
00658 
00659             <span class="comment">// job 2 financial_aid_statistics</span>
00660 
00661             <span class="keywordflow">if</span> ( stuPtr-&gt;<a class="code" href="classStudent.html#m8">financial_aid</a> &gt; 0 ) {
00662                 <span class="keywordtype">char</span> minor;
00663 
00664                 minor = ( is_minority_group(stuPtr-&gt;<a class="code" href="classStudent.html#m3">gender_ethnic_group</a>) ) ? <a class="code" href="Oenroll_8h.html#a32a14">MINORITY</a> : <a class="code" href="Oenroll_8h.html#a32a13">NON_MINORITY</a>;
00665 
00666                 fraction_on_aid[minor]++;
00667                 average_aid[minor]++;
00668                 studentGotAid++;
00669             }
00670         }
00671     }
00672 
00673     <span class="comment">//--------------------------------------//</span>
00674 
00675     <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="Oenroll_8h.html#a32a12">MINORITY_GROUP_COUNT</a>; i++) {
00676         fraction_on_aid[i] /= total_student_count;
00677         <span class="keywordflow">if</span> ( studentGotAid)
00678             average_aid[i] /= studentGotAid;
00679     }
00680 }
00681 
00682 <span class="comment">//------------- End of function EnrollRes::calc_total_aid --------//</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:37:26 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
