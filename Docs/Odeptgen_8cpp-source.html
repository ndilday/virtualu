<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Odeptgen.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Odeptgen.cpp</h1><a href="Odeptgen_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : ODEPT.H</span>
00002 <span class="comment">//Description : Department Class Definition</span>
00003 <span class="comment">//Owner       : Fred</span>
00004 
00005 <span class="preprocessor">#include &lt;<a class="code" href="ALL_8H.html">ALL.H</a>&gt;</span>
00006 <span class="preprocessor">#include &lt;ODEPT.H&gt;</span>
00007 <span class="preprocessor">#include &lt;<a class="code" href="ODEPTRES_8H.html">ODEPTRES.H</a>&gt;</span>
00008 <span class="preprocessor">#include &lt;ODEPTGEN.H&gt;</span>
00009 
00010 <span class="comment">//----------- Begin of function GeneralDepartment Constructor -----//</span>
<a name="l00012"></a><a class="code" href="classGeneralDepartment.html#a0">00012</a> <span class="comment">GeneralDepartment::GeneralDepartment() {</span>
00013     init();
00014 }
00015 
00016 <span class="comment">//------------- End of function GeneralDepartment Constructor -----//</span>
00017 
00018 <span class="comment">//----------- Begin of function GeneralDepartment init -----//</span>
<a name="l00020"></a><a class="code" href="classGeneralDepartment.html#a1">00020</a> <span class="comment">void GeneralDepartment::init() {</span>
00021     <span class="comment">//don't do this!!!: memset(this, 0, sizeof(GeneralDepartment));</span>
00022     <a class="code" href="ALL_8H.html#a0">err_when</a>(student_array.student_count != 0);
00023     <span class="comment">// fix in version 2</span>
00024     student_array.zap();                            <span class="comment">// clear empty_room_array in last game</span>
00025 
00026     <span class="comment">//</span>
00027     department_id = 0;
00028 
00029     <span class="comment">//</span>
00030     memset(project_array, 0, <span class="keyword">sizeof</span>(project_array));
00031     project_count = 0;
00032     project_added_this_year = <span class="keyword">false</span>;
00033 
00034 }
00035 
00036 <span class="comment">//------------- End of function GeneralDepartment init -----//</span>
00037 
00038 <span class="comment">//----------- Begin of function GeneralDepartment next_day -----//</span>
<a name="l00040"></a><a class="code" href="classGeneralDepartment.html#a4">00040</a> <span class="comment">void GeneralDepartment::next_day() {</span>
00041     student_array.next_day();
00042 }
00043 
00044 <span class="comment">//------------- End of function GeneralDepartment next_day -----//</span>
00045 
00046 <span class="comment">//----------- Begin of function GeneralDepartment next_month_construction -----//</span>
<a name="l00051"></a><a class="code" href="classGeneralDepartment.html#a7">00051</a> <span class="comment">void GeneralDepartment::next_month_construction(int &amp;newSF, int &amp;expense) {</span>
00052     newSF = 0;
00053     expense = 0;
00054 
00055     <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=project_count-1 ; i&gt;=0 ; i-- ) {
00056         <span class="keywordflow">if</span>( --(project_array[i].month_left) &lt;= 0 ) {
00057             newSF += project_array[i].new_sf;
00058             expense += project_array[i].expense;
00059 
00060             m.del_array_rec(project_array, project_count, <span class="keyword">sizeof</span>(project_array[0]), i+1 );
00061             project_count--;
00062         }
00063     }
00064 }
00065 
00066 <span class="comment">//------------- End of function GeneralDepartment next_month_construction -----//</span>
00067 
00068 <span class="comment">//----------- Begin of function GeneralDepartment:add_construction -----//</span>
<a name="l00077"></a><a class="code" href="classGeneralDepartment.html#a8">00077</a> <span class="comment">void GeneralDepartment::add_construction(int newSF, int expense) {</span>
00078     <a class="code" href="ALL_8H.html#a0">err_when</a>( newSF &lt;= 0 || expense &lt;=0 );
00079 
00080     project_array[project_count].new_sf  = newSF;
00081     project_array[project_count].expense = expense;
00082 
00083 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00084 <span class="preprocessor"></span>    project_array[project_count].month_left = 12;
00085 <span class="preprocessor">#else</span>
00086 <span class="preprocessor"></span>    <span class="keywordflow">if</span> ( !project_added_this_year )
00087         project_array[project_count].month_left = department_res[department_id]-&gt;months_to_construct;
00088     <span class="keywordflow">else</span>
00089         project_array[project_count].month_left = 0;
00090 <span class="preprocessor">#endif</span>
00091 <span class="preprocessor"></span>
00092     project_count++;
00093     <a class="code" href="ALL_8H.html#a0">err_when</a>(project_count &gt; <a class="code" href="Odeptgen_8h.html#a1a0">MAX_PROJECT_COUNT</a>);
00094 
00095     project_added_this_year = <span class="keyword">true</span>;
00096 }
00097 
00098 <span class="comment">//------------- End of function GeneralDepartment:add_construction -----//</span>
00099 
00100 <span class="comment">//----------- Begin of function GeneralDepartment:next_month_construction -----//</span>
<a name="l00104"></a><a class="code" href="classGeneralDepartment.html#a9">00104</a> <span class="comment">void GeneralDepartment::confirm_construction_yearly() {</span>
00105     <span class="comment">//TO sort project_array by month_left (incrementaly)</span>
00106     <span class="comment">// IF genDeptInfo-&gt;months_to_construct will change</span>
00107 
00108     <span class="comment">// project_added_this_year = false;</span>
00109 }
00110 
00111 <span class="comment">//------------- End of function GeneralDepartment:next_month_construction -----//</span>
00112 
00113 <span class="comment">//----------- Begin of function GeneralDepartment:next_month_construction -----//</span>
<a name="l00115"></a><a class="code" href="classGeneralDepartment.html#a10">00115</a> <span class="comment">int GeneralDepartment::get_constructing_sf() {</span>
00116     <span class="keywordtype">int</span> total = 0;
00117 
00118     <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;project_count; i++) {
00119         total += project_array[i].new_sf;
00120     }
00121 
00122     <span class="keywordflow">return</span> total;
00123 }
00124 
00125 <span class="comment">//------------- End of function GeneralDepartment:next_month_construction -----//</span>
00126 
00127 <span class="comment">//----- Begin of function GeneralDepartment::get_course_requirement ----//</span>
<a name="l00136"></a><a class="code" href="classGeneralDepartment.html#a5">00136</a> <span class="comment">int GeneralDepartment::get_course_requirement(int studentLevel, int targetDeptRecno, int courseDepth) {</span>
00137     <a class="code" href="structDepartmentInfo.html">DepartmentInfo</a>* thisDeptInfo = department_res[department_id];
00138 
00139     <span class="keywordtype">int</span> targetDeptId  = department_array[targetDeptRecno]-&gt;department_id;
00140 
00141     <span class="comment">//## chea 291199 added to fix 2.1.1</span>
00142     <span class="keywordtype">int</span> targetFieldId=0;
00143 
00144     <span class="keywordflow">if</span>( targetDeptId &gt; 0 )
00145         targetFieldId = department_res[targetDeptId]-&gt;<a class="code" href="structDepartmentInfo.html#m1">field_id</a>;
00146 
00147     <span class="keywordflow">if</span>( targetDeptId == department_id )             <span class="comment">// if the target department is this departemnt, set targetFieldId to 0, as 0 means own department</span>
00148         targetFieldId = 0;
00149 
00150     <span class="comment">//-- if targetDeptId is 0, the first element in the depth array will be used. for instance, bachelor_depth1[0] will be used if the department is a general education department</span>
00151 
00152     <span class="keywordflow">switch</span>( studentLevel ) {
00153     <span class="keywordflow">case</span> <a class="code" href="Ostudent_8h.html#a32a3">UG_TRADITION</a>:
00154     <span class="keywordflow">case</span> <a class="code" href="Ostudent_8h.html#a32a4">UG_NONTRADITION</a>:
00155     <span class="keywordflow">case</span> <a class="code" href="Ostudent_8h.html#a32a7">DISTANCE_LEARN</a>: {
00156         <span class="keywordflow">switch</span>(courseDepth) {
00157         <span class="keywordflow">case</span> <a class="code" href="Ocourse_8h.html#a36a14">DEPTH_D1</a>:
00158             <span class="comment">// [0] is own department</span>
00159             <span class="keywordflow">return</span> thisDeptInfo-&gt;<a class="code" href="structGeneralDepartmentInfo.html#m0">bachelor_depth1</a>[targetFieldId];
00160 
00161         <span class="keywordflow">case</span> <a class="code" href="Ocourse_8h.html#a36a15">DEPTH_D2</a>:
00162             <span class="keywordflow">return</span> thisDeptInfo-&gt;<a class="code" href="structGeneralDepartmentInfo.html#m1">bachelor_depth2</a>[targetFieldId];
00163 
00164         <span class="keywordflow">case</span> <a class="code" href="Ocourse_8h.html#a36a16">DEPTH_D3</a>:
00165             <span class="keywordflow">return</span> thisDeptInfo-&gt;<a class="code" href="structGeneralDepartmentInfo.html#m2">bachelor_depth3</a>[targetFieldId];
00166         }
00167         <span class="keywordflow">break</span>;
00168     }
00169 
00170     <span class="keywordflow">case</span> <a class="code" href="Ostudent_8h.html#a32a5">MASTER</a>: {
00171         <span class="keywordflow">switch</span>(courseDepth) {
00172         <span class="keywordflow">case</span> <a class="code" href="Ocourse_8h.html#a36a16">DEPTH_D3</a>:
00173             <span class="keywordflow">return</span> thisDeptInfo-&gt;<a class="code" href="structDepartmentInfo.html#m34">master_depth3</a>[targetFieldId];
00174 
00175         <span class="keywordflow">case</span> <a class="code" href="Ocourse_8h.html#a36a17">DEPTH_GR</a>:
00176             <span class="keywordflow">return</span> thisDeptInfo-&gt;<a class="code" href="structDepartmentInfo.html#m35">master_graduate</a>[targetFieldId];
00177         }
00178         <span class="keywordflow">break</span>;
00179     }
00180 
00181     <span class="keywordflow">case</span> <a class="code" href="Ostudent_8h.html#a32a6">DOCTOR</a>:
00182         <span class="keywordflow">return</span> thisDeptInfo-&gt;<a class="code" href="structDepartmentInfo.html#m39">doctor_graduate</a>[targetFieldId];
00183         <span class="keywordflow">break</span>;
00184     }
00185 
00186     <a class="code" href="ALL_8H.html#a1">err_here</a>();
00187     <span class="keywordflow">return</span> 0;
00188 }
00189 
00190 <span class="comment">//------ End of function GeneralDepartment::get_course_requirement -----//</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:37:24 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
