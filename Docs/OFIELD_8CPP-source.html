<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>OFIELD.CPP Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>OFIELD.CPP</h1><a href="OFIELD_8CPP.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : OFIELD.CPP</span>
00002 <span class="comment">//Description : Field object</span>
00003 
00004 <span class="preprocessor">#include &lt;<a class="code" href="ALL_8H.html">ALL.H</a>&gt;</span>
00005 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00006 <span class="preprocessor">#include &lt;<a class="code" href="OGAMESET_8H.html">OGAMESET.H</a>&gt;</span>
00007 <span class="preprocessor">#include &lt;<a class="code" href="OFIELD_8H.html">OFIELD.H</a>&gt;</span>
00008 
00009 <span class="comment">//---------- #define constant ------------//</span>
00010 
<a name="l00011"></a><a class="code" href="OFIELD_8CPP.html#a0">00011</a> <span class="preprocessor">#define FIELD_DB   "FIELD"</span>
00012 <span class="preprocessor"></span>
00013 <span class="comment">//------- Begin of function FieldRes::FieldRes -----------//</span>
00014 
<a name="l00015"></a><a class="code" href="classFieldRes.html#a0">00015</a> <a class="code" href="classFieldRes.html#a0">FieldRes::FieldRes</a>() {
00016     <a class="code" href="classFieldRes.html#m0">init_flag</a>=0;
00017 }
00018 
00019 <span class="comment">//--------- End of function FieldRes::FieldRes -----------//</span>
00020 
00021 <span class="comment">//---------- Begin of function FieldRes::init -----------//</span>
<a name="l00025"></a><a class="code" href="classFieldRes.html#a1">00025</a> <span class="comment">void FieldRes::init() {</span>
00026     deinit();
00027 
00028     <span class="comment">//------- load database information --------//</span>
00029 
00030     load_info();
00031 
00032     init_flag=1;
00033 }
00034 
00035 <span class="comment">//---------- End of function FieldRes::init -----------//</span>
00036 
00037 <span class="comment">//---------- Begin of function FieldRes::deinit -----------//</span>
00038 
<a name="l00039"></a><a class="code" href="classFieldRes.html#a2">00039</a> <span class="keywordtype">void</span> <a class="code" href="classFieldRes.html#a2">FieldRes::deinit</a>() {
00040     <span class="keywordflow">if</span>( init_flag ) {
00041         <a class="code" href="ALL_8H.html#a8">mem_del</a>(<a class="code" href="classFieldRes.html#m2">info_array</a>);
00042         <a class="code" href="classFieldRes.html#m2">info_array</a> = 0;
00043         <a class="code" href="classFieldRes.html#m0">init_flag</a>=0;
00044     }
00045 }
00046 
00047 <span class="comment">//---------- End of function FieldRes::deinit -----------//</span>
00048 
00049 <span class="comment">//------- Begin of function FieldRes::load_info -------//</span>
00053 <span class="comment">void FieldRes::load_info() {</span>
00054     <a class="code" href="structFieldRec.html">FieldRec</a>  *fieldRec;
00055     <a class="code" href="structFieldInfo.html">FieldInfo</a> *fieldInfo;
00056     <a class="code" href="classDatabase.html">Database</a>  *dbField = game_set.open_db(<a class="code" href="OFIELD_8CPP.html#a0">FIELD_DB</a>);
00057 
00058     field_count = (short) dbField-&gt;<a class="code" href="classDatabase.html#a7">rec_count</a>();
00059     info_array  = (<a class="code" href="structFieldInfo.html">FieldInfo</a>*) <a class="code" href="ALL_8H.html#a5">mem_add</a>( <span class="keyword">sizeof</span>(<a class="code" href="structFieldInfo.html">FieldInfo</a>)*field_count );
00060 
00061     <span class="comment">//------ read in field information array -------//</span>
00062 
00063     memset( info_array, 0, <span class="keyword">sizeof</span>(<a class="code" href="structFieldInfo.html">FieldInfo</a>) * field_count );
00064 
00065     <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0 ; i&lt;field_count ; i++ ) {
00066         fieldRec  = (<a class="code" href="structFieldRec.html">FieldRec</a>*) dbField-&gt;<a class="code" href="classDatabase.html#a4">read</a>(i+1);
00067         fieldInfo = info_array+i;
00068 
00069         fieldInfo-&gt;<a class="code" href="structFieldInfo.html#m0">code</a> = fieldRec-&gt;<a class="code" href="structFieldRec.html#m0">code</a>;
00070 
00071         m.rtrim_fld( fieldInfo-&gt;<a class="code" href="structFieldInfo.html#m1">name</a>, fieldRec-&gt;<a class="code" href="structFieldRec.html#m1">name</a>, fieldRec-&gt;<a class="code" href="structFieldRec.html#s1s0">NAME_LEN</a> );
00072 
00073         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> j=0 ; j&lt;<a class="code" href="Ocourse_8h.html#a10">MAX_COURSE_DEPTH_WITHOUT_GR</a> ; j++ )
00074             fieldInfo-&gt;<a class="code" href="structFieldInfo.html#m2">elective_course_focus_pref</a>[j] = m.atoi( fieldRec-&gt;<a class="code" href="structFieldRec.html#m2">elective_course_focus_pref</a>[j], 2 );
00075     }
00076 }
00077 
00078 <span class="comment">//--------- End of function FieldRes::load_info ---------//</span>
00079 
00080 <span class="comment">//---------- Begin of function FieldRes::look_up_code -----------//</span>
<a name="l00084"></a><a class="code" href="classFieldRes.html#a3">00084</a> <span class="comment">int FieldRes::look_up_code(int fieldCode) {</span>
00085     <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0 ; i&lt;field_count ; i++ ) {
00086         <span class="keywordflow">if</span>( info_array[i].code == fieldCode )
00087             <span class="keywordflow">return</span> i+1;
00088     }
00089 
00090     <span class="keywordflow">return</span> 0;
00091 }
00092 
00093 <span class="comment">//---------- End of function FieldRes::look_up_code -----------//</span>
00094 
00095 <span class="preprocessor">#ifdef DEBUG</span>
00096 <span class="preprocessor"></span><span class="comment">//---------- Begin of function FieldRes::operator[] -----------//</span>
00098 <span class="comment">FieldInfo* FieldRes::operator[](int fieldId) {</span>
00099     <a class="code" href="ALL_8H.html#a0">err_when</a>( fieldId &lt; 1 || fieldId &gt; field_count );
00100 
00101     <span class="keywordflow">return</span> info_array + fieldId - 1;
00102 }
00103 
00104 <span class="comment">//---------- End of function FieldRes::operator[] -----------//</span>
00105 <span class="preprocessor">#endif</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:37:33 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
