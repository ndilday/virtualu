<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>oopt3.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>oopt3.cpp</h1><a href="oopt3_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : OOPT3.CPP</span>
00002 <span class="comment">//Description : OptStage3 class</span>
00003 
00004 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00005 <span class="preprocessor">#include &lt;<a class="code" href="OGAMESET_8H.html">OGAMESET.H</a>&gt;</span>
00006 <span class="preprocessor">#include &lt;OWORLDMT.H&gt;</span>
00007 <span class="preprocessor">#include &lt;<a class="code" href="OOPT3_8H.html">OOPT3.H</a>&gt;</span>
00008 <span class="preprocessor">#include &lt;<a class="code" href="OVGA_8H.html">OVGA.H</a>&gt;</span>
00009 <span class="preprocessor">#include &lt;<a class="code" href="COLOR_8H.html">COLOR.H</a>&gt;</span>
00010 <span class="preprocessor">#include &lt;OFINANCE.H&gt;</span>
00011 <span class="preprocessor">#include &lt;OFONT.H&gt;</span>
00012 <span class="preprocessor">#include &lt;ODEPT.H&gt;</span>
00013 <span class="preprocessor">#include &lt;<a class="code" href="ODEPTRES_8H.html">ODEPTRES.H</a>&gt;</span>
00014 <span class="preprocessor">#include &lt;OGAMESTR.H&gt;</span>
00015 <span class="preprocessor">#include &lt;OMOUSE.H&gt;</span>
00016 <span class="preprocessor">#include &lt;<a class="code" href="OTEXT_8H.html">OTEXT.H</a>&gt;</span>
00017 <span class="preprocessor">#include &lt;OIFACE.H&gt;</span>
00018 <span class="preprocessor">#include &lt;<a class="code" href="OHELPIF_8H.html">OHELPIF.H</a>&gt;</span>
00019 <span class="preprocessor">#include &lt;<a class="code" href="OBNDSLDR_8H.html">OBNDSLDR.H</a>&gt;</span>
00020 <span class="preprocessor">#include &lt;<a class="code" href="OVALSLDR_8H.html">OVALSLDR.H</a>&gt;</span>
00021 <span class="preprocessor">#include &lt;<a class="code" href="OHELP_8H.html">OHELP.H</a>&gt;</span>
00022 <span class="preprocessor">#include &lt;OOPT.H&gt;</span>
00023 <span class="preprocessor">#include &lt;OAUDIO.H&gt;</span>
00024 <span class="preprocessor">#include &lt;OCONFIG.H&gt;</span>
00025 <span class="preprocessor">#include &lt;OPSCHOOL.H&gt;</span>
00026 <span class="comment">//------- Define constants -------//</span>
00027 
00028 <span class="keyword">enum</span> {
00029     <a class="code" href="oopt3_8cpp.html#a69a25">REPORT_X1</a> = <a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a> + 15,
00030     <a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a> = <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a> + 25,
00031     <a class="code" href="oopt3_8cpp.html#a69a27">REPORT_X2</a> = <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a> - 15,
00032     <a class="code" href="oopt3_8cpp.html#a69a28">REPORT_Y2</a> = <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a> - 105
00033 };
00034 
00035 <span class="keyword">enum</span> {  <a class="code" href="oopt3_8cpp.html#a70a29">SEPARATOR_1</a> = <a class="code" href="oopt3_8cpp.html#a69a25">REPORT_X1</a> + 200 };
00036 <span class="keyword">enum</span> {  <a class="code" href="oopt3_8cpp.html#a71a30">SEPARATOR_2</a> = <a class="code" href="oopt3_8cpp.html#a69a25">REPORT_X1</a> + 330 };
00037 <span class="keyword">enum</span> {  <a class="code" href="oopt3_8cpp.html#a72a31">SEPARATOR_3</a> = <a class="code" href="oopt3_8cpp.html#a69a25">REPORT_X1</a> + 420 };
00038 <span class="keyword">enum</span> {  <a class="code" href="oopt3_8cpp.html#a73a32">SEPARATOR_4</a> = <a class="code" href="oopt3_8cpp.html#a69a25">REPORT_X1</a> + 650 };
00039 <span class="keyword">enum</span> {  <a class="code" href="oopt3_8cpp.html#a74a33">SEPARATOR_5</a> = <a class="code" href="oopt3_8cpp.html#a69a25">REPORT_X1</a> + 650 };
00040 <span class="keyword">enum</span> {  <a class="code" href="oopt3_8cpp.html#a75a34">SEPARATOR_6</a> = <a class="code" href="oopt3_8cpp.html#a69a25">REPORT_X1</a> + 715 };
00041 <span class="keyword">enum</span> {  <a class="code" href="oopt3_8cpp.html#a76a35">SEPARATOR_7</a> = <a class="code" href="oopt3_8cpp.html#a69a25">REPORT_X1</a> + 750 };
00042 
00043 <span class="keyword">enum</span> {
00044     <a class="code" href="oopt3_8cpp.html#a77a36">LINE_SPACING</a> = 21,
00045     <a class="code" href="oopt3_8cpp.html#a77a37">HEADING_HEIGHT</a> = 21,
00046     <a class="code" href="oopt3_8cpp.html#a77a38">FIRST_LINE_OFFSET</a> = <a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a> + <a class="code" href="oopt3_8cpp.html#a77a37">HEADING_HEIGHT</a> + 14,
00047     <a class="code" href="oopt3_8cpp.html#a77a39">DESCRIPTION_OFFSET</a> = <a class="code" href="oopt3_8cpp.html#a69a25">REPORT_X1</a> + 10,
00048     <a class="code" href="oopt3_8cpp.html#a77a40">EXISTING_FACULTY_OFFSET</a> = (<a class="code" href="oopt3_8cpp.html#a70a29">SEPARATOR_1</a> + <a class="code" href="oopt3_8cpp.html#a71a30">SEPARATOR_2</a>)/2 -10,
00049     <a class="code" href="oopt3_8cpp.html#a77a41">SALARY_OFFSET</a> = (<a class="code" href="oopt3_8cpp.html#a71a30">SEPARATOR_2</a> + <a class="code" href="oopt3_8cpp.html#a72a31">SEPARATOR_3</a>)/2 -10,
00050     <a class="code" href="oopt3_8cpp.html#a77a42">SLIDER_OFFSET</a> = 1,
00051     <a class="code" href="oopt3_8cpp.html#a77a43">TARGET_OFFSET</a> = <a class="code" href="oopt3_8cpp.html#a72a31">SEPARATOR_3</a> + 20,
00052     <a class="code" href="oopt3_8cpp.html#a77a44">TARGET_WIDTH</a> = <a class="code" href="oopt3_8cpp.html#a73a32">SEPARATOR_4</a> - <a class="code" href="oopt3_8cpp.html#a72a31">SEPARATOR_3</a> - 35,
00053     <a class="code" href="oopt3_8cpp.html#a77a45">TARGET_HEIGHT</a> = 6,
00054     <a class="code" href="oopt3_8cpp.html#a77a46">FACULTY_OFFSET_X</a> = <a class="code" href="oopt3_8cpp.html#a71a30">SEPARATOR_2</a> + 20,
00055     <a class="code" href="oopt3_8cpp.html#a77a47">FACULTY_OFFSET_Y</a> = -1,
00056     <a class="code" href="oopt3_8cpp.html#a77a48">FACULTY_WIDTH</a> = 14,
00057     <a class="code" href="oopt3_8cpp.html#a77a49">FACULTY_HEIGHT</a> = 14,
00058     <a class="code" href="oopt3_8cpp.html#a77a50">PREF_BUTTON_WIDTH</a> = 16,
00059     <a class="code" href="oopt3_8cpp.html#a77a51">PREF_BUTTON_HEIGHT</a> = 16,
00060     <a class="code" href="oopt3_8cpp.html#a77a52">PREF_BUTTON_DISTANCE</a> = 10,
00061     <a class="code" href="oopt3_8cpp.html#a77a53">PREF_BUTTON_OFFSET</a> = 0,
00062     <a class="code" href="oopt3_8cpp.html#a77a54">PREF_BUTTON_OFFSET1</a> = <a class="code" href="oopt3_8cpp.html#a73a32">SEPARATOR_4</a>+17,
00063     <a class="code" href="oopt3_8cpp.html#a77a55">PREF_BUTTON_OFFSET2</a> = <a class="code" href="oopt3_8cpp.html#a77a54">PREF_BUTTON_OFFSET1</a> + <a class="code" href="oopt3_8cpp.html#a77a50">PREF_BUTTON_WIDTH</a> + <a class="code" href="oopt3_8cpp.html#a77a52">PREF_BUTTON_DISTANCE</a>,
00064     <a class="code" href="oopt3_8cpp.html#a77a56">PREF_BUTTON_OFFSET3</a> = <a class="code" href="oopt3_8cpp.html#a77a55">PREF_BUTTON_OFFSET2</a> + <a class="code" href="oopt3_8cpp.html#a77a50">PREF_BUTTON_WIDTH</a> + <a class="code" href="oopt3_8cpp.html#a77a52">PREF_BUTTON_DISTANCE</a>,
00065     <a class="code" href="oopt3_8cpp.html#a77a57">REMAIN_MESSAGE_X</a> = (<a class="code" href="oopt3_8cpp.html#a69a27">REPORT_X2</a>-<a class="code" href="oopt3_8cpp.html#a69a25">REPORT_X1</a>-400)/2+<a class="code" href="oopt3_8cpp.html#a77a39">DESCRIPTION_OFFSET</a>,
00066     <a class="code" href="oopt3_8cpp.html#a77a58">REMAIN_MESSAGE_Y1</a> = <a class="code" href="oopt3_8cpp.html#a69a28">REPORT_Y2</a> + 5,
00067     <a class="code" href="oopt3_8cpp.html#a77a59">REMAIN_MESSAGE_Y2</a> = <a class="code" href="oopt3_8cpp.html#a69a28">REPORT_Y2</a> + 22,
00068     <a class="code" href="oopt3_8cpp.html#a77a60">REMAIN_MESSAGE_Y3</a> = <a class="code" href="oopt3_8cpp.html#a69a28">REPORT_Y2</a> + 39,
00069     <a class="code" href="oopt3_8cpp.html#a77a61">REMAIN_X</a> = <a class="code" href="oopt3_8cpp.html#a77a57">REMAIN_MESSAGE_X</a> + 350,
00070     <a class="code" href="oopt3_8cpp.html#a77a62">REMAIN_Y1</a> = <a class="code" href="oopt3_8cpp.html#a77a58">REMAIN_MESSAGE_Y1</a>,
00071     <a class="code" href="oopt3_8cpp.html#a77a63">REMAIN_Y2</a> = <a class="code" href="oopt3_8cpp.html#a77a59">REMAIN_MESSAGE_Y2</a>,
00072     <a class="code" href="oopt3_8cpp.html#a77a64">REMAIN_Y3</a> = <a class="code" href="oopt3_8cpp.html#a77a60">REMAIN_MESSAGE_Y3</a>,
00073     <a class="code" href="oopt3_8cpp.html#a77a65">REMAIN_CLEAR</a> = 20 ,
00074     <a class="code" href="oopt3_8cpp.html#a77a66">RESULT_OFFSET</a> = <a class="code" href="oopt3_8cpp.html#a74a33">SEPARATOR_5</a> + 28,
00075     <a class="code" href="oopt3_8cpp.html#a77a67">RESULT_LENGTH</a> = 50
00076 };
00077 
00078 <span class="keyword">enum</span> {  <a class="code" href="oopt3_8cpp.html#a78a68">BG_PIC_ID</a> = 3 };
00079 
00080 <span class="comment">//-------- define static vars -----------//</span>
00081 
00082 <span class="keyword">static</span> <span class="keywordtype">char</span> *title[] = {
00083     <span class="stringliteral">"Department"</span>,
00084     <span class="stringliteral">"Existing faculty"</span>,
00085     <span class="stringliteral">"Salary"</span>,
00086 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00087 <span class="preprocessor"></span>    <span class="stringliteral">"Target hires and upper limit"</span>,
00088 <span class="preprocessor">#else</span>
00089 <span class="preprocessor"></span>    <span class="stringliteral">"Target hires and upper bound"</span>,
00090 <span class="preprocessor">#endif</span>
00091 <span class="preprocessor"></span>    <span class="stringliteral">"Preference"</span>,
00092     <span class="stringliteral">"Result"</span>,
00093 };
00094 
00095 <span class="keyword">static</span> <span class="keywordtype">char</span> *pref_label[] = {
00096     <span class="stringliteral">"1"</span>, <span class="stringliteral">"2"</span>, <span class="stringliteral">"3"</span>
00097 };
00098 
00099 <span class="comment">//static char *remain_msg1 = "Total number of faculty you can still hire : ";</span>
00100 <span class="keyword">static</span> <span class="keywordtype">char</span> *remain_msg1 = <span class="stringliteral">"Number of budgeted new faculty positions : "</span>;
00101 <span class="keyword">static</span> <span class="keywordtype">char</span> *remain_msg2 = <span class="stringliteral">"Sum of departmental hiring targets : "</span>;
00102 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00103 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">char</span> *remain_msg3 = <span class="stringliteral">"Maximum faculty to be hired : "</span>;
00104 <span class="preprocessor">#else</span>
00105 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">char</span> *remain_msg3 = <span class="stringliteral">"Total faculty to be hired : "</span>;
00106 <span class="preprocessor">#endif</span>
00107 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">char</span> *optimize_label = <span class="stringliteral">"Optimize"</span>;
00108 
00109 <span class="comment">//***** Temporary *****//</span>
00110 <span class="keyword">static</span> <span class="keywordtype">char</span> *heading[] = {
00111     <span class="stringliteral">"Department 1"</span>,
00112     <span class="stringliteral">"Department 2"</span>,
00113     <span class="stringliteral">"Department 3"</span>,
00114     <span class="stringliteral">"Department 4"</span>,
00115     <span class="stringliteral">"Department 5"</span>,
00116     <span class="stringliteral">"Department 6"</span>,
00117     <span class="stringliteral">"Department 7"</span>,
00118     <span class="stringliteral">"Department 8"</span>,
00119     <span class="stringliteral">"Department 9"</span>,
00120     <span class="stringliteral">"Department 10"</span>,
00121     <span class="stringliteral">"Department 11"</span>,
00122     <span class="stringliteral">"Department 12"</span>,
00123 };
00124 <span class="comment">//*********************//</span>
00125 
00126 <span class="keyword">static</span> <a class="code" href="classText.html">Text</a> opt3_text1;
00127 <span class="keyword">static</span> <a class="code" href="classText.html">Text</a> opt3_text2;
00128 <span class="keyword">static</span> <a class="code" href="classText.html">Text</a> opt3_text3;
00129 <span class="keyword">static</span> <a class="code" href="classText.html">Text</a> opt3_data1[<a class="code" href="Gamedef_8h.html#a10">MAX_DEPARTMENT</a>];
00130 <span class="keyword">static</span> <a class="code" href="classText.html">Text</a> opt3_data2[<a class="code" href="Gamedef_8h.html#a10">MAX_DEPARTMENT</a>];
00131 <span class="comment">//static BoundedSlider opt3_slider_group[MAX_DEPARTMENT];</span>
00132 <span class="keyword">static</span> <a class="code" href="classValueSlider.html">ValueSlider</a> value_slider1;
00133 <span class="keyword">static</span> <span class="keywordtype">int</span> v1[<a class="code" href="Gamedef_8h.html#a10">MAX_DEPARTMENT</a>];
00134 <span class="keyword">static</span> <span class="keywordtype">float</span> v2[<a class="code" href="Gamedef_8h.html#a10">MAX_DEPARTMENT</a>];
00135 <span class="keyword">static</span> <span class="keywordtype">int</span> v3[<a class="code" href="Gamedef_8h.html#a10">MAX_DEPARTMENT</a>];
00136 <span class="keyword">static</span> <span class="keywordtype">int</span> v4[<a class="code" href="Gamedef_8h.html#a10">MAX_DEPARTMENT</a>];
00137 <span class="keyword">static</span> <span class="keywordtype">int</span> v5[<a class="code" href="Gamedef_8h.html#a10">MAX_DEPARTMENT</a>];
00138 <span class="keyword">static</span> <span class="keywordtype">double</span> targetValue[<a class="code" href="Gamedef_8h.html#a10">MAX_DEPARTMENT</a>];
00139 <span class="keyword">static</span> <span class="keywordtype">double</span> upperBound[<a class="code" href="Gamedef_8h.html#a10">MAX_DEPARTMENT</a>];
00140 <span class="keyword">static</span> <span class="keywordtype">double</span> lowerBound;
00141 
00142 <span class="keyword">static</span> <a class="code" href="classButton.html">Button</a> help_button;
00143 <span class="keyword">static</span> <span class="keywordtype">short</span> *help_button_up_bitmap;
00144 <span class="keyword">static</span> <span class="keywordtype">short</span> *help_button_down_bitmap;
00145 
00146 <span class="keyword">static</span> <a class="code" href="classText.html">Text</a> result_text_opt3[<a class="code" href="Gamedef_8h.html#a10">MAX_DEPARTMENT</a>];
00147 <span class="comment">//------- Begin of function OptStage3::OptStage3 -----------//</span>
<a name="l00149"></a><a class="code" href="classOptStage3.html#a0">00149</a> <span class="comment">OptStage3::OptStage3() {</span>
00150 }
00151 
00152 <span class="comment">//--------- End of function OptStage3::OptStage3 -----------//</span>
00153 
00154 <span class="comment">//------- Begin of function OptStage3::~OptStage3 -----------//</span>
<a name="l00156"></a><a class="code" href="classOptStage3.html#a1">00156</a> <span class="comment">OptStage3::~OptStage3() {</span>
00157 }
00158 
00159 <span class="comment">//--------- End of function OptStage3::~OptStage3 -----------//</span>
00160 
00161 <span class="comment">//------- Begin of function OptStage3::report ---------------//</span>
<a name="l00163"></a><a class="code" href="classOptStage3.html#a2">00163</a> <span class="comment">void OptStage3::report(int refreshFlag) {</span>
00164 }
00165 
00166 <span class="comment">//---------- End of function OptStage3::report ------------//</span>
00167 
00168 <span class="comment">//-------- Begin of function OptStage3::detect ------------//</span>
<a name="l00170"></a><a class="code" href="classOptStage3.html#a3">00170</a> <span class="comment">void OptStage3::detect() {</span>
00171 }
00172 
00173 <span class="comment">//---------- End of function OptStage3::detect ------------//</span>
00174 
00175 <span class="comment">//-------- Begin of function OptStage3::draw_count_bar ------------//</span>
00178 <span class="comment">void OptStage3::draw_count_bar(int rowId) {</span>
00179 }
00180 
00181 <span class="comment">//---------- End of function OptStage3::draw_count_bar ------------//</span>
00182 
00183 <span class="comment">//-------- Begin of function OptStage3::detect_count_bar ----------//</span>
00185 <span class="comment">int OptStage3::detect_count_bar(int rowId) {</span>
00186     <span class="keywordflow">return</span> -1;
00187 }
00188 
00189 <span class="comment">//---------- End of function OptStage3::detect_count_bar ----------//</span>
00190 
00191 <span class="comment">//------- Begin of function Optimization::init_stage_3 -----------//</span>
00193 <span class="comment">void Optimization::init_stage_3() {</span>
00194     <span class="comment">//***** temporary *****//</span>
00195     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="Gamedef_8h.html#a10">MAX_DEPARTMENT</a>; i++) {
00196         pref[i] = 1;
00197         existing[i] = i + 2;
00198         new_hire[i] = 10 - i;
00199     }
00200     <span class="comment">//*********************//</span>
00201 }
00202 
00203 <span class="comment">//--------- End of function Optimization::init_stage_3 -----------//</span>
00204 
00205 <span class="comment">//------- Begin of function Optimization::deinit_stage_3 ---------//</span>
00207 <span class="comment">void Optimization::deinit_stage_3() {</span>
00208     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="Gamedef_8h.html#a10">MAX_DEPARTMENT</a>; i++) {
00209         <span class="keyword">delete</span> opt3_button_group_array[i];
00210 
00211         <span class="keywordflow">if</span>(opt3_button_group_array[i]) {
00212             opt3_button_group_array[i]=<a class="code" href="OHELP_8H.html#a0">NULL</a>;
00213         }
00214         opt3_slider_group[i].deinit();
00215 
00216         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a>; j++) {
00217             <span class="keywordflow">if</span>(opt3_button_group_up_bitmap[i * <a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> + j]) {
00218                 <a class="code" href="ALL_8H.html#a8">mem_del</a>(opt3_button_group_up_bitmap[i * <a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> + j]);
00219                 <a class="code" href="ALL_8H.html#a8">mem_del</a>(opt3_button_group_down_bitmap[i * <a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> + j]);
00220                 opt3_button_group_up_bitmap[i * <a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> + j] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00221                 opt3_button_group_down_bitmap[i * <a class="code" href="Oopt_8h.html#a3a1">PREF_COUNT</a> + j] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00222             }
00223         }
00224         opt3_data1[i].<a class="code" href="classText.html#a26">deinit</a>();
00225         opt3_data2[i].<a class="code" href="classText.html#a26">deinit</a>();
00226         result_text_opt3[i].<a class="code" href="classText.html#a26">deinit</a>();
00227     }
00228     opt3_text1.<a class="code" href="classText.html#a26">deinit</a>();
00229     opt3_text2.<a class="code" href="classText.html#a26">deinit</a>();
00230     opt3_text3.<a class="code" href="classText.html#a26">deinit</a>();
00231     value_slider1.<a class="code" href="classValueSlider.html#a5">deinit</a>();
00232     opt3_text3.<a class="code" href="classText.html#a26">deinit</a>();
00233     <span class="comment">//##### begin Gilbert 21/04/2001 #####//</span>
00234     help_button.<a class="code" href="classButton.html#a2">deinit</a>();
00235     <span class="comment">//##### end Gilbert 21/04/2001 #####//</span>
00236     stage_init_flag = 0;
00237 }
00238 
00239 <span class="comment">//--------- End of function Optimization::deinit_stage_3 -------//</span>
00240 
00241 <span class="comment">//------- Begin of function Optimization::report_stage_3 ---------------//</span>
<a name="l00243"></a><a class="code" href="classOptimization.html#a9">00243</a> <span class="comment">void Optimization::report_stage_3(int refreshFlag) {</span>
00244     <a class="code" href="classDepartment.html">Department</a> *deptPtr;
00245     <span class="keywordtype">int</span> i;
00246     <span class="keywordtype">int</span> dept_sum;
00247 
00248     <span class="keywordflow">if</span>(department_array.size()&gt;0)
00249         line_spacing=((<a class="code" href="oopt3_8cpp.html#a69a28">REPORT_Y2</a>-<a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>-<a class="code" href="oopt3_8cpp.html#a77a37">HEADING_HEIGHT</a>)/department_array.size())-1;
00250     <span class="keywordflow">else</span>
00251         line_spacing=<a class="code" href="oopt3_8cpp.html#a77a36">LINE_SPACING</a>;
00252 
00253     finance.calc_max_hires();                       <span class="comment">//## chea test;</span>
00254     remain_hire1 = finance.max_hires;
00255     remain_hire2 = 0;
00256     remain_hire3 = finance.total_hires;
00257     dept_sum = 0;
00258     <span class="keywordflow">for</span> (i =department_array.size();i&gt;0;i--) {
00259         <span class="keywordflow">if</span> (department_array.is_deleted(i))
00260             <span class="keywordflow">continue</span>;
00261         deptPtr = department_array[i];
00262 
00263         v1[i-1]=finance.hiring_policy_array[i-1].fac_count;
00264         v2[i-1]=finance.hiring_policy_array[i-1].avg_salary;
00265         remain_hire2 += finance.hiring_policy_array[i-1].target_value;
00266     }
00267 
00268     <span class="keywordflow">if</span> (refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>) {
00269         <span class="comment">// show the title</span>
00270         user_interface.brighten(<a class="code" href="oopt3_8cpp.html#a69a25">REPORT_X1</a>+100, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="oopt3_8cpp.html#a69a27">REPORT_X2</a>-100, <a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>);
00271         user_interface.brighten(<a class="code" href="oopt3_8cpp.html#a69a25">REPORT_X1</a>, <a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>, <a class="code" href="oopt3_8cpp.html#a69a27">REPORT_X2</a>, <a class="code" href="oopt3_8cpp.html#a69a28">REPORT_Y2</a>+55);
00272         user_interface.rect(<a class="code" href="oopt3_8cpp.html#a69a25">REPORT_X1</a>+100, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="oopt3_8cpp.html#a69a27">REPORT_X2</a>-100, <a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>);
00273         font_charts.center_put( <a class="code" href="oopt3_8cpp.html#a69a25">REPORT_X1</a>, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="oopt3_8cpp.html#a69a27">REPORT_X2</a>, <a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>, <span class="stringliteral">"Faculty Hiring"</span> );
00274 
00275         <span class="comment">// show the frame outline</span>
00276         <span class="comment">//              user_interface.bg_img(BG_PIC_ID, &amp;vga_back);</span>
00277 
00278         user_interface.h_line(<a class="code" href="oopt3_8cpp.html#a69a25">REPORT_X1</a>, <a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>+<a class="code" href="oopt3_8cpp.html#a77a37">HEADING_HEIGHT</a>, <a class="code" href="oopt3_8cpp.html#a69a27">REPORT_X2</a>-<a class="code" href="oopt3_8cpp.html#a69a25">REPORT_X1</a>);
00279         user_interface.v_line(<a class="code" href="oopt3_8cpp.html#a70a29">SEPARATOR_1</a>-1, <a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>+1, <a class="code" href="oopt3_8cpp.html#a69a28">REPORT_Y2</a>-<a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>-2);
00280         user_interface.v_line(<a class="code" href="oopt3_8cpp.html#a71a30">SEPARATOR_2</a>-1, <a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>+1, <a class="code" href="oopt3_8cpp.html#a69a28">REPORT_Y2</a>-<a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>-2);
00281         user_interface.v_line(<a class="code" href="oopt3_8cpp.html#a72a31">SEPARATOR_3</a>-1, <a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>+1, <a class="code" href="oopt3_8cpp.html#a69a28">REPORT_Y2</a>-<a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>-2);
00282         <span class="comment">//              user_interface.v_line(SEPARATOR_4-1, REPORT_Y1+1, REPORT_Y2-REPORT_Y1-2);</span>
00283         user_interface.v_line(<a class="code" href="oopt3_8cpp.html#a74a33">SEPARATOR_5</a>-1, <a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>+1, <a class="code" href="oopt3_8cpp.html#a69a28">REPORT_Y2</a>-<a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>-2);
00284         user_interface.rect(<a class="code" href="oopt3_8cpp.html#a69a25">REPORT_X1</a>, <a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>, <a class="code" href="oopt3_8cpp.html#a69a27">REPORT_X2</a>, <a class="code" href="oopt3_8cpp.html#a69a28">REPORT_Y2</a>, 2);
00285         user_interface.rect(<a class="code" href="oopt3_8cpp.html#a69a25">REPORT_X1</a>, <a class="code" href="oopt3_8cpp.html#a69a28">REPORT_Y2</a>, <a class="code" href="oopt3_8cpp.html#a69a27">REPORT_X2</a>, <a class="code" href="oopt3_8cpp.html#a69a28">REPORT_Y2</a>+55, 2);
00286 
00287         font_chartsm.center_put( <a class="code" href="oopt3_8cpp.html#a69a25">REPORT_X1</a>+1, <a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>+1,
00288                                  <a class="code" href="oopt3_8cpp.html#a70a29">SEPARATOR_1</a>-1, <a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>+1+<a class="code" href="oopt3_8cpp.html#a77a37">HEADING_HEIGHT</a>, title[0] );
00289         font_chartsm.center_put( <a class="code" href="oopt3_8cpp.html#a70a29">SEPARATOR_1</a>+1, <a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>+1,
00290                                  <a class="code" href="oopt3_8cpp.html#a71a30">SEPARATOR_2</a>-1, <a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>+1+<a class="code" href="oopt3_8cpp.html#a77a37">HEADING_HEIGHT</a>, title[1] );
00291         font_chartsm.center_put( <a class="code" href="oopt3_8cpp.html#a71a30">SEPARATOR_2</a>+1, <a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>+1,
00292                                  <a class="code" href="oopt3_8cpp.html#a72a31">SEPARATOR_3</a>-1, <a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>+1+<a class="code" href="oopt3_8cpp.html#a77a37">HEADING_HEIGHT</a>, title[2] );
00293         font_chartsm.center_put( <a class="code" href="oopt3_8cpp.html#a72a31">SEPARATOR_3</a>+1, <a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>+1,
00294                                  <a class="code" href="oopt3_8cpp.html#a73a32">SEPARATOR_4</a>-1, <a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>+1+<a class="code" href="oopt3_8cpp.html#a77a37">HEADING_HEIGHT</a>, title[3] );
00295         <span class="comment">//              font_chartsm.center_put( SEPARATOR_3+1, REPORT_Y1+1,</span>
00296         <span class="comment">//                      SEPARATOR_5-1, REPORT_Y1+1+HEADING_HEIGHT, title[4] );</span>
00297         font_chartsm.center_put( <a class="code" href="oopt3_8cpp.html#a74a33">SEPARATOR_5</a>+1, <a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>+1,
00298                                  <a class="code" href="oopt3_8cpp.html#a75a34">SEPARATOR_6</a>-1, <a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>+1+<a class="code" href="oopt3_8cpp.html#a77a37">HEADING_HEIGHT</a>, title[5] );
00299 
00300         <span class="comment">//              if(user_interface.backgd_flag==1)</span>
00301         <span class="comment">//                      image_interface.put_back(SEPARATOR_4+5,REPORT_Y1+3,"QUEST_UP");</span>
00302 
00303         <span class="keywordflow">for</span> (i =department_array.size();i&gt;0;i--) {
00304             <span class="keywordflow">if</span> (department_array.is_deleted(i))
00305                 <span class="keywordflow">continue</span>;
00306             deptPtr = department_array[i];
00307             font_chartsm.center_put( <a class="code" href="oopt3_8cpp.html#a77a39">DESCRIPTION_OFFSET</a>,
00308                                      <a class="code" href="oopt3_8cpp.html#a77a38">FIRST_LINE_OFFSET</a> + line_spacing * (i-1),
00309                                      <a class="code" href="oopt3_8cpp.html#a70a29">SEPARATOR_1</a>-1,
00310                                      <a class="code" href="oopt3_8cpp.html#a77a38">FIRST_LINE_OFFSET</a> + line_spacing * (i-1) + 14,
00311                                      department_res[deptPtr-&gt;<a class="code" href="classGeneralDepartment.html#m2">department_id</a>]-&gt;name);
00312         }
00313 
00314         font_chartsm.put( <a class="code" href="oopt3_8cpp.html#a77a57">REMAIN_MESSAGE_X</a>, <a class="code" href="oopt3_8cpp.html#a77a58">REMAIN_MESSAGE_Y1</a>, remain_msg1 );
00315         font_chartsm.put( <a class="code" href="oopt3_8cpp.html#a77a57">REMAIN_MESSAGE_X</a>, <a class="code" href="oopt3_8cpp.html#a77a59">REMAIN_MESSAGE_Y2</a>, remain_msg2 );
00316         font_chartsm.put( <a class="code" href="oopt3_8cpp.html#a77a57">REMAIN_MESSAGE_X</a>, <a class="code" href="oopt3_8cpp.html#a77a60">REMAIN_MESSAGE_Y3</a>, remain_msg3 );
00317 
00318         <span class="comment">// show the preference's buttons</span>
00319         <span class="keywordflow">if</span> (stage_init_flag != 3) {                   <span class="comment">// current stage not init'ed</span>
00320             <span class="comment">// ##### begin Gilbert 23/04/2001 ###### //</span>
00321             deinit();                                   <span class="comment">// for free memory</span>
00322             <span class="comment">// ##### end Gilbert 23/04/2001 ###### //</span>
00323 
00324             <span class="keywordflow">for</span> (i = 0; i &lt; department_array.size(); i++) {
00325                 targetValue[i] = (double)finance.hiring_policy_array[i].target_value;
00326                 <span class="comment">//121099 BUGHERE</span>
00327                 upperBound[i] = (double)finance.hiring_policy_array[i].upper_bound;
00328             }
00329 
00330             <span class="comment">/*                  deinit();</span>
00331 <span class="comment">                                ButtonGroup *button_ref;</span>
00332 <span class="comment">                                int pressedButton;</span>
00333 <span class="comment"></span>
00334 <span class="comment">                                for (i = 0; i &lt; department_array.size(); i++)</span>
00335 <span class="comment">                                {</span>
00336 <span class="comment">                                opt3_button_group_array[i] = new ButtonGroup(PREF_COUNT);</span>
00337 <span class="comment">                                targetValue[i] = (double)finance.hiring_policy_array[i].target_value;</span>
00338 <span class="comment">                                upperBound[i] = (double)finance.hiring_policy_array[i].upper_bound;  //121099 BUGHERE</span>
00339 <span class="comment">                                pref[i] = finance.hiring_policy_array[i].weight;</span>
00340 <span class="comment"></span>
00341 <span class="comment">                                user_interface.create_button_bitmap(</span>
00342 <span class="comment">                                PREF_BUTTON_OFFSET1-2,</span>
00343 <span class="comment">                                PREF_BUTTON_OFFSET + FIRST_LINE_OFFSET + line_spacing * i-2,</span>
00344 <span class="comment">                                PREF_BUTTON_OFFSET1 + PREF_BUTTON_WIDTH,</span>
00345 <span class="comment">                                PREF_BUTTON_OFFSET + FIRST_LINE_OFFSET + line_spacing * i + PREF_BUTTON_HEIGHT,</span>
00346 <span class="comment">                                pref_label[0], &amp;opt3_button_group_up_bitmap[PREF_COUNT * i], &amp;opt3_button_group_down_bitmap[PREF_COUNT * i], &amp;vga_back);</span>
00347 <span class="comment">                                user_interface.create_button_bitmap(</span>
00348 <span class="comment">                                PREF_BUTTON_OFFSET2-2,</span>
00349 <span class="comment">                                PREF_BUTTON_OFFSET + FIRST_LINE_OFFSET + line_spacing * i-2,</span>
00350 <span class="comment">                                PREF_BUTTON_OFFSET2 + PREF_BUTTON_WIDTH,</span>
00351 <span class="comment">                                PREF_BUTTON_OFFSET + FIRST_LINE_OFFSET + line_spacing * i + PREF_BUTTON_HEIGHT,</span>
00352 <span class="comment">                                pref_label[1], &amp;opt3_button_group_up_bitmap[PREF_COUNT * i + 1], &amp;opt3_button_group_down_bitmap[PREF_COUNT * i + 1], &amp;vga_back);</span>
00353 <span class="comment">                                user_interface.create_button_bitmap(</span>
00354 <span class="comment">                                PREF_BUTTON_OFFSET3-2,</span>
00355 <span class="comment">                                PREF_BUTTON_OFFSET + FIRST_LINE_OFFSET + line_spacing * i-2,</span>
00356 <span class="comment">                                PREF_BUTTON_OFFSET3 + PREF_BUTTON_WIDTH,</span>
00357 <span class="comment">                                PREF_BUTTON_OFFSET + FIRST_LINE_OFFSET + line_spacing * i + PREF_BUTTON_HEIGHT,</span>
00358 <span class="comment">                                pref_label[2], &amp;opt3_button_group_up_bitmap[PREF_COUNT * i + 2], &amp;opt3_button_group_down_bitmap[PREF_COUNT * i + 2], &amp;vga_back);</span>
00359 <span class="comment"></span>
00360 <span class="comment">                                button_ref = opt3_button_group_array[i];</span>
00361 <span class="comment">                                //                              pressedButton = (int)(pref[i]*2.0-1.0);</span>
00362 <span class="comment">                                if(pref[i]==OPT_LOW_WEIGHT)</span>
00363 <span class="comment">                                pressedButton =0;</span>
00364 <span class="comment">                                if(pref[i]==OPT_MID_WEIGHT)</span>
00365 <span class="comment">                                pressedButton =1;</span>
00366 <span class="comment">                                if(pref[i]==OPT_HIGH_WEIGHT)</span>
00367 <span class="comment">                                pressedButton =2;</span>
00368 <span class="comment"></span>
00369 <span class="comment">                                (*button_ref)[0].create_bitmapW(</span>
00370 <span class="comment">                                PREF_BUTTON_OFFSET1-2,</span>
00371 <span class="comment">                                PREF_BUTTON_OFFSET + FIRST_LINE_OFFSET + line_spacing * i-2,</span>
00372 <span class="comment">                                PREF_BUTTON_OFFSET1 + PREF_BUTTON_WIDTH,</span>
00373 <span class="comment">                                PREF_BUTTON_OFFSET + FIRST_LINE_OFFSET + line_spacing * i + PREF_BUTTON_HEIGHT,</span>
00374 <span class="comment">                                ((pressedButton == 0) ? opt3_button_group_down_bitmap[PREF_COUNT * i] : opt3_button_group_up_bitmap[PREF_COUNT * i]) + 4);</span>
00375 <span class="comment">                                (*button_ref)[1].create_bitmapW(</span>
00376 <span class="comment">                                PREF_BUTTON_OFFSET2-2,</span>
00377 <span class="comment">                                PREF_BUTTON_OFFSET + FIRST_LINE_OFFSET + line_spacing * i-2,</span>
00378 <span class="comment">                                PREF_BUTTON_OFFSET2 + PREF_BUTTON_WIDTH,</span>
00379 <span class="comment">                                PREF_BUTTON_OFFSET + FIRST_LINE_OFFSET + line_spacing * i + PREF_BUTTON_HEIGHT,</span>
00380 <span class="comment">                                ((pressedButton == 1) ? opt3_button_group_down_bitmap[PREF_COUNT * i+1] : opt3_button_group_up_bitmap[PREF_COUNT * i+1]) + 4);</span>
00381 <span class="comment">                                (*button_ref)[2].create_bitmapW(</span>
00382 <span class="comment">                                PREF_BUTTON_OFFSET3-2,</span>
00383 <span class="comment">                                PREF_BUTTON_OFFSET + FIRST_LINE_OFFSET + line_spacing * i-2,</span>
00384 <span class="comment">                                PREF_BUTTON_OFFSET3 + PREF_BUTTON_WIDTH,</span>
00385 <span class="comment">                                PREF_BUTTON_OFFSET + FIRST_LINE_OFFSET + line_spacing * i + PREF_BUTTON_HEIGHT,</span>
00386 <span class="comment">                                ((pressedButton == 2) ? opt3_button_group_down_bitmap[PREF_COUNT * i+2] : opt3_button_group_up_bitmap[PREF_COUNT * i+2]) + 4);</span>
00387 <span class="comment"></span>
00388 <span class="comment">                                button_ref-&gt;button_pressed = pressedButton;</span>
00389 <span class="comment">                                }</span>
00390 <span class="comment">            */</span>
00391             <span class="keywordflow">if</span>(user_interface.backgd_flag==1)
00392                 help_button.<a class="code" href="classButton.html#a10">create_text</a>(
00393                     <a class="code" href="oopt3_8cpp.html#a77a57">REMAIN_MESSAGE_X</a>-22,
00394                     <a class="code" href="oopt3_8cpp.html#a77a62">REMAIN_Y1</a>,
00395                     <a class="code" href="oopt3_8cpp.html#a77a57">REMAIN_MESSAGE_X</a>-8,
00396                     <a class="code" href="oopt3_8cpp.html#a77a62">REMAIN_Y1</a>+18,
00397                     <span class="stringliteral">"?"</span>);
00398 
00399             stage_init_flag = 3;
00400         }
00401 
00402         <span class="comment">// ##### begin Gilbert 21/04/2001 ###### //</span>
00403         <a class="code" href="ALL_8H.html#a0">err_when</a>( department_array.size() &gt; <a class="code" href="Gamedef_8h.html#a10">MAX_DEPARTMENT</a> );
00404         <span class="comment">// ##### end Gilbert 21/04/2001 ###### //</span>
00405 
00406         <span class="comment">// show the data</span>
00407         <span class="keywordflow">for</span> (i = 0; i &lt; department_array.size(); i++) {
00408             opt3_data1[i].<a class="code" href="classText.html#a11">put</a>(<a class="code" href="oopt3_8cpp.html#a77a40">EXISTING_FACULTY_OFFSET</a>, <a class="code" href="oopt3_8cpp.html#a77a38">FIRST_LINE_OFFSET</a> + line_spacing * i,&amp;v1[i],4);
00409             opt3_data2[i].<a class="code" href="classText.html#a11">put</a>(<a class="code" href="oopt3_8cpp.html#a77a41">SALARY_OFFSET</a>, <a class="code" href="oopt3_8cpp.html#a77a38">FIRST_LINE_OFFSET</a> + line_spacing * i,&amp;v2[i],4);
00410 
00411             <span class="comment">//##### begin chwong 981215#####//</span>
00412 
00413             opt3_slider_group[i].init(
00414                 <a class="code" href="oopt3_8cpp.html#a77a43">TARGET_OFFSET</a>,
00415                 <a class="code" href="oopt3_8cpp.html#a77a42">SLIDER_OFFSET</a> + <a class="code" href="oopt3_8cpp.html#a77a38">FIRST_LINE_OFFSET</a> + line_spacing * i + 2,
00416                 <a class="code" href="oopt3_8cpp.html#a77a44">TARGET_WIDTH</a>,
00417                 line_spacing-15,
00418                 <span class="comment">//                                      &amp;(targetValue[i]), NULL, &amp;(upperBound[i]),0,10,  //121099 BUGHERE</span>
00419                 &amp;(targetValue[i]), <a class="code" href="OHELP_8H.html#a0">NULL</a>, &amp;(upperBound[i]),0,10,
00420                 1,
00421                 <span class="comment">//                                      vga.active_buf-&gt;color_up,</span>
00422                 <span class="comment">//                                      vga.active_buf-&gt;color_dark,</span>
00423                 <a class="code" href="COLOR_8H.html#a25">V_YELLOW</a>,
00424                 <a class="code" href="COLOR_8H.html#a20">V_GREEN</a>,
00425                 9);
00426             <span class="keywordflow">if</span>(user_interface.backgd_flag==1)
00427                 image_interface.put_back(<a class="code" href="oopt3_8cpp.html#a77a57">REMAIN_MESSAGE_X</a>-27,
00428                                          <a class="code" href="oopt3_8cpp.html#a77a62">REMAIN_Y1</a>,<span class="stringliteral">"QUEST_UP"</span>);
00429             <span class="comment">//                  opt3_button_group_array[i]-&gt;paint(opt3_button_group_array[i]-&gt;button_pressed);</span>
00430             opt3_slider_group[i].paint();
00431 
00432             result_text_opt3[i].<a class="code" href="classText.html#a2">init</a>(
00433                 <a class="code" href="oopt3_8cpp.html#a77a66">RESULT_OFFSET</a> + <a class="code" href="oopt3_8cpp.html#a77a67">RESULT_LENGTH</a>-50,
00434                 <a class="code" href="oopt3_8cpp.html#a77a38">FIRST_LINE_OFFSET</a> + line_spacing * i,
00435                 &amp;(opt3_slider_group[i].result_value));
00436 
00437         }
00438         opt3_text1.<a class="code" href="classText.html#a11">put</a>( <a class="code" href="oopt3_8cpp.html#a77a61">REMAIN_X</a>, <a class="code" href="oopt3_8cpp.html#a77a62">REMAIN_Y1</a>, &amp;remain_hire1);
00439         opt3_text2.<a class="code" href="classText.html#a11">put</a>( <a class="code" href="oopt3_8cpp.html#a77a61">REMAIN_X</a>, <a class="code" href="oopt3_8cpp.html#a77a63">REMAIN_Y2</a>, &amp;remain_hire2);
00440         <span class="keywordflow">for</span> (i =department_array.size();i&gt;0;i--) {
00441             <span class="keywordflow">if</span> (department_array.is_deleted(i))
00442                 <span class="keywordflow">continue</span>;
00443             <span class="comment">//BUGHERE</span>
00444             <span class="comment">//                  if(finance.hiring_policy_array[i-1].upper_bound==0)</span>
00445             dept_sum += 20;
00446             <span class="comment">//                          else</span>
00447             <span class="comment">//                                  dept_sum += (int)finance.hiring_policy_array[i-1].upper_bound;</span>
00448         }
00449 
00450         <span class="keywordflow">if</span>( sys.view_mode == <a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a> ) { <span class="comment">// only allow setting the value in optimization</span>
00451             value_slider1.<a class="code" href="classValueSlider.html#a2">init</a>(
00452                 <a class="code" href="oopt3_8cpp.html#a77a61">REMAIN_X</a>-45, <a class="code" href="oopt3_8cpp.html#a77a64">REMAIN_Y3</a>-1,
00453                 100,15,0,remain_hire2+10,&amp;(remain_hire3),1,<a class="code" href="COLOR_8H.html#a25">V_YELLOW</a>,1);
00454         }
00455         <span class="keywordflow">else</span> {
00456             opt3_text3.<a class="code" href="classText.html#a11">put</a>( <a class="code" href="oopt3_8cpp.html#a77a61">REMAIN_X</a>, <a class="code" href="oopt3_8cpp.html#a77a64">REMAIN_Y3</a>, &amp;remain_hire3);
00457         }
00458     }
00459 
00460     <span class="keywordflow">if</span>( sys.view_mode == <a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a> )
00461         value_slider1.<a class="code" href="classValueSlider.html#a7">refresh</a>();
00462     <span class="keywordflow">else</span>
00463         opt3_text3.<a class="code" href="classText.html#a25">refresh</a>();
00464 
00465     <span class="keywordflow">for</span> (i = 0; i &lt; department_array.size(); i++) {
00466         opt3_data1[i].<a class="code" href="classText.html#a25">refresh</a>();
00467         opt3_data2[i].<a class="code" href="classText.html#a25">refresh</a>();
00468         <span class="comment">//              opt3_button_group_array[i]-&gt;push(opt3_button_group_array[i]-&gt;button_pressed);</span>
00469         opt3_slider_group[i].refresh();
00470     }
00471 
00472     vga.use_back();
00473     opt3_text1.<a class="code" href="classText.html#a25">refresh</a>();
00474     opt3_text2.<a class="code" href="classText.html#a25">refresh</a>();
00475     vga.blt_buf(<a class="code" href="oopt3_8cpp.html#a77a61">REMAIN_X</a>,<a class="code" href="oopt3_8cpp.html#a77a62">REMAIN_Y1</a>,<a class="code" href="oopt3_8cpp.html#a77a61">REMAIN_X</a>+50,<a class="code" href="oopt3_8cpp.html#a77a64">REMAIN_Y3</a>-1);
00476     <span class="comment">//  opt3_text3.refresh();</span>
00477     <span class="keywordflow">for</span> (i = 0; i &lt; department_array.size(); i++) { {
00478 
00479         <span class="comment">//              if (optimization.is_optimized[2]==1)</span>
00480         opt3_slider_group[i].result_value = finance.hiring_policy_array[i].result_value;
00481         result_text_opt3[i].<a class="code" href="classText.html#a24">paint</a>();
00482         vga.blt_buf(
00483             <a class="code" href="oopt3_8cpp.html#a77a66">RESULT_OFFSET</a> + <a class="code" href="oopt3_8cpp.html#a77a67">RESULT_LENGTH</a>-50,
00484             <a class="code" href="oopt3_8cpp.html#a77a38">FIRST_LINE_OFFSET</a> + line_spacing * i,
00485             <a class="code" href="oopt3_8cpp.html#a77a66">RESULT_OFFSET</a> + <a class="code" href="oopt3_8cpp.html#a77a67">RESULT_LENGTH</a>,
00486             <a class="code" href="oopt3_8cpp.html#a77a38">FIRST_LINE_OFFSET</a> + line_spacing * i + 16
00487             );
00488     }
00489     }
00490 
00491     <span class="comment">//------------------------------------------//</span>
00492 
00493     <span class="keywordtype">int</span> useBackBuf = vga.use_back_buf;
00494     vga.use_front();
00495 
00496     <span class="keywordflow">if</span>( useBackBuf )
00497         vga.use_back();
00498 }
00499 
00500 <span class="comment">//---------- End of function Optimization::report_stage_3 ------------//</span>
00501 
00502 <span class="comment">//-------- Begin of function Optimization::detect_stage_3 ------------//</span>
<a name="l00504"></a><a class="code" href="classOptimization.html#a12">00504</a> <span class="comment">int Optimization::detect_stage_3() {</span>
00505     <span class="keywordflow">if</span> (stage_init_flag != 3)
00506         <span class="keywordflow">return</span> 0;
00507     help.set_help(  <a class="code" href="oopt3_8cpp.html#a72a31">SEPARATOR_3</a>, <a class="code" href="oopt3_8cpp.html#a77a42">SLIDER_OFFSET</a> + <a class="code" href="oopt3_8cpp.html#a77a38">FIRST_LINE_OFFSET</a>,
00508                     <a class="code" href="oopt3_8cpp.html#a73a32">SEPARATOR_4</a>-30,<a class="code" href="oopt3_8cpp.html#a69a28">REPORT_Y2</a>-20,<span class="stringliteral">"H8.2.1."</span>);
00509     help.set_help(  <a class="code" href="oopt3_8cpp.html#a73a32">SEPARATOR_4</a>-30, <a class="code" href="oopt3_8cpp.html#a77a42">SLIDER_OFFSET</a> + <a class="code" href="oopt3_8cpp.html#a77a38">FIRST_LINE_OFFSET</a>,
00510                     <a class="code" href="oopt3_8cpp.html#a73a32">SEPARATOR_4</a>,<a class="code" href="oopt3_8cpp.html#a69a28">REPORT_Y2</a>-20,<span class="stringliteral">"H8.2.2."</span>);
00511     help.set_help(  <a class="code" href="oopt3_8cpp.html#a73a32">SEPARATOR_4</a>, <a class="code" href="oopt3_8cpp.html#a77a42">SLIDER_OFFSET</a> + <a class="code" href="oopt3_8cpp.html#a77a38">FIRST_LINE_OFFSET</a>,
00512                     <a class="code" href="oopt3_8cpp.html#a74a33">SEPARATOR_5</a>,<a class="code" href="oopt3_8cpp.html#a69a28">REPORT_Y2</a>-20,<span class="stringliteral">"H8.2.3."</span>);
00513 
00514     help.set_help(  <a class="code" href="oopt3_8cpp.html#a77a61">REMAIN_X</a>-45, <a class="code" href="oopt3_8cpp.html#a77a64">REMAIN_Y3</a>-1,<a class="code" href="oopt3_8cpp.html#a77a61">REMAIN_X</a>+55, <a class="code" href="oopt3_8cpp.html#a77a64">REMAIN_Y3</a>+15,<span class="stringliteral">"H8.2.4."</span>);
00515 
00516     <span class="keywordtype">int</span> i;
00517     <span class="comment">//------ Detection in preference (right) column --------//</span>
00518     <span class="comment">/*</span>
00519 <span class="comment">      if (mouse.single_click( SEPARATOR_4, REPORT_Y1+1+HEADING_HEIGHT,</span>
00520 <span class="comment">      REPORT_X2, REPORT_Y2 ))</span>
00521 <span class="comment">      {</span>
00522 <span class="comment">      for (i = 0; i &lt; department_array.size(); i++)</span>
00523 <span class="comment">      if        ( (int j = opt3_button_group_array[i]-&gt;detect()) &gt;= 0)</span>
00524 <span class="comment">      {</span>
00525 <span class="comment"></span>
00526 <span class="comment">      optimization.is_optimize_slider_modified[2]=0;    //## chea 041099 try to release the opt button</span>
00527 <span class="comment"></span>
00528 <span class="comment">      ButtonGroup *buttonGroupPtr = opt3_button_group_array[i];</span>
00529 <span class="comment">      vga.use_back();</span>
00530 <span class="comment">      for (int k = 0; k &lt; PREF_COUNT; k++)</span>
00531 <span class="comment">      {</span>
00532 <span class="comment">      (*buttonGroupPtr)[k].body_ptr =</span>
00533 <span class="comment">      (void *) ((k==j)?(opt3_button_group_down_bitmap[i*PREF_COUNT+k] + 4):(opt3_button_group_up_bitmap[i*PREF_COUNT+k] + 4));</span>
00534 <span class="comment">      }</span>
00535 <span class="comment">      buttonGroupPtr-&gt;paint(buttonGroupPtr-&gt;button_pressed);</span>
00536 <span class="comment"></span>
00537 <span class="comment">      if(department_array.size()&gt;0)</span>
00538 <span class="comment">      line_spacing=((REPORT_Y2-REPORT_Y1-HEADING_HEIGHT)/department_array.size())-1;</span>
00539 <span class="comment">      else</span>
00540 <span class="comment">      line_spacing=LINE_SPACING;</span>
00541 <span class="comment"></span>
00542 <span class="comment">      vga.blt_buf(</span>
00543 <span class="comment">      PREF_BUTTON_OFFSET1,</span>
00544 <span class="comment">      PREF_BUTTON_OFFSET + FIRST_LINE_OFFSET + line_spacing * i,</span>
00545 <span class="comment">      PREF_BUTTON_OFFSET1 + PREF_BUTTON_WIDTH,</span>
00546 <span class="comment">      PREF_BUTTON_OFFSET + FIRST_LINE_OFFSET + line_spacing * i + PREF_BUTTON_HEIGHT</span>
00547 <span class="comment">      );</span>
00548 <span class="comment"></span>
00549 <span class="comment">      vga.blt_buf(</span>
00550 <span class="comment">      PREF_BUTTON_OFFSET2,</span>
00551 <span class="comment">      PREF_BUTTON_OFFSET + FIRST_LINE_OFFSET + line_spacing * i,</span>
00552 <span class="comment">      PREF_BUTTON_OFFSET2 + PREF_BUTTON_WIDTH,</span>
00553 <span class="comment">      PREF_BUTTON_OFFSET + FIRST_LINE_OFFSET + line_spacing * i + PREF_BUTTON_HEIGHT</span>
00554 <span class="comment">      );</span>
00555 <span class="comment"></span>
00556 <span class="comment">      vga.blt_buf(</span>
00557 <span class="comment">      PREF_BUTTON_OFFSET3,</span>
00558 <span class="comment">      PREF_BUTTON_OFFSET + FIRST_LINE_OFFSET + line_spacing * i,</span>
00559 <span class="comment">      PREF_BUTTON_OFFSET3 + PREF_BUTTON_WIDTH,</span>
00560 <span class="comment">      PREF_BUTTON_OFFSET + FIRST_LINE_OFFSET + line_spacing * i + PREF_BUTTON_HEIGHT</span>
00561 <span class="comment">      );</span>
00562 <span class="comment">      //                                vga.blt_buf(PREF_BUTTON_OFFSET4, PREF_BUTTON_OFFSET + FIRST_LINE_OFFSET + LINE_SPACING * (i + ((i &gt;= REVENUE_POLICY_COUNT) ? 2 : 1)), PREF_BUTTON_OFFSET4 + PREF_BUTTON_WIDTH, PREF_BUTTON_OFFSET + FIRST_LINE_OFFSET + LINE_SPACING * (i + ((i &gt;= REVENUE_POLICY_COUNT) ? 2 : 1)) + PREF_BUTTON_HEIGHT);</span>
00563 <span class="comment"></span>
00564 <span class="comment">      if(j==0)</span>
00565 <span class="comment">      {</span>
00566 <span class="comment">      pref[i]  = OPT_LOW_WEIGHT;</span>
00567 <span class="comment">      opt3_button_group_array[i]-&gt;push(0);</span>
00568 <span class="comment">      optimization.is_optimize_slider_modified[2]=0;  //## chea 041099 try to release the opt button</span>
00569 <span class="comment">      }</span>
00570 <span class="comment">      else if(j==1)</span>
00571 <span class="comment">      {</span>
00572 <span class="comment">      pref[i]  = OPT_MID_WEIGHT;</span>
00573 <span class="comment">      opt3_button_group_array[i]-&gt;push(1);</span>
00574 <span class="comment">      optimization.is_optimize_slider_modified[2]=0;  //## chea 041099 try to release the opt button</span>
00575 <span class="comment">      }</span>
00576 <span class="comment">      else if(j==2)</span>
00577 <span class="comment">      {</span>
00578 <span class="comment">      pref[i]  = OPT_HIGH_WEIGHT;</span>
00579 <span class="comment">      opt3_button_group_array[i]-&gt;push(2);</span>
00580 <span class="comment">      optimization.is_optimize_slider_modified[2]=0;  //## chea 041099 try to release the opt button</span>
00581 <span class="comment">      }</span>
00582 <span class="comment"></span>
00583 <span class="comment">      finance.hiring_policy_array[i].weight = (float)pref[i];</span>
00584 <span class="comment">      break;</span>
00585 <span class="comment">      }</span>
00586 <span class="comment">      }</span>
00587 <span class="comment">    */</span>
00588     <span class="comment">/*</span>
00589 <span class="comment">      if (mouse.single_click(SEPARATOR_4+5,REPORT_Y1+3,SEPARATOR_4+21,REPORT_Y1+19))</span>
00590 <span class="comment">      {</span>
00591 <span class="comment">      String str;</span>
00592 <span class="comment">      str  = DIR_RES;</span>
00593 <span class="comment">      str += "SCORE";</span>
00594 <span class="comment">      ResTxt rs;</span>
00595 <span class="comment">      rs.init(str);</span>
00596 <span class="comment">      image_interface.put_back(SEPARATOR_4+5,REPORT_Y1+3,"QUEST_DN");</span>
00597 <span class="comment">      vga.blt_buf(SEPARATOR_4+5,REPORT_Y1+3,SEPARATOR_4+21,REPORT_Y1+19);</span>
00598 <span class="comment">      sys.back_view_mode=sys.view_mode;</span>
00599 <span class="comment">      help_if.help_textlist.topic_id=rs.locate_topic("Preference");</span>
00600 <span class="comment">      if(help_if.help_textlist.topic_id&gt;0)</span>
00601 <span class="comment">      {</span>
00602 <span class="comment">      help_if.help_textlist.add_history(help_if.help_textlist.topic_id);</span>
00603 <span class="comment">      sys.set_view_mode(MODE_HELP_DESC);</span>
00604 <span class="comment">      sys.redraw_all_flag = 1;</span>
00605 <span class="comment">      audio.play_wav("BEEPS-1",audio.int_to_DsVolume(config.sound_effect_volume));</span>
00606 <span class="comment">      }</span>
00607 <span class="comment">      return 1;</span>
00608 <span class="comment">      }</span>
00609 <span class="comment">    */</span>
00610     <span class="keywordflow">if</span> (mouse.in_area(<a class="code" href="oopt3_8cpp.html#a77a43">TARGET_OFFSET</a>,
00611                       <a class="code" href="oopt3_8cpp.html#a69a26">REPORT_Y1</a>+1+<a class="code" href="oopt3_8cpp.html#a77a37">HEADING_HEIGHT</a>,
00612                       <a class="code" href="oopt3_8cpp.html#a77a43">TARGET_OFFSET</a>+<a class="code" href="oopt3_8cpp.html#a77a44">TARGET_WIDTH</a>, <a class="code" href="oopt3_8cpp.html#a69a28">REPORT_Y2</a> )) {
00613         <span class="keywordflow">for</span> (i = 0; i &lt; department_array.size(); i++)
00614             <span class="keywordflow">if</span>(opt3_slider_group[i].detect()) {
00615                 optimization.is_optimize_slider_modified[2]=0;
00616                 finance.hiring_policy_array[i].target_value=(int)(*(opt3_slider_group[i].var_ptr));
00617                 finance.hiring_policy_array[i].upper_bound=(int)(*(opt3_slider_group[i].up_ptr));
00618                 finance.calc_max_hires();
00619 
00620                 <span class="comment">// only allow setting the value in optimization</span>
00621                 <span class="keywordflow">if</span>( sys.view_mode == <a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a> ) {
00622                     value_slider1.<a class="code" href="classValueSlider.html#m6">max_val</a> = max( remain_hire2+10, *(value_slider1.<a class="code" href="classValueSlider.html#m7">var_ptr</a>) );
00623                     value_slider1.<a class="code" href="classValueSlider.html#a7">refresh</a>();
00624                 }
00625                 <span class="keywordflow">return</span> 1;
00626             }
00627     }
00628 
00629     <span class="keywordflow">if</span>(help_button.<a class="code" href="classButton.html#a21">detect</a>()) {
00630         <a class="code" href="classString.html">String</a> str;
00631         str  = <a class="code" href="Gamedef_8h.html#a4">DIR_RES</a>;
00632         str += <span class="stringliteral">"SCORE"</span>;
00633 
00634         <a class="code" href="classResTxt.html">ResTxt</a> rs;
00635         rs.<a class="code" href="classResTxt.html#a2">init</a>(str);
00636 
00637         <span class="comment">// ## chwg1203</span>
00638         <span class="comment">//              REMAIN_MESSAGE_X-20,</span>
00639         <span class="comment">//                      REMAIN_Y1,</span>
00640         <span class="comment">//                      REMAIN_MESSAGE_X-6,</span>
00641         <span class="comment">//                      REMAIN_Y1+18,</span>
00642 
00643         image_interface.put_back(
00644             <a class="code" href="oopt3_8cpp.html#a77a57">REMAIN_MESSAGE_X</a>-27,
00645             <a class="code" href="oopt3_8cpp.html#a77a62">REMAIN_Y1</a>,
00646             <span class="stringliteral">"QUEST_DN"</span>);
00647         vga.blt_buf(
00648             <a class="code" href="oopt3_8cpp.html#a77a57">REMAIN_MESSAGE_X</a>-27,
00649             <a class="code" href="oopt3_8cpp.html#a77a62">REMAIN_Y1</a>,
00650             <a class="code" href="oopt3_8cpp.html#a77a57">REMAIN_MESSAGE_X</a>-7,
00651             <a class="code" href="oopt3_8cpp.html#a77a62">REMAIN_Y1</a>+20);
00652 
00653         sys.back_view_mode=sys.view_mode;
00654         help_if.help_textlist.topic_id=rs.<a class="code" href="classResTxt.html#a7">locate_topic</a>(<span class="stringliteral">"Number of budgeted new faculty positions"</span>);
00655         <span class="keywordflow">if</span>(help_if.help_textlist.topic_id&gt;0) {
00656             help_if.help_textlist.add_history(help_if.help_textlist.topic_id);
00657             sys.set_view_mode(<a class="code" href="Osys_8h.html#a45a31">MODE_HELP_DESC</a>);
00658             sys.redraw_all_flag = 1;
00659             audio.play_wav(<span class="stringliteral">"BEEPS-1"</span>,audio.int_to_DsVolume(config.sound_effect_volume));
00660         }
00661         <span class="keywordflow">return</span> 1;
00662     }
00663 
00664     vga.use_back();
00665 
00666     <span class="keywordflow">if</span>( sys.view_mode == <a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a> ) {   <span class="comment">// only allow setting the value in optimization</span>
00667         <span class="keywordflow">if</span>(value_slider1.<a class="code" href="classValueSlider.html#a8">detect</a>()) {
00668             finance.total_hires=*(value_slider1.<a class="code" href="classValueSlider.html#m7">var_ptr</a>);
00669             optimization.is_optimize_slider_modified[2]=0;
00670         }
00671     }
00672 
00673     <span class="keywordflow">return</span> 0;
00674 }
00675 
00676 <span class="comment">//---------- End of function Optimization::detect_stage_3 ------------//</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:38:10 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
