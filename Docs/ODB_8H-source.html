<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ODB.H Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>ODB.H</h1><a href="ODB_8H.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : ODB.H</span>
00002 <span class="comment">//Description : Header file of ODB.CPP object Database</span>
00003 
00004 <span class="preprocessor">#ifndef __ODB_H</span>
00005 <span class="preprocessor"></span><span class="preprocessor">#define __ODB_H</span>
00006 <span class="preprocessor"></span>
00007 <span class="preprocessor">#ifndef __OFILE_H</span>
00008 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="OFILE_8H.html">OFILE.H</a>&gt;</span>
00009 <span class="preprocessor">#endif</span>
00010 <span class="preprocessor"></span>
00011 <span class="comment">//-------- Define class Database ------------//</span>
00012 
<a name="l00014"></a><a class="code" href="classDatabase.html">00014</a> <span class="keyword">class </span><a class="code" href="classDatabase.html">Database</a> : <span class="keyword">public</span> <a class="code" href="classFile.html">File</a> {
00015 <span class="keyword">private</span>:
00016 
00018     <span class="keyword">struct </span>DbfHeader {
00019         <span class="keywordtype">char</span>     dbf_id;
00020         <span class="keywordtype">char</span>     last_update[3];
00021         <span class="keywordtype">long</span>     last_rec;
00022         <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> data_offset;
00023         <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> rec_size;
00024     };
00025 
00027     <span class="keyword">struct </span>DbfRec {
00028         <span class="keywordtype">char</span>     field_name[11];
00029         <span class="keywordtype">char</span>     field_type;
00030         <span class="keywordtype">long</span>     dummy[4];
00031         <span class="keyword">union </span>{
00032             <span class="keywordtype">unsigned</span> char_len;
00033             <span class="keyword">struct </span>{
00034                 <span class="keywordtype">char</span> len;
00035                 <span class="keywordtype">char</span> dec;
00036             } num_size;
00037         }len_info;
00038 
00039         <span class="keywordtype">char</span> filler[14];
00040     };
00041 
00042 <span class="keyword">private</span>:
00043 
00044     DbfHeader dbf_header;
00045     <span class="keywordtype">char</span>*     rec_buf;
00046     <span class="keywordtype">long</span>      cur_recno;
00047     <span class="keywordtype">long</span>      last_read_recno;
00048 
00049     <span class="keywordtype">char</span>*     dbf_buf;                            <span class="comment">// buffer for reading in the whole dbf</span>
00050     <span class="keywordtype">char</span>      dbf_buf_allocated;                  <span class="comment">// whether we allocated the buffer or only take from extern pointer</span>
00051 
00052 <span class="keyword">public</span>:
00053 
00054     <a class="code" href="classDatabase.html#a0">Database</a>(<span class="keywordtype">char</span>* =0, <span class="keywordtype">int</span>=0);
00055     <a class="code" href="classDatabase.html#a1">~Database</a>();
00056 
00057     <span class="keywordtype">void</span>  <a class="code" href="classDatabase.html#a2">open</a>(<span class="keywordtype">char</span>*, <span class="keywordtype">int</span>=0);
00058     <span class="keywordtype">void</span>  <a class="code" href="classDatabase.html#a3">open_from_buf</a>(<span class="keywordtype">char</span>*);
00059 
00060     <span class="keywordtype">char</span>* <a class="code" href="classDatabase.html#a4">read</a>(<span class="keywordtype">long</span>=0);
<a name="l00061"></a><a class="code" href="classDatabase.html#a5">00061</a>     <span class="keywordtype">void</span>  <a class="code" href="classDatabase.html#a5">go</a>(<span class="keywordtype">long</span> recNo)    { cur_recno=recNo; }
00062     <span class="keywordtype">void</span>  <a class="code" href="classDatabase.html#a6">close</a>();
00063 
<a name="l00064"></a><a class="code" href="classDatabase.html#a7">00064</a>     <span class="keywordtype">long</span>  <a class="code" href="classDatabase.html#a7">rec_count</a>()       { <span class="keywordflow">return</span> dbf_header.last_rec; }
<a name="l00065"></a><a class="code" href="classDatabase.html#a8">00065</a>     <span class="keywordtype">long</span>  <a class="code" href="classDatabase.html#a8">recno</a>()           { <span class="keywordflow">return</span> cur_recno; }
00066 };
00067 
00068 <span class="comment">//----------------------------------------------//</span>
00069 
00070 <span class="comment">//extern Database db_movie_hdr, db_movie_dtl;</span>
00071 
00072 <span class="comment">//----------------------------------------------//</span>
00073 <span class="preprocessor">#endif</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:37:20 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
