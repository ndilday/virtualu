<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Omatrix.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Omatrix.h</h1><a href="Omatrix_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename   : OMATRIX.H</span>
00002 <span class="comment">//Description: Header file for the class Matrix</span>
00003 
00004 <span class="preprocessor">#ifndef __OMATRIX_H</span>
00005 <span class="preprocessor"></span><span class="preprocessor">#define __OMATRIX_H</span>
00006 <span class="preprocessor"></span>
00007 <span class="comment">//------- Define constant for object_type; for DisplaySort::object_type --------//</span>
00008 
00009 <span class="keyword">enum</span> {
00010     <a class="code" href="Omatrix_8h.html#a11a0">OBJECT_FIRM</a>,
00011     <a class="code" href="Omatrix_8h.html#a11a1">OBJECT_PLANT</a>,
00012     <a class="code" href="Omatrix_8h.html#a11a2">OBJECT_VEHICLE</a>,
00013     <a class="code" href="Omatrix_8h.html#a11a3">OBJECT_SPRITE</a>,
00014 };
00015 
00016 <span class="comment">//---------- Define struct DisplaySort ----------//</span>
00017 
<a name="l00019"></a><a class="code" href="structDisplaySort.html">00019</a> <span class="keyword">struct </span><a class="code" href="structDisplaySort.html">DisplaySort</a> {
<a name="l00020"></a><a class="code" href="structDisplaySort.html#m0">00020</a>     <span class="keywordtype">char</span>  <a class="code" href="structDisplaySort.html#m0">object_type</a>;
<a name="l00021"></a><a class="code" href="structDisplaySort.html#m1">00021</a>     <span class="keywordtype">short</span> <a class="code" href="structDisplaySort.html#m1">object_recno</a>;
<a name="l00022"></a><a class="code" href="structDisplaySort.html#m2">00022</a>     <span class="keywordtype">short</span> <a class="code" href="structDisplaySort.html#m2">depth</a>;
<a name="l00023"></a><a class="code" href="structDisplaySort.html#m4">00023</a>     <span class="keywordtype">short</span> <a class="code" href="structDisplaySort.html#m3">loc_x</a>,<a class="code" href="structDisplaySort.html#m4">loc_y</a>;
<a name="l00024"></a><a class="code" href="structDisplaySort.html#m8">00024</a>     <span class="keywordtype">short</span> <a class="code" href="structDisplaySort.html#m5">abs_x1</a>, <a class="code" href="structDisplaySort.html#m6">abs_x2</a>, <a class="code" href="structDisplaySort.html#m7">abs_y1</a>, <a class="code" href="structDisplaySort.html#m8">abs_y2</a>;
<a name="l00025"></a><a class="code" href="structDisplaySort.html#m9">00025</a>     <span class="keywordtype">char</span>* <a class="code" href="structDisplaySort.html#m9">bitmap_ptr</a>;
00026 };
00027 
00028 <span class="comment">//--- Define constant values for Location::loc_type ---//</span>
00029 
00030 <span class="keyword">enum</span> {
00031     <a class="code" href="Omatrix_8h.html#a12a4">LOC_EMPTY</a>,
00032     <a class="code" href="Omatrix_8h.html#a12a5">LOC_IS_FIRM</a>,
00033     <a class="code" href="Omatrix_8h.html#a12a6">LOC_IS_ROAD</a>,
00034     <a class="code" href="Omatrix_8h.html#a12a7">LOC_IS_ROAD_SUB</a>,                                <span class="comment">// the top-right, bottom-left &amp; bottom-right of the road</span>
00035     <a class="code" href="Omatrix_8h.html#a12a8">LOC_IS_PLANT</a>,
00036     <a class="code" href="Omatrix_8h.html#a12a9">LOC_IS_SPRITE</a>,
00037 };
00038 
00039 <span class="keyword">enum</span> {
00040     <a class="code" href="Omatrix_8h.html#a13a10">LOCATE_WALK_LAND</a> = 0x01,
00041     <span class="comment">//LOCATE_HAS_SPRITE = 0x02,</span>
00042 };
00043 
00044 <span class="comment">//----------- Define class Location -----//</span>
00045 
00049 <span class="keyword">struct </span><a class="code" href="classLocation.html">Location</a> {
00050 <span class="keyword">public</span>:
<a name="l00051"></a><a class="code" href="classLocation.html#m0">00051</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="classLocation.html#m0">loc_flag</a>;
<a name="l00052"></a><a class="code" href="classLocation.html#m1">00052</a>     <span class="keywordtype">char</span>    <a class="code" href="classLocation.html#m1">loc_type</a>;
<a name="l00053"></a><a class="code" href="classLocation.html#m2">00053</a>     <span class="keywordtype">short</span>    <a class="code" href="classLocation.html#m2">cargo_recno</a>;
<a name="l00054"></a><a class="code" href="classLocation.html#m3">00054</a>     <span class="keywordtype">short</span>   <a class="code" href="classLocation.html#m3">extra_para</a>;                           <span class="comment">//char                extra_para;</span>
<a name="l00055"></a><a class="code" href="classLocation.html#m4">00055</a>     <span class="keywordtype">char</span>    <a class="code" href="classLocation.html#m4">terrain_id</a>;
00056 
00057 <span class="keyword">public</span>:
<a name="l00058"></a><a class="code" href="classLocation.html#a9">00058</a>     <span class="keywordtype">int</span>   <a class="code" href="classLocation.html#a9">is_empty</a>()            { <span class="keywordflow">return</span> <a class="code" href="classLocation.html#m1">loc_type</a> == <a class="code" href="Omatrix_8h.html#a12a4">LOC_EMPTY</a>; }
<a name="l00059"></a><a class="code" href="classLocation.html#a10">00059</a>     <span class="keywordtype">void</span>    <a class="code" href="classLocation.html#a10">set_terrain</a>(<span class="keywordtype">int</span> terrainId)  { <a class="code" href="classLocation.html#m4">terrain_id</a> = terrainId; <a class="code" href="classLocation.html#a12">set_walkable_on</a>(); }
00060 
00061     <span class="comment">//---------- for sprite animation functions ---------//</span>
<a name="l00062"></a><a class="code" href="classLocation.html#a11">00062</a>     <span class="keywordtype">int</span>   <a class="code" href="classLocation.html#a11">is_walkable</a>() {                         <span class="comment">//  is_road() || is_road_sub(); }</span>
00063         <span class="keywordflow">return</span> <a class="code" href="classLocation.html#m0">loc_flag</a> &amp; <a class="code" href="Omatrix_8h.html#a13a10">LOCATE_WALK_LAND</a>;
00064     }
<a name="l00065"></a><a class="code" href="classLocation.html#a12">00065</a>     <span class="keywordtype">void</span>    <a class="code" href="classLocation.html#a12">set_walkable_on</a>()   { <a class="code" href="classLocation.html#m0">loc_flag</a> |= <a class="code" href="Omatrix_8h.html#a13a10">LOCATE_WALK_LAND</a>; }
<a name="l00066"></a><a class="code" href="classLocation.html#a13">00066</a>     <span class="keywordtype">void</span>    <a class="code" href="classLocation.html#a13">set_walkable_off</a>()  { <a class="code" href="classLocation.html#m0">loc_flag</a> &amp;= ~<a class="code" href="Omatrix_8h.html#a13a10">LOCATE_WALK_LAND</a>; }
00067 
00068     <span class="comment">//---------- firm functions ---------//</span>
00069 
00070     <span class="keywordtype">void</span>    <a class="code" href="classLocation.html#a14">set_firm</a>(<span class="keywordtype">int</span> firmRecno);
00071     <span class="keywordtype">void</span>    <a class="code" href="classLocation.html#a15">remove_firm</a>();
00072 
<a name="l00073"></a><a class="code" href="classLocation.html#a16">00073</a>     <span class="keywordtype">int</span>   <a class="code" href="classLocation.html#a16">is_firm</a>()   { <span class="keywordflow">return</span> <a class="code" href="classLocation.html#m1">loc_type</a> == <a class="code" href="Omatrix_8h.html#a12a5">LOC_IS_FIRM</a>; }
<a name="l00074"></a><a class="code" href="classLocation.html#a17">00074</a>     <span class="keywordtype">int</span>   <a class="code" href="classLocation.html#a17">firm_recno</a>()  { <span class="keywordflow">return</span> <a class="code" href="classLocation.html#m2">cargo_recno</a>; }
00075 
00076     <span class="comment">//--------- plant functions ---------//</span>
00077 
<a name="l00078"></a><a class="code" href="classLocation.html#a18">00078</a>     <span class="keywordtype">int</span>     <a class="code" href="classLocation.html#a18">is_plant</a>()            { <span class="keywordflow">return</span> <a class="code" href="classLocation.html#m1">loc_type</a>==<a class="code" href="Omatrix_8h.html#a12a8">LOC_IS_PLANT</a>; }
00079     <span class="keywordtype">void</span>    <a class="code" href="classLocation.html#a19">set_plant</a>(<span class="keywordtype">int</span> plantId, <span class="keywordtype">int</span> offsetX, <span class="keywordtype">int</span> offsetY);
00080     <span class="keywordtype">void</span>    <a class="code" href="classLocation.html#a20">remove_plant</a>();
00081 
<a name="l00082"></a><a class="code" href="classLocation.html#a21">00082</a>     <span class="keywordtype">int</span>   <a class="code" href="classLocation.html#a21">plant_id</a>()            { <span class="keywordflow">if</span>( <a class="code" href="classLocation.html#a18">is_plant</a>() ) <span class="keywordflow">return</span> <a class="code" href="classLocation.html#m3">extra_para</a>; <span class="keywordflow">else</span> <span class="keywordflow">return</span> 0; }
<a name="l00083"></a><a class="code" href="classLocation.html#a22">00083</a>     <span class="keywordtype">int</span>   <a class="code" href="classLocation.html#a22">plant_inner_x</a>() {                       <span class="comment">// a percentage from 0% to 100%</span>
00084         <span class="keywordflow">return</span> <a class="code" href="classLocation.html#m2">cargo_recno</a> &amp; 0xFF;
00085     }
<a name="l00086"></a><a class="code" href="classLocation.html#a23">00086</a>     <span class="keywordtype">int</span>   <a class="code" href="classLocation.html#a23">plant_inner_y</a>() {                       <span class="comment">// a percentage from 0% to 100%</span>
00087         <span class="keywordflow">return</span> <a class="code" href="classLocation.html#m2">cargo_recno</a> &gt;&gt; 8;
00088     }
00089 
00090     <span class="comment">//---------- road functions ---------//</span>
00091 
<a name="l00092"></a><a class="code" href="classLocation.html#a24">00092</a>     <span class="keywordtype">int</span>   <a class="code" href="classLocation.html#a24">is_road</a>()           { <span class="keywordflow">return</span> <a class="code" href="classLocation.html#m1">loc_type</a> == <a class="code" href="Omatrix_8h.html#a12a6">LOC_IS_ROAD</a>; }
<a name="l00093"></a><a class="code" href="classLocation.html#a25">00093</a>     <span class="keywordtype">int</span>   <a class="code" href="classLocation.html#a25">is_road_sub</a>()         { <span class="keywordflow">return</span> <a class="code" href="classLocation.html#m1">loc_type</a> == <a class="code" href="Omatrix_8h.html#a12a7">LOC_IS_ROAD_SUB</a>; }
00094     <span class="keywordtype">void</span>    <a class="code" href="classLocation.html#a26">set_road</a>(<span class="keywordtype">int</span> roadId);
<a name="l00095"></a><a class="code" href="classLocation.html#a27">00095</a>     <span class="keywordtype">void</span>    <a class="code" href="classLocation.html#a27">set_road_sub</a>()          { <a class="code" href="classLocation.html#m1">loc_type</a>=<a class="code" href="Omatrix_8h.html#a12a7">LOC_IS_ROAD_SUB</a>; <a class="code" href="classLocation.html#a12">set_walkable_on</a>();}
00096     <span class="keywordtype">void</span>    <a class="code" href="classLocation.html#a28">remove_road</a>();
00097     <span class="comment">//TO? add remove_road_sub();</span>
<a name="l00098"></a><a class="code" href="classLocation.html#a29">00098</a>     <span class="keywordtype">int</span>   <a class="code" href="classLocation.html#a29">road_id</a>()           { <span class="keywordflow">if</span>( <a class="code" href="classLocation.html#a24">is_road</a>() ) <span class="keywordflow">return</span> <a class="code" href="classLocation.html#m2">cargo_recno</a>; <span class="keywordflow">else</span> <span class="keywordflow">return</span> 0; }
00099 
00100     <span class="comment">//---------- sprite functions ---------//</span>
00101 
00102     <span class="keywordtype">void</span>    <a class="code" href="classLocation.html#a30">set_sprite</a>(<span class="keywordtype">int</span> spriteRecno);
00103     <span class="keywordtype">void</span>    <a class="code" href="classLocation.html#a31">remove_sprite</a>();
00104 
<a name="l00105"></a><a class="code" href="classLocation.html#a32">00105</a>     <span class="keywordtype">int</span>   <a class="code" href="classLocation.html#a32">has_sprite</a>()    { <span class="keywordflow">return</span> <a class="code" href="classLocation.html#a11">is_walkable</a>() &amp;&amp; <a class="code" href="classLocation.html#m3">extra_para</a>; }
<a name="l00106"></a><a class="code" href="classLocation.html#a33">00106</a>     <span class="keywordtype">int</span>   <a class="code" href="classLocation.html#a33">sprite_recno</a>()    { <span class="keywordflow">if</span> ( <a class="code" href="classLocation.html#a32">has_sprite</a>() ) <span class="keywordflow">return</span> <a class="code" href="classLocation.html#m3">extra_para</a>; <span class="keywordflow">else</span> <span class="keywordflow">return</span> 0; }
00107 };
00108 
00109 <span class="comment">//--------- define class Matrix ------------//</span>
00110 
00111 <span class="keyword">class </span><a class="code" href="classDynArray.html">DynArray</a>;
00112 
<a name="l00115"></a><a class="code" href="classMatrix.html">00115</a> <span class="keyword">class </span><a class="code" href="classMatrix.html">Matrix</a> {
00116 <span class="keyword">public</span>:
<a name="l00117"></a><a class="code" href="classMatrix.html#m1">00117</a>     <span class="keywordtype">int</span>      <a class="code" href="classMatrix.html#m0">max_x_loc</a>, <a class="code" href="classMatrix.html#m1">max_y_loc</a>;
<a name="l00118"></a><a class="code" href="classMatrix.html#m2">00118</a>     <a class="code" href="classLocation.html">Location</a> *<a class="code" href="classMatrix.html#m2">loc_matrix</a>;
<a name="l00119"></a><a class="code" href="classMatrix.html#m3">00119</a>     <span class="keywordtype">int</span>      <a class="code" href="classMatrix.html#m3">loc_width</a>, <a class="code" href="classMatrix.html#m4">loc_height</a>;
00120 
<a name="l00121"></a><a class="code" href="classMatrix.html#m6">00121</a>     <span class="keywordtype">int</span>      <a class="code" href="classMatrix.html#m5">top_x_loc</a>, <a class="code" href="classMatrix.html#m6">top_y_loc</a>;                <span class="comment">// the top left location of current zoom window</span>
<a name="l00122"></a><a class="code" href="classMatrix.html#m8">00122</a>     <span class="keywordtype">int</span>   <a class="code" href="classMatrix.html#m7">abs_top_x</a>, <a class="code" href="classMatrix.html#m8">abs_top_y</a>;
<a name="l00123"></a><a class="code" href="classMatrix.html#m10">00123</a>     <span class="keywordtype">int</span>      <a class="code" href="classMatrix.html#m9">disp_x_loc</a>, <a class="code" href="classMatrix.html#m10">disp_y_loc</a>;              <span class="comment">// calculated in Matrix()</span>
00124 
<a name="l00125"></a><a class="code" href="classMatrix.html#m14">00125</a>     <span class="keywordtype">int</span>      <a class="code" href="classMatrix.html#m11">win_x1</a>, <a class="code" href="classMatrix.html#m12">win_y1</a>, <a class="code" href="classMatrix.html#m13">win_x2</a>, <a class="code" href="classMatrix.html#m14">win_y2</a>;
<a name="l00126"></a><a class="code" href="classMatrix.html#m15">00126</a>     <span class="keywordtype">int</span>   <a class="code" href="classMatrix.html#m15">win_width</a>, <a class="code" href="classMatrix.html#m16">win_height</a>;
00127 
<a name="l00128"></a><a class="code" href="classMatrix.html#m17">00128</a>     <span class="keywordtype">char</span>    <a class="code" href="classMatrix.html#m17">save_image_flag</a>;
<a name="l00129"></a><a class="code" href="classMatrix.html#m18">00129</a>     <span class="keywordtype">short</span>*  <a class="code" href="classMatrix.html#m18">save_image_buf</a>;
<a name="l00130"></a><a class="code" href="classMatrix.html#m19">00130</a>     <span class="keywordtype">char</span>   <a class="code" href="classMatrix.html#m19">is_image_buf_latest</a>;
00131 
<a name="l00132"></a><a class="code" href="classMatrix.html#m20">00132</a>     <span class="keywordtype">char</span>    <a class="code" href="classMatrix.html#m20">zoom_level</a>;                           <span class="comment">// any of ZOOM_SMALL, ZOOM_MEDIUM, or ZOOM_LARGE</span>
00133 
00134     <span class="keyword">static</span> <a class="code" href="classDynArray.html">DynArray</a> <a class="code" href="classMatrix.html#p0">disp_sort_array</a>;
00135 
00136 <span class="keyword">public</span>:
00137     <a class="code" href="classMatrix.html#a0">Matrix</a>();
00138     <a class="code" href="classMatrix.html#a1">~Matrix</a>();
00139 
00140     <span class="keywordtype">void</span>        <a class="code" href="classMatrix.html#a2">init</a>(<span class="keywordtype">int</span> winX1, <span class="keywordtype">int</span> winY1, <span class="keywordtype">int</span> winX2, <span class="keywordtype">int</span> winY2,
00141                      <span class="keywordtype">int</span> locWidth, <span class="keywordtype">int</span> locHeight, <a class="code" href="classLocation.html">Location</a>* locMatrix,
00142                      <span class="keywordtype">int</span> maxXLoc, <span class="keywordtype">int</span> maxYLoc, <span class="keywordtype">int</span> zoomLevel, <span class="keywordtype">char</span> saveImageFlag=0);
00143 
00144     <span class="keyword">virtual</span> <span class="keywordtype">void</span>  <a class="code" href="classMatrix.html#a3">draw_all</a>();                     <span class="comment">// draw everything on the map</span>
00145     <span class="keyword">virtual</span> <span class="keywordtype">void</span>  <a class="code" href="classMatrix.html#a4">draw_update</a>();                  <span class="comment">// called each frame, only draw portions that need updating</span>
<a name="l00146"></a><a class="code" href="classMatrix.html#a5">00146</a>     <span class="keyword">virtual</span> <span class="keywordtype">int</span>   <a class="code" href="classMatrix.html#a5">detect</a>()    { <span class="keywordflow">return</span> 0; }
00147 
<a name="l00148"></a><a class="code" href="classMatrix.html#a6">00148</a>     <span class="keywordtype">void</span>        <a class="code" href="classMatrix.html#a6">reset_image_buf</a>()   { <a class="code" href="classMatrix.html#m19">is_image_buf_latest</a>=0; }
00149 
00150     <span class="keywordtype">void</span>        <a class="code" href="classMatrix.html#a7">put_center_text</a>(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">char</span>* str);
00151 
00152     <span class="keywordtype">void</span>        <a class="code" href="classMatrix.html#a8">set_top_loc</a>(<span class="keywordtype">int</span> topXLoc, <span class="keywordtype">int</span> topYLoc);
00153     <span class="keywordtype">void</span>        <a class="code" href="classMatrix.html#a9">loc_to_abs_top_left</a>(<span class="keywordtype">int</span>&amp; absX, <span class="keywordtype">int</span>&amp; absY, <span class="keywordtype">int</span> locX, <span class="keywordtype">int</span> locY);
00154     <span class="keywordtype">void</span>        <a class="code" href="classMatrix.html#a10">loc_to_abs_center_left</a>(<span class="keywordtype">int</span>&amp; absX, <span class="keywordtype">int</span>&amp; absY, <span class="keywordtype">int</span> locX, <span class="keywordtype">int</span> locY);
00155     <span class="keywordtype">void</span>        <a class="code" href="classMatrix.html#a11">loc_to_abs_bottom_right</a>(<span class="keywordtype">int</span>&amp; absX, <span class="keywordtype">int</span>&amp; absY, <span class="keywordtype">int</span> locX, <span class="keywordtype">int</span> locY);
00156     <span class="keywordtype">void</span>        <a class="code" href="classMatrix.html#a12">abs_to_loc</a>(<span class="keywordtype">int</span>&amp; locX, <span class="keywordtype">int</span>&amp; locY, <span class="keywordtype">int</span> absX, <span class="keywordtype">int</span> absY);
00157 
00158 <span class="keyword">protected</span>:
00159 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00160 <span class="preprocessor"></span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span>  draw_text();                    <span class="comment">// called by draw_all</span>
00161 <span class="preprocessor">#endif</span>
00162 <span class="preprocessor"></span>
00163 <span class="keyword">private</span>:
00164     <span class="keywordtype">void</span>        draw_objects();
00165     <span class="keywordtype">void</span>        draw_objects_now(<a class="code" href="classDynArray.html">DynArray</a>* dispSortArray);
00166 
00167     <span class="keywordtype">void</span>        draw_terrain(<span class="keywordtype">int</span> xLoc, <span class="keywordtype">int</span> yLoc, <span class="keywordtype">int</span> terrainId);
00168     <span class="keywordtype">void</span>        draw_plant(<span class="keywordtype">int</span> xLoc, <span class="keywordtype">int</span> yLoc, <span class="keywordtype">int</span> terrainId);
00169     <span class="keywordtype">void</span>        draw_bitmap(<span class="keywordtype">int</span> absX, <span class="keywordtype">int</span> absY, <span class="keywordtype">char</span>* bmpPtr);
00170 };
00171 
00172 <span class="comment">//------------------------------------------//</span>
00173 <span class="preprocessor">#endif</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:38:05 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
