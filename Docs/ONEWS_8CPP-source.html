<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ONEWS.CPP Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>ONEWS.CPP</h1><a href="ONEWS_8CPP.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : ONEWS_IF.CPP</span>
00002 <span class="comment">//Description : Object NewsArray; including sys, font related functions.</span>
00003 <span class="comment">//Owner                 :Fred</span>
00004 
00005 <span class="preprocessor">#include &lt;OFONT.H&gt;</span>
00006 <span class="preprocessor">#include &lt;OINFO.H&gt;</span>
00007 <span class="preprocessor">#include &lt;OFINANCE.H&gt;</span>
00008 
00009 <span class="preprocessor">#include &lt;ONEWS.H&gt;</span>
00010 
00011 <span class="comment">//------- define screen coordinations -------//</span>
00012 <span class="comment">//--------- define static vars --------------//</span>
00013 
00014 <span class="comment">//------ Begin of function NewsArray::NewsArray -----//</span>
00015 
<a name="l00016"></a><a class="code" href="classNewsArray.html#a0">00016</a> <a class="code" href="classNewsArray.html#a0">NewsArray::NewsArray</a>() : <a class="code" href="classDynArray.html">DynArray</a>(sizeof(<a class="code" href="structNews.html">News</a>), 100) {
00017 }
00018 
00019 <span class="comment">//-------- End of function NewsArray::NewsArray -----//</span>
00020 
00021 <span class="comment">//------ Begin of function NewsArray::init -----//</span>
<a name="l00023"></a><a class="code" href="classNewsArray.html#a1">00023</a> <span class="comment">void NewsArray::init() {</span>
00024     reset();
00025 }
00026 
00027 <span class="comment">//------- End of function NewsArray::init -----//</span>
00028 
00029 <span class="comment">//------ Begin of function NewsArray::deinit -----//</span>
<a name="l00031"></a><a class="code" href="classNewsArray.html#a2">00031</a> <span class="comment">void NewsArray::deinit() {</span>
00032     reset();
00033 }
00034 
00035 <span class="comment">//------- End of function NewsArray::deinit -----//</span>
00036 
00037 <span class="comment">//------ Begin of function NewsArray::reset -----//</span>
<a name="l00041"></a><a class="code" href="classNewsArray.html#a7">00041</a> <span class="comment">void NewsArray::reset() {</span>
00042     zap();                                          <span class="comment">// clear all news in the log</span>
00043 
00044     last_clear_recno = 0;
00045     news_add_flag    = 1;
00046 
00047     default_setting();
00048 }
00049 
00050 <span class="comment">//------- End of function NewsArray::reset -----//</span>
00051 
00052 <span class="comment">//------ Begin of function NewsArray::default_setting -----//</span>
<a name="l00056"></a><a class="code" href="classNewsArray.html#a8">00056</a> <span class="comment">void NewsArray::default_setting() {</span>
00057     news_type_option[<a class="code" href="Onews_8h.html#a47a6">NEWS_NORMAL</a>]=1;
00058 
00059     news_who_option = <a class="code" href="Onews_8h.html#a49a8">NEWS_DISP_ALL</a>;                <span class="comment">// default display news of groups controlled by the player</span>
00060 }
00061 
00062 <span class="comment">//------- End of function NewsArray::default_setting -----//</span>
00063 
00064 <span class="comment">//------ Begin of function NewsArray::remove -----//</span>
<a name="l00071"></a><a class="code" href="classNewsArray.html#a11">00071</a> <span class="comment">void NewsArray::remove(int newsId, int shortPara1) {</span>
00072     <a class="code" href="structNews.html">News</a>* newsPtr;
00073 
00074     <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=size() ; i&gt;0 ; i-- ) {
00075         newsPtr = news_array[i];
00076 
00077         <span class="keywordflow">if</span>( newsPtr-&gt;<a class="code" href="structNews.html#m0">id</a> == newsId &amp;&amp;
00078             newsPtr-&gt;<a class="code" href="structNews.html#m5">short_para1</a> == shortPara1 ) {
00079             linkout(i);
00080 
00081             <span class="comment">//### begin alex 31/3 ###//</span>
00082             <span class="comment">//if( i&lt;last_clear_recno &amp;&amp; last_clear_recno &gt; 1 )</span>
00083             <span class="keywordflow">if</span>( i&lt;=last_clear_recno &amp;&amp; last_clear_recno &gt; 0 )
00084                 last_clear_recno--;
00085             <span class="comment">//#### end alex 31/3 ####//</span>
00086 
00087             <span class="keywordflow">break</span>;
00088         }
00089     }
00090 }
00091 
00092 <span class="comment">//------- End of function NewsArray::remove -----//</span>
00093 
00094 <span class="comment">//------- Begin of function NewsArray::operator[] -----//</span>
00095 
<a name="l00096"></a><a class="code" href="classNewsArray.html#a40">00096</a> <a class="code" href="structNews.html">News</a>* <a class="code" href="classNewsArray.html#a40">NewsArray::operator[]</a>(<span class="keywordtype">int</span> recNo) {
00097 <span class="preprocessor">#ifdef DEBUG</span>
00098 <span class="preprocessor"></span>
00099     <a class="code" href="structNews.html">News</a>* msgPtr;
00100 
00101     <span class="keywordflow">if</span>( recNo )
00102         msgPtr = (<a class="code" href="structNews.html">News</a>*) <a class="code" href="classDynArray.html#a13">get</a>(recNo);
00103     <span class="keywordflow">else</span>
00104         msgPtr = <a class="code" href="OHELP_8H.html#a0">NULL</a>;                                <span class="comment">// NULL will then cause error</span>
00105 
00106     <a class="code" href="ALL_8H.html#a2">err_if</a>( !msgPtr || msgPtr-&gt;<a class="code" href="structNews.html#m4">news_date</a>==0 )
00107         <a class="code" href="ALL_8H.html#a4">err_now</a>( <span class="stringliteral">"NewsArray[] is deleted"</span> );
00108 
00109     <span class="keywordflow">return</span> msgPtr;
00110 
00111 <span class="preprocessor">#else</span>
00112 <span class="preprocessor"></span>
00113     <span class="keywordflow">return</span> (<a class="code" href="structNews.html">News</a>*) <a class="code" href="classDynArray.html#a13">get</a>(recNo);
00114 <span class="preprocessor">#endif</span>
00115 <span class="preprocessor"></span>}
00116 
00117 <span class="comment">//--------- End of function NewsArray::operator[] ----//</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:38:08 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
