<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>MYEXCEPT.CPP Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>MYEXCEPT.CPP</h1><a href="MYEXCEPT_8CPP.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Owner: Fred</span>
00002 <span class="comment">//$$myexcept.cpp                        Exception handler</span>
00003 
00004 <span class="comment">// Copyright (C) 1993,4,6: R B Davies</span>
00005 
<a name="l00006"></a><a class="code" href="MYEXCEPT_8CPP.html#a0">00006</a> <span class="preprocessor">#define WANT_STREAM                               // include.h will get stream fns</span>
00007 <span class="preprocessor"></span>
00008 <span class="preprocessor">#include &lt;string.h&gt;</span>                               <span class="comment">// C string library</span>
00009 
00010 <span class="preprocessor">#include "include.h"</span>                              <span class="comment">// include standard files</span>
00011 <span class="comment">//#include "boolean.h"</span>
00012 
00013 <span class="preprocessor">#include "myexcept.h"</span>                             <span class="comment">// for exception handling</span>
00014 
<a name="l00015"></a><a class="code" href="MYEXCEPT_8CPP.html#a1">00015</a> <span class="preprocessor">#define DEBUG_VC</span>
00016 <span class="preprocessor"></span><span class="preprocessor">#ifdef DEBUG_VC</span>
00017 <span class="preprocessor"></span><span class="preprocessor">#include &lt;OLog.h&gt;</span>
00018 <span class="preprocessor">#endif</span>
00019 <span class="preprocessor"></span>
00020 <span class="preprocessor">#ifdef use_namespace</span>
00021 <span class="preprocessor"></span><span class="keyword">namespace </span>RBD_COMMON {
00022 <span class="preprocessor">#endif</span>
00023 <span class="preprocessor"></span>
00024     <span class="comment">//#define REG_DEREG                    // for print out uses of new/delete</span>
00025     <span class="comment">//#define CLEAN_LIST                   // to print entries being added to</span>
00026     <span class="comment">// or deleted from cleanup list</span>
00027 
00028 <span class="preprocessor">#ifdef SimulateExceptions</span>
00029 <span class="preprocessor"></span>
00030     <span class="keywordtype">void</span> Throw() {
00031         <span class="keywordflow">for</span> (<a class="code" href="classJanitor.html">Janitor</a>* jan = JumpBase::jl-&gt;janitor; jan; jan = jan-&gt;NextJanitor)
00032             jan-&gt;<a class="code" href="classJanitor.html#a0">CleanUp</a>();
00033         JumpBase::jl = JumpBase::jl-&gt;ji;
00034         <span class="keywordflow">if</span> ( ! JumpBase::jl ) <a class="code" href="namespaceRBD__COMMON.html#a2">Terminate</a>();
00035         <a class="code" href="classTracer.html#p0">Tracer::last</a> = JumpBase::jl-&gt;trace;
00036         longjmp(JumpBase::jl-&gt;env, 1);
00037     }
00038 <span class="preprocessor">#endif                                          // end of simulate exceptions</span>
00039 <span class="preprocessor"></span>
00040     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="classException.html#p0">Exception::Select</a>;
00041     <span class="keywordtype">char</span>* <a class="code" href="classException.html#q0">Exception::what_error</a>;
00042     <span class="keywordtype">int</span> <a class="code" href="classException.html#q1">Exception::SoFar</a>;
00043     <span class="keywordtype">int</span> <a class="code" href="classException.html#q2">Exception::LastOne</a>;
00044 
00045     <a class="code" href="classException.html#a0">Exception::Exception</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* a_what) {
00046         Select++; SoFar = 0;
00047         <span class="keywordflow">if</span> (!what_error) {                            <span class="comment">// make space for exception message</span>
00048             LastOne = 511;
00049             what_error = <span class="keyword">new</span> <span class="keywordtype">char</span>[512];
00050             <span class="keywordflow">if</span> (!what_error) {                          <span class="comment">// fail to make space</span>
00051                 LastOne = 0;
00052                 what_error = <span class="stringliteral">"No heap space for exception message\n"</span>;
00053             }
00054         }
00055         AddMessage(<span class="stringliteral">"\n\nAn exception has been thrown\n"</span>);
00056         AddMessage(a_what);
00057         <span class="keywordflow">if</span> (a_what) <a class="code" href="classTracer.html#d1">Tracer::AddTrace</a>();
00058     }
00059 
00060     <span class="keywordtype">void</span> <a class="code" href="classException.html#d0">Exception::AddMessage</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* a_what) {
00061         <span class="keywordflow">if</span> (a_what) {
00062             <span class="keywordtype">int</span> l = strlen(a_what); <span class="keywordtype">int</span> r = LastOne - SoFar;
00063             <span class="keywordflow">if</span> (l &lt; r) { strcpy(what_error+SoFar, a_what); SoFar += l; }
00064             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r &gt; 0) {
00065                 strncpy(what_error+SoFar, a_what, r);
00066                 what_error[LastOne] = 0;
00067                 SoFar = LastOne;
00068             }
00069         }
00070     }
00071 
00072     <span class="keywordtype">void</span> <a class="code" href="classException.html#d1">Exception::AddInt</a>(<span class="keywordtype">int</span> value) {
00073         <span class="keywordtype">bool</span> negative;
00074         <span class="keywordflow">if</span> (value == 0) { AddMessage(<span class="stringliteral">"0"</span>); <span class="keywordflow">return</span>; }
00075         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (value &lt; 0) { value = -value; negative = <span class="keyword">true</span>; }
00076         <span class="keywordflow">else</span> negative = <span class="keyword">false</span>;
00077         <span class="keywordtype">int</span> n = 0; <span class="keywordtype">int</span> v = value;                     <span class="comment">// how many digits will we need?</span>
00078         <span class="keywordflow">while</span> (v &gt; 0) { v /= 10; n++; }
00079         <span class="keywordflow">if</span> (negative) n++;
00080         <span class="keywordflow">if</span> (LastOne-SoFar &lt; n) { AddMessage(<span class="stringliteral">"***"</span>); <span class="keywordflow">return</span>; }
00081 
00082         SoFar += n; n = SoFar; what_error[n] = 0;
00083         <span class="keywordflow">while</span> (value &gt; 0) {
00084             <span class="keywordtype">int</span> nv = value / 10; <span class="keywordtype">int</span> rm = value - nv * 10;  value = nv;
00085             what_error[--n] = (char)(rm + <span class="charliteral">'0'</span>);
00086         }
00087         <span class="keywordflow">if</span> (negative) what_error[--n] = <span class="charliteral">'-'</span>;
00088         <span class="keywordflow">return</span>;
00089     }
00090 
00091     <span class="keywordtype">void</span> <a class="code" href="classTracer.html#d0">Tracer::PrintTrace</a>() {
00092         cout &lt;&lt; <span class="stringliteral">"\n"</span>;
00093         <span class="keywordflow">for</span> (<a class="code" href="classTracer.html">Tracer</a>* et = last; et; et=et-&gt;<a class="code" href="classTracer.html#o1">previous</a>)
00094             cout &lt;&lt; <span class="stringliteral">"  * "</span> &lt;&lt; et-&gt;<a class="code" href="classTracer.html#o0">entry</a> &lt;&lt; <span class="stringliteral">"\n"</span>;
00095     }
00096 
00097     <span class="keywordtype">void</span> <a class="code" href="classTracer.html#d1">Tracer::AddTrace</a>() {
00098         <span class="keywordflow">if</span> (last) {
00099             <a class="code" href="classException.html#d0">Exception::AddMessage</a>(<span class="stringliteral">"Trace: "</span>);
00100             <a class="code" href="classException.html#d0">Exception::AddMessage</a>(last-&gt;entry);
00101             <span class="keywordflow">for</span> (<a class="code" href="classTracer.html">Tracer</a>* et = last-&gt;previous; et; et=et-&gt;<a class="code" href="classTracer.html#o1">previous</a>) {
00102                 <a class="code" href="classException.html#d0">Exception::AddMessage</a>(<span class="stringliteral">"; "</span>);
00103                 <a class="code" href="classException.html#d0">Exception::AddMessage</a>(et-&gt;<a class="code" href="classTracer.html#o0">entry</a>);
00104             }
00105             <a class="code" href="classException.html#d0">Exception::AddMessage</a>(<span class="stringliteral">".\n"</span>);
00106         }
00107     }
00108 
00109 <span class="preprocessor">#ifdef SimulateExceptions</span>
00110 <span class="preprocessor"></span>
00111     <a class="code" href="classJanitor.html#a1">Janitor::Janitor</a>() {
00112         <span class="keywordflow">if</span> (do_not_link) {
00113             do_not_link = <span class="keyword">false</span>; NextJanitor = 0; OnStack = <span class="keyword">false</span>;
00114 <span class="preprocessor">#ifdef CLEAN_LIST</span>
00115 <span class="preprocessor"></span>            cout &lt;&lt; <span class="stringliteral">"Not added to clean-list "</span> &lt;&lt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)<span class="keyword">this</span> &lt;&lt; <span class="stringliteral">"\n"</span>;
00116 <span class="preprocessor">#endif</span>
00117 <span class="preprocessor"></span>        }
00118         <span class="keywordflow">else</span> {
00119             OnStack = <span class="keyword">true</span>;
00120 <span class="preprocessor">#ifdef CLEAN_LIST</span>
00121 <span class="preprocessor"></span>            cout &lt;&lt; <span class="stringliteral">"Add to       clean-list "</span> &lt;&lt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)<span class="keyword">this</span> &lt;&lt; <span class="stringliteral">"\n"</span>;
00122 <span class="preprocessor">#endif</span>
00123 <span class="preprocessor"></span>            NextJanitor = JumpBase::jl-&gt;janitor; JumpBase::jl-&gt;janitor=<span class="keyword">this</span>;
00124         }
00125     }
00126 
00127     <a class="code" href="classJanitor.html#a2">Janitor::~Janitor</a>() {
00128         <span class="comment">// expect the item to be deleted to be first on list</span>
00129         <span class="comment">// but must be prepared to search list</span>
00130         <span class="keywordflow">if</span> (OnStack) {
00131 <span class="preprocessor">#ifdef CLEAN_LIST</span>
00132 <span class="preprocessor"></span>            cout &lt;&lt; <span class="stringliteral">"Delete from  clean-list "</span> &lt;&lt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)<span class="keyword">this</span> &lt;&lt; <span class="stringliteral">"\n"</span>;
00133 <span class="preprocessor">#endif</span>
00134 <span class="preprocessor"></span>            <a class="code" href="classJanitor.html">Janitor</a>* lastjan = JumpBase::jl-&gt;janitor;
00135             <span class="keywordflow">if</span> (<span class="keyword">this</span> == lastjan) JumpBase::jl-&gt;janitor = NextJanitor;
00136             <span class="keywordflow">else</span> {
00137                 <span class="keywordflow">for</span> (<a class="code" href="classJanitor.html">Janitor</a>* jan = lastjan-&gt;NextJanitor; jan;
00138                      jan = lastjan-&gt;NextJanitor) {
00139                     <span class="keywordflow">if</span> (jan==<span class="keyword">this</span>)
00140                     { lastjan-&gt;NextJanitor = jan-&gt;NextJanitor; <span class="keywordflow">return</span>; }
00141                     lastjan=jan;
00142                 }
00143 
00144                 <span class="comment">/* fred 0526*/</span>
00145                 Throw(<a class="code" href="classException.html">Exception</a>(
00146                     <span class="stringliteral">"Cannot resolve memory linked list\nSee notes in myexcept.cpp for details\n"</span>
00147                     ));
00148                 
00149                 <span class="comment">/*</span>
00150 <span class="comment"></span>
00151 <span class="comment">                  This message occurs when a call to ~Janitor() occurs, apparently</span>
00152 <span class="comment">                  without a corresponding call to Janitor(). This could happen if my</span>
00153 <span class="comment">                  way of deciding whether a constructor is being called by new</span>
00154 <span class="comment">                  fails. It can also happen if you have a class derived from Janitor</span>
00155 <span class="comment">                  which does not include a copy constructor [ eg X(const &amp;X) ].</span>
00156 <span class="comment">                  Possibly also if delete is applied an object on the stack (ie not</span>
00157 <span class="comment">                  called by new). Otherwise, it is a bug in Newmat or your compiler.</span>
00158 <span class="comment">                  If you don't #define TEMPS_DESTROYED_QUICKLY you will get this</span>
00159 <span class="comment">                  error with Microsoft C 7.0. There are probably situations where</span>
00160 <span class="comment">                  you will get this when you do define TEMPS_DESTROYED_QUICKLY. This</span>
00161 <span class="comment">                  is a bug in MSC. Beware of "operator" statements for defining</span>
00162 <span class="comment">                  conversions; particularly for converting from a Base class to a</span>
00163 <span class="comment">                  Derived class.</span>
00164 <span class="comment"></span>
00165 <span class="comment">                  You may get away with simply deleting this error message and Throw</span>
00166 <span class="comment">                  statement if you can't find a better way of overcoming the</span>
00167 <span class="comment">                  problem. In any case please tell me if you get this error message,</span>
00168 <span class="comment">                  particularly for compilers apart from Microsoft C 7.0.</span>
00169 <span class="comment"></span>
00170 <span class="comment">                */</span>
00171 
00172             }
00173         }
00174     }
00175 
00176     JumpItem* JumpBase::jl;                         <span class="comment">// will be set to zero</span>
00177     jmp_buf JumpBase::env;
00178     <span class="keywordtype">bool</span> Janitor::do_not_link;                      <span class="comment">// will be set to false</span>
00179 
00180     <span class="keywordtype">int</span> JanitorInitializer::ref_count;
00181 
00182     JanitorInitializer::JanitorInitializer() {
00183         <span class="keywordflow">if</span> (ref_count++ == 0) <span class="keyword">new</span> JumpItem;
00184         <span class="comment">// need JumpItem at head of list</span>
00185     }
00186 <span class="preprocessor">#endif                                          // end of SimulateExceptions</span>
00187 <span class="preprocessor"></span>
00188     <a class="code" href="classTracer.html">Tracer</a>* <a class="code" href="classTracer.html#p0">Tracer::last</a>;                           <span class="comment">// will be set to zero</span>
00189 
<a name="l00190"></a><a class="code" href="MYEXCEPT_8CPP.html#a2">00190</a>     <span class="keywordtype">void</span> <a class="code" href="MYEXCEPT_8CPP.html#a2">Terminate</a>() {
00191         cout &lt;&lt; <span class="stringliteral">"\n\nThere has been an exception with no handler - exiting"</span>;
00192         <span class="keyword">const</span> <span class="keywordtype">char</span>* what = <a class="code" href="classException.html#d2">Exception::what</a>();
00193 
00194         <a class="code" href="OLOG_8H.html#a6">DEBUG_LOG</a>(<span class="stringliteral">"--- MyExcept.cpp: Terminate() ---\n"</span>);
00195         <span class="keywordflow">if</span> (what) {
00196             cout &lt;&lt; what &lt;&lt; <span class="stringliteral">"\n"</span>;
00197 <span class="preprocessor">#ifdef DEBUG_VC</span>
00198 <span class="preprocessor"></span>            <a class="code" href="OLOG_8H.html#a6">DEBUG_LOG</a>((<span class="keywordtype">char</span> *)what);  <a class="code" href="OLOG_8H.html#a6">DEBUG_LOG</a>(<span class="stringliteral">"\n"</span>);
00199 <span class="preprocessor">#endif</span>
00200 <span class="preprocessor"></span>        }
00201         exit(1);
00202     }
00203 
00204 <span class="preprocessor">#ifdef DO_FREE_CHECK</span>
00205 <span class="preprocessor"></span>    <span class="comment">// Routines for tracing whether new and delete calls are balanced</span>
00206 
00207     FreeCheckLink::FreeCheckLink() : next(FreeCheck::next)
00208     { FreeCheck::next = <span class="keyword">this</span>; }
00209 
00210     FCLClass::FCLClass(<span class="keywordtype">void</span>* t, <span class="keywordtype">char</span>* name) : ClassName(name) { ClassStore=t; }
00211 
00212     FCLRealArray::FCLRealArray(<span class="keywordtype">void</span>* t, <span class="keywordtype">char</span>* o, <span class="keywordtype">int</span> s)
00213         : Operation(o), size(s) { ClassStore=t; }
00214 
00215     FCLIntArray::FCLIntArray(<span class="keywordtype">void</span>* t, <span class="keywordtype">char</span>* o, <span class="keywordtype">int</span> s)
00216         : Operation(o), size(s) { ClassStore=t; }
00217 
00218     FreeCheckLink* FreeCheck::next;
00219     <span class="keywordtype">int</span> FreeCheck::BadDelete;
00220 
00221     <span class="keywordtype">void</span> FCLClass::Report()
00222     { cout &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; ClassName &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)ClassStore &lt;&lt; <span class="stringliteral">"\n"</span>; }
00223 
00224     <span class="keywordtype">void</span> FCLRealArray::Report() {
00225         cout &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; Operation &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)ClassStore &lt;&lt;
00226             <span class="stringliteral">"   "</span> &lt;&lt; size &lt;&lt; <span class="stringliteral">"\n"</span>;
00227     }
00228 
00229     <span class="keywordtype">void</span> FCLIntArray::Report() {
00230         cout &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; Operation &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)ClassStore &lt;&lt;
00231             <span class="stringliteral">"   "</span> &lt;&lt; size &lt;&lt; <span class="stringliteral">"\n"</span>;
00232     }
00233 
00234     <span class="keywordtype">void</span> FreeCheck::Register(<span class="keywordtype">void</span>* t, <span class="keywordtype">char</span>* name) {
00235         FCLClass* f = <span class="keyword">new</span> FCLClass(t,name);
00236         <span class="keywordflow">if</span> (!f) { cout &lt;&lt; <span class="stringliteral">"Out of memory in FreeCheck\n"</span>; exit(1); }
00237 <span class="preprocessor">#ifdef REG_DEREG</span>
00238 <span class="preprocessor"></span>        cout &lt;&lt; <span class="stringliteral">"Registering   "</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)t &lt;&lt; <span class="stringliteral">"\n"</span>;
00239 <span class="preprocessor">#endif</span>
00240 <span class="preprocessor"></span>    }
00241 
00242     <span class="keywordtype">void</span> FreeCheck::RegisterR(<span class="keywordtype">void</span>* t, <span class="keywordtype">char</span>* o, <span class="keywordtype">int</span> s) {
00243         FCLRealArray* f = <span class="keyword">new</span> FCLRealArray(t,o,s);
00244         <span class="keywordflow">if</span> (!f) { cout &lt;&lt; <span class="stringliteral">"Out of memory in FreeCheck\n"</span>; exit(1); }
00245 <span class="preprocessor">#ifdef REG_DEREG</span>
00246 <span class="preprocessor"></span>        cout &lt;&lt; o &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; s &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)t &lt;&lt; <span class="stringliteral">"\n"</span>;
00247 <span class="preprocessor">#endif</span>
00248 <span class="preprocessor"></span>    }
00249 
00250     <span class="keywordtype">void</span> FreeCheck::RegisterI(<span class="keywordtype">void</span>* t, <span class="keywordtype">char</span>* o, <span class="keywordtype">int</span> s) {
00251         FCLIntArray* f = <span class="keyword">new</span> FCLIntArray(t,o,s);
00252         <span class="keywordflow">if</span> (!f) { cout &lt;&lt; <span class="stringliteral">"Out of memory in FreeCheck\n"</span>; exit(1); }
00253 <span class="preprocessor">#ifdef REG_DEREG</span>
00254 <span class="preprocessor"></span>        cout &lt;&lt; o &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; s &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)t &lt;&lt; <span class="stringliteral">"\n"</span>;
00255 <span class="preprocessor">#endif</span>
00256 <span class="preprocessor"></span>    }
00257 
00258     <span class="keywordtype">void</span> FreeCheck::DeRegister(<span class="keywordtype">void</span>* t, <span class="keywordtype">char</span>* name) {
00259         FreeCheckLink* last = 0;
00260 <span class="preprocessor">#ifdef REG_DEREG</span>
00261 <span class="preprocessor"></span>        cout &lt;&lt; <span class="stringliteral">"Deregistering "</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)t &lt;&lt; <span class="stringliteral">"\n"</span>;
00262 <span class="preprocessor">#endif</span>
00263 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (FreeCheckLink* fcl = next; fcl; fcl = fcl-&gt;next) {
00264             <span class="keywordflow">if</span> (fcl-&gt;ClassStore==t) {
00265                 <span class="keywordflow">if</span> (last) last-&gt;next = fcl-&gt;next; <span class="keywordflow">else</span> next = fcl-&gt;next;
00266                 <span class="keyword">delete</span> fcl; <span class="keywordflow">return</span>;
00267             }
00268             last = fcl;
00269         }
00270         cout &lt;&lt; <span class="stringliteral">"\nRequest to delete non-existent object of class and location:\n"</span>;
00271         cout &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)t &lt;&lt; <span class="stringliteral">"\n"</span>;
00272         BadDelete++;
00273         <a class="code" href="classTracer.html#d0">Tracer::PrintTrace</a>();
00274         cout &lt;&lt; <span class="stringliteral">"\n"</span>;
00275     }
00276 
00277     <span class="keywordtype">void</span> FreeCheck::DeRegisterR(<span class="keywordtype">void</span>* t, <span class="keywordtype">char</span>* o, <span class="keywordtype">int</span> s) {
00278         FreeCheckLink* last = 0;
00279 <span class="preprocessor">#ifdef REG_DEREG</span>
00280 <span class="preprocessor"></span>        cout &lt;&lt; o &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; s &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)t &lt;&lt; <span class="stringliteral">"\n"</span>;
00281 <span class="preprocessor">#endif</span>
00282 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (FreeCheckLink* fcl = next; fcl; fcl = fcl-&gt;next) {
00283             <span class="keywordflow">if</span> (fcl-&gt;ClassStore==t) {
00284                 <span class="keywordflow">if</span> (last) last-&gt;next = fcl-&gt;next; <span class="keywordflow">else</span> next = fcl-&gt;next;
00285                 <span class="keywordflow">if</span> (s &gt;= 0 &amp;&amp; ((FCLRealArray*)fcl)-&gt;size != s) {
00286                     cout &lt;&lt; <span class="stringliteral">"\nArray sizes don't agree:\n"</span>;
00287                     cout &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; o &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)t
00288                          &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; ((FCLRealArray*)fcl)-&gt;size &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; s &lt;&lt; <span class="stringliteral">"\n"</span>;
00289                     <a class="code" href="classTracer.html#d0">Tracer::PrintTrace</a>();
00290                     cout &lt;&lt; <span class="stringliteral">"\n"</span>;
00291                 }
00292                 <span class="keyword">delete</span> fcl; <span class="keywordflow">return</span>;
00293             }
00294             last = fcl;
00295         }
00296         cout &lt;&lt; <span class="stringliteral">"\nRequest to delete non-existent real array:\n"</span>;
00297         cout &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; o &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)t &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; s &lt;&lt; <span class="stringliteral">"\n"</span>;
00298         BadDelete++;
00299         <a class="code" href="classTracer.html#d0">Tracer::PrintTrace</a>();
00300         cout &lt;&lt; <span class="stringliteral">"\n"</span>;
00301     }
00302 
00303     <span class="keywordtype">void</span> FreeCheck::DeRegisterI(<span class="keywordtype">void</span>* t, <span class="keywordtype">char</span>* o, <span class="keywordtype">int</span> s) {
00304         FreeCheckLink* last = 0;
00305 <span class="preprocessor">#ifdef REG_DEREG</span>
00306 <span class="preprocessor"></span>        cout &lt;&lt; o &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; s &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)t &lt;&lt; <span class="stringliteral">"\n"</span>;
00307 <span class="preprocessor">#endif</span>
00308 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (FreeCheckLink* fcl = next; fcl; fcl = fcl-&gt;next) {
00309             <span class="keywordflow">if</span> (fcl-&gt;ClassStore==t) {
00310                 <span class="keywordflow">if</span> (last) last-&gt;next = fcl-&gt;next; <span class="keywordflow">else</span> next = fcl-&gt;next;
00311                 <span class="keywordflow">if</span> (s &gt;= 0 &amp;&amp; ((FCLIntArray*)fcl)-&gt;size != s) {
00312                     cout &lt;&lt; <span class="stringliteral">"\nArray sizes don't agree:\n"</span>;
00313                     cout &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; o &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)t
00314                          &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; ((FCLIntArray*)fcl)-&gt;size &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; s &lt;&lt; <span class="stringliteral">"\n"</span>;
00315                     <a class="code" href="classTracer.html#d0">Tracer::PrintTrace</a>();
00316                     cout &lt;&lt; <span class="stringliteral">"\n"</span>;
00317                 }
00318                 <span class="keyword">delete</span> fcl; <span class="keywordflow">return</span>;
00319             }
00320             last = fcl;
00321         }
00322         cout &lt;&lt; <span class="stringliteral">"\nRequest to delete non-existent int array:\n"</span>;
00323         cout &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; o &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)t &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; s &lt;&lt; <span class="stringliteral">"\n"</span>;
00324         BadDelete++;
00325         <a class="code" href="classTracer.html#d0">Tracer::PrintTrace</a>();
00326         cout &lt;&lt; <span class="stringliteral">"\n"</span>;
00327     }
00328 
00329     <span class="keywordtype">void</span> FreeCheck::Status() {
00330         <span class="keywordflow">if</span> (next) {
00331             cout &lt;&lt; <span class="stringliteral">"\nObjects of the following classes remain undeleted:\n"</span>;
00332             <span class="keywordflow">for</span> (FreeCheckLink* fcl = next; fcl; fcl = fcl-&gt;next) fcl-&gt;Report();
00333             cout &lt;&lt; <span class="stringliteral">"\n"</span>;
00334         }
00335         <span class="keywordflow">else</span> cout &lt;&lt; <span class="stringliteral">"\nNo objects remain undeleted\n\n"</span>;
00336         <span class="keywordflow">if</span> (BadDelete) {
00337             cout &lt;&lt; <span class="stringliteral">"\nThere were "</span> &lt;&lt; BadDelete &lt;&lt;
00338                 <span class="stringliteral">" requests to delete non-existent items\n\n"</span>;
00339         }
00340     }
00341 <span class="preprocessor">#endif                                          // end of DO_FREE_CHECK</span>
00342 <span class="preprocessor"></span>
00343     <span class="comment">// derived exception bodies</span>
00344 
00345     <a class="code" href="classLogic__error.html#a0">Logic_error::Logic_error</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* a_what) : <a class="code" href="classException.html">Exception</a>() {
00346         Select = <a class="code" href="classException.html#p0">Exception::Select</a>;
00347         AddMessage(<span class="stringliteral">"Logic error:- "</span>); AddMessage(a_what);
00348         <span class="keywordflow">if</span> (a_what) <a class="code" href="classTracer.html#d1">Tracer::AddTrace</a>();
00349     }
00350 
00351     <a class="code" href="classRuntime__error.html#a0">Runtime_error::Runtime_error</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* a_what)
00352         : <a class="code" href="classException.html">Exception</a>() {
00353         Select = <a class="code" href="classException.html#p0">Exception::Select</a>;
00354         AddMessage(<span class="stringliteral">"Runtime error:- "</span>); AddMessage(a_what);
00355         <span class="keywordflow">if</span> (a_what) <a class="code" href="classTracer.html#d1">Tracer::AddTrace</a>();
00356     }
00357 
00358     <a class="code" href="classDomain__error.html#a0">Domain_error::Domain_error</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* a_what) : <a class="code" href="classLogic__error.html">Logic_error</a>() {
00359         Select = <a class="code" href="classException.html#p0">Exception::Select</a>;
00360         AddMessage(<span class="stringliteral">"domain error\n"</span>); AddMessage(a_what);
00361         <span class="keywordflow">if</span> (a_what) <a class="code" href="classTracer.html#d1">Tracer::AddTrace</a>();
00362     }
00363 
00364     <a class="code" href="classInvalid__argument.html#a0">Invalid_argument::Invalid_argument</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* a_what) : <a class="code" href="classLogic__error.html">Logic_error</a>() {
00365         Select = <a class="code" href="classException.html#p0">Exception::Select</a>;
00366         AddMessage(<span class="stringliteral">"invalid argument\n"</span>); AddMessage(a_what);
00367         <span class="keywordflow">if</span> (a_what) <a class="code" href="classTracer.html#d1">Tracer::AddTrace</a>();
00368     }
00369 
00370     <a class="code" href="classLength__error.html#a0">Length_error::Length_error</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* a_what) : <a class="code" href="classLogic__error.html">Logic_error</a>() {
00371         Select = <a class="code" href="classException.html#p0">Exception::Select</a>;
00372         AddMessage(<span class="stringliteral">"length error\n"</span>); AddMessage(a_what);
00373         <span class="keywordflow">if</span> (a_what) <a class="code" href="classTracer.html#d1">Tracer::AddTrace</a>();
00374     }
00375 
00376     <a class="code" href="classOut__of__range.html#a0">Out_of_range::Out_of_range</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* a_what) : <a class="code" href="classLogic__error.html">Logic_error</a>() {
00377         Select = <a class="code" href="classException.html#p0">Exception::Select</a>;
00378         AddMessage(<span class="stringliteral">"out of range\n"</span>); AddMessage(a_what);
00379         <span class="keywordflow">if</span> (a_what) <a class="code" href="classTracer.html#d1">Tracer::AddTrace</a>();
00380     }
00381 
00382     <a class="code" href="classBad__cast.html#a0">Bad_cast::Bad_cast</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* a_what) : <a class="code" href="classLogic__error.html">Logic_error</a>() {
00383         Select = <a class="code" href="classException.html#p0">Exception::Select</a>;
00384         AddMessage(<span class="stringliteral">"bad cast\n"</span>); AddMessage(a_what);
00385         <span class="keywordflow">if</span> (a_what) <a class="code" href="classTracer.html#d1">Tracer::AddTrace</a>();
00386     }
00387 
00388     <a class="code" href="classBad__typeid.html#a0">Bad_typeid::Bad_typeid</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* a_what) : <a class="code" href="classLogic__error.html">Logic_error</a>() {
00389         Select = <a class="code" href="classException.html#p0">Exception::Select</a>;
00390         AddMessage(<span class="stringliteral">"bad type id.\n"</span>); AddMessage(a_what);
00391         <span class="keywordflow">if</span> (a_what) <a class="code" href="classTracer.html#d1">Tracer::AddTrace</a>();
00392     }
00393 
00394     <a class="code" href="classRange__error.html#a0">Range_error::Range_error</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* a_what) : <a class="code" href="classRuntime__error.html">Runtime_error</a>() {
00395         Select = <a class="code" href="classException.html#p0">Exception::Select</a>;
00396         AddMessage(<span class="stringliteral">"range error\n"</span>); AddMessage(a_what);
00397         <span class="keywordflow">if</span> (a_what) <a class="code" href="classTracer.html#d1">Tracer::AddTrace</a>();
00398     }
00399 
00400     <a class="code" href="classOverflow__error.html#a0">Overflow_error::Overflow_error</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* a_what) : <a class="code" href="classRuntime__error.html">Runtime_error</a>() {
00401         Select = <a class="code" href="classException.html#p0">Exception::Select</a>;
00402         AddMessage(<span class="stringliteral">"overflow error\n"</span>); AddMessage(a_what);
00403         <span class="keywordflow">if</span> (a_what) <a class="code" href="classTracer.html#d1">Tracer::AddTrace</a>();
00404     }
00405 
00406     <a class="code" href="classBad__alloc.html#a0">Bad_alloc::Bad_alloc</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* a_what) : <a class="code" href="classException.html">Exception</a>() {
00407         Select = <a class="code" href="classException.html#p0">Exception::Select</a>;
00408         AddMessage(<span class="stringliteral">"bad allocation\n"</span>); AddMessage(a_what);
00409         <span class="keywordflow">if</span> (a_what) <a class="code" href="classTracer.html#d1">Tracer::AddTrace</a>();
00410     }
00411 
00412     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="classLogic__error.html#p0">Logic_error::Select</a>;
00413     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="classRuntime__error.html#p0">Runtime_error::Select</a>;
00414     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="classDomain__error.html#p0">Domain_error::Select</a>;
00415     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="classInvalid__argument.html#p0">Invalid_argument::Select</a>;
00416     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="classLength__error.html#p0">Length_error::Select</a>;
00417     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="classOut__of__range.html#p0">Out_of_range::Select</a>;
00418     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="classBad__cast.html#p0">Bad_cast::Select</a>;
00419     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="classBad__typeid.html#p0">Bad_typeid::Select</a>;
00420     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="classRange__error.html#p0">Range_error::Select</a>;
00421     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="classOverflow__error.html#p0">Overflow_error::Select</a>;
00422     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="classBad__alloc.html#p0">Bad_alloc::Select</a>;
00423 
00424 <span class="preprocessor">#ifdef use_namespace</span>
00425 <span class="preprocessor"></span>}
00426 <span class="preprocessor">#endif</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:37:02 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
