<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>OTXTBOX.CPP Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>OTXTBOX.CPP</h1><a href="OTXTBOX_8CPP.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : OTXTBOX.CPP</span>
00002 <span class="comment">//Description : Object text box</span>
00003 
00004 <span class="preprocessor">#include &lt;<a class="code" href="OVGA_8H.html">OVGA.H</a>&gt;</span>
00005 <span class="preprocessor">#include &lt;OINFO.H&gt;</span>
00006 <span class="preprocessor">#include &lt;OFONT.H&gt;</span>
00007 <span class="preprocessor">#include &lt;OMOUSE.H&gt;</span>
00008 <span class="preprocessor">#include &lt;<a class="code" href="OSCROLL_8H.html">OSCROLL.H</a>&gt;</span>
00009 <span class="preprocessor">#include &lt;OIFACE.H&gt;</span>
00010 <span class="preprocessor">#include &lt;<a class="code" href="OTXTBOX_8H.html">OTXTBOX.H</a>&gt;</span>
00011 
00012 <span class="comment">//-------- Define macro constant ----------//</span>
00013 
<a name="l00014"></a><a class="code" href="OTXTBOX_8CPP.html#a0">00014</a> <span class="preprocessor">#define SCROLL_BAR_WIDTH 15</span>
00015 <span class="preprocessor"></span>
<a name="l00016"></a><a class="code" href="OTXTBOX_8CPP.html#a1">00016</a> <span class="preprocessor">#define TEXT_LINE_SPACE   6</span>
<a name="l00017"></a><a class="code" href="OTXTBOX_8CPP.html#a2">00017</a> <span class="preprocessor"></span><span class="preprocessor">#define TEXT_MARGIN       8</span>
00018 <span class="preprocessor"></span>
00019 <span class="comment">//--------- Define static vars ------------//</span>
00020 
00021 <span class="keyword">static</span>  <a class="code" href="classScrollBar.html">ScrollBar</a> scroll_bar;
00022 
00023 <span class="comment">//---------- Begin of function TxtBox::init -------//</span>
<a name="l00027"></a><a class="code" href="classTxtBox.html#a1">00027</a> <span class="comment">void TxtBox::init(int x1, int y1, int x2, int y2) {</span>
00028     text_x1 = x1;
00029     text_y1 = y1;
00030     text_x2 = x2-<a class="code" href="OTXTBOX_8CPP.html#a0">SCROLL_BAR_WIDTH</a>-4;                <span class="comment">// space + scroll bar width</span>
00031     text_y2 = y2;
00032 
00033     scroll_x1 = x2-<a class="code" href="OTXTBOX_8CPP.html#a0">SCROLL_BAR_WIDTH</a>+1;
00034     scroll_y1 = y1;
00035     scroll_x2 = x2;
00036     scroll_y2 = y2;
00037 
00038     init_flag = 1;
00039     top_line=1;
00040 
00041     vga.d3_panel_down( text_x1, text_y1, text_x2, text_y2, 2, 0 );
00042 }
00043 
00044 <span class="comment">//---------- End of function TxtBox::init -------//</span>
00045 
00046 <span class="comment">//------- Begin of function TxtBox::disp -------//</span>
<a name="l00051"></a><a class="code" href="classTxtBox.html#a2">00051</a> <span class="comment">void TxtBox::disp(char* textPtr, int refreshFlag) {</span>
00052     <a class="code" href="ALL_8H.html#a0">err_when</a>( !init_flag );
00053 
00054     text_ptr = textPtr;
00055 
00056     <span class="comment">//------------ INFO_REPAINT ------------//</span>
00057 
00058     <span class="keywordflow">if</span>( refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a> ) {
00059         <span class="comment">//-------- count the no. of lines of the text --------//</span>
00060 
00061         <span class="keywordtype">int</span> dispLines;                                <span class="comment">// no. of lines can be displayed on the area</span>
00062         <span class="keywordtype">int</span> totalLines;                               <span class="comment">// total no. of lines of the text</span>
00063 
00064         font_std.count_line( text_x1+<a class="code" href="OTXTBOX_8CPP.html#a2">TEXT_MARGIN</a>, text_y1+<a class="code" href="OTXTBOX_8CPP.html#a2">TEXT_MARGIN</a>,
00065                              text_x2-<a class="code" href="OTXTBOX_8CPP.html#a2">TEXT_MARGIN</a>, text_y2-<a class="code" href="OTXTBOX_8CPP.html#a2">TEXT_MARGIN</a>,
00066                              textPtr, <a class="code" href="OTXTBOX_8CPP.html#a1">TEXT_LINE_SPACE</a>, dispLines, totalLines );
00067 
00068         <span class="comment">//-------- display scroll bar ------//</span>
00069 
00070         scroll_bar.<a class="code" href="classScrollBar.html#a1">init</a>( 1, scroll_x1, scroll_y1, scroll_x2, scroll_y2,
00071                          dispLines, dispLines, totalLines );
00072 
00073         scroll_bar.<a class="code" href="classScrollBar.html#a2">paint</a>();
00074     }
00075 
00076     <span class="comment">//--------- display text body ----------//</span>
00077 
00078     user_interface.bar( text_x1+2, text_y1+2, text_x2-2, text_y2-2, <a class="code" href="COLOR_8H.html#a17">V_WHITE</a> );
00079 
00080     font_std.put_paragraph( text_x1+<a class="code" href="OTXTBOX_8CPP.html#a2">TEXT_MARGIN</a>, text_y1+<a class="code" href="OTXTBOX_8CPP.html#a2">TEXT_MARGIN</a>,
00081                             text_x2-<a class="code" href="OTXTBOX_8CPP.html#a2">TEXT_MARGIN</a>, text_y2-<a class="code" href="OTXTBOX_8CPP.html#a2">TEXT_MARGIN</a>,
00082                             textPtr, <a class="code" href="OTXTBOX_8CPP.html#a1">TEXT_LINE_SPACE</a>, top_line );
00083 }
00084 
00085 <span class="comment">//-------- Begin of function TxtBox::disp -------//</span>
00086 
00087 <span class="comment">//------- Begin of function TxtBox::detect -------//</span>
<a name="l00092"></a><a class="code" href="classTxtBox.html#a3">00092</a> <span class="comment">int TxtBox::detect() {</span>
00093     <span class="keywordflow">if</span>( !init_flag )
00094         <span class="keywordflow">return</span> 0;
00095 
00096     <span class="comment">//----------- detect scroll bar --------------//</span>
00097 
00098     <span class="keywordtype">int</span> rc;
00099 
00100     <span class="keywordflow">if</span>( (rc=scroll_bar.<a class="code" href="classScrollBar.html#a4">detect</a>()) &gt; 0 ) {
00101         top_line = rc;
00102         disp(text_ptr, <a class="code" href="Gamedef_8h.html#a71a17">INFO_UPDATE</a>);
00103         <span class="keywordflow">return</span> 1;
00104     }
00105 
00106     <span class="comment">//------- if mouse pressed on text area ------//</span>
00107     <span class="comment">//-- can pressed on hyper-texted field or just fast scrolling --//</span>
00108 
00109     <span class="keywordflow">if</span>( !mouse.single_click( text_x1, text_y1, text_x2, text_y2 ) )
00110         <span class="keywordflow">return</span> 0;
00111 
00112     <span class="comment">//------ detect fast scrolling --------//</span>
00113     <span class="comment">/*</span>
00114 <span class="comment">      if( mouse.click_y() &lt; text_y1 + (text_y2-text_y1) / 2 )</span>
00115 <span class="comment">      top_line = scroll_bar.page_up(1);   // page up, 1 = skip less one line, so when scrolling text, want the last line of previous page be the first line of current page, then pass 1 as skipLess</span>
00116 <span class="comment">      else</span>
00117 <span class="comment">      top_line = scroll_bar.page_down(1); // page down</span>
00118 <span class="comment">    */</span>
00119     disp(text_ptr, <a class="code" href="Gamedef_8h.html#a71a17">INFO_UPDATE</a>);
00120 
00121     <span class="keywordflow">return</span> 1;
00122 }
00123 
00124 <span class="comment">//-------- Begin of function TxtBox::detect -------//</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:38:32 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
