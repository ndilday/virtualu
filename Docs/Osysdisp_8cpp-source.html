<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Osysdisp.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Osysdisp.cpp</h1><a href="Osysdisp_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : OSYSDISP.CPP</span>
00002 <span class="comment">//Description : Sys class functions for displaying</span>
00003 
00004 <span class="preprocessor">#include &lt;<a class="code" href="ALL_8H.html">ALL.H</a>&gt;</span>
00005 <span class="preprocessor">#include &lt;<a class="code" href="ODEBUGX_8H.html">ODEBUGX.H</a>&gt;</span>
00006 <span class="preprocessor">#include &lt;OINFO.H&gt;</span>
00007 <span class="preprocessor">#include &lt;OMISC.H&gt;</span>
00008 <span class="preprocessor">#include &lt;OCONFIG.H&gt;</span>
00009 <span class="preprocessor">#include &lt;OMOUSE.H&gt;</span>
00010 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00011 <span class="preprocessor">#include &lt;OFONT.H&gt;</span>
00012 <span class="preprocessor">#include &lt;<a class="code" href="OVGA_8H.html">OVGA.H</a>&gt;</span>
00013 <span class="preprocessor">#include &lt;<a class="code" href="OWORLD_8H.html">OWORLD.H</a>&gt;</span>
00014 <span class="preprocessor">#include &lt;OIFACE.H&gt;</span>
00015 <span class="preprocessor">#include &lt;OFINANCE.H&gt;</span>
00016 <span class="preprocessor">#include &lt;OFACURES.H&gt;</span>
00017 <span class="preprocessor">#include &lt;OPSCHOOL.H&gt;</span>
00018 <span class="preprocessor">#include &lt;<a class="code" href="OADM__OFF_8H.html">OADM_OFF.H</a>&gt;</span>
00019 <span class="preprocessor">#include &lt;OOPT.H&gt;</span>
00020 <span class="preprocessor">#include &lt;OCHANCE.H&gt;</span>
00021 <span class="preprocessor">#include &lt;OATHLETI.H&gt;</span>
00022 <span class="preprocessor">#include &lt;ODEVELOP.H&gt;</span>
00023 <span class="preprocessor">#include &lt;OFACILIT.H&gt;</span>
00024 <span class="preprocessor">#include &lt;OLIBTECH.H&gt;</span>
00025 <span class="preprocessor">#include &lt;OINVEST.H&gt;</span>
00026 <span class="preprocessor">#include &lt;<a class="code" href="OTEST_8H.html">OTEST.H</a>&gt;</span>                                <span class="comment">//Norris 0629</span>
00027 <span class="preprocessor">#include &lt;<a class="code" href="OHELPIF_8H.html">OHELPIF.H</a>&gt;</span>                              <span class="comment">//chwg 1015</span>
00028 <span class="preprocessor">#include &lt;OLETTER.H&gt;</span>                              <span class="comment">//chwg 1021</span>
00029 <span class="preprocessor">#include &lt;<a class="code" href="OBLCKBRD_8H.html">OBLCKBRD.H</a>&gt;</span>                             <span class="comment">//chwg 1026</span>
00030 <span class="preprocessor">#include &lt;<a class="code" href="OMISCREP_8H.html">OMISCREP.H</a>&gt;</span>
00031 <span class="preprocessor">#include &lt;<a class="code" href="OMORERPT_8H.html">OMORERPT.H</a>&gt;</span>                             <span class="comment">//chwg 0107</span>
00032 <span class="preprocessor">#include &lt;<a class="code" href="ODEPTLST_8H.html">ODEPTLST.H</a>&gt;</span>                             <span class="comment">//## chwg010999</span>
00033 <span class="preprocessor">#include &lt;<a class="code" href="OPRTMENU_8H.html">OPRTMENU.H</a>&gt;</span>                             <span class="comment">//## chwg010999</span>
00034 <span class="preprocessor">#include &lt;ODEPT.H&gt;</span>
00035 <span class="preprocessor">#include &lt;OCRIME.H&gt;</span>
00036 <span class="preprocessor">#include &lt;<a class="code" href="OPARKING_8H.html">OPARKING.H</a>&gt;</span>
00037 <span class="preprocessor">#include &lt;<a class="code" href="ORETIRE_8H.html">ORETIRE.H</a>&gt;</span>                              <span class="comment">//## chwg021299</span>
00038 <span class="preprocessor">#include &lt;<a class="code" href="OBANKRUP_8H.html">OBANKRUP.H</a>&gt;</span>                             <span class="comment">//## chwg021299</span>
00039 <span class="preprocessor">#include &lt;<a class="code" href="OFINSCOR_8H.html">OFINSCOR.H</a>&gt;</span>                             <span class="comment">//## chwg021299</span>
00040 <span class="preprocessor">#include &lt;<a class="code" href="OSCEN__IF_8H.html">OSCEN_IF.H</a>&gt;</span>                             <span class="comment">//## chwg021299</span>
00041 <span class="preprocessor">#include &lt;OLOSEGAM.H&gt;</span>                             <span class="comment">//## chwg021299</span>
00042 
00043 <span class="preprocessor">#include &lt;<a class="code" href="OHELP_8H.html">OHELP.H</a>&gt;</span>                                <span class="comment">// ## chwg031099</span>
00044 
00045 <span class="comment">//-------- Begin of function Sys::disp_frame --------//</span>
00046 <span class="keyword">enum</span> {
00047     <a class="code" href="Osysdisp_8cpp.html#a4a0">NEWS_POPUP_X1</a> = 120,
00048     <a class="code" href="Osysdisp_8cpp.html#a4a1">NEWS_POPUP_Y1</a> = 130,
00049     <a class="code" href="Osysdisp_8cpp.html#a4a2">NEWS_POPUP_X2</a> = <a class="code" href="Osysdisp_8cpp.html#a4a0">NEWS_POPUP_X1</a>+532,
00050     <a class="code" href="Osysdisp_8cpp.html#a4a3">NEWS_POPUP_Y2</a> = <a class="code" href="Osysdisp_8cpp.html#a4a1">NEWS_POPUP_Y1</a>+222
00051 };
00052 
00053 <span class="keywordtype">void</span> Sys::disp_frame() {
00054 
00055     <span class="keywordflow">if</span>( sys.signal_exit_flag )
00056         <span class="keywordflow">return</span>;
00057 
00058     <span class="comment">//------- refresh info display --------//</span>
00059 
00060     info.disp();
00061 
00062     <span class="keywordflow">if</span> (<a class="code" href="classSys.html#m13">prev_view_mode</a> != <a class="code" href="classSys.html#m14">view_mode</a>) {
00063         deinit_report();                              <span class="comment">// deinit the current report, free up allocated memory and etc.</span>
00064 
00065         <span class="comment">//---- update prev_view_mode ----//</span>
00066 
00067         <a class="code" href="classSys.html#m13">prev_view_mode</a> = <a class="code" href="classSys.html#m14">view_mode</a>;
00068     }
00069 
00070     <span class="comment">//## chwg021999</span>
00071     <span class="keywordflow">if</span>(news_pop_up_flag)
00072         vga.dont_blt=1;                               <span class="comment">// if using pop_up menu, dont_blt first</span>
00073 
00074     <span class="comment">//## chwg021999</span>
00075     <span class="comment">//  if(help.should_disp())</span>
00076     <span class="comment">//          vga.dont_blt=1;         // if show short help, dont_blt first</span>
00077 
00078     <span class="comment">/*</span>
00079 <span class="comment">      //------ if in staying view mode ------//</span>
00080 <span class="comment">      if( staying_view_mode &amp;&amp; staying_view_mode != view_mode</span>
00081 <span class="comment">      &amp;&amp; staying_view_mode != MODE_EVALUATION_LETTER )</span>
00082 <span class="comment">      {</span>
00083 <span class="comment">      vga_back.bar(260, 515, 620, 590, V_BLACK );</span>
00084 <span class="comment">      vga.use_back();</span>
00085 <span class="comment">      font_fblack.put_paragraph( 280, 535, 610, 570,</span>
00086 <span class="comment">      "CLICK HERE TO GO BACK TO RESOURCE OPTIMIZATION SCREEN" );</span>
00087 <span class="comment">      vga.blt_buf(260, 515, 620, 590);</span>
00088 <span class="comment">      }</span>
00089 <span class="comment">      else</span>
00090 <span class="comment">      {</span>
00091 <span class="comment">      //                blackboard.black_message_report(sys.redraw_all_flag);</span>
00092 <span class="comment">      }</span>
00093 <span class="comment">    */</span>
00094 
00095     <span class="comment">//-------- re-draw the whole screen if needed, such as after task switching ---------//</span>
00096 
00097     <span class="keywordflow">if</span>( redraw_all_flag ) {
00098         <span class="keywordtype">int</span> mail_state=0;
00099         <span class="keywordflow">if</span>( (<a class="code" href="classSys.html#m14">view_mode</a>==<a class="code" href="Osys_8h.html#a45a33">MODE_WELCOME_LETTER</a>)
00100             ||  (<a class="code" href="classSys.html#m14">view_mode</a>==<a class="code" href="Osys_8h.html#a45a34">MODE_EVALUATION_LETTER</a>)
00101             ||  (<a class="code" href="classSys.html#m14">view_mode</a>==<a class="code" href="Osys_8h.html#a45a32">MODE_SCEN_WELCOME_LETTER</a>)
00102 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00103 <span class="preprocessor"></span>            || (<a class="code" href="classSys.html#m14">view_mode</a>==MODE_STATE_REPORT)
00104             || (<a class="code" href="classSys.html#m14">view_mode</a>==<a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a>)
00105 <span class="preprocessor">#endif</span>
00106 <span class="preprocessor"></span>            )
00107             mail_state=1;
00108         <span class="keywordflow">if</span>(player_school.scenario_id&gt;0 &amp;&amp; (<a class="code" href="classSys.html#m14">view_mode</a>==<a class="code" href="Osys_8h.html#a45a21">MODE_SCENARIO_LETTER</a>||<a class="code" href="classSys.html#m14">view_mode</a>==<a class="code" href="Osys_8h.html#a45a32">MODE_SCEN_WELCOME_LETTER</a>))
00109             mail_state=1;
00110 
00111         <a class="code" href="classSys.html#a13">set_speed</a>(-1);                                <span class="comment">// refresh the speed indicator    //##chwg1008</span>
00112 
00113         mouse.hide_area( 8, 562, 74, 599 );           <span class="comment">// ## chw1014</span>
00114         <span class="keywordflow">if</span>((<a class="code" href="classSys.html#m14">view_mode</a>!=<a class="code" href="Osys_8h.html#a45a28">MODE_PAUSE</a>)
00115            &amp;&amp;(<a class="code" href="classSys.html#m14">view_mode</a>!=<a class="code" href="Osys_8h.html#a45a26">MODE_AWARD_REPORT</a>)
00116            &amp;&amp;(<a class="code" href="classSys.html#m14">view_mode</a>!=<a class="code" href="Osys_8h.html#a45a17">MODE_GAME_OPTIONS</a>)
00117            &amp;&amp;(<a class="code" href="classSys.html#m14">view_mode</a>!=<a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a>)
00118            &amp;&amp;(<a class="code" href="classSys.html#m14">view_mode</a>!=<a class="code" href="Osys_8h.html#a45a27">MODE_PRINTING_MENU</a>)) {
00119             image_interface.put_back( 8, 562, mail_state==1 ? <span class="stringliteral">"MAIL-DN"</span> : <span class="stringliteral">"MAIL-UP"</span> );
00120         }
00121         <span class="keywordflow">else</span> {
00122             image_interface.put_back( 8, 562, <span class="stringliteral">"MAIL-UP"</span> );
00123             user_interface.darken(8, 562, 74, 599);
00124         }
00125         <span class="comment">/*              if(sys.view_mode==MODE_PRINTING_MENU)</span>
00126 <span class="comment">                        if(     (print_menu.print_view_mode==MODE_WELCOME_LETTER)</span>
00127 <span class="comment">                        ||      (print_menu.print_view_mode==MODE_EVALUATION_LETTER)</span>
00128 <span class="comment">                        ||      (print_menu.print_view_mode==MODE_SCEN_WELCOME_LETTER)</span>
00129 <span class="comment">                        ||      (print_menu.print_view_mode==MODE_SCENARIO_LETTER))</span>
00130 <span class="comment">                        image_interface.put_back( 8, 562, "MAIL-DN");</span>
00131 <span class="comment">                        mouse.show_area();                            */</span>
00132         vga.blt_buf(8, 562, 74, 599 ,1);
00133 
00134         mouse.hide_area( 178, 515, 208, 541 );        <span class="comment">// ## chw1014</span>
00135         image_interface.put_back( 178, 515, world.zoom_level==1 ? <span class="stringliteral">"MAG-UP"</span> : <span class="stringliteral">"MAG-DN"</span> );
00136         mouse.show_area();
00137         vga.blt_buf( 178, 515, 208, 541 ,1);
00138 
00139         mouse.hide_area(177, 561, 207, 591);          <span class="comment">// ## chw1014</span>
00140         <span class="keywordflow">if</span>((<a class="code" href="classSys.html#m14">view_mode</a>!=<a class="code" href="Osys_8h.html#a45a9">MODE_NORMAL</a>)
00141            &amp;&amp;(<a class="code" href="classSys.html#m14">view_mode</a>!=<a class="code" href="Osys_8h.html#a45a31">MODE_HELP_DESC</a>)
00142            &amp;&amp;(<a class="code" href="classSys.html#m14">view_mode</a>!=<a class="code" href="Osys_8h.html#a45a30">MODE_HELP_TOPIC</a>)
00143            &amp;&amp;(<a class="code" href="classSys.html#m14">view_mode</a>!=<a class="code" href="Osys_8h.html#a45a19">MODE_MORE_REPORT</a>)
00144            &amp;&amp;(<a class="code" href="classSys.html#m14">view_mode</a>!=<a class="code" href="Osys_8h.html#a45a28">MODE_PAUSE</a>)
00145            &amp;&amp;(<a class="code" href="classSys.html#m14">view_mode</a>!=<a class="code" href="Osys_8h.html#a45a20">MODE_DEPT_LIST</a>)
00146            &amp;&amp;(<a class="code" href="classSys.html#m14">view_mode</a>!=<a class="code" href="Osys_8h.html#a45a17">MODE_GAME_OPTIONS</a>)
00147            &amp;&amp;(<a class="code" href="classSys.html#m14">view_mode</a>!=<a class="code" href="Osys_8h.html#a45a26">MODE_AWARD_REPORT</a>)
00148            &amp;&amp;(<a class="code" href="classSys.html#m14">view_mode</a>!=<a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a>)) {
00149             image_interface.put_back( 180, 564, <span class="stringliteral">"PRINT-UP"</span> );
00150         }
00151         <span class="keywordflow">else</span> {
00152             image_interface.put_back( 180, 564, <span class="stringliteral">"PRINT-DN"</span> );
00153             user_interface.darken(180, 564, 180+26, 564+28);
00154         }
00155         mouse.show_area();
00156         vga.blt_buf(180, 564, 180+26, 564+28);
00157         <span class="comment">/*</span>
00158 <span class="comment">          if((view_mode==MODE_PAUSE)</span>
00159 <span class="comment">          ||(view_mode==MODE_GAME_OPTIONS)</span>
00160 <span class="comment">          ||(view_mode==MODE_YEAR_END_REPORT)</span>
00161 <span class="comment">          ||(view_mode==MODE_EVALUATION_LETTER)</span>
00162 <span class="comment">          ||(view_mode==MODE_SCEN_WELCOME_LETTER)</span>
00163 <span class="comment">          ||(view_mode==MODE_WELCOME_LETTER)</span>
00164 <span class="comment">          ||(view_mode==MODE_FINAL_SCORE)</span>
00165 <span class="comment">          ||(view_mode==MODE_AWARD_REPORT)</span>
00166 <span class="comment">          ||(view_mode==MODE_YEAR_END_REPORT)</span>
00167 <span class="comment">          ||(view_mode==MODE_SCENARIO_LETTER)</span>
00168 <span class="comment">          ||(view_mode==MODE_RETIREMENT)</span>
00169 <span class="comment">          ||(view_mode==MODE_BANKRUPTCY)</span>
00170 <span class="comment">          ||(view_mode==MODE_LOSE_GAME)</span>
00171 <span class="comment">          ||(view_mode==MODE_FINAL_SCORE)</span>
00172 <span class="comment">          )</span>
00173 <span class="comment">          {</span>
00174 <span class="comment">          vga_back.put_bitmap(REPORT_BUTTON_X1, REPORT_BUTTON_Y1, info.report_bitmap[0]);               // the report does not belong to any of the buttons</span>
00175 <span class="comment">          user_interface.darken(REPORT_BUTTON_X1, REPORT_BUTTON_Y1, REPORT_BUTTON_X2, REPORT_BUTTON_Y2-1);</span>
00176 <span class="comment">          vga.blt_buf(REPORT_BUTTON_X1, REPORT_BUTTON_Y1, REPORT_BUTTON_X2, REPORT_BUTTON_Y2-1);</span>
00177 <span class="comment">          }</span>
00178 <span class="comment">        */</span>
00179         sys.m_o_log_display_updated=1;
00180     }
00181 
00182     <span class="keywordflow">if</span>( <a class="code" href="classSys.html#m14">view_mode</a> == <a class="code" href="Osys_8h.html#a45a9">MODE_NORMAL</a> ) {
00183         <span class="keywordflow">if</span>( redraw_all_flag ) {
00184 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00185 <span class="preprocessor"></span>            <span class="comment">// set the top bar to display the user university name</span>
00186             sys.is_institution_report = 1;
00187 <span class="preprocessor">#endif</span>
00188 <span class="preprocessor"></span>
00189             world.map_matrix.reset_image_buf();         <span class="comment">// force ZoomMatrix to redraw the map</span>
00190 
00191             world.draw_all();
00192 
00193             info.disp_6_graphs();
00194 
00195             info.disp_column_bitmap(&amp;vga_back);
00196 
00197 <span class="preprocessor">#ifdef DEBUG</span>
00198 <span class="preprocessor"></span>            <span class="comment">// display the value of ck1, ck2, ck3 in player_school</span>
00199 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00200 <span class="preprocessor"></span>            <span class="comment">//  float ck1, ck2, ck3;</span>
00201             <span class="comment">//  player_school.get_cks( ck1, ck2, ck3 );</span>
00202             <span class="comment">//  font_chartsm.put( 200, 100, "CK1:" );</span>
00203             <span class="comment">//  font_chartsm.put( 200, 130, m.format(ck1) );</span>
00204             <span class="comment">//  font_chartsm.put( 200, 180, "CK2:" );</span>
00205             <span class="comment">//  font_chartsm.put( 200, 210, m.format(ck2) );</span>
00206             <span class="comment">//  font_chartsm.put( 200, 260, "CK3:" );</span>
00207             <span class="comment">//  font_chartsm.put( 200, 290, m.format(ck3) );</span>
00208 <span class="preprocessor">#endif</span>
00209 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00210 <span class="preprocessor"></span>
00211             <a class="code" href="classSys.html#a14">set_view_mode</a>(<a class="code" href="classSys.html#m14">view_mode</a>);                   <span class="comment">// for displaying the pressed button on the top of the screen</span>
00212 
00213             <a class="code" href="classSys.html#m8">redraw_all_flag</a> = 0;
00214             vga.blt_buf(<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>, <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>,1);
00215             vga.blt_buf(<a class="code" href="Oworldmt_8h.html#a2">MAP_X1</a>, <a class="code" href="Oworldmt_8h.html#a3">MAP_Y1</a>, <a class="code" href="Oworldmt_8h.html#a4">MAP_X2</a>, <a class="code" href="Oworldmt_8h.html#a5">MAP_Y2</a>,1);
00216         }
00217         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( redraw_zoom_flag ) {
00218             <span class="comment">// world.map_matrix.reset_image_buf();</span>
00219 
00220             world.draw_all();                           <span class="comment">// ZoomMatrix will use the last saved image buf instead of redrawing a new map</span>
00221             info.disp_6_graphs();
00222 
00223             info.disp_column_bitmap(&amp;vga_back);
00224             <a class="code" href="classSys.html#a13">set_speed</a>(-1);                              <span class="comment">// refresh the speed indicator  //##chwg1008</span>
00225             <a class="code" href="classSys.html#m9">redraw_zoom_flag</a> = 0;
00226             vga.blt_buf(<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>, <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>,1);
00227             vga.blt_buf(<a class="code" href="Oworldmt_8h.html#a2">MAP_X1</a>, <a class="code" href="Oworldmt_8h.html#a3">MAP_Y1</a>, <a class="code" href="Oworldmt_8h.html#a4">MAP_X2</a>, <a class="code" href="Oworldmt_8h.html#a5">MAP_Y2</a>,1);
00228         }
00229         <span class="keywordflow">else</span> {
00230             <span class="comment">//                  world.draw_update();</span>
00231             <span class="comment">//                  info.disp_6_graphs();</span>
00232         }
00233     }
00234     <span class="keywordflow">else</span> {
00235         <span class="keywordtype">int</span> refreshFlag = <a class="code" href="Gamedef_8h.html#a71a17">INFO_UPDATE</a>;
00236 
00237         <span class="keywordflow">if</span>( <a class="code" href="classSys.html#m8">redraw_all_flag</a> || <a class="code" href="classSys.html#m9">redraw_zoom_flag</a> ) {
00238             refreshFlag     = <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>;
00239             <a class="code" href="classSys.html#m8">redraw_all_flag</a>  = 0;
00240             <a class="code" href="classSys.html#m9">redraw_zoom_flag</a> = 0;
00241         }
00242 
00243         <span class="comment">//----------------------------------------------------------//</span>
00244         <span class="comment">//</span>
00245         <span class="comment">// Comments:    the info.report_bitmap[] is an array of bitmaps</span>
00246         <span class="comment">//                                      for the display of the upper-left corner button list</span>
00247         <span class="comment">//                                      [0] - bitmap with no button pressed</span>
00248         <span class="comment">//                                      [1] - first button pressed, etc.</span>
00249         <span class="comment">//                                      the array is initialzed at Info::disp_panel_init</span>
00250         <span class="comment">//</span>
00251         <span class="comment">//----------------------------------------------------------//</span>
00252 
00253         <span class="comment">//---- if the mode is set to the detail screen of a building -----//</span>
00254 
00255         <span class="keywordflow">if</span>( <a class="code" href="classSys.html#m14">view_mode</a> &gt;= <a class="code" href="Osys_8h.html#a45a38">MODE_FIRST_NONDEPARTMENTAL_FIRM</a> &amp;&amp;
00256             <a class="code" href="classSys.html#m14">view_mode</a> &lt;= <a class="code" href="Osys_8h.html#a45a39">MODE_LAST_NONDEPARTMENTAL_FIRM</a> ) {
00257             sys.is_institution_report=0;
00258 
00259             <span class="keywordflow">switch</span>( <a class="code" href="OFIRMID_8H.html#a21a1">FIRST_NONDEPARTMENTAL_FIRM_ID</a> + <a class="code" href="classSys.html#m14">view_mode</a> - <a class="code" href="Osys_8h.html#a45a38">MODE_FIRST_NONDEPARTMENTAL_FIRM</a> ) {
00260             <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a5">FIRM_ADMISSIONS</a>:
00261                 adm_office.report(refreshFlag);
00262                 <span class="keywordflow">break</span>;
00263 
00264             <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a6">FIRM_DEVELOPMENT</a>:
00265                 development_office.report(refreshFlag);
00266                 <span class="keywordflow">break</span>;
00267 
00268             <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a3">FIRM_LIBRARY</a>:
00269                 library_tech_office.report(refreshFlag);
00270                 <span class="keywordflow">break</span>;
00271 
00272             <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a7">FIRM_FACILITIES</a>:
00273                 facility_office.report(refreshFlag);
00274                 <span class="keywordflow">break</span>;
00275 
00276             <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a4">FIRM_OLD_MAIN</a>:
00277                 investment_office.report(refreshFlag);
00278                 <span class="keywordflow">break</span>;
00279 
00280             <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a10">FIRM_PRESIDENT</a>: {
00281                 <span class="keywordflow">if</span>(info.year_passed&lt;=1) {
00282                     <a class="code" href="classSys.html#a15">set_staying_view_mode</a>(<a class="code" href="Osys_8h.html#a45a33">MODE_WELCOME_LETTER</a>);
00283                 }
00284                 <span class="keywordflow">else</span> {
00285                     <a class="code" href="classSys.html#a15">set_staying_view_mode</a>(<a class="code" href="Osys_8h.html#a45a34">MODE_EVALUATION_LETTER</a>);
00286                 }
00287             }
00288             <span class="keywordflow">break</span>;
00289 
00290             <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a11">FIRM_TOWER</a>:
00291                 player_school.score_report(refreshFlag);
00292                 <span class="keywordflow">break</span>;
00293 
00294             <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a14">FIRM_PARK_LOTS</a>:
00295             <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a15">FIRM_PARK_STRUCTURE</a>:
00296                 parking.parking_report(refreshFlag);
00297                 <span class="keywordflow">break</span>;
00298 
00299             <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a13">FIRM_POLICE</a>:
00300                 crime.crime_report(refreshFlag);
00301                 <span class="keywordflow">break</span>;
00302 
00303             <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a17">FIRM_STADIUM</a>:
00304             <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a18">FIRM_PLAY_FIELD</a>:
00305             <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a19">FIRM_INDOOR_SPORTS</a>:
00306                 athletics_office.report(refreshFlag);
00307                 <span class="keywordflow">break</span>;
00308 
00309             <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a9">FIRM_RESIDENCE</a>:
00310                 player_school.summary_student_report_call_residence();
00311                 player_school.summary_student_report(refreshFlag);
00312                 <a class="code" href="classSys.html#a14">set_view_mode</a>(<a class="code" href="Osys_8h.html#a45a11">MODE_STUDENT_REPORT</a>);
00313                 <span class="keywordflow">break</span>;
00314             }
00315         }
00316         <span class="keywordflow">else</span> {
00317             <span class="comment">//----- if the mode is set to display one of the building independent reports ----//</span>
00318 
00319             <span class="keywordflow">switch</span>( view_mode ) {
00320             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a9">MODE_NORMAL</a>:
00321                 sys.is_institution_report=0;
00322                 world.detect();
00323                 <span class="keywordflow">break</span>;
00324 
00325             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a28">MODE_PAUSE</a>:
00326                 <span class="keywordflow">if</span>(refreshFlag==<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>) {
00327                     user_interface.brighten(<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>, <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>);
00328                     user_interface.brighten(<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>, <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>);
00329 
00330                     info.disp_column_bitmap(&amp;vga_back);
00331                     font_yellow_diamond.put(<a class="code" href="OVGA_8H.html#a0">VGA_WIDTH</a>/2-40,<a class="code" href="OVGA_8H.html#a1">VGA_HEIGHT</a>/3+50,<span class="stringliteral">"PAUSE GAME"</span>);
00332                     vga.blt_buf(<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>, <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>,1);
00333                 }
00334                 <span class="keywordflow">break</span>;
00335 
00336             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a21">MODE_SCENARIO_LETTER</a>:
00337                 scenario_report.scenario_report_report(refreshFlag);
00338                 <span class="keywordflow">break</span>;
00339 
00340             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a22">MODE_RETIREMENT</a>:
00341                 retirement.retirement_report(refreshFlag);
00342                 <span class="keywordflow">break</span>;
00343 
00344             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a23">MODE_BANKRUPTCY</a>:
00345                 bankruptcy.bankruptcy_report(refreshFlag);
00346                 <span class="keywordflow">break</span>;
00347 
00348             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a24">MODE_LOSE_GAME</a>:
00349                 lose_game.lose_game_report(refreshFlag);
00350                 <span class="keywordflow">break</span>;
00351 
00352             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a25">MODE_FINAL_SCORE</a>:
00353                 final_score.final_score_report(refreshFlag);
00354                 <span class="keywordflow">break</span>;
00355 
00356             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a16">MODE_FACULTY_LIST</a>:
00357                 faculty_res.report(refreshFlag);
00358                 <span class="keywordflow">break</span>;
00359 
00360             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a10">MODE_FACULTY_SUMMARY</a>:
00361                 faculty_res.summary_report(refreshFlag);
00362                 <span class="keywordflow">break</span>;
00363 
00364             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a11">MODE_STUDENT_REPORT</a>:
00365                 player_school.summary_student_report(refreshFlag);
00366                 <span class="keywordflow">break</span>;
00367 
00368             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a14">MODE_FINANCIAL_REPORT</a>:
00369                 finance.disp_report_main(refreshFlag);
00370                 <span class="keywordflow">break</span>;
00371 
00372             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a13">MODE_PERFORMANCE_REPORT</a>:
00373                 department_array[department_array.selected_recno]-&gt;main_report(refreshFlag);
00374                 <span class="keywordflow">break</span>;
00375 
00376             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a12">MODE_COURSE_REPORT</a>:
00377                 department_array[department_array.selected_recno]-&gt;course_report(refreshFlag);
00378                 <span class="keywordflow">break</span>;
00379 
00380             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a15">MODE_SCORE_REPORT</a>:
00381                 player_school.score_report(refreshFlag);
00382                 <span class="keywordflow">break</span>;
00383 
00384             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a18">MODE_YEAR_END_REPORT</a>:
00385                 finance.new_fiscal_year_report(refreshFlag);
00386                 <span class="keywordflow">break</span>;
00387 
00388             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a17">MODE_GAME_OPTIONS</a>:
00389                 sys.setting_report(refreshFlag);
00390                 <span class="keywordflow">break</span>;
00391 
00392             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a30">MODE_HELP_TOPIC</a>:
00393                 help_if.help_topic_report(refreshFlag);
00394                 <span class="keywordflow">break</span>;
00395 
00396             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a31">MODE_HELP_DESC</a>:
00397                 help_if.help_desc_report(refreshFlag);
00398                 <span class="keywordflow">break</span>;
00399 
00400             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a32">MODE_SCEN_WELCOME_LETTER</a>:
00401                 letter.scen_welcome_letter_report(refreshFlag);
00402                 <span class="keywordflow">break</span>;
00403 
00404             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a33">MODE_WELCOME_LETTER</a>:
00405                 letter.welcome_letter_report(refreshFlag);
00406                 <span class="keywordflow">break</span>;
00407 
00408             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a34">MODE_EVALUATION_LETTER</a>:
00409                 letter.eval_letter_report(refreshFlag);
00410                 <span class="keywordflow">break</span>;
00411 
00412 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00413 <span class="preprocessor"></span>            <span class="keywordflow">case</span> MODE_STATE_REPORT:
00414                 letter.state_report(refreshFlag);
00415                 <span class="keywordflow">break</span>;
00416 <span class="preprocessor">#endif</span>
00417 <span class="preprocessor"></span>
00418             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a35">MODE_BLACKBOARD_LOG</a>:
00419                 blackboard.black_log_report(refreshFlag);
00420                 <span class="keywordflow">break</span>;
00421 
00422             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a26">MODE_AWARD_REPORT</a>:
00423                 <span class="keywordflow">if</span>(misc_report.page_num==0)misc_report.page_num=1;
00424                 misc_report.award_report(refreshFlag);
00425                 <span class="keywordflow">break</span>;
00426 
00427             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a19">MODE_MORE_REPORT</a>:
00428                 more_report.more_report_report(refreshFlag);
00429                 <span class="keywordflow">break</span>;
00430 
00431             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a20">MODE_DEPT_LIST</a>:
00432                 dept_list.dept_list_report(refreshFlag);
00433                 <span class="keywordflow">break</span>;
00434 
00435             <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a27">MODE_PRINTING_MENU</a>:
00436                 print_menu.report(refreshFlag);
00437                 <span class="keywordflow">break</span>;
00438 
00439             }
00440         }
00441     }
00442 
00443     vga_back.rest_area(<a class="code" href="classSys.html#m39">menu_pull_down</a> ? info.menu_down_bitmap : info.menu_up_bitmap, 0, 0);
00444     vga.blt_buf(<a class="code" href="Oinfo_8h.html#a98a2">MENU_BUTTON_X1</a>, <a class="code" href="Oinfo_8h.html#a98a3">MENU_BUTTON_Y1</a>, <a class="code" href="Oinfo_8h.html#a98a4">MENU_BUTTON_X2</a>, <a class="code" href="Oinfo_8h.html#a98a5">MENU_BUTTON_Y2</a>);
00445 
00446     <span class="comment">//-------- display depat list button ---------------//</span>
00447     <span class="comment">//  vga_back.rest_area(list_button_bitmap,0,0);</span>
00448     image_interface.put_back(<a class="code" href="Oinfo_8h.html#a111a58">LIST_BUTTON_X1</a>, <a class="code" href="Oinfo_8h.html#a111a59">LIST_BUTTON_Y1</a>, <span class="stringliteral">"LIST_UP"</span> );
00449     vga.blt_buf(<a class="code" href="Oinfo_8h.html#a111a58">LIST_BUTTON_X1</a>, <a class="code" href="Oinfo_8h.html#a111a59">LIST_BUTTON_Y1</a>, <a class="code" href="Oinfo_8h.html#a111a60">LIST_BUTTON_X2</a>, <a class="code" href="Oinfo_8h.html#a111a61">LIST_BUTTON_Y2</a>);
00450 
00451     <span class="comment">//----------- Display newspaper -------------//</span>
00452 
00453     <span class="keywordflow">if</span>(news_pop_up_flag) {
00454         image_interface.put_back(<a class="code" href="Osysdisp_8cpp.html#a4a0">NEWS_POPUP_X1</a>, <a class="code" href="Osysdisp_8cpp.html#a4a1">NEWS_POPUP_Y1</a>, <span class="stringliteral">"NEWSPOP"</span> );
00455 
00456         <span class="keywordflow">if</span>(config.frame_speed!=0)
00457             <a class="code" href="classSys.html#m40">save_speed</a> = config.frame_speed;
00458 
00459         <a class="code" href="classSys.html#a13">set_speed</a>(0);                                 <span class="comment">// set the gaming speed to frozen, the speed is frozen until the player reset the staying view_mode</span>
00460 
00461         vga.use_back();
00462 
00463         font_letter.put_paragraph(
00464             <a class="code" href="Osysdisp_8cpp.html#a4a0">NEWS_POPUP_X1</a>+40, <a class="code" href="Osysdisp_8cpp.html#a4a1">NEWS_POPUP_Y1</a>+110, <a class="code" href="Osysdisp_8cpp.html#a4a2">NEWS_POPUP_X2</a>-30, <a class="code" href="Osysdisp_8cpp.html#a4a3">NEWS_POPUP_Y2</a>,
00465             chance_event.news_news_str.str_buf,8);
00466 
00467         font_letter.put(<a class="code" href="Osysdisp_8cpp.html#a4a0">NEWS_POPUP_X1</a>+200, <a class="code" href="Osysdisp_8cpp.html#a4a1">NEWS_POPUP_Y1</a>+77,chance_event.news_date_str);
00468         vga.blt_buf(<a class="code" href="Osysdisp_8cpp.html#a4a0">NEWS_POPUP_X1</a>, <a class="code" href="Osysdisp_8cpp.html#a4a1">NEWS_POPUP_Y1</a>, <a class="code" href="Osysdisp_8cpp.html#a4a2">NEWS_POPUP_X2</a>, <a class="code" href="Osysdisp_8cpp.html#a4a3">NEWS_POPUP_Y2</a>);
00469     }
00470 
00471     <span class="keywordflow">if</span>(vga.dont_blt) {
00472         vga.dont_blt=0;
00473         vga.blt_buf(<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>,<a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>);
00474         vga.blt_buf(<a class="code" href="Oinfo_8h.html#a111a58">LIST_BUTTON_X1</a>, <a class="code" href="Oinfo_8h.html#a111a59">LIST_BUTTON_Y1</a>, <a class="code" href="Oinfo_8h.html#a111a60">LIST_BUTTON_X2</a>, <a class="code" href="Oinfo_8h.html#a111a61">LIST_BUTTON_Y2</a>);
00475         vga.blt_buf(<a class="code" href="Oinfo_8h.html#a98a2">MENU_BUTTON_X1</a>, <a class="code" href="Oinfo_8h.html#a98a3">MENU_BUTTON_Y1</a>, <a class="code" href="Oinfo_8h.html#a98a4">MENU_BUTTON_X2</a>, <a class="code" href="Oinfo_8h.html#a98a5">MENU_BUTTON_Y2</a>);
00476         vga.blt_buf(<a class="code" href="Oworldmt_8h.html#a2">MAP_X1</a>, <a class="code" href="Oworldmt_8h.html#a3">MAP_Y1</a>, <a class="code" href="Oworldmt_8h.html#a4">MAP_X2</a>, <a class="code" href="Oworldmt_8h.html#a5">MAP_Y2</a>, 1);
00477         vga.blt_buf(8, 562, 74, 599 ,1);              <span class="comment">// mail</span>
00478         vga.blt_buf(178, 515, 208, 541 ,1);           <span class="comment">// mag. glass</span>
00479         <span class="comment">//              vga.blt_buf(0,0,VGA_WIDTH-1,VGA_HEIGHT-1);</span>
00480     }
00481 
00482     help.disp();
00483 
00484     <span class="keywordflow">if</span>(news_pop_up_flag) {
00485         vga_back.put_bitmap( 110, 539, image_interface.get_ptr(<span class="stringliteral">"SPED-BAS"</span>));
00486         vga.blt_buf(110, 539, 110+63, 539+30);
00487     }
00488 
00489     <span class="comment">//--------------------------------//</span>
00490     <a class="code" href="classSys.html#a16">blt_virtual_buf</a>();
00491 }
00492 
00493 <span class="comment">//-------- End of function Sys::disp_frame --------//</span>
00494 
00495 <span class="comment">//-------- Begin of function Sys::deinit_report --------//</span>
00499 <span class="comment">void Sys::deinit_report() {</span>
00500     <span class="keywordflow">if</span>( prev_view_mode &gt;= <a class="code" href="Osys_8h.html#a45a38">MODE_FIRST_NONDEPARTMENTAL_FIRM</a> &amp;&amp;
00501         prev_view_mode &lt;= <a class="code" href="Osys_8h.html#a45a39">MODE_LAST_NONDEPARTMENTAL_FIRM</a> ) {
00502         <span class="keywordflow">switch</span>( <a class="code" href="OFIRMID_8H.html#a21a1">FIRST_NONDEPARTMENTAL_FIRM_ID</a> + prev_view_mode
00503                 - <a class="code" href="Osys_8h.html#a45a38">MODE_FIRST_NONDEPARTMENTAL_FIRM</a> ) {
00504         <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a5">FIRM_ADMISSIONS</a>:
00505             adm_office.deinit();
00506             <span class="keywordflow">break</span>;
00507 
00508         <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a17">FIRM_STADIUM</a>:
00509             athletics_office.deinit();
00510             <span class="keywordflow">break</span>;
00511 
00512         <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a6">FIRM_DEVELOPMENT</a>:
00513             development_office.deinit();
00514             <span class="keywordflow">break</span>;
00515 
00516         <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a3">FIRM_LIBRARY</a>:
00517             library_tech_office.deinit();
00518             <span class="keywordflow">break</span>;
00519 
00520         <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a7">FIRM_FACILITIES</a>:
00521             facility_office.deinit();
00522             <span class="keywordflow">break</span>;
00523 
00524         <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a10">FIRM_PRESIDENT</a>:
00525             letter.deinit();
00526             <span class="keywordflow">break</span>;
00527 
00528         <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a11">FIRM_TOWER</a>:
00529             player_school.score_report_deinit();
00530             <span class="keywordflow">break</span>;
00531 
00532         <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a4">FIRM_OLD_MAIN</a>:
00533             investment_office.deinit();
00534             <span class="keywordflow">break</span>;
00535 
00536         <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a9">FIRM_RESIDENCE</a>:
00537             player_school.summary_student_report_deinit();
00538             <span class="keywordflow">break</span>;
00539 
00540         <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a14">FIRM_PARK_LOTS</a>:
00541         <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a15">FIRM_PARK_STRUCTURE</a>:
00542             parking.deinit();
00543             <span class="keywordflow">break</span>;
00544 
00545         <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a13">FIRM_POLICE</a>:
00546             crime.deinit();
00547             <span class="keywordflow">break</span>;
00548         }
00549     }
00550     <span class="keywordflow">else</span> {
00551         <span class="keywordflow">switch</span>( prev_view_mode ) {
00552         <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a10">MODE_FACULTY_SUMMARY</a>:
00553             faculty_res.summary_report_deinit();
00554             <span class="keywordflow">break</span>;
00555 
00556         <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a11">MODE_STUDENT_REPORT</a>:
00557             player_school.summary_student_report_deinit();
00558             <span class="keywordflow">break</span>;
00559 
00560         <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a12">MODE_COURSE_REPORT</a>:
00561             department_array[department_array.selected_recno]-&gt;course_report_deinit();
00562             <span class="keywordflow">break</span>;
00563 
00564         <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a15">MODE_SCORE_REPORT</a>:
00565             player_school.score_report_deinit();
00566             <span class="keywordflow">break</span>;
00567 
00568         <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a14">MODE_FINANCIAL_REPORT</a>:
00569             finance.report_deinit();
00570             <span class="keywordflow">break</span>;
00571 
00572         <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a13">MODE_PERFORMANCE_REPORT</a>:
00573             department_array[department_array.selected_recno]-&gt;main_report_deinit();
00574             <span class="keywordflow">break</span>;
00575 
00576         <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a17">MODE_GAME_OPTIONS</a>:
00577             sys.setting_report_deinit();
00578             <span class="keywordflow">break</span>;
00579 
00580         <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a30">MODE_HELP_TOPIC</a>:
00581             help_if.deinit();
00582             <span class="keywordflow">break</span>;
00583 
00584         <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a31">MODE_HELP_DESC</a>:
00585             help_if.deinit();
00586             <span class="keywordflow">break</span>;
00587 
00588         <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a33">MODE_WELCOME_LETTER</a>:
00589             letter.deinit();
00590             <span class="keywordflow">break</span>;
00591 
00592         <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a32">MODE_SCEN_WELCOME_LETTER</a>:
00593             letter.deinit();
00594             <span class="keywordflow">break</span>;
00595 
00596         <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a34">MODE_EVALUATION_LETTER</a>:
00597             letter.deinit();
00598             <span class="keywordflow">break</span>;
00599 
00600 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00601 <span class="preprocessor"></span>        <span class="keywordflow">case</span> MODE_STATE_REPORT:
00602             letter.deinit();
00603             <span class="keywordflow">break</span>;
00604 <span class="preprocessor">#endif</span>
00605 <span class="preprocessor"></span>
00606         <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a20">MODE_DEPT_LIST</a>:
00607             dept_list.deinit();
00608             <span class="keywordflow">break</span>;
00609 
00610         <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a19">MODE_MORE_REPORT</a>:
00611             more_report.deinit();
00612             <span class="keywordflow">break</span>;
00613 
00614         <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a27">MODE_PRINTING_MENU</a>:
00615             print_menu.deinit();
00616             <span class="keywordflow">break</span>;
00617 
00618             <span class="comment">//## fred 0213</span>
00619         <span class="keywordflow">case</span> <a class="code" href="Osys_8h.html#a45a26">MODE_AWARD_REPORT</a>:
00620             misc_report.award_deinit();
00621             <span class="keywordflow">break</span>;
00622             <span class="comment">//##</span>
00623 
00624         }
00625     }
00626 }
00627 
00628 <span class="comment">//-------- End of function Sys::deinit_report --------//</span>
00629 
00630 <span class="comment">//-------- Begin of function Sys::blt_virtual_buf --------//</span>
<a name="l00631"></a><a class="code" href="classSys.html#a16">00631</a> <span class="keywordtype">void</span> <a class="code" href="classSys.html#a16">Sys::blt_virtual_buf</a>() {
00632     <span class="comment">// add in (GAME_VERSION&gt;=200)</span>
00633     <span class="comment">// if( !debugx.debug_session )</span>
00634     <span class="keywordflow">if</span>( !<a class="code" href="classSys.html#m38">use_true_front</a> )
00635         <span class="keywordflow">return</span>;
00636 
00637     <span class="comment">//--- in a debug sesion, vga_front is not the true front buffer, now copy it to the true one ---//</span>
00638 
00639     <span class="keywordtype">int</span> frontLocked=0;
00640 
00641     <span class="keywordflow">if</span>( vga_front.buf_locked ) {
00642         vga_front.unlock_buf();
00643         frontLocked=1;
00644     }
00645 
00646     RECT bltRect;
00647 
00648     bltRect.left   = 0;
00649     bltRect.top    = 0;
00650     bltRect.right  = <a class="code" href="OVGA_8H.html#a0">VGA_WIDTH</a>-1;
00651     bltRect.bottom = <a class="code" href="OVGA_8H.html#a1">VGA_HEIGHT</a>-1;
00652 
00653     POINT destPoint;
00654     destPoint.x = 0;
00655     destPoint.y = 0;
00656 
00657     <span class="keywordflow">if</span>( <a class="code" href="classSys.html#m38">use_true_front</a> == 2 ) {                     <span class="comment">// window mode</span>
00658         ClientToScreen( <a class="code" href="classSys.html#m0">main_hwnd</a>, &amp;destPoint );
00659     }
00660 
00661     <span class="keywordtype">int</span> rc = vga_true_front.dd_buf-&gt;BltFast(
00662         destPoint.x, destPoint.y,
00663         vga_front.dd_buf,                             <span class="comment">// src surface</span>
00664         &amp;bltRect,                                     <span class="comment">// src rect (all of it)</span>
00665         DDBLTFAST_WAIT );
00666 
00667     <span class="keywordflow">if</span>( frontLocked )
00668         vga_front.lock_buf();
00669 }
00670 
00671 <span class="comment">//--------- End of function Sys::blt_virtual_buf ---------//</span>
00672 
00673 <span class="comment">//-------- Begin of function Sys::set_news_pop_up --------//</span>
<a name="l00675"></a><a class="code" href="classSys.html#a11">00675</a> <span class="comment">void Sys::set_news_pop_up() {</span>
00676     news_pop_up_flag = 1;
00677     news_pop_up_time = m.get_time();
00678 }
00679 
00680 <span class="comment">//-------- End of function Sys::set_news_pop_up --------//</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:38:29 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
