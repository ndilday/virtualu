<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>OVBROWIF.CPP Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>OVBROWIF.CPP</h1><a href="OVBROWIF_8CPP.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : OVBROWIF.CPP</span>
00002 <span class="comment">//Description : Object Visual Browse for the Interface</span>
00003 
00004 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00005 <span class="preprocessor">#include &lt;OINFO.H&gt;</span>
00006 <span class="preprocessor">#include &lt;<a class="code" href="OVGA_8H.html">OVGA.H</a>&gt;</span>
00007 <span class="preprocessor">#include &lt;<a class="code" href="OVBROWIF_8H.html">OVBROWIF.H</a>&gt;</span>
00008 
00009 <span class="comment">//---------- Begin of function VBrowseIF::VBrowseIF -------//</span>
<a name="l00011"></a><a class="code" href="classVBrowseIF.html#a0">00011</a> <span class="comment">VBrowseIF::VBrowseIF() {</span>
00012     vga_front_only = 0;                             <span class="comment">// if 1, then it does all the bitmap processing on the front buffer only</span>
00013 }
00014 
00015 <span class="comment">//----------- End of function VBrowseIF::VBrowseIF ----------//</span>
00016 
00017 <span class="comment">//---------- Begin of function VBrowseIF::init_var -------//</span>
<a name="l00019"></a><a class="code" href="classVBrowseIF.html#a2">00019</a> <span class="comment">void VBrowseIF::init_var(int totalRec, int recNo) {</span>
00020     <a class="code" href="classVBrowse.html#b0">VBrowse::init_var</a>(totalRec, recNo);
00021 
00022     scroll_bar.init( 1, x2-SCROLL_BAR_WIDTH, y1, x2, y2, disp_max_rec,
00023                      (disp_frame &amp;&amp; x_max_rec==1 ? 1 : disp_max_rec),<span class="comment">// only use record as scroller unit when it's a vertical browser with frame</span>
00024                      total_rec_num, 1, 1 );                        <span class="comment">// last 1 - Interface mode if_flag is 1</span>
00025 }
00026 
00027 <span class="comment">//----------- End of function VBrowseIF::init_var ----------//</span>
00028 
00029 <span class="comment">//--------- Begin of function VBrowseIF::paint ---------//</span>
<a name="l00031"></a><a class="code" href="classVBrowseIF.html#a4">00031</a> <span class="comment">void VBrowseIF::paint() {</span>
00032     <span class="comment">// the list content box</span>
00033     vga.d3_panel_down( x1, y1, x2-SCROLL_BAR_WIDTH-3, y2, vga_front_only );
00034 
00035     scroll_bar.paint();
00036 }
00037 
00038 <span class="comment">//--------- End of function VBrowseIF::paint ---------//</span>
00039 
00040 <span class="comment">//--------- Begin of function VBrowseIF::refresh ---------//</span>
<a name="l00049"></a><a class="code" href="classVBrowseIF.html#a3">00049</a> <span class="comment">void VBrowseIF::refresh(int newRecNo, int newTotalRec) {</span>
00050     <span class="keywordflow">if</span>( !vga_front_only &amp;&amp; !vga.use_back_buf )
00051         <span class="comment">// the list content box</span>
00052         vga.blt_buf( x1, y1, x2-SCROLL_BAR_WIDTH-3, y2 );
00053 
00054     <a class="code" href="classVBrowse.html#a8">VBrowse::refresh</a>(newRecNo, newTotalRec);
00055 }
00056 
00057 <span class="comment">//--------- End of function VBrowseIF::refresh ---------//</span>
00058 
00059 <span class="comment">//-------- Begin of function VBrowseIF::disp_all ----------//</span>
<a name="l00063"></a><a class="code" href="classVBrowseIF.html#b0">00063</a> <span class="comment">void VBrowseIF::disp_all() {</span>
00064     <span class="keywordtype">int</span> recNo;
00065 
00066     <span class="keywordflow">if</span>( !vga_front_only &amp;&amp; !vga.use_back_buf )
00067         vga.blt_buf( ix1, iy1, ix2, iy2, 0 );         <span class="comment">// clear background</span>
00068 
00069     <span class="keywordtype">int</span> scrollRecno = (disp_frame &amp;&amp; x_max_rec==1) ? rec_no : top_rec_no;
00070 
00071     scroll_bar.refresh( scrollRecno, 1, disp_max_rec,
00072                         (disp_frame &amp;&amp; x_max_rec==1 ? 1 : disp_max_rec),
00073                         total_rec_num );
00074 
00075     <span class="keywordflow">for</span>( recNo=top_rec_no ; recNo&lt;=total_rec_num &amp;&amp; recNo&lt;top_rec_no+disp_max_rec ; recNo++ ) {
00076         disp_one( recNo, DISP_REC );
00077 
00078         <span class="keywordflow">if</span>( recNo == rec_no )
00079             disp_one( recNo, DISP_HIGH );
00080     }
00081 }
00082 
00083 <span class="comment">//--------- End of function VBrowseIF::disp_all ----------//</span>
00084 
00085 <span class="comment">//-------- Begin of function VBrowseIF::disp_one ----------//</span>
<a name="l00092"></a><a class="code" href="classVBrowseIF.html#b1">00092</a> <span class="comment">void VBrowseIF::disp_one(int recNo, int dispType) {</span>
00093     <span class="keywordflow">if</span>( none_record )
00094         <span class="keywordflow">return</span>;
00095 
00096     <span class="keywordtype">int</span> x,y;
00097 
00098     y = iy1 + (recNo-top_rec_no)/x_max_rec * (rec_height+rec_y_space);
00099     x = ix1 + (recNo-top_rec_no)%x_max_rec * (rec_width+rec_x_space);
00100 
00101     <span class="comment">//---- put a outline rect around the record if it is highlight ---//</span>
00102 
00103     <span class="keywordflow">if</span>( disp_frame &amp;&amp; dispType == CLEAR_HIGH &amp;&amp; !vga.use_back_buf &amp;&amp; !vga_front_only ) {
00104         <span class="comment">// top</span>
00105         vga.blt_buf( x-2, y-2       , x+rec_width+1, y-2         );
00106         <span class="comment">// bottom</span>
00107         vga.blt_buf( x-2, y+rec_height+1, x+rec_width+1, y+rec_height+1 );
00108         <span class="comment">// left</span>
00109         vga.blt_buf( x-2, y-2       , x-2        , y+rec_height+1 );
00110         <span class="comment">// right</span>
00111         vga.blt_buf( x+rec_width+1, y-2 , x+rec_width+1, y+rec_height+1 );
00112     }
00113 
00114     <span class="keywordflow">if</span>( dispType == DISP_REC )
00115         disp_rec( recNo, x, y, <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a> );        <span class="comment">// call user defined function</span>
00116 
00117     <span class="keywordflow">if</span>( disp_frame &amp;&amp; dispType == DISP_HIGH ) {
00118         <span class="comment">//-------- draw d3 up border --------//</span>
00119 
00120         <a class="code" href="classVga.html#p0">Vga::active_buf</a>-&gt;<a class="code" href="classVgaBuf.html#a47">draw_d3_up_border</a>(x-2, y-2, x+rec_width+1, y+rec_height+1);
00121 
00122         <span class="comment">//--------- display the record --------//</span>
00123 
00124         <span class="keywordtype">int</span> scrollRecno = (disp_frame &amp;&amp; x_max_rec==1) ? recNo : top_rec_no;
00125 
00126         scroll_bar.refresh( scrollRecno, 0, disp_max_rec,
00127                             (disp_frame &amp;&amp; x_max_rec==1 ? 1 : disp_max_rec),
00128                             total_rec_num );
00129     }
00130 }
00131 
00132 <span class="comment">//--------- End of function VBrowseIF::disp_one ----------//</span>
00133 
00134 <span class="comment">//-------- Begin of function VBrowseIF::disp_rec --------//</span>
<a name="l00136"></a><a class="code" href="classVBrowseIF.html#b2">00136</a> <span class="comment">void VBrowseIF::disp_rec(int recNo, int x, int y, int refreshFlag) {</span>
00137     (*disp_rec_func)( recNo, x, y, refreshFlag );   <span class="comment">// call user defined function</span>
00138 
00139     sys.yield();
00140 }
00141 
00142 <span class="comment">//---------- End of function VBrowseIF::disp_rec -----------//</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:38:33 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
