<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Oblckbrd.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Oblckbrd.cpp</h1><a href="Oblckbrd_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00002 <span class="preprocessor">#include &lt;<a class="code" href="OGAMESET_8H.html">OGAMESET.H</a>&gt;</span>
00003 <span class="preprocessor">#include &lt;OWORLDMT.H&gt;</span>
00004 <span class="preprocessor">#include &lt;<a class="code" href="OGSET_8H.html">OGSET.H</a>&gt;</span>
00005 <span class="preprocessor">#include &lt;<a class="code" href="OVGA_8H.html">OVGA.H</a>&gt;</span>
00006 <span class="preprocessor">#include &lt;<a class="code" href="COLOR_8H.html">COLOR.H</a>&gt;</span>
00007 <span class="preprocessor">#include &lt;OFINANCE.H&gt;</span>
00008 <span class="preprocessor">#include &lt;OFONT.H&gt;</span>
00009 <span class="preprocessor">#include &lt;OGAMESTR.H&gt;</span>
00010 <span class="preprocessor">#include &lt;OMOUSE.H&gt;</span>
00011 <span class="preprocessor">#include &lt;<a class="code" href="OVBROW98_8H.html">OVBROW98.H</a>&gt;</span>
00012 <span class="preprocessor">#include &lt;OIFACE.H&gt;</span>
00013 <span class="preprocessor">#include &lt;OPSCHOOL.H&gt;</span>
00014 <span class="preprocessor">#include &lt;OFACULTY.H&gt;</span>
00015 <span class="preprocessor">#include &lt;ODEPT.H&gt;</span>
00016 <span class="preprocessor">#include &lt;<a class="code" href="ONAMERES_8H.html">ONAMERES.H</a>&gt;</span>
00017 <span class="preprocessor">#include &lt;<a class="code" href="ODEPTRES_8H.html">ODEPTRES.H</a>&gt;</span>
00018 <span class="preprocessor">#include &lt;OENROLL.H&gt;</span>
00019 <span class="preprocessor">#include &lt;<a class="code" href="OSTUOFF_8H.html">OSTUOFF.H</a>&gt;</span>
00020 <span class="preprocessor">#include &lt;<a class="code" href="OSCHLRES_8H.html">OSCHLRES.H</a>&gt;</span>
00021 <span class="preprocessor">#include &lt;<a class="code" href="OPEERSCH_8H.html">OPEERSCH.H</a>&gt;</span>
00022 <span class="preprocessor">#include &lt;OATHLETI.H&gt;</span>
00023 <span class="preprocessor">#include &lt;OINFO.H&gt;</span>
00024 <span class="preprocessor">#include &lt;<a class="code" href="OBLCKBRD_8H.html">OBLCKBRD.H</a>&gt;</span>
00025 <span class="preprocessor">#include &lt;OBUTTON.H&gt;</span>
00026 <span class="preprocessor">#include &lt;ONEWS.H&gt;</span>
00027 <span class="preprocessor">#include &lt;<a class="code" href="OTASK_8H.html">OTASK.H</a>&gt;</span>
00028 <span class="preprocessor">#include &lt;<a class="code" href="ODATE_8H.html">ODATE.H</a>&gt;</span>
00029 
00030 <span class="keyword">enum</span> {                                            <span class="comment">// screen coordinates</span>
00031     <a class="code" href="Oblckbrd_8cpp.html#a24a17">REPORT_X1</a> = <a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>+15,
00032     <a class="code" href="Oblckbrd_8cpp.html#a24a18">REPORT_Y1</a> = <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>+25,
00033     <a class="code" href="Oblckbrd_8cpp.html#a24a19">REPORT_X2</a> = <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-15,
00034     <a class="code" href="Oblckbrd_8cpp.html#a24a20">REPORT_Y2</a> = <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-55
00035 };
00036 
00037 <span class="keyword">enum</span> {                                            <span class="comment">// the bg image id</span>
00038     <a class="code" href="Oblckbrd_8cpp.html#a25a21">BG_PIC_ID</a> = 5
00039 };
00040 
00041 <span class="keyword">static</span> <span class="keywordtype">int</span> blackboard_report_init_flag;
00042 
00043 <span class="keyword">static</span> <a class="code" href="classVBrowse98.html">VBrowse98</a> blackboard_browser;
00044 <span class="keyword">static</span> <span class="keywordtype">int</span> browser_recno=1;
00045 <span class="keyword">static</span> <span class="keywordtype">int</span> old_browser_rec_count=1;
00046 <span class="keyword">static</span> <span class="keywordtype">int</span> new_browser_rec_count=0;
00047 <span class="keyword">static</span> <span class="keywordtype">void</span> log_disp_rep_row(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>);
00048 <span class="keyword">static</span> <span class="keywordtype">int</span> log_detect_rep_row(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>);
00049 
00050 <span class="keyword">static</span> <span class="keywordtype">int</span> news_lines,tasks_lines,remained_news_lines,remained_tasks_lines,idx1,idx2;
00051 <span class="keyword">static</span> <span class="keywordtype">int</span> space_for_news,space_for_task;
00052 
00053 <span class="keyword">static</span> <a class="code" href="classButtonGroup.html">ButtonGroup</a> bottom_button_group(2);
00054 <span class="keyword">static</span> <span class="keywordtype">short</span> *bottom_button_up_bitmap[2];
00055 <span class="keyword">static</span> <span class="keywordtype">short</span> *bottom_button_down_bitmap[2];
00056 <span class="keyword">static</span> <span class="keywordtype">char</span> *bottom_button_label[] = {
00057     <span class="stringliteral">"News and Messages"</span>, <span class="stringliteral">"Objectives"</span>
00058 };
00059 
00060 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00061 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="classButton.html">Button</a> button_back;
00062 <span class="preprocessor">#endif</span>
00063 <span class="preprocessor"></span>
00064 <span class="keyword">static</span> <span class="keywordtype">void</span> log_disp_rep_row(<span class="keywordtype">int</span> recno, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y,<span class="keywordtype">int</span> refreshFlag) {
00065     <span class="keywordtype">int</span> tab1=x+5;
00066     <span class="keywordtype">int</span> tab2=x+20;
00067     <a class="code" href="classString.html">String</a> str;
00068 
00069     <span class="keywordflow">if</span>(blackboard.log_mode==<a class="code" href="OBLCKBRD_8H.html#a3a1">NEWS_MODE</a>) {
00070         <span class="keywordflow">if</span>(recno==1) {
00071             idx1=1;
00072             idx2=1;
00073         }
00074 
00075         <span class="comment">//              if(recno==2)</span>
00076         <span class="comment">//              {       str="News and Messages:";</span>
00077         <span class="comment">//                      font_blue_san.put(tab2,y+2,str);</span>
00078         <span class="comment">//              }</span>
00079 
00080         <span class="keywordflow">if</span>((recno&gt;=1)&amp;&amp;(recno&lt;=space_for_news)) {
00081             <span class="keywordtype">char</span> * tmp;
00082             <span class="keywordflow">if</span>(space_for_news&gt;0) {
00083                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1,idx1=1,idx2=1;i&lt;recno;i++) {
00084                     <span class="keywordtype">int</span> j=(news_array[idx1]-&gt;line_count);
00085                     <span class="keywordflow">if</span>(idx2&gt;=j) {
00086                         idx2=1;
00087                         idx1++;
00088                     }
00089                     <span class="keywordflow">else</span>
00090                         idx2++;
00091                     <span class="keywordflow">if</span>(idx1&gt;news_array.size())<span class="keywordflow">break</span>;
00092                 }
00093 
00094                 <span class="keywordflow">if</span>(idx2==0)idx2=1;
00095                 <span class="keywordflow">if</span>(idx1&lt;=news_array.size()) {
00096                     tmp=news_array[idx1]-&gt;msg();
00097                     <span class="keywordflow">if</span>(idx2==1) {
00098                         <span class="comment">// str=date.date_str(news_array[idx1]-&gt;news_date,1,0);</span>
00099                         str = info.date_str_julian( news_array[idx1]-&gt;news_date, <a class="code" href="Oinfo_8h.html#a114a96">INFO_DATE_DEFAULT</a>|<a class="code" href="Oinfo_8h.html#a114a90">INFO_DATE_NO_DAY</a>|<a class="code" href="Oinfo_8h.html#a114a92">INFO_DATE_SHORT_MONTH</a> );
00100                         font_chartsm.put(tab2,y+2,str);
00101                     }
00102                     str=font_chartsm.get_line(400,idx2,tmp);
00103                     font_chartsm.put(tab2+75,y+2,str);
00104                 }
00105                 <span class="keywordflow">else</span>
00106                     font_chartsm.put(tab2+75,y+2,<span class="stringliteral">"..."</span>);
00107             }
00108         }
00109     }
00110     <span class="keywordflow">else</span> {
00111         <span class="keywordflow">if</span>(recno==1) {
00112             idx1=1;
00113             idx2=1;
00114         }
00115 
00116         <span class="comment">//              if(recno==2)</span>
00117         <span class="comment">//              {</span>
00118         <span class="comment">//                      str="Objectives :";</span>
00119         <span class="comment">//                      font_blue_san.put(tab2,y+2,str);</span>
00120         <span class="comment">//              }</span>
00121 
00122         <span class="keywordflow">if</span>((recno&gt;=1)&amp;&amp;(recno&lt;=space_for_task)) {
00123             <span class="keywordtype">char</span> * tmp;
00124             <span class="keywordflow">if</span>(space_for_task&gt;0) {
00125                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1,idx1=1,idx2=1;i&lt;recno;i++) {
00126                     <span class="keywordflow">if</span>(idx2&gt;=(task_array[idx1]-&gt;line_count)) {
00127                         idx2=1;
00128                         idx1++;
00129                     }
00130                     <span class="keywordflow">else</span>
00131                         idx2++;
00132 
00133                     <span class="keywordflow">if</span>(idx1&gt;task_array.size())<span class="keywordflow">break</span>;
00134                 }
00135 
00136                 <span class="keywordflow">if</span>(idx2==0)idx2=1;
00137                 <span class="keywordflow">if</span>(idx1&lt;=task_array.size()) {
00138                     tmp=task_array[idx1]-&gt;get_task_msg();
00139                     <span class="keywordflow">if</span>(idx2==1) {
00140                         <span class="comment">// str=date.date_str(task_array[idx1]-&gt;news_date,1,0);</span>
00141                         str=info.date_str_julian( task_array[idx1]-&gt;news_date, <a class="code" href="Oinfo_8h.html#a114a96">INFO_DATE_DEFAULT</a>|<a class="code" href="Oinfo_8h.html#a114a90">INFO_DATE_NO_DAY</a>|<a class="code" href="Oinfo_8h.html#a114a92">INFO_DATE_SHORT_MONTH</a> );
00142                         font_chartsm.put(tab2,y+2,str);
00143                     }
00144                     str=font_chartsm.get_line(400,idx2,tmp);
00145                     font_chartsm.put(tab2+75,y+2,str);
00146                 }
00147                 <span class="keywordflow">else</span>
00148                     font_chartsm.put(tab2+75,y+2,<span class="stringliteral">"..."</span>);
00149             }
00150         }
00151     }
00152 
00153 };
00154 
00155 <span class="keyword">static</span> <span class="keywordtype">int</span> log_detect_rep_row(<span class="keywordtype">int</span> recno, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y) {
00156     <span class="keywordflow">return</span> 0;
00157 };
00158 
00159 <span class="comment">//------- Begin of function BlackBoard::BlackBoard -----------//</span>
<a name="l00161"></a><a class="code" href="classBlackBoard.html#a0">00161</a> <span class="comment">BlackBoard::BlackBoard() {</span>
00162     init();
00163 }
00164 
00165 <span class="comment">//--------- End of function BlackBoard::BlackBoard -----------//</span>
00166 
00167 <span class="comment">//------- Begin of function BlackBoard::~BlackBoard -----------//</span>
<a name="l00169"></a><a class="code" href="classBlackBoard.html#a1">00169</a> <span class="comment">BlackBoard::~BlackBoard() {</span>
00170     deinit();
00171 }
00172 
00173 <span class="comment">//--------- End of function BlackBoard::~BlackBoard -----------//</span>
00174 
00175 <span class="comment">//------- Begin of function BlackBoard::deinit ---------------//</span>
<a name="l00177"></a><a class="code" href="classBlackBoard.html#a3">00177</a> <span class="comment">void BlackBoard::deinit() {</span>
00178     <span class="keywordflow">if</span> (*bottom_button_up_bitmap) {
00179         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++) {
00180             <a class="code" href="ALL_8H.html#a8">mem_del</a>(bottom_button_up_bitmap[i]);
00181             <a class="code" href="ALL_8H.html#a8">mem_del</a>(bottom_button_down_bitmap[i]);
00182             bottom_button_up_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00183             bottom_button_down_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00184         }
00185     }
00186 
00187 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00188 <span class="preprocessor"></span>    button_back.<a class="code" href="classButton.html#a2">deinit</a>();
00189 <span class="preprocessor">#endif</span>
00190 <span class="preprocessor"></span>    <span class="comment">//--------- deallocate memory -------------//</span>
00191     blackboard_report_init_flag = 0;
00192 }
00193 
00194 <span class="comment">//--------- End of function BlackBoard::deinit ---------------//</span>
00195 
00196 <span class="comment">//------- Begin of function BlackBoard::init -----------------//</span>
<a name="l00198"></a><a class="code" href="classBlackBoard.html#a2">00198</a> <span class="comment">void BlackBoard::init() {</span>
00199     memset(<span class="keyword">this</span>,0,<span class="keyword">sizeof</span>(<a class="code" href="classBlackBoard.html">BlackBoard</a>));
00200     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++) {
00201         bottom_button_up_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00202         bottom_button_down_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00203     }
00204     blackboard_report_init_flag = 0;
00205     log_mode=<a class="code" href="OBLCKBRD_8H.html#a3a1">NEWS_MODE</a>;
00206 }
00207 
00208 <span class="comment">//--------- End of function BlackBoard::init -----------------//</span>
00209 
<a name="l00210"></a><a class="code" href="classBlackBoard.html#a4">00210</a> <span class="keywordtype">void</span> <a class="code" href="classBlackBoard.html#a4">BlackBoard::black_message_report</a>(<span class="keywordtype">int</span> refreshFlag) {
00211     <span class="keywordtype">int</span> i,j,k;
00212     vga.use_back();
00213     vga_back.bar(260, 515, 620, 590, <a class="code" href="COLOR_8H.html#a15">V_BLACK</a> );
00214 
00215     <span class="keywordflow">for</span>(i=3,j=news_array.size();i&gt;=0;j--) {
00216         <span class="keywordflow">if</span>(j&lt;=0){i=-1;<span class="keywordflow">continue</span>;}
00217         news_array[j]-&gt;line_count=font_fblack.count_line(260,news_array[j]-&gt;msg());
00218         <span class="keywordflow">for</span>(k=news_array[j]-&gt;line_count;k&gt;0;k--) {
00219             <span class="keywordtype">char</span> *print_str;
00220             <span class="keywordflow">if</span>(i&gt;=0) {
00221                 <span class="comment">//                                      print_str=font_fblack.get_line(260,k,news_array[j]-&gt;msg());</span>
00222                 <span class="comment">//## chea 240999</span>
00223                 print_str=font_fblack.get_line(255,k,news_array[j]-&gt;msg());
00224                 font_fblack.put(320,520+i*18,print_str);
00225                 <span class="keywordflow">if</span>(k==1) {
00226                     <span class="comment">// print_str=date.date_str(news_array[j]-&gt;news_date,1,0);</span>
00227                     print_str=info.date_str_julian( news_array[j]-&gt;news_date, <a class="code" href="Oinfo_8h.html#a114a96">INFO_DATE_DEFAULT</a>|<a class="code" href="Oinfo_8h.html#a114a90">INFO_DATE_NO_DAY</a>|<a class="code" href="Oinfo_8h.html#a114a92">INFO_DATE_SHORT_MONTH</a> );
00228                     font_fblack.put(265,520+i*18,print_str);
00229                 }
00230                 i--;
00231             }
00232         }
00233     }
00234     <span class="comment">//          log_mode=NEWS_MODE;</span>
00235     vga.blt_buf(260, 515, 620, 590);
00236 };
00237 
<a name="l00238"></a><a class="code" href="classBlackBoard.html#a5">00238</a> <span class="keywordtype">void</span> <a class="code" href="classBlackBoard.html#a5">BlackBoard::black_objective_report</a>(<span class="keywordtype">int</span> refreshFlag) {
00239     <span class="keywordtype">int</span> i,j,k=0;
00240     vga.use_back();
00241     vga_back.bar(260, 515, 620, 590, <a class="code" href="COLOR_8H.html#a15">V_BLACK</a> );
00242 
00243     <span class="keywordflow">for</span>(i=3,j=task_array.size();i&gt;=0;j--) {
00244         <span class="keywordflow">if</span>(j&lt;=0){i=-1;<span class="keywordflow">continue</span>;}
00245         task_array[j]-&gt;line_count=font_fblack.count_line(260,task_array[j]-&gt;get_task_msg());
00246         <span class="keywordflow">for</span>(k=task_array[j]-&gt;line_count;k&gt;0;k--) {
00247             <span class="keywordtype">char</span> *print_str;
00248             <span class="keywordflow">if</span>(i&gt;=0) {
00249                 print_str=font_fblack.get_line(260,k,task_array[j]-&gt;get_task_msg());
00250                 font_fblack.put(320,520+i*18,print_str);
00251                 <span class="keywordflow">if</span>(k==1) {
00252                     <span class="comment">// print_str=date.date_str(task_array[j]-&gt;news_date,1,0);</span>
00253                     print_str=info.date_str_julian( task_array[j]-&gt;news_date, <a class="code" href="Oinfo_8h.html#a114a96">INFO_DATE_DEFAULT</a>|<a class="code" href="Oinfo_8h.html#a114a90">INFO_DATE_NO_DAY</a>|<a class="code" href="Oinfo_8h.html#a114a92">INFO_DATE_SHORT_MONTH</a> );
00254                     font_fblack.put(265,520+i*18,print_str);
00255                 }
00256                 i--;
00257             }
00258         }
00259     }
00260     <span class="comment">//          log_mode=OBJECTIVE_MODE;</span>
00261     vga.blt_buf(260, 515, 620, 590);
00262 };
00263 
<a name="l00264"></a><a class="code" href="classBlackBoard.html#a6">00264</a> <span class="keywordtype">void</span> <a class="code" href="classBlackBoard.html#a6">BlackBoard::black_log_report</a>(<span class="keywordtype">int</span> refreshFlag) {
00265     <span class="keywordtype">int</span> tab1=<a class="code" href="Oblckbrd_8cpp.html#a24a17">REPORT_X1</a>,tab2=<a class="code" href="Oblckbrd_8cpp.html#a24a17">REPORT_X1</a>+70,
00266         tab3=<a class="code" href="Oblckbrd_8cpp.html#a24a17">REPORT_X1</a>+100,tab4=<a class="code" href="Oblckbrd_8cpp.html#a24a17">REPORT_X1</a>+700;
00267     <span class="keywordtype">int</span> vtab1=<a class="code" href="Oblckbrd_8cpp.html#a24a18">REPORT_Y1</a>+20,vtab2=<a class="code" href="Oblckbrd_8cpp.html#a24a18">REPORT_Y1</a>+70,
00268         vtab3=<a class="code" href="Oblckbrd_8cpp.html#a24a18">REPORT_Y1</a>+100,vtab4=<a class="code" href="Oblckbrd_8cpp.html#a24a18">REPORT_Y1</a>+350;
00269     vga.use_back();
00270 
00271     new_browser_rec_count=2;
00272     space_for_news=0;
00273     space_for_task=0;
00274 
00275     <span class="keywordtype">int</span> i;
00276 
00277     <span class="keywordflow">if</span>(<a class="code" href="classBlackBoard.html#m0">log_mode</a>==<a class="code" href="OBLCKBRD_8H.html#a3a1">NEWS_MODE</a>) {
00278         <span class="keywordflow">for</span>(i=1;i&lt;=news_array.size();i++) {
00279             news_array[i]-&gt;line_count=font_chartsm.count_line(400,news_array[i]-&gt;msg());
00280             new_browser_rec_count+=news_array[i]-&gt;line_count;
00281             space_for_news+=news_array[i]-&gt;line_count;
00282         }
00283     }
00284     <span class="keywordflow">else</span> {
00285         <span class="keywordflow">for</span>(i=1;i&lt;=task_array.size();i++) {
00286             task_array[i]-&gt;line_count=font_chartsm.count_line(400,task_array[i]-&gt;get_task_msg());
00287             new_browser_rec_count+=task_array[i]-&gt;line_count;
00288             space_for_task+=task_array[i]-&gt;line_count;
00289         }
00290     }
00291 
00292     <span class="keywordflow">if</span>(new_browser_rec_count!=old_browser_rec_count)
00293         refreshFlag = <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>;
00294     old_browser_rec_count=new_browser_rec_count;
00295 
00296     <span class="keywordflow">if</span> (refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>) {
00297         <span class="keywordflow">if</span>(blackboard_report_init_flag )
00298             <a class="code" href="classBlackBoard.html#a3">deinit</a>();
00299 
00300         <span class="comment">//------------- paint the background ----------------//</span>
00301         <span class="keywordflow">if</span> (!blackboard_report_init_flag) {
00302             user_interface.bg_img(<a class="code" href="Oblckbrd_8cpp.html#a25a21">BG_PIC_ID</a>, &amp;vga_back);
00303 
00304             user_interface.brighten(tab1,vtab1,tab4,vtab4);
00305             user_interface.brighten(tab1,vtab1,tab4,vtab4);
00306             user_interface.rect(tab1,vtab1,tab4,vtab4);
00307 
00308             user_interface.brighten(<a class="code" href="Oblckbrd_8cpp.html#a24a17">REPORT_X1</a>+250,<a class="code" href="Oblckbrd_8cpp.html#a24a18">REPORT_Y1</a>-18,<a class="code" href="Oblckbrd_8cpp.html#a24a17">REPORT_X1</a>+480,<a class="code" href="Oblckbrd_8cpp.html#a24a18">REPORT_Y1</a>+13);
00309             user_interface.brighten(<a class="code" href="Oblckbrd_8cpp.html#a24a17">REPORT_X1</a>+250,<a class="code" href="Oblckbrd_8cpp.html#a24a18">REPORT_Y1</a>-18,<a class="code" href="Oblckbrd_8cpp.html#a24a17">REPORT_X1</a>+480,<a class="code" href="Oblckbrd_8cpp.html#a24a18">REPORT_Y1</a>+13);
00310             user_interface.rect(<a class="code" href="Oblckbrd_8cpp.html#a24a17">REPORT_X1</a>+250,<a class="code" href="Oblckbrd_8cpp.html#a24a18">REPORT_Y1</a>-18,<a class="code" href="Oblckbrd_8cpp.html#a24a17">REPORT_X1</a>+480,<a class="code" href="Oblckbrd_8cpp.html#a24a18">REPORT_Y1</a>+13);
00311             font_charts.put(<a class="code" href="Oblckbrd_8cpp.html#a24a17">REPORT_X1</a>+285,<a class="code" href="Oblckbrd_8cpp.html#a24a18">REPORT_Y1</a>-8,<span class="stringliteral">"News and Objective Log"</span>);
00312 
00313             <span class="keywordtype">int</span> browseRecHeight=20;
00314 
00315             blackboard_browser.<a class="code" href="classVBrowse98.html#a2">init</a>(
00316                 tab1,vtab1,tab4,vtab4,
00317                 0,  browseRecHeight,
00318                 new_browser_rec_count,
00319                 log_disp_rep_row,
00320                 log_detect_rep_row,0);
00321 
00322 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00323 <span class="preprocessor"></span>            blackboard_browser.<a class="code" href="classVBrowse98.html#a4">open</a>(new_browser_rec_count);
00324 <span class="preprocessor">#else</span>
00325 <span class="preprocessor"></span>            blackboard_browser.<a class="code" href="classVBrowse98.html#a4">open</a>(1);
00326 <span class="preprocessor">#endif</span>
00327 <span class="preprocessor"></span>
00328             <span class="keywordtype">short</span> x = tab1+120;
00329             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++, x+=270) {
00330                 user_interface.create_button_bitmap(x, vtab4+13, x+200, vtab4+33,
00331                                                     bottom_button_label[i], &amp;bottom_button_up_bitmap[i],
00332                                                     &amp;bottom_button_down_bitmap[i], &amp;vga_back);
00333 
00334                 bottom_button_group[i].create_bitmapW(x, vtab4+13, x+200, vtab4+33,
00335                                                       ((i == <a class="code" href="classBlackBoard.html#m0">log_mode</a>) ? bottom_button_down_bitmap[i] : bottom_button_up_bitmap[i])+4);
00336             }
00337 
00338 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00339 <span class="preprocessor"></span>            button_back.<a class="code" href="classButton.html#a10">create_text</a>( tab4-80, vtab4+13, tab4-10, vtab4+33, <span class="stringliteral">"Back"</span> );
00340 <span class="preprocessor">#endif</span>
00341 <span class="preprocessor"></span>
00342             blackboard_report_init_flag = 1;
00343         }
00344         bottom_button_group.<a class="code" href="classButtonGroup.html#a3">paint</a>(<a class="code" href="classBlackBoard.html#m0">log_mode</a>);
00345 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00346 <span class="preprocessor"></span>        button_back.<a class="code" href="classButton.html#a20">paint</a>();
00347 <span class="preprocessor">#endif</span>
00348 <span class="preprocessor"></span>    }
00349     <span class="keywordflow">else</span> {
00350         vga.use_back();
00351         blackboard_browser.<a class="code" href="classVBrowse98.html#a11">update</a>();
00352     }
00353 
00354     <span class="comment">//------- blt the back buffer to front buffer -------//</span>
00355     vga.blt_buf(260, 515, 620, 590);
00356     vga.blt_buf(<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>, <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>);
00357     vga.use_front();
00358     <span class="comment">//---------- End of function blackboard::welcome_blackboard_report ------------//</span>
00359 };
00360 
<a name="l00361"></a><a class="code" href="classBlackBoard.html#a8">00361</a> <span class="keywordtype">int</span> <a class="code" href="classBlackBoard.html#a8">BlackBoard::black_log_detect</a>() {
00362     <span class="keywordflow">if</span> (!blackboard_report_init_flag)
00363         <span class="keywordflow">return</span> 0;
00364     vga.use_front();
00365     blackboard_browser.<a class="code" href="classVBrowse98.html#a8">detect</a>();
00366     <span class="keywordtype">int</span> bottomButtonGroupDetect;
00367     <span class="keywordflow">if</span> ((bottomButtonGroupDetect = bottom_button_group.<a class="code" href="classButtonGroup.html#a4">detect</a>()) &gt;= 0) {
00368         <span class="comment">//---- deinit the modes to free memory ----//</span>
00369         <span class="comment">//              (*deinit_func_ptr[current_mode])();</span>
00370 
00371         <span class="comment">//-------- change display mode ------------//</span>
00372         bottom_button_group[<a class="code" href="classBlackBoard.html#m0">log_mode</a>].body_ptr = (<span class="keywordtype">void</span> *) (bottom_button_up_bitmap[<a class="code" href="classBlackBoard.html#m0">log_mode</a>] + 4);
00373         <a class="code" href="classBlackBoard.html#m0">log_mode</a> = bottomButtonGroupDetect;
00374         bottom_button_group[<a class="code" href="classBlackBoard.html#m0">log_mode</a>].body_ptr = (<span class="keywordtype">void</span> *) (bottom_button_down_bitmap[<a class="code" href="classBlackBoard.html#m0">log_mode</a>] + 4);
00375 
00376         <span class="comment">//-------- post display redraw flag -------//</span>
00377         sys.redraw_all_flag = 1;
00378 
00379         <span class="keywordflow">return</span> 1;
00380     }
00381 
00382 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00383 <span class="preprocessor"></span>    <span class="keywordflow">if</span>( button_back.<a class="code" href="classButton.html#a21">detect</a>() ) {
00384         sys.set_view_mode( sys.back_view_mode );
00385         <span class="keywordflow">return</span> 1;
00386     }
00387 <span class="preprocessor">#endif</span>
00388 <span class="preprocessor"></span>
00389     <span class="keywordflow">return</span> 0;
00390 }
00391 
<a name="l00392"></a><a class="code" href="classBlackBoard.html#a7">00392</a> <span class="keywordtype">void</span> <a class="code" href="classBlackBoard.html#a7">BlackBoard::black_log_deinit</a>() {
00393 
00394 }
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:37:15 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
