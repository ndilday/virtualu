<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>OSCHLEX.CPP Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>OSCHLEX.CPP</h1><a href="OSCHLEX_8CPP.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : OSCHEX.CPP</span>
00002 <span class="comment">//Description : SchoolEx class functions -- also see Initial_Conds of HE.initialization.xls</span>
00003 <span class="comment">//Owner                 : Fred</span>
00004 
00005 <span class="preprocessor">#include &lt;<a class="code" href="ODB_8H.html">ODB.H</a>&gt;</span>
00006 
00007 <span class="preprocessor">#include &lt;Oschrec2.h&gt;</span>                             <span class="comment">// SchoolDegreeRec</span>
00008 <span class="preprocessor">#include &lt;Oschlex.h&gt;</span>
00009 <span class="preprocessor">#include &lt;<a class="code" href="OSCHLRES_8H.html">OSCHLRES.H</a>&gt;</span>
00010 <span class="preprocessor">#include &lt;OPSCHOOL.H&gt;</span>
00011 
00012 <span class="preprocessor">#ifdef DEBUG</span>
00013 <span class="preprocessor"></span><span class="preprocessor">#include &lt;stdio.h&gt;</span>
00014 <span class="preprocessor">#endif</span>
00015 <span class="preprocessor"></span>
<a name="l00016"></a><a class="code" href="OSCHLEX_8CPP.html#a0">00016</a> <span class="preprocessor">#define SCHOOL_DB3   DIR_RES"UMASTER3.RES"</span>
00017 <span class="preprocessor"></span>
00018 <span class="comment">//--------- Begin of function SchoolEx::init --------//</span>
<a name="l00023"></a><a class="code" href="classSchoolEx.html#a0">00023</a> <span class="comment">void SchoolEx::init(int schoolRecno) {</span>
00024     <a class="code" href="classDatabase.html">Database</a>  dbSchool(<a class="code" href="OSCHLEX_8CPP.html#a0">SCHOOL_DB3</a>, 0);              <span class="comment">// 1-read the entire DB into buffer</span>
00025     <span class="keywordtype">short</span> db3Count = (short) dbSchool.<a class="code" href="classDatabase.html#a7">rec_count</a>();
00026     <a class="code" href="ALL_8H.html#a0">err_when</a>(db3Count != school_res.db_school_count);
00027 
00028 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00029 <span class="preprocessor"></span>
00030     db_school_recno = school_res.desired_school_array[schoolRecno].desired_recno;
00031 
00032     <a class="code" href="classSchool.html">School</a>* sPtr = &amp;school_res.desired_school_array[schoolRecno];
00033 
00034     <a class="code" href="classSchoolDegreeRec.html">SchoolDegreeRec</a>* degRec = (<a class="code" href="classSchoolDegreeRec.html">SchoolDegreeRec</a>*) dbSchool.<a class="code" href="classDatabase.html#a4">read</a>(db_school_recno);
00035 
00036 <span class="preprocessor">#else</span>
00037 <span class="preprocessor"></span>    <a class="code" href="classSchool.html">School</a>* sPtr = school_res.get_db_school(schoolRecno);
00038 
00039     <a class="code" href="classSchoolDegreeRec.html">SchoolDegreeRec</a>* degRec = (<a class="code" href="classSchoolDegreeRec.html">SchoolDegreeRec</a>*) dbSchool.<a class="code" href="classDatabase.html#a4">read</a>(schoolRecno);
00040 
00041     db_school_recno = schoolRecno;
00042 <span class="preprocessor">#endif</span>
00043 <span class="preprocessor"></span>
00044     memset( <span class="keyword">this</span>, 0, <span class="keyword">sizeof</span>(<a class="code" href="classSchoolEx.html">SchoolEx</a>));
00045 
00046     <span class="comment">//--- copy all vars from a School object in db_school_array[] to player_school_ex ---//</span>
00047 
00048     memcpy( <span class="keyword">this</span>, sPtr, <span class="keyword">sizeof</span>(<a class="code" href="classSchool.html">School</a>) );           <span class="comment">// SchoolEx is a derived class of School</span>
00049 
00050     <span class="comment">//-- field L-R of sheet "init_cond" of Excel file "initialization" --//</span>
00051 
00052     operating_reserve   = sPtr-&gt;<a class="code" href="classSchool.html#m70">current_funds_balance</a>;
00053     endowment_market    = sPtr-&gt;<a class="code" href="classSchool.html#m69">end_of_year_endowment_market_value</a>;
00054     buildings       = sPtr-&gt;<a class="code" href="classSchool.html#m72">year_end_market_value_of_plant</a>;
00055     capital_reserve   = sPtr-&gt;<a class="code" href="classSchool.html#m73">year_end_capital_reserve</a>;
00056     general_plant_debt  = sPtr-&gt;<a class="code" href="classSchool.html#m74">year_end_general_plant_and_residence_hall_debt</a> - sPtr-&gt;<a class="code" href="classSchool.html#m75">residence_hall_debt</a>;
00057     residence_hall_debt = sPtr-&gt;<a class="code" href="classSchool.html#m75">residence_hall_debt</a>;
00058     fund_balance      = endowment_market+buildings+capital_reserve-general_plant_debt-residence_hall_debt;
00059 
00060     <span class="comment">//----- field S -----//</span>
00061 
00062     gross_tuition_revenue = sPtr-&gt;<a class="code" href="classSchool.html#m36">total_gross_tuition_revenue</a>;
00063     financial_aid       = sPtr-&gt;<a class="code" href="classSchool.html#m37">total_financial_aid</a>;
00064     net_tuition_revenue   = gross_tuition_revenue-financial_aid;
00065 
00066     state_appropriations    = sPtr-&gt;<a class="code" href="classSchool.html#m41">state_and_local_appropriations</a>;
00067 
00068     sponsored_research    = sPtr-&gt;<a class="code" href="classSchool.html#m39">adjusted_total_sponsored_research</a>;
00069     gifts_to_operations   = sPtr-&gt;<a class="code" href="classSchool.html#m43">gifts_to_operations</a>;
00070     endowment_spending    = int(endowment_market * sPtr-&gt;<a class="code" href="classSchool.html#m108">endowment_spending_rate</a>/100.0);
00071 
00072     <span class="comment">//---- field Z ------//</span>
00073 
00074     athletics           = sPtr-&gt;<a class="code" href="classSchool.html#m44">athletics_revenue</a>;
00075     other_operating_income    = sPtr-&gt;<a class="code" href="classSchool.html#m45">adjusted_other_operating_income</a>;
00076     interest_on_operating_reserve   = <span class="keywordtype">int</span>(sPtr-&gt;<a class="code" href="classSchool.html#m70">current_funds_balance</a> * 0.08);
00077     total_sources_of_funds        = net_tuition_revenue
00078         + state_appropriations + sponsored_research + gifts_to_operations + endowment_spending
00079         + athletics + other_operating_income + interest_on_operating_reserve;
00080 
00081     <span class="comment">// field AD</span>
00082     dept_expense_faculty_salaries   = sPtr-&gt;<a class="code" href="classSchool.html#m48">academic_dept_faculty_salaries</a>;
00083     dept_expense_staff_salaries   = sPtr-&gt;<a class="code" href="classSchool.html#m47">academic_dept_total_salaries</a> - dept_expense_faculty_salaries;
00084     dept_expense_other          = sPtr-&gt;<a class="code" href="classSchool.html#m49">academic_dept_other_expense</a>;
00085     sponsored_research_faculty_salaries   = sPtr-&gt;<a class="code" href="classSchool.html#m51">sponsored_research_faculty_salaries</a>;
00086     sponsored_research_staff_salaries   = sPtr-&gt;<a class="code" href="classSchool.html#m50">sponsored_research_total_salaries</a> - sponsored_research_faculty_salaries;
00087     sponsored_research_other          = sPtr-&gt;<a class="code" href="classSchool.html#m52">sponsored_research_other_expense</a>;
00088 
00089     <span class="comment">// field AJ</span>
00090     library_staff_salaries    = sPtr-&gt;<a class="code" href="classSchool.html#m53">library_salaries</a>;
00091     library_other_expense   = sPtr-&gt;<a class="code" href="classSchool.html#m54">library_other_expense</a>;
00092 
00093     academic_it_staff_salaries    = <span class="keywordtype">int</span>(sPtr-&gt;<a class="code" href="classSchool.html#m67">academic_support_salaries</a> * 0.1);
00094     academic_it_other_expense   = <span class="keywordtype">int</span>(sPtr-&gt;<a class="code" href="classSchool.html#m68">academic_support_other_expense</a> * 0.3);
00095 
00096     <span class="comment">// field AN</span>
00097     student_life_staff_salaries = sPtr-&gt;<a class="code" href="classSchool.html#m55">student_life_salaries</a>;
00098     student_life_other_expense    = sPtr-&gt;<a class="code" href="classSchool.html#m56">student_life_other_expense</a>;
00099 
00100     <span class="comment">// fields already defined in base class School</span>
00101     <span class="comment">//athletics_salaries                                = sPtr-&gt;athletics_salaries;</span>
00102     <span class="comment">//athletics_other_expense                           = sPtr-&gt;athletics_other_expense;</span>
00103 
00104     <span class="comment">// field AR</span>
00105     inst_advancement_staff_salaries   = sPtr-&gt;<a class="code" href="classSchool.html#m61">inst_advancement_salaries</a>;
00106     inst_advancement_other_expense    = sPtr-&gt;<a class="code" href="classSchool.html#m62">inst_advancement_other_expense</a>;
00107 
00108     administration_staff_salaries   = sPtr-&gt;<a class="code" href="classSchool.html#m59">inst_support_net_salaries</a>;
00109     administration_other_expense    = sPtr-&gt;<a class="code" href="classSchool.html#m60">inst_support_net_other_expense</a>;
00110 
00111     o_and_m_staff_salaries    = sPtr-&gt;<a class="code" href="classSchool.html#m63">o_and_m_salaries</a>;
00112     o_and_m_other_expense   = sPtr-&gt;<a class="code" href="classSchool.html#m64">o_and_m_other_expense</a>;
00113 
00114     <span class="comment">// field AX</span>
00115     other_operating_expense_staff_salaries    = sPtr-&gt;<a class="code" href="classSchool.html#m67">academic_support_salaries</a> - academic_it_staff_salaries;
00116     other_operating_expense_other_expense   = sPtr-&gt;<a class="code" href="classSchool.html#m68">academic_support_other_expense</a> - academic_it_other_expense;
00117 
00118     total_operating_expenditure =                   <span class="comment">// = sPtr-&gt;SUM(AD1244:AY1244)</span>
00119         dept_expense_faculty_salaries +
00120         dept_expense_staff_salaries +
00121         dept_expense_other +
00122         sponsored_research_faculty_salaries +
00123         sponsored_research_staff_salaries +
00124         sponsored_research_other +
00125         library_staff_salaries +
00126         library_other_expense +
00127         academic_it_staff_salaries +
00128         academic_it_other_expense +
00129         student_life_staff_salaries +
00130         student_life_other_expense +
00131         athletics_salaries +
00132         athletics_other_expense +
00133         inst_advancement_staff_salaries +
00134         inst_advancement_other_expense +
00135         administration_staff_salaries +
00136         administration_other_expense +
00137         o_and_m_staff_salaries +
00138         o_and_m_other_expense +
00139         other_operating_expense_staff_salaries +
00140         other_operating_expense_other_expense;
00141 
00142     <span class="comment">// field BA</span>
00143     service_on_general_plant_debt = <span class="keywordtype">int</span>((sPtr-&gt;<a class="code" href="classSchool.html#m74">year_end_general_plant_and_residence_hall_debt</a>
00144                                          - sPtr-&gt;<a class="code" href="classSchool.html#m75">residence_hall_debt</a>)*0.065);
00145     transfer_to_capital_reserve = sPtr-&gt;<a class="code" href="classSchool.html#m78">transfer_to_plant</a>;
00146     total_uses_of_funds       = total_operating_expenditure + service_on_general_plant_debt+transfer_to_capital_reserve;
00147     surplus_or_deficit        = total_sources_of_funds-total_uses_of_funds;
00148 
00149     <span class="comment">// field BE</span>
00150     tuition_rate        = <span class="keywordtype">int</span>(sPtr-&gt;<a class="code" href="classSchool.html#m90">freshmen_from_within_the_state_percent</a>/100.0*sPtr-&gt;<a class="code" href="classSchool.html#m15">in_state_tuition</a>+(1-sPtr-&gt;<a class="code" href="classSchool.html#m90">freshmen_from_within_the_state_percent</a>/100.0)*sPtr-&gt;<a class="code" href="classSchool.html#m16">out_state_tuition</a>);
00151     room_and_board_rate   = sPtr-&gt;<a class="code" href="classSchool.html#m17">room_and_board_charges</a>;
00152     <span class="comment">//BUGHERE0 what that? "/ 1000 * 100"???</span>
00153     percent_traditional_ug_in_residence_halls   = <span class="keywordtype">float</span>(sPtr-&gt;<a class="code" href="classSchool.html#m18">ug_in_housing_percent</a>/1000.0 * 100.0);
00154     percent_get_bacc_in_5_year              = <span class="keywordtype">float</span>(sPtr-&gt;<a class="code" href="classSchool.html#m24">student_get_bacc_in_5_year_percent</a>/1000.0 * 100.0);
00155     overhead_rate_on_sponsored_research       = sPtr-&gt;<a class="code" href="classSchool.html#m107">overhead_rate</a>;
00156     endowment_spending_rate               = sPtr-&gt;<a class="code" href="classSchool.html#m108">endowment_spending_rate</a>;
00157 
00158     <span class="comment">// ----- field BK to CG ----- //</span>
00159 
00160     <span class="comment">// field BP - Assoc Profs</span>
00161     memcpy(&amp;(school_faculty_array_ex[<a class="code" href="Ofaculty_8h.html#a27a10">ASSOC_PROF</a>]), &amp;(sPtr-&gt;<a class="code" href="classSchool.html#m19">school_faculty_array</a>[<a class="code" href="Ofaculty_8h.html#a27a10">ASSOC_PROF</a>]), <span class="keyword">sizeof</span>(<a class="code" href="structSchoolFaculty.html">SchoolFaculty</a>));
00162     school_faculty_array_ex[<a class="code" href="Ofaculty_8h.html#a27a10">ASSOC_PROF</a>].active_research_dollars
00163         <span class="comment">//## chea 061299 1.8.2</span>
00164         <span class="comment">//              = int(0.8*sPtr-&gt;sponsored_research_per_reg_faculty);</span>
00165         = <span class="keywordtype">int</span>(sPtr-&gt;<a class="code" href="classSchool.html#m105">sponsored_research_per_reg_faculty</a>);
00166 
00167     <span class="comment">// field BU - Asst Professors</span>
00168     memcpy(&amp;(school_faculty_array_ex[<a class="code" href="Ofaculty_8h.html#a27a9">ASST_PROF</a>]), &amp;(sPtr-&gt;<a class="code" href="classSchool.html#m19">school_faculty_array</a>[<a class="code" href="Ofaculty_8h.html#a27a9">ASST_PROF</a>]), <span class="keyword">sizeof</span>(<a class="code" href="structSchoolFaculty.html">SchoolFaculty</a>));
00169     school_faculty_array_ex[<a class="code" href="Ofaculty_8h.html#a27a9">ASST_PROF</a>].active_research_dollars
00170         <span class="comment">//## chea 061299 1.8.2</span>
00171         <span class="comment">//              = int(0.5*sPtr-&gt;sponsored_research_per_reg_faculty);</span>
00172         = <span class="keywordtype">int</span>(0.6*sPtr-&gt;<a class="code" href="classSchool.html#m105">sponsored_research_per_reg_faculty</a>);
00173 
00174     <span class="comment">// field BK - Full Professors</span>
00175     memcpy(&amp;(school_faculty_array_ex[<a class="code" href="Ofaculty_8h.html#a27a11">FULL_PROF</a>]), &amp;(sPtr-&gt;<a class="code" href="classSchool.html#m19">school_faculty_array</a>[<a class="code" href="Ofaculty_8h.html#a27a11">FULL_PROF</a>]), <span class="keyword">sizeof</span>(<a class="code" href="structSchoolFaculty.html">SchoolFaculty</a>));
00176 
00177     if ( school_faculty_array_ex[<a class="code" href="Ofaculty_8h.html#a27a11">FULL_PROF</a>].faculty_count )
00178         school_faculty_array_ex[<a class="code" href="Ofaculty_8h.html#a27a11">FULL_PROF</a>].active_research_dollars
00179             = <span class="keywordtype">int</span>((sPtr-&gt;<a class="code" href="classSchool.html#m39">adjusted_total_sponsored_research</a>
00180                    - school_faculty_array_ex[<a class="code" href="Ofaculty_8h.html#a27a10">ASSOC_PROF</a>].faculty_count*school_faculty_array_ex[<a class="code" href="Ofaculty_8h.html#a27a10">ASSOC_PROF</a>].active_research_dollars
00181                    - school_faculty_array_ex[<a class="code" href="Ofaculty_8h.html#a27a9">ASST_PROF</a>].faculty_count*school_faculty_array_ex[<a class="code" href="Ofaculty_8h.html#a27a9">ASST_PROF</a>].active_research_dollars
00182                 ) / school_faculty_array_ex[<a class="code" href="Ofaculty_8h.html#a27a11">FULL_PROF</a>].faculty_count);
00183     <span class="keywordflow">else</span>
00184         school_faculty_array_ex[<a class="code" href="Ofaculty_8h.html#a27a11">FULL_PROF</a>].active_research_dollars = 0;
00185     <span class="comment">// (??-BP1244*BR1244-BU1244*BW1244)/BK1244;</span>
00186 
00187     <span class="comment">// field BZ - long-term adjuncts</span>
00188     memcpy(&amp;(school_faculty_array_ex[<a class="code" href="Ofaculty_8h.html#a27a12">LONG_TERM_ADJUNCT</a>]), &amp;(sPtr-&gt;<a class="code" href="classSchool.html#m19">school_faculty_array</a>[<a class="code" href="Ofaculty_8h.html#a27a12">LONG_TERM_ADJUNCT</a>]), <span class="keyword">sizeof</span>(<a class="code" href="structSchoolFaculty.html">SchoolFaculty</a>));
00189     school_faculty_array_ex[<a class="code" href="Ofaculty_8h.html#a27a12">LONG_TERM_ADJUNCT</a>].salary
00190         = <span class="keywordtype">int</span>(0.5*school_faculty_array_ex[<a class="code" href="Ofaculty_8h.html#a27a11">FULL_PROF</a>].salary
00191               + 0.35*school_faculty_array_ex[<a class="code" href="Ofaculty_8h.html#a27a10">ASSOC_PROF</a>].salary
00192               + 0.15*school_faculty_array_ex[<a class="code" href="Ofaculty_8h.html#a27a9">ASST_PROF</a>].salary);
00193 
00194     <span class="comment">// field CD - short-term adjuncts</span>
00195     memcpy(&amp;(school_faculty_array_ex[<a class="code" href="Ofaculty_8h.html#a27a13">SHORT_TERM_ADJUNCT</a>]), &amp;(sPtr-&gt;<a class="code" href="classSchool.html#m19">school_faculty_array</a>[<a class="code" href="Ofaculty_8h.html#a27a13">SHORT_TERM_ADJUNCT</a>]), <span class="keyword">sizeof</span>(<a class="code" href="structSchoolFaculty.html">SchoolFaculty</a>));
00196     school_faculty_array_ex[<a class="code" href="Ofaculty_8h.html#a27a13">SHORT_TERM_ADJUNCT</a>].salary
00197         = <span class="keywordtype">int</span>(0.15*school_faculty_array_ex[<a class="code" href="Ofaculty_8h.html#a27a11">FULL_PROF</a>].salary
00198               + 0.40*school_faculty_array_ex[<a class="code" href="Ofaculty_8h.html#a27a10">ASSOC_PROF</a>].salary
00199               + 0.45*school_faculty_array_ex[<a class="code" href="Ofaculty_8h.html#a27a9">ASST_PROF</a>].salary);
00200 
00201     <span class="comment">// Enroll ft,pt_ug,etc (Enroll SL1-5)</span>
00202     full_time_undergrad   = sPtr-&gt;<a class="code" href="classSchool.html#m80">full_time_undergrad</a>;
00203     part_time_undergrad   = sPtr-&gt;<a class="code" href="classSchool.html#m81">part_time_undergrad</a>;
00204     enrollment_masters    = sPtr-&gt;<a class="code" href="classSchool.html#m109">enrollment_masters</a>;
00205     enrollment_doctoral   = sPtr-&gt;<a class="code" href="classSchool.html#m110">enrollment_doctoral</a>;
00206     non_degree_seeking    = sPtr-&gt;<a class="code" href="classSchool.html#m83">non_degree_seeking</a>;
00207 
00208     <span class="comment">// field CM - Percent Female SL1-5</span>
00209     percent_female_sl[0]    = sPtr-&gt;<a class="code" href="classSchool.html#m84">female_undergrad_percent</a>;
00210     percent_female_sl[1]    = <span class="keywordtype">char</span>(sPtr-&gt;<a class="code" href="classSchool.html#m84">female_undergrad_percent</a>*1.1);
00211     percent_female_sl[2]    = <span class="keywordtype">char</span>(sPtr-&gt;<a class="code" href="classSchool.html#m85">female_grad_and_prof_percent</a>*1.1);
00212     percent_female_sl[3]    = <span class="keywordtype">char</span>(sPtr-&gt;<a class="code" href="classSchool.html#m85">female_grad_and_prof_percent</a>*0.75);
00213     percent_female_sl[4]    = <span class="keywordtype">char</span>(sPtr-&gt;<a class="code" href="classSchool.html#m84">female_undergrad_percent</a>*0.85);
00214 
00215     <span class="comment">// field CR - Percent Minority SL1-5</span>
00216     percent_minority_sl[0]  = <span class="keywordtype">char</span>(sPtr-&gt;<a class="code" href="classSchool.html#m86">minority_undergrad_percent</a>*0.85);
00217     percent_minority_sl[1]  = <span class="keywordtype">char</span>(sPtr-&gt;<a class="code" href="classSchool.html#m86">minority_undergrad_percent</a>*1.2);
00218     percent_minority_sl[2]  = sPtr-&gt;<a class="code" href="classSchool.html#m87">minority_grad_and_prof_percent</a>;
00219     percent_minority_sl[3]  = <span class="keywordtype">char</span>(sPtr-&gt;<a class="code" href="classSchool.html#m87">minority_grad_and_prof_percent</a>*0.6);
00220     percent_minority_sl[4]  = <span class="keywordtype">char</span>(sPtr-&gt;<a class="code" href="classSchool.html#m86">minority_undergrad_percent</a>*1.1);
00221 
00222     percent_instate_freshmen        = sPtr-&gt;<a class="code" href="classSchool.html#m90">freshmen_from_within_the_state_percent</a>;
00223     percent_non_resident_alien_doctoral = sPtr-&gt;<a class="code" href="classSchool.html#m88">non_resident_alien_grad_and_prof_percent</a>;
00224 
00225     <span class="comment">//##### begin fred0514 #####</span>
00226     <span class="comment">// field CY</span>
00227     <span class="comment">//memcpy(target_student_intake_sl, sPtr-&gt;target_student_intake_sl, sizeof(target_student_intake_sl));</span>
00228     <span class="comment">//memcpy(dropout_rate_sl, sPtr-&gt;dropout_rate_sl, sizeof(dropout_rate_sl));</span>
00229     <span class="comment">//memcpy(target_grad_rate_sl, sPtr-&gt;target_grad_rate_sl, sizeof(target_grad_rate_sl));</span>
00230     <span class="comment">//##### end fred0514 #####</span>
00231 
00232     <span class="comment">// field DN</span>
00233     ug_applications   = sPtr-&gt;<a class="code" href="classSchool.html#m21">student_applications</a>;
00234     ug_applications_rate  = <span class="keywordtype">float</span>(ug_applications)/sPtr-&gt;<a class="code" href="classSchool.html#m22">student_accepted</a>;
00235     ug_yield_rate     = 100-<span class="keywordtype">char</span>(<span class="keywordtype">float</span>(sPtr-&gt;<a class="code" href="classSchool.html#m23">student_enrolled</a>)/sPtr-&gt;<a class="code" href="classSchool.html#m22">student_accepted</a>*100.0);
00236 
00237     <span class="comment">//TO int the 3nd to 5th vars, as in the excel sheet?</span>
00238     <span class="comment">// fields already defined in base class School</span>
00239     <span class="comment">//percent_ug_students_on_aid                = sPtr-&gt;percent_ug_students_on_aid;</span>
00240     <span class="comment">//percent_freshmen_with_need                = sPtr-&gt;percent_freshmen_with_need;</span>
00241     <span class="comment">//percent_freshmen_offered_aid                      = sPtr-&gt;percent_freshmen_offered_aid;</span>
00242     <span class="comment">//percent_freshmen_offered_full_aid = sPtr-&gt;percent_freshmen_offered_full_aid;</span>
00243     <span class="comment">//institutional_aid_per_fte         = sPtr-&gt;institutional_aid_per_fte;</span>
00244 
00245     <span class="comment">//----- init using degRec -----//</span>
00246     <span class="comment">// (from sheet degree_by_field of excel file master)</span>
00247     <span class="comment">// note: ** major_pref of sl1 = that of sl2 **</span>
00248     <span class="comment">// add degree fields here: student_ifield_pctercne</span>
00249 
00250     <span class="comment">//SchoolDegreeSLRec student_level[3];               // for sl 1&amp;2, 3, 4 // major_pref of sl1 = that of sl2</span>
00251     <span class="comment">//SchoolDegreeSLRec2 student_level5;                // for sl 5</span>
00252 
00253     <a class="code" href="ALL_8H.html#a0">err_when</a>(<a class="code" href="Ostudent_8h.html#a32a3">UG_TRADITION</a>!=0);
00254     <span class="keywordtype">short</span> sl;
00255 
00256     <span class="keywordflow">for</span> (sl=<a class="code" href="Ostudent_8h.html#a32a3">UG_TRADITION</a>; sl&lt;=<a class="code" href="Ostudent_8h.html#a32a6">DOCTOR</a>; sl++) {
00257         <span class="keywordflow">if</span> ( sl != <a class="code" href="Ostudent_8h.html#a32a6">DOCTOR</a>  )
00258             init_student_ifield_pct(degRec, sl, 8);
00259         <span class="keywordflow">else</span>
00260             init_student_ifield_pct(degRec, sl, 9);     <span class="comment">// special case in the database</span>
00261     }
00262 
00263     <span class="comment">// sheet degree_by_field store info in integer (number of student)</span>
00264     <span class="comment">// but spreadsheet init_condi change this to percentage</span>
00265     <span class="keywordtype">short</span> fd;
00266     <span class="keywordtype">float</span> total;
00267 
00268     <span class="keywordflow">for</span> (sl=0; sl&lt;<a class="code" href="Ostudent_8h.html#a1">MAX_STUDENT_LEVEL_INI</a>; sl++)
00269         <span class="keywordflow">for</span> (fd = 0; fd &lt; <a class="code" href="OFIELD_8H.html#a26a1">IPED_FIELD_COUNT</a>; fd++) {
00270             total = student_ifield_pct_total[sl];
00271             <span class="keywordflow">if</span> ( total &lt;= 0.00001 )                       // total must &gt;= 0
00272                 student_ifield_pct[sl][fd] = 0.0;
00273             <span class="keywordflow">else</span>
00274                 student_ifield_pct[sl][fd] /= total;
00275         }
00276 
00277 #ifdef DEBUG_NO
00278     <span class="keyword">const</span> <span class="keywordtype">short</span> specialOrder[<a class="code" href="OFIELD_8H.html#a26a1">IPED_FIELD_COUNT</a>] = {
00279         <a class="code" href="OFIELD_8H.html#a27a2">AGRICULTURE</a>,<a class="code" href="OFIELD_8H.html#a27a11">INTER_DISCIPLINARY</a>,<a class="code" href="OFIELD_8H.html#a27a4">BUSINESS</a>,<a class="code" href="OFIELD_8H.html#a27a5">COMMUNICAIONS_LIBRARY_SCI</a>,
00280         <a class="code" href="OFIELD_8H.html#a27a13">MATH_COMP_SCI</a>,<a class="code" href="OFIELD_8H.html#a27a6">EDUCATION</a>,<a class="code" href="OFIELD_8H.html#a27a7">ENGINEERING</a>,<a class="code" href="OFIELD_8H.html#a27a8">FOREIGN_LANGUAGES</a>,<a class="code" href="OFIELD_8H.html#a27a9">HEALTH_SOCIAL_SVCS</a>,<a class="code" href="OFIELD_8H.html#a27a10">HUMANITIES</a>,
00281         <a class="code" href="OFIELD_8H.html#a27a12">LIFE_PHYSICAL_SCI</a>,<a class="code" href="OFIELD_8H.html#a27a14">SOCIAL_SCIENCES</a>,<a class="code" href="OFIELD_8H.html#a27a15">VISUAL_PERFORMING_ARTS</a>,<a class="code" href="OFIELD_8H.html#a27a3">BASIC_PERSONAL_PRACTICAL_SVCS</a>
00282     };
00283 
00284     <span class="keywordflow">for</span> (<span class="keywordtype">short</span> fd=0; fd&lt;<a class="code" href="OFIELD_8H.html#a26a1">IPED_FIELD_COUNT</a>; fd++) {
00285         <span class="keywordtype">char</span> s[300];
00286         sprintf(s, <span class="stringliteral">"schoolex: init: %f "</span>, student_ifield_pct[0][specialOrder[fd]]);
00287         debug_msg(s);
00288     }
00289 #endif
00290     <span class="comment">// northwest sl1</span>
00291     <span class="comment">//  0.000   0.021   0.029   0.115   0.035   0.023   0.143   0.012   0.000   0.134   0.085   0.299   0.084   0.020</span>
00292 }
00293 
00294 <span class="comment">//--------- End of function SchoolEx::init --------//</span>
00295 
00296 <span class="comment">//--------- Begin of function SchoolEx::init --------//</span>
00300 <span class="comment">void SchoolEx::init_student_ifield_pct(SchoolDegreeRec* degRec, short sl, short len) {</span>
00301     <span class="keywordflow">if</span> ( sl != <a class="code" href="Ostudent_8h.html#a32a7">DISTANCE_LEARN</a> ) {
00302         <a class="code" href="structSchoolDegreeSLRec.html">SchoolDegreeSLRec</a>* slRec = &amp;(degRec-&gt;<a class="code" href="classSchoolDegreeRec.html#o7">student_level</a>[sl]);
00303 
00304         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a2">AGRICULTURE</a>] = (<span class="keywordtype">float</span>)  m.atoi( slRec-&gt;  agriculture_forestry, len );
00305         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a11">INTER_DISCIPLINARY</a>] = (float)  m.atoi( slRec-&gt; inter_disciplinary, len );
00306         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a4">BUSINESS</a>] = (float)  m.atoi( slRec-&gt; business, len);
00307         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a5">COMMUNICAIONS_LIBRARY_SCI</a>] = (float)  m.atoi( slRec-&gt;  communicaions_library_sci, len );
00308         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a13">MATH_COMP_SCI</a>] = (float)  m.atoi( slRec-&gt;  math_comp_sci, len );
00309         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a6">EDUCATION</a>] = (float)  m.atoi( slRec-&gt;  education, len );
00310 
00311         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a7">ENGINEERING</a>] = (float)  m.atoi( slRec-&gt;  engineering, len );
00312         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a8">FOREIGN_LANGUAGES</a>] = (float)  m.atoi( slRec-&gt;  foreign_languages, len );
00313         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a9">HEALTH_SOCIAL_SVCS</a>] = (float)  m.atoi( slRec-&gt; health_social_svcs, len );
00314         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a10">HUMANITIES</a>] = (float)  m.atoi( slRec-&gt; humanities, len );
00315         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a12">LIFE_PHYSICAL_SCI</a>] = (float)  m.atoi( slRec-&gt;  life_physical_sci, len );
00316 
00317         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a14">SOCIAL_SCIENCES</a>] = (float)  m.atoi( slRec-&gt;  social_sciences, len );
00318         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a15">VISUAL_PERFORMING_ARTS</a>] = (float)  m.atoi( slRec-&gt; visual_Performing_arts, len );
00319         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a3">BASIC_PERSONAL_PRACTICAL_SVCS</a>] = (float)  m.atoi( slRec-&gt;  basic_Personal_practical_svcs, len );
00320 
00321         student_ifield_pct_total[sl] = (float)  m.atoi( slRec-&gt; total, len );
00322     }
00323     <span class="keywordflow">else</span> {
00324         <a class="code" href="structSchoolDegreeSLRec2.html">SchoolDegreeSLRec2</a>* slRec = &amp;(degRec-&gt;<a class="code" href="classSchoolDegreeRec.html#o8">student_level5</a>);
00325 
00326         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a2">AGRICULTURE</a>] = (float)  m.atoi( slRec-&gt;  agriculture_forestry, len );
00327         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a11">INTER_DISCIPLINARY</a>] = (float)  m.atoi( slRec-&gt; inter_disciplinary, len );
00328         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a4">BUSINESS</a>] = (float)  m.atoi( slRec-&gt; business, len);
00329         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a5">COMMUNICAIONS_LIBRARY_SCI</a>] = (float)  m.atoi( slRec-&gt;  communicaions_library_sci, len );
00330         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a13">MATH_COMP_SCI</a>] = (float)  m.atoi( slRec-&gt;  math_comp_sci, len );
00331         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a6">EDUCATION</a>] = (float)  m.atoi( slRec-&gt;  education, len );
00332 
00333         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a7">ENGINEERING</a>] = (float)  m.atoi( slRec-&gt;  engineering, len );
00334         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a8">FOREIGN_LANGUAGES</a>] = (float)  m.atoi( slRec-&gt;  foreign_languages, len );
00335         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a9">HEALTH_SOCIAL_SVCS</a>] = (float)  m.atoi( slRec-&gt; health_social_svcs, len );
00336         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a10">HUMANITIES</a>] = (float)  m.atoi( slRec-&gt; humanities, len );
00337         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a12">LIFE_PHYSICAL_SCI</a>] = (float)  m.atoi( slRec-&gt;  life_physical_sci, len );
00338 
00339         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a14">SOCIAL_SCIENCES</a>] = (float)  m.atoi( slRec-&gt;  social_sciences, len );
00340         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a15">VISUAL_PERFORMING_ARTS</a>] = (float)  m.atoi( slRec-&gt; visual_Performing_arts, len );
00341         student_ifield_pct[sl][<a class="code" href="OFIELD_8H.html#a27a3">BASIC_PERSONAL_PRACTICAL_SVCS</a>] = (float)  m.atoi( slRec-&gt;  basic_Personal_practical_svcs, len );
00342 
00343         student_ifield_pct_total[sl] = (float)  m.atoi( slRec-&gt; total, 11 );
00344     }
00345 }
00346 
00347 <span class="comment">//--------- End of function SchoolEx::init --------//</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:38:19 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
