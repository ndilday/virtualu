<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Oprtmen5.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Oprtmen5.cpp</h1><a href="Oprtmen5_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : OPRTMENU5.CPP</span>
00002 <span class="comment">//Description : Printing Menu Class Implementation</span>
00003 <span class="comment">//Owner           : Kevin(ho)</span>
00004 
00005 <span class="preprocessor">#include &lt;OPRINT.H&gt;</span>
00006 <span class="preprocessor">#include &lt;<a class="code" href="OVGALOCK_8H.html">OVGALOCK.H</a>&gt;</span>
00007 <span class="preprocessor">#include &lt;<a class="code" href="OPRTMENU_8H.html">OPRTMENU.H</a>&gt;</span>
00008 <span class="preprocessor">#include &lt;OWORLDMT.H&gt;</span>
00009 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00010 <span class="preprocessor">#include &lt;<a class="code" href="OBOX_8H.html">OBOX.H</a>&gt;</span>
00011 <span class="preprocessor">#include &lt;<a class="code" href="OVGA_8H.html">OVGA.H</a>&gt;</span>
00012 <span class="preprocessor">#include &lt;OFONT.H&gt;</span>
00013 <span class="preprocessor">#include &lt;OGAMESTR.H&gt;</span>
00014 <span class="preprocessor">#include &lt;OMOUSE.H&gt;</span>
00015 <span class="preprocessor">#include &lt;<a class="code" href="OMOUSE2_8H.html">OMOUSE2.H</a>&gt;</span>
00016 <span class="preprocessor">#include &lt;OIFACE.H&gt;</span>
00017 <span class="preprocessor">#include &lt;OINFO.H&gt;</span>
00018 <span class="preprocessor">#include &lt;OPSCHOOL.H&gt;</span>
00019 <span class="preprocessor">#include &lt;OLIBTECH.H&gt;</span>
00020 <span class="preprocessor">#include &lt;OINVEST.H&gt;</span>
00021 <span class="preprocessor">#include &lt;<a class="code" href="OPARKING_8H.html">OPARKING.H</a>&gt;</span>
00022 <span class="preprocessor">#include &lt;OCRIME.H&gt;</span>
00023 <span class="preprocessor">#include &lt;ODEPT.H&gt;</span>
00024 <span class="preprocessor">#include &lt;<a class="code" href="ODATE_8H.html">ODATE.H</a>&gt;</span>
00025 
00026 <span class="keyword">enum</span> {                                            <span class="comment">// screen coordinates</span>
00027     <a class="code" href="Oprtmen5_8cpp.html#a8a0">REPORT_X1</a> = <a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>+15,
00028     <a class="code" href="Oprtmen5_8cpp.html#a8a1">REPORT_Y1</a> = <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>+25,
00029     <a class="code" href="Oprtmen5_8cpp.html#a8a2">REPORT_X2</a> = <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-15,
00030     <a class="code" href="Oprtmen5_8cpp.html#a8a3">REPORT_Y2</a> = <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-55
00031 };
00032 
00033 <span class="keyword">enum</span> {
00034     <a class="code" href="Oprtmen5_8cpp.html#a9a4">PRINT_OPT1</a>=1,
00035     <a class="code" href="Oprtmen5_8cpp.html#a9a5">PRINT_OPT2</a>=2,
00036     <a class="code" href="Oprtmen5_8cpp.html#a9a6">PRINT_OPT3</a>=3,
00037     <a class="code" href="Oprtmen5_8cpp.html#a9a7">PRINT_OPT4</a>=4,
00038 };
00039 
<a name="l00040"></a><a class="code" href="classPrintMenu.html#a10">00040</a> <span class="keywordtype">void</span> <a class="code" href="classPrintMenu.html#a10">PrintMenu::printing5</a>() {
00041   box.tell(<span class="stringliteral">"Now printing. \nPlease wait..."</span>);
00042   sys.no_true_output_flag=1;
00043   box.close();
00044   sys.no_true_output_flag=0;
00045 
00049   <span class="keywordflow">if</span>(<a class="code" href="classPrintMenu.html#m0">print_view_mode</a>==<a class="code" href="Osys_8h.html#a45a13">MODE_PERFORMANCE_REPORT</a>) {
00050     <span class="keywordflow">if</span>(<a class="code" href="classPrintMenu.html#m1">print_option</a>==3) {
00051       <span class="keywordtype">int</span> deptRecno = department_array.selected_recno;
00052       <a class="code" href="classDepartment.html">Department</a>* cur_dept_ptr = department_array[deptRecno];
00053       cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a15">print_report</a>();
00054       <span class="keywordflow">return</span>;
00055     }
00056 
00057     <span class="keywordflow">if</span>(<a class="code" href="classPrintMenu.html#m1">print_option</a>==4) {
00058       <span class="keywordtype">int</span> tmp_backup=department_array.selected_recno;
00059       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;=department_array.size();i++) {
00060         <span class="keywordflow">if</span>(department_array.is_deleted(i))
00061           <span class="keywordflow">continue</span>;
00062         department_array.selected_recno=i;
00063         <a class="code" href="classDepartment.html">Department</a>* cur_dept_ptr = department_array[i];
00064         cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a15">print_report</a>();
00065       }
00066       department_array.selected_recno=tmp_backup;
00067       <span class="keywordflow">return</span>; {
00068     }
00069 
00070       <a class="code" href="classMouseDispCount.html">MouseDispCount</a> mdc;
00071       print.start_print(sys.main_hwnd,sys.app_hinstance);
00072       print.open_page();
00073 
00074       print.dfont(10,<span class="keyword">false</span>,<span class="keyword">false</span>,0);
00075 
00076       print.put_text(<span class="stringliteral">"Insitution : "</span>,30,4);
00077                                                   <span class="comment">//Player Institution</span>
00078       print.put_text(player_school.school_name,44,4);
00079       print.put_text(<span class="stringliteral">"President : "</span>,30,5);
00080       <a class="code" href="classString.html">String</a> str;
00081       str =  player_school.player_first_name;
00082       str += <span class="stringliteral">" "</span>;
00083       str += player_school.player_last_name;
00084       print.put_text(str.<a class="code" href="classString.html#m0">str_buf</a>,44,5);           <span class="comment">//President</span>
00085       print.put_text(<span class="stringliteral">"Date : "</span>,99,5);
00086       <span class="comment">// print.put_text(date.date_str(info.game_date),107,5);                   //date</span>
00087       print.put_text(info.date_str_julian(info.game_date), 107,5 );
00088 
00089       <span class="keywordflow">if</span>(player_school.scenario_id&gt;0) {
00090         print.dfont(10,<span class="keyword">false</span>,<span class="keyword">false</span>,700);
00091         print.put_text(scn_name[player_school.scenario_id-1],50,6);
00092       }
00093 
00094       <span class="keywordflow">if</span>(<a class="code" href="classPrintMenu.html#m1">print_option</a>==1) {
00095         <span class="keyword">enum</span> {
00096           <a class="code" href="Odept__if_8cpp.html#a138a86">MODE_INSTITUTION</a>  = 0,
00097           <a class="code" href="Odept__if_8cpp.html#a138a87">MODE_DEPARTMENT</a> = 1,
00098           MODE_RANK     = 2,
00099         };
00100 
00101         <span class="keywordtype">int</span> recno_backup=department_array.selected_recno;
00102         <span class="keywordtype">int</span> scn_backup=department_array.current_screen_mode;
00103         <span class="keywordtype">int</span> report_type_backup=department_array.current_pref_report_type;
00104         <span class="keywordtype">int</span> data_mode_backup=department_array.current_data_mode;
00105 
00106         <span class="keywordtype">int</span> deptRecno = department_array.selected_recno;
00107 
00108         print.dfont(18,<span class="keyword">false</span>,<span class="keyword">false</span>,700);
00109         print.put_text(<span class="stringliteral">"Virtual U Performance Report"</span>,17,1);
00110 
00111         <a class="code" href="classDepartment.html">Department</a>* cur_dept_ptr = department_array[deptRecno];
00112         <a class="code" href="classString.html">String</a> str1;
00113         str1 = <span class="stringliteral">"Department : "</span>;
00114         str1 += cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a3">name</a>();
00115         str1 += <span class="stringliteral">"                                                                                                                              "</span>;
00116         print.dfont(12,<span class="keyword">false</span>,<span class="keyword">false</span>,0);
00117         print.put_text(<span class="stringliteral">"________________________________________________________________________________________________________________________________________________________________________________________________"</span>,20,6);
00118         print.dfont(12,<span class="keyword">false</span>,<span class="keyword">true</span>,0);
00119         print.put_text(str1.<a class="code" href="classString.html#m0">str_buf</a>,20,7);
00120 
00121         user_interface.backgd_flag=0;
00122         sys.no_true_output_flag=1;
00123         sys.view_mode=<a class="code" href="Osys_8h.html#a45a13">MODE_PERFORMANCE_REPORT</a>; {
00124         <span class="comment">//                              if(department_array.current_data_mode!=MODE_RANK)</span>
00125                                                   <span class="comment">// chwg072699</span>
00126           department_array[department_array.selected_recno]-&gt;<a class="code" href="classDepartment.html#a14">set_report_init_flag</a>(1);
00127           department_array[department_array.selected_recno]-&gt;<a class="code" href="classDepartment.html#a5">main_report_deinit</a>();
00128           department_array[department_array.selected_recno]-&gt;<a class="code" href="classDepartment.html#a4">main_report</a>(<a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>);
00129         }
00130 
00131         <span class="comment">//First page printing</span>
00132         <span class="comment">//*********************start printing********************</span>
00133         <span class="comment">//this will print the bmp in the center of the paper and 1/7 down the page</span>
00134         print.put_vga_back_center(<span class="stringliteral">"prn001.bmp"</span>,
00135           <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>-33,
00136           0.2,<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>,<a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>
00137         <span class="comment">/*upper left cor. of bitmap*/</span>
00138           );
00139 
00140         sys.no_true_output_flag=0;
00141         user_interface.backgd_flag=1; {
00142 
00143         <span class="comment">//                              if(department_array.current_data_mode!=MODE_RANK)</span>
00144                                                   <span class="comment">// chwg072699</span>
00145           department_array[department_array.selected_recno]-&gt;<a class="code" href="classDepartment.html#a14">set_report_init_flag</a>(1);
00146           department_array[department_array.selected_recno]-&gt;<a class="code" href="classDepartment.html#a5">main_report_deinit</a>();
00147         }
00148         department_array.selected_recno=recno_backup;
00149         department_array.current_screen_mode=scn_backup;
00150         department_array.current_pref_report_type=report_type_backup;
00151         department_array.current_data_mode=data_mode_backup;
00152 
00153       }
00154 
00155       <span class="keywordflow">if</span>(<a class="code" href="classPrintMenu.html#m1">print_option</a>==2) {
00156         <span class="comment">/*                              String str1;</span>
00157 <span class="comment">                str1 = "Department : ";</span>
00158 <span class="comment">                str1 += cur_dept_ptr-&gt;name();</span>
00159 <span class="comment">                str1 += "                                                                                                                              ";</span>
00160 <span class="comment">                print.dfont(12,false,false,0);</span>
00161 <span class="comment">                print.put_text("________________________________________________________________________________________________________________________________________________________________________________________________",20,6);</span>
00162 <span class="comment">                print.dfont(12,false,true,0);</span>
00163 <span class="comment">                print.put_text(str1.str_buf,20,7);</span>
00164 <span class="comment">        */</span>
00165 
00166         print.dfont(18,<span class="keyword">false</span>,<span class="keyword">false</span>,700);
00167         print.put_text(<span class="stringliteral">"Virtual U Departmental Performance Summary Report"</span>,7,1);
00168 
00169         print.dfont(12,<span class="keyword">false</span>,<span class="keyword">false</span>,0);
00170         print.put_text(<span class="stringliteral">"________________________________________________________________________________________________________________________________________________________________________________________________"</span>,15,10);
00171 
00172         print.dfont(10,<span class="keyword">false</span>,<span class="keyword">false</span>,0);
00173 
00174         print.put_text(<span class="stringliteral">"Faculty"</span>,100,10);
00175         print.put_text(<span class="stringliteral">"Faculty"</span>,130,10);
00176 
00177         print.put_text(<span class="stringliteral">"Educational"</span>,55,11);
00178         print.put_text(<span class="stringliteral">"Departmental"</span>,70,11);
00179         print.put_text(<span class="stringliteral">"Student"</span>,85,11);
00180         print.put_text(<span class="stringliteral">"Research"</span>,100,11);
00181         print.put_text(<span class="stringliteral">"Faculty"</span>,115,11);
00182         print.put_text(<span class="stringliteral">"Diversity"</span>,130,11);
00183 
00184         print.put_text(<span class="stringliteral">"Department"</span>,20,12);
00185         print.put_text(<span class="stringliteral">"Quality"</span>,55,12);
00186         print.put_text(<span class="stringliteral">"Prestige"</span>,70,12);
00187         print.put_text(<span class="stringliteral">"Morale"</span>,85,12);
00188         print.put_text(<span class="stringliteral">"Performance"</span>,100,12);
00189         print.put_text(<span class="stringliteral">"Morale"</span>,115,12);
00190         print.put_text(<span class="stringliteral">"Index"</span>,130,12);
00191 
00192         print.dfont(10,<span class="keyword">false</span>,<span class="keyword">false</span>,0);
00193 
00194         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;=department_array.size();i++) {
00195           <span class="keywordflow">if</span>(department_array.is_deleted(i))
00196             <span class="keywordflow">continue</span>;
00197           <a class="code" href="classDepartment.html">Department</a>* cur_dept_ptr = department_array[i];
00198 
00199           print.put_text(cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#a3">name</a>(),18,13+i);
00200           print.put_text(m.format(cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m52">p_educational_quality_history</a>[HISTORY_TRIMESTER_COUNT-1],1),58,13+i);
00201           print.put_text(m.format(cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m53">p_academic_standing_history</a>[HISTORY_YEAR_COUNT-1],1),73,13+i);
00202           print.put_text(m.format(cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m54">p_student_morale_history</a>[HISTORY_TRIMESTER_COUNT-1],1),86,13+i);
00203           print.put_text(m.format(cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m55">p_faculty_research_history</a>[HISTORY_MONTH_COUNT-1],1),102,13+i);
00204           print.put_text(m.format(cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m56">p_faculty_morale_history</a>[HISTORY_MONTH_COUNT-1],1),117,13+i);
00205           print.put_text(m.format(cur_dept_ptr-&gt;<a class="code" href="classDepartment.html#m57">p_faculty_diversity_history</a>[HISTORY_YEAR_COUNT-1],1),132,13+i);
00206         }
00207       }
00208       print.end_page();
00209       print.endprint(sys.main_hwnd);
00210     }
00211   }
00212 }
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:38:13 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
