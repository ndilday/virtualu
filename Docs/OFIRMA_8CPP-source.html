<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>OFIRMA.CPP Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>OFIRMA.CPP</h1><a href="OFIRMA_8CPP.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : OFirmArray.cpp</span>
00002 <span class="comment">//Description : FirmArray Class Definition</span>
00003 <span class="comment">//owner         : ho</span>
00004 
00005 <span class="preprocessor">#include &lt;OAUDIO.H&gt;</span>
00006 <span class="preprocessor">#include &lt;OCONFIG.H&gt;</span>
00007 <span class="preprocessor">#include &lt;ODEPT.H&gt;</span>
00008 <span class="preprocessor">#include &lt;<a class="code" href="OFIRMRES_8H.html">OFIRMRES.H</a>&gt;</span>
00009 <span class="preprocessor">#include &lt;OFIRM.H&gt;</span>
00010 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00011 
00012 <span class="comment">//----------- Begin of function FirmArray Constructor -----//</span>
<a name="l00017"></a><a class="code" href="classFirmArray.html#a0">00017</a> <span class="comment">FirmArray::FirmArray() : DynArrayB(sizeof(Firm*), 50, DEFAULT_REUSE_INTERVAL_DAYS) {</span>
00018 
00019 }
00020 
00021 <span class="comment">//------------- End of function FirmArray Constructor -----//</span>
00022 
00023 <span class="comment">//----------- Begin of function FirmArray Destructor ------//</span>
<a name="l00025"></a><a class="code" href="classFirmArray.html#a1">00025</a> <span class="comment">FirmArray::~FirmArray() {</span>
00026 
00027 }
00028 
00029 <span class="comment">//------------- End of function FirmArray Destructor ------//</span>
00030 
00031 <span class="comment">//----------- Begin of function FirmArray::init --------//</span>
<a name="l00033"></a><a class="code" href="classFirmArray.html#a2">00033</a> <span class="comment">void FirmArray::init() {</span>
00034     selected_recno = 0;
00035     touched_recno  = 0;
00036 }
00037 
00038 <span class="comment">//------------- End of function FirmArray::init --------//</span>
00039 
00040 <span class="comment">//----------- Begin of function FirmArray::deinit --------//</span>
<a name="l00042"></a><a class="code" href="classFirmArray.html#a3">00042</a> <span class="comment">void FirmArray::deinit() {</span>
00043     <span class="comment">//#### fred 1113</span>
00044 
00045     <span class="keywordflow">if</span>( size()==0 )
00046         <span class="keywordflow">return</span>;
00047 
00048     <span class="comment">//----------------------------------//</span>
00049 
00050     <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=size() ; i&gt;0 ; i-- ) {
00051         <span class="keywordflow">if</span>( !is_deleted(i) )
00052             del_firm(i);
00053     }
00054 
00055     <span class="comment">//----------------------------------//</span>
00056 
00057     zap();                                          <span class="comment">// zap the DynArrayB</span>
00058 }
00059 
00060 <span class="comment">//------------- End of function FirmArray::deinit --------//</span>
00061 
00062 <span class="comment">//----------- Begin of function FirmArray::process ------//</span>
<a name="l00069"></a><a class="code" href="classFirmArray.html#a9">00069</a> <span class="comment">int FirmArray::process() {</span>
00070     <span class="keywordflow">return</span> 1;
00071 }
00072 
00073 <span class="comment">//------------- End of function FirmArray::process ------//</span>
00074 
00075 <span class="comment">//--------- Begin of function FirmArray::add_firm ---------//</span>
<a name="l00083"></a><a class="code" href="classFirmArray.html#a4">00083</a> <span class="comment">int FirmArray::add_firm(int xLoc, int yLoc, int firmId) {</span>
00084     <span class="keywordflow">if</span>( !firm_res[firmId]-&gt;is_available() )         <span class="comment">// if the firm is not available in the current university type, don't add it</span>
00085         <span class="keywordflow">return</span> 0;
00086 
00087     <span class="comment">//  if( !world.can_build_firm(xLoc, yLoc, firmId) )</span>
00088     <span class="comment">//          return 0;</span>
00089 
00090     <span class="comment">//---------- create the firm -------------//</span>
00091 
00092     <span class="keywordtype">int</span> firmRecno = create_firm(firmId);
00093 
00094     firm_array[firmRecno]-&gt;init(xLoc, yLoc, firmId);
00095 
00096     <span class="keywordflow">return</span> firmRecno;
00097 }
00098 
00099 <span class="comment">//---------- End of function FirmArray::add_firm ---------//</span>
00100 
00101 <span class="comment">//--------- Begin of function FirmArray::create_firm ---------//</span>
<a name="l00111"></a><a class="code" href="classFirmArray.html#a5">00111</a> <span class="comment">int FirmArray::create_firm(int firmId) {</span>
00112     <a class="code" href="classFirm.html">Firm</a>* firmPtr;
00113 
00114     <span class="keywordflow">switch</span>(firmId) {
00115     <span class="keywordflow">case</span> 1:
00116     <span class="keywordflow">default</span>:
00117         firmPtr = <span class="keyword">new</span> <a class="code" href="classFirm.html">Firm</a>;                         <span class="comment">//TO change it to NAT_SCI ??</span>
00118         <span class="keywordflow">break</span>;
00119 
00120         <span class="comment">//temp default:</span>
00121         <span class="comment">//err_now("FirmArray::create_firm()");</span>
00122     }
00123 
00124     <span class="comment">//----------------------------------------//</span>
00125 
00126     linkin(&amp;firmPtr);
00127     firmPtr-&gt;<a class="code" href="classFirm.html#m0">firm_recno</a> = recno();
00128 
00129     <span class="keywordflow">return</span> firmPtr-&gt;<a class="code" href="classFirm.html#m0">firm_recno</a>;
00130 }
00131 
00132 <span class="comment">//----------- End of function FirmArray::create_firm ---------//</span>
00133 
00134 <span class="comment">//--------- Begin of function FirmArray::del_firm ---------//</span>
00135 
<a name="l00136"></a><a class="code" href="classFirmArray.html#a7">00136</a> <span class="keywordtype">void</span> <a class="code" href="classFirmArray.html#a7">FirmArray::del_firm</a>(<span class="keywordtype">int</span> recNo) {
00137     <a class="code" href="classFirm.html">Firm</a>* firmPtr = firm_array[recNo];
00138 
00139     <span class="keyword">delete</span> firmPtr;
00140 
00141     <a class="code" href="classDynArrayB.html#a5">linkout</a>(recNo);
00142 
00143     <span class="comment">//--------------------------------//</span>
00144 
00145     <span class="keywordflow">if</span>( recNo == <a class="code" href="classFirmArray.html#m0">selected_recno</a> )
00146         <a class="code" href="classFirmArray.html#m0">selected_recno</a> = 0;
00147 
00148     <span class="comment">//--------------------------------//</span>
00149 
00150     <span class="keywordflow">if</span>( recNo == <a class="code" href="classFirmArray.html#m1">touched_recno</a> )
00151         <a class="code" href="classFirmArray.html#m1">touched_recno</a> = 0;
00152 }
00153 
00154 <span class="comment">//----------- End of function FirmArray::del_firm -----------//</span>
00155 
00156 <span class="comment">//--------- Begin of function FirmArray::select_firm ---------//</span>
00157 
<a name="l00158"></a><a class="code" href="classFirmArray.html#a6">00158</a> <span class="keywordtype">void</span> <a class="code" href="classFirmArray.html#a6">FirmArray::select_firm</a>(<span class="keywordtype">int</span> selectedRecno) {
00159     <a class="code" href="classFirmArray.html#m0">selected_recno</a> = selectedRecno;
00160 
00161     <span class="keywordflow">if</span>( !selectedRecno )
00162         <span class="keywordflow">return</span>;
00163 
00164     <a class="code" href="classFirm.html">Firm</a>* firmPtr = <a class="code" href="classFirmArray.html#a17">operator[]</a>(selectedRecno);
00165 
00166     <span class="keywordflow">if</span>( firmPtr-&gt;<a class="code" href="classFirm.html#m2">department_recno</a> ) {               <span class="comment">// only change the selected department recno if the newly selected firm is a departmental building, otherwise keep the current selected department</span>
00167         department_array.selected_recno = firmPtr-&gt;<a class="code" href="classFirm.html#m2">department_recno</a>;
00168         sys.bDept=<span class="keyword">true</span>;
00169     }
00170     <span class="keywordflow">else</span> {
00171         sys.bDept=<span class="keyword">false</span>;
00172         sys.old_Dept=-1;
00173 
00174         <span class="comment">//--------- play sound --------------//</span>
00175 
00176         <span class="keywordflow">switch</span>( firmPtr-&gt;<a class="code" href="classFirm.html#m1">firm_id</a> ) {
00177         <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a5">FIRM_ADMISSIONS</a>:
00178             audio.play_wav(<span class="stringliteral">"ADMISSN"</span>,audio.int_to_DsVolume(config.sound_effect_volume));
00179             <span class="keywordflow">break</span>;
00180 
00181         <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a19">FIRM_INDOOR_SPORTS</a>:
00182             audio.play_wav(<span class="stringliteral">"BBALL"</span>,audio.int_to_DsVolume(config.sound_effect_volume));
00183             <span class="keywordflow">break</span>;
00184 
00185         <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a17">FIRM_STADIUM</a>:
00186             audio.play_wav(<span class="stringliteral">"FOOTBALL"</span>,audio.int_to_DsVolume(config.sound_effect_volume));
00187             <span class="keywordflow">break</span>;
00188 
00189         <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a6">FIRM_DEVELOPMENT</a>:
00190             audio.play_wav(<span class="stringliteral">"DEVALUMN"</span>,audio.int_to_DsVolume(config.sound_effect_volume));
00191             <span class="keywordflow">break</span>;
00192 
00193         <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a7">FIRM_FACILITIES</a>:
00194             audio.play_wav(<span class="stringliteral">"FACMAN"</span>,audio.int_to_DsVolume(config.sound_effect_volume));
00195             <span class="keywordflow">break</span>;
00196 
00197         <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a3">FIRM_LIBRARY</a>:
00198             audio.play_wav(<span class="stringliteral">"INFOTECH"</span>,audio.int_to_DsVolume(config.sound_effect_volume));
00199             <span class="keywordflow">break</span>;
00200 
00201         <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a4">FIRM_OLD_MAIN</a>:
00202             audio.play_wav(<span class="stringliteral">"INVEST"</span>,audio.int_to_DsVolume(config.sound_effect_volume));
00203             <span class="keywordflow">break</span>;
00204 
00205         <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a13">FIRM_POLICE</a>:
00206             audio.play_wav(<span class="stringliteral">"CRIME"</span>,audio.int_to_DsVolume(config.sound_effect_volume));
00207             <span class="keywordflow">break</span>;
00208 
00209         <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a14">FIRM_PARK_LOTS</a>:
00210         <span class="keywordflow">case</span> <a class="code" href="OFIRMID_8H.html#a22a15">FIRM_PARK_STRUCTURE</a>:
00211             audio.play_wav(<span class="stringliteral">"PARKING"</span>,audio.int_to_DsVolume(config.sound_effect_volume));
00212             <span class="keywordflow">break</span>;
00213         }
00214     }
00215 }
00216 
00217 <span class="comment">//----------- End of function FirmArray::select_firm -----------//</span>
00218 
00219 <span class="comment">//======================================================//</span>
00220 
00221 <span class="preprocessor">#ifdef DEBUG</span>
00222 <span class="preprocessor"></span>
00223 <span class="comment">//------- Begin of function FirmArray::operator() -----//</span>
00225 <span class="comment">Firm* FirmArray::operator()() {</span>
00226     <a class="code" href="classFirm.html">Firm</a>* firmPtr = (<a class="code" href="classFirm.html">Firm</a>*) get_ptr();              <span class="comment">// if recno()==0, get_ptr() returns NULL</span>
00227 
00228     <a class="code" href="ALL_8H.html#a2">err_if</a>( !firmPtr )
00229         <a class="code" href="ALL_8H.html#a4">err_now</a>( <span class="stringliteral">"FirmArray[recno()] is deleted"</span> );
00230 
00231     <span class="keywordflow">return</span> firmPtr;
00232 }
00233 
00234 <span class="comment">//--------- End of function FirmArray::operator() ----//</span>
00235 
00236 <span class="comment">//------- Begin of function FirmArray::operator[] -----//</span>
00238 <span class="comment">Firm* FirmArray::operator[](int recNo) {</span>
00239     <a class="code" href="classFirm.html">Firm</a>* firmPtr = (<a class="code" href="classFirm.html">Firm</a>*) get_ptr(recNo);
00240 
00241     <span class="keywordflow">if</span>( !firmPtr )
00242         err.run( <span class="stringliteral">"FirmArray[] is deleted"</span> );
00243 
00244     <span class="keywordflow">return</span> firmPtr;
00245 }
00246 
00247 <span class="comment">//--------- End of function FirmArray::operator[] ----//</span>
00248 <span class="preprocessor">#endif</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:37:40 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
