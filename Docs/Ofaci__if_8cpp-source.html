<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Ofaci_if.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Ofaci_if.cpp</h1><a href="Ofaci__if_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : OFACI_IF.CPP</span>
00002 <span class="comment">//Description : Facility (Facility and Alumni Affairs Office) class</span>
00003 <span class="comment">// owner                        : Kevin(Ho)</span>
00004 <span class="comment">// Notes:       Steps to introduce a new class of user interface</span>
00005 <span class="comment">//                              1.      construct the new class</span>
00006 <span class="comment">//                              2.      in sys.h, add the new MODE, e.g. MODE_ADMISSIONS_AND_FINANCIAL_OFFICE</span>
00007 <span class="comment">//                              3.      include the new header file in cc.cpp, osysdisp.cpp, osysdet.cpp</span>
00008 <span class="comment">//                              4.      in cc.cpp, declare a global object of the new class, with the name matching the 'extern' statement in the header file</span>
00009 <span class="comment">//                              5.      in osysdisp.cpp, under switch(view_mode), add the redirection to the display function</span>
00010 <span class="comment">//                              6.      in osysdet.cpp, under Sys::detect_view, add the redirection to the detect function</span>
00011 <span class="comment">//                              7.      in osysdet.cpp, under Sys::process_key, add the new hot key (optional)</span>
00012 <span class="comment">//                              8.      in osysdet.cpp, under Sys::detect_button, modify if necessary (see the comments there)</span>
00013 <span class="comment">//                              9.      the deinit function (AdmOffice::deinit()) can be called when the view_mode in 'sys' object is switched</span>
00014 <span class="comment">//                                      the function frees memory occupied by this object</span>
00015 <span class="comment">//                                      the report function would re-allocate memory when it is called (note the init_flag)</span>
00016 <span class="comment">//                                      notice the beginning section of Sys::disp_frame()</span>
00017 <span class="comment">// Kevin 0723</span>
00018 
00019 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00020 <span class="preprocessor">#include &lt;<a class="code" href="OBOX_8H.html">OBOX.H</a>&gt;</span>
00021 <span class="preprocessor">#include &lt;<a class="code" href="OSTR_8H.html">OSTR.H</a>&gt;</span>
00022 <span class="preprocessor">#include &lt;OMISC.H&gt;</span>
00023 <span class="preprocessor">#include &lt;<a class="code" href="OGAMESET_8H.html">OGAMESET.H</a>&gt;</span>
00024 <span class="preprocessor">#include &lt;OWORLDMT.H&gt;</span>
00025 <span class="preprocessor">#include &lt;OFACILIT.H&gt;</span>
00026 <span class="preprocessor">#include &lt;<a class="code" href="OVGA_8H.html">OVGA.H</a>&gt;</span>
00027 <span class="preprocessor">#include &lt;OIFACE.H&gt;</span>
00028 <span class="preprocessor">#include &lt;OINFO.H&gt;</span>
00029 <span class="preprocessor">#include &lt;<a class="code" href="COLOR_8H.html">COLOR.H</a>&gt;</span>
00030 <span class="preprocessor">#include &lt;OFONT.H&gt;</span>
00031 <span class="preprocessor">#include &lt;OText.H&gt;</span>
00032 <span class="preprocessor">#include &lt;OGAMESTR.H&gt;</span>
00033 <span class="preprocessor">#include &lt;OMOUSE.H&gt;</span>
00034 <span class="preprocessor">#include &lt;OBUTTON.H&gt;</span>
00035 <span class="preprocessor">#include &lt;<a class="code" href="OVALSLDR_8H.html">OVALSLDR.H</a>&gt;</span>
00036 <span class="preprocessor">#include &lt;OSPINNER.H&gt;</span>
00037 <span class="preprocessor">#include &lt;<a class="code" href="OGRPHYR_8H.html">OGRPHYR.H</a>&gt;</span>
00038 <span class="preprocessor">#include &lt;<a class="code" href="OGRPHMTH_8H.html">OGRPHMTH.H</a>&gt;</span>
00039 <span class="preprocessor">#include &lt;<a class="code" href="OGRPNFM_8H.html">OGRPNFM.H</a>&gt;</span>
00040 <span class="preprocessor">#include &lt;<a class="code" href="OGRPARE2_8H.html">OGRPARE2.H</a>&gt;</span>
00041 <span class="preprocessor">#include &lt;<a class="code" href="OPIECHRT_8H.html">OPIECHRT.H</a>&gt;</span>
00042 <span class="preprocessor">#include &lt;OFINANCE.H&gt;</span>
00043 <span class="preprocessor">#include &lt;<a class="code" href="OHELP_8H.html">OHELP.H</a>&gt;</span>
00044 <span class="preprocessor">#include &lt;<a class="code" href="ODEPTRES_8H.html">ODEPTRES.H</a>&gt;</span>
00045 <span class="preprocessor">#include &lt;OMATH.H&gt;</span>
00046 
00047 <span class="comment">//------- Define constants -------//</span>
00048 
00049 <span class="keyword">enum</span> {                                            <span class="comment">// the 'sub' view-modes</span>
00050     <a class="code" href="Ofaci__if_8cpp.html#a167a59">MODE_FINANCIAL</a> = 0,
00051     <a class="code" href="Ofaci__if_8cpp.html#a167a60">MODE_SPACEUSAGE</a> = 1,
00052     <a class="code" href="Ofaci__if_8cpp.html#a167a61">MODE_CAPITAL</a> = 2,
00053     <a class="code" href="Ofaci__if_8cpp.html#a167a62">MODE_DEBT</a> = 3,
00054 };
00055 
00056 <span class="keyword">enum</span> {                                            <span class="comment">// the bg image id</span>
00057     <a class="code" href="Ofaci__if_8cpp.html#a168a63">BG_PIC_ID</a> = 2
00058 };
00059 
00060 <span class="keyword">enum</span> {                                            <span class="comment">// screen coordinates</span>
00061     <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a> = <a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>+15,
00062     <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a> = <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>+25,
00063     <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a> = <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>-15,
00064     <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a> = <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>-55
00065 };
00066 
00067 <span class="keyword">enum</span> {
00068     <a class="code" href="Ofaci__if_8cpp.html#a170a68">BOTTOM_BUTTON_X1</a> = <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+40,
00069     <a class="code" href="Ofaci__if_8cpp.html#a170a69">BOTTOM_BUTTON_Y1</a> = <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>+15,
00070     <a class="code" href="Ofaci__if_8cpp.html#a170a70">BOTTOM_BUTTON_X2</a> = <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>-40,
00071     <a class="code" href="Ofaci__if_8cpp.html#a170a71">BOTTOM_BUTTON_Y2</a> = <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>+40
00072 };
00073 
00074 <span class="keyword">enum</span> {
00075     <a class="code" href="Ofaci__if_8cpp.html#a171a72">BOTTOM_BUTTON_WIDTH</a> = 125,
00076     <a class="code" href="Ofaci__if_8cpp.html#a171a73">BOTTOM_BUTTON_HEIGHT</a> = 25,
00077     <a class="code" href="Ofaci__if_8cpp.html#a171a74">BOTTOM_BUTTON_DISTANCE</a>
00078     = (<a class="code" href="Ofaci__if_8cpp.html#a170a70">BOTTOM_BUTTON_X2</a>-<a class="code" href="Ofaci__if_8cpp.html#a170a68">BOTTOM_BUTTON_X1</a>-<a class="code" href="Ofaci__if_8cpp.html#a171a72">BOTTOM_BUTTON_WIDTH</a>*4)/3
00079 };
00080 
00081 <span class="keyword">enum</span> {
00082     <a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a> = 68,
00083     <a class="code" href="Ofaci__if_8cpp.html#a172a76">MODE_FINANCIAL_BOX2_HEIGHT</a> = 270,
00084     <a class="code" href="Ofaci__if_8cpp.html#a172a77">MODE_FINANCIAL_GRAPH_WIDTH</a> = 400,
00085     <a class="code" href="Ofaci__if_8cpp.html#a172a78">MODE_FINANCIAL_GRAPH_HEIGHT</a> = 160,
00086     <a class="code" href="Ofaci__if_8cpp.html#a172a79">MODE_FINANCIAL_LEGEND_HEIGHT</a> = 26,
00087     <a class="code" href="Ofaci__if_8cpp.html#a172a80">MODE_FINANCIAL_LEGEND_WIDTH</a> = 400,
00088 
00089     <a class="code" href="Ofaci__if_8cpp.html#a172a81">MODE_FINANCIAL_TAB1</a> = 15,
00090     <a class="code" href="Ofaci__if_8cpp.html#a172a82">MODE_FINANCIAL_TAB2</a> = 280,
00091     <a class="code" href="Ofaci__if_8cpp.html#a172a83">MODE_FINANCIAL_TAB3</a> = 360,
00092     <a class="code" href="Ofaci__if_8cpp.html#a172a84">MODE_FINANCIAL_TAB4</a> = 440,
00093     <a class="code" href="Ofaci__if_8cpp.html#a172a85">MODE_FINANCIAL_TAB5</a> = 520,
00094     <a class="code" href="Ofaci__if_8cpp.html#a172a86">MODE_FINANCIAL_TAB6</a> = 600,
00095 };
00096 
00097 <span class="keyword">enum</span> {
00098     <a class="code" href="Ofaci__if_8cpp.html#a173a87">MODE_SPACEUSAGE_BOX1_HEIGHT</a> = 300,
00099     <a class="code" href="Ofaci__if_8cpp.html#a173a88">MODE_SPACEUSAGE_BOX2_HEIGHT</a> = 60,
00100     <a class="code" href="Ofaci__if_8cpp.html#a173a89">MODE_SPACEUSAGE_BOX_WIDTH</a> = 650,
00101     <a class="code" href="Ofaci__if_8cpp.html#a173a90">MODE_SPACEUSAGE_GRAPH_WIDTH</a> = 300,
00102     <a class="code" href="Ofaci__if_8cpp.html#a173a91">MODE_SPACEUSAGE_GRAPH_HEIGHT</a> = 300,
00103     <a class="code" href="Ofaci__if_8cpp.html#a173a92">MODE_SPACEUSAGE_TAB1</a> = 10,
00104     <a class="code" href="Ofaci__if_8cpp.html#a173a93">MODE_SPACEUSAGE_VTAB1</a> = 45,
00105     <a class="code" href="Ofaci__if_8cpp.html#a173a94">MODE_SPACEUSAGE_VTAB2</a> = <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>-40,
00106     <a class="code" href="Ofaci__if_8cpp.html#a173a95">SPACEUSAGE_REC_HEIGHT</a> = 20,
00107 };
00108 
00109 <span class="keyword">enum</span> {
00110     <a class="code" href="Ofaci__if_8cpp.html#a174a96">FINANCIAL_BUTTON_X1</a> = <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a84">MODE_FINANCIAL_TAB4</a>,
00111     <a class="code" href="Ofaci__if_8cpp.html#a174a97">FINANCIAL_BUTTON_Y1</a> = <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>+180,
00112     <a class="code" href="Ofaci__if_8cpp.html#a174a98">FINANCIAL_BUTTON_X2</a> = <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>,
00113     <a class="code" href="Ofaci__if_8cpp.html#a174a99">FINANCIAL_BUTTON_Y2</a> = <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>+10
00114 };
00115 
00116 <span class="keyword">enum</span> {
00117     <a class="code" href="Ofaci__if_8cpp.html#a175a100">FINANCIAL_BUTTON_WIDTH</a> = 200,
00118     <a class="code" href="Ofaci__if_8cpp.html#a175a101">FINANCIAL_BUTTON_HEIGHT</a> = 23,
00119     <a class="code" href="Ofaci__if_8cpp.html#a175a102">FINANCIAL_BUTTON_DISTANCE</a>
00120     = (<a class="code" href="Ofaci__if_8cpp.html#a174a99">FINANCIAL_BUTTON_Y2</a>-<a class="code" href="Ofaci__if_8cpp.html#a174a97">FINANCIAL_BUTTON_Y1</a>-<a class="code" href="Ofaci__if_8cpp.html#a175a101">FINANCIAL_BUTTON_HEIGHT</a>*4)/3
00121 };
00122 
00123 <span class="keyword">enum</span> {                                            <span class="comment">// the 'sub' view-modes</span>
00124     <a class="code" href="Ofaci__if_8cpp.html#a176a103">MODE_FINANCIAL_IMPLEMENT</a> = 2,
00125     <a class="code" href="Ofaci__if_8cpp.html#a176a104">MODE_FINANCIAL_ANNOUNCE</a> = 1,
00126     <a class="code" href="Ofaci__if_8cpp.html#a176a105">MODE_FINANCIAL_CONSIDER</a> = 0,
00127 };
00128 
00129 <span class="keyword">enum</span> {
00130     <a class="code" href="Ofaci__if_8cpp.html#a177a106">MODE_CAPITAL_BOX1_HEIGHT</a> = 75,
00131     <a class="code" href="Ofaci__if_8cpp.html#a177a107">MODE_CAPITAL_BOX2_HEIGHT</a> = 260,
00132     <a class="code" href="Ofaci__if_8cpp.html#a177a108">MODE_CAPITAL_GRAPH_WIDTH</a> = 400,
00133     <a class="code" href="Ofaci__if_8cpp.html#a177a109">MODE_CAPITAL_GRAPH_HEIGHT</a> = 160,
00134     <a class="code" href="Ofaci__if_8cpp.html#a177a110">MODE_CAPITAL_LEGEND_HEIGHT</a> = 26,
00135     <a class="code" href="Ofaci__if_8cpp.html#a177a111">MODE_CAPITAL_LEGEND_WIDTH</a> = 400,
00136 
00137     <a class="code" href="Ofaci__if_8cpp.html#a177a112">MODE_CAPITAL_TAB1</a> = 15,
00138     <a class="code" href="Ofaci__if_8cpp.html#a177a113">MODE_CAPITAL_TAB2</a> = 280,
00139     <a class="code" href="Ofaci__if_8cpp.html#a177a114">MODE_CAPITAL_TAB3</a> = 360,
00140     <a class="code" href="Ofaci__if_8cpp.html#a177a115">MODE_CAPITAL_TAB4</a> = 440,
00141     <a class="code" href="Ofaci__if_8cpp.html#a177a116">MODE_CAPITAL_TAB5</a> = 520,
00142     <a class="code" href="Ofaci__if_8cpp.html#a177a117">MODE_CAPITAL_TAB6</a> = 600,
00143 };
00144 
00145 <span class="keyword">enum</span> {
00146     <a class="code" href="Ofaci__if_8cpp.html#a178a118">CAPITAL_BUTTON_X1</a> = <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a115">MODE_CAPITAL_TAB4</a>+30,
00147     <a class="code" href="Ofaci__if_8cpp.html#a178a119">CAPITAL_BUTTON_Y1</a> = <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a106">MODE_CAPITAL_BOX1_HEIGHT</a>+150,
00148     <a class="code" href="Ofaci__if_8cpp.html#a178a120">CAPITAL_BUTTON_X2</a> = <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>,
00149     <a class="code" href="Ofaci__if_8cpp.html#a178a121">CAPITAL_BUTTON_Y2</a> = <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>
00150 };
00151 
00152 <span class="keyword">enum</span> {
00153     <a class="code" href="Ofaci__if_8cpp.html#a179a122">CAPITAL_BUTTON_WIDTH</a> = 200,
00154     <a class="code" href="Ofaci__if_8cpp.html#a179a123">CAPITAL_BUTTON_HEIGHT</a> = 25,
00155     <a class="code" href="Ofaci__if_8cpp.html#a179a124">CAPITAL_BUTTON_DISTANCE</a>
00156     = (<a class="code" href="Ofaci__if_8cpp.html#a178a121">CAPITAL_BUTTON_Y2</a>-<a class="code" href="Ofaci__if_8cpp.html#a178a119">CAPITAL_BUTTON_Y1</a>-<a class="code" href="Ofaci__if_8cpp.html#a179a123">CAPITAL_BUTTON_HEIGHT</a>*4)/3
00157 };
00158 
00159 <span class="keyword">enum</span> {                                            <span class="comment">// the 'sub' view-modes</span>
00160     <a class="code" href="Ofaci__if_8cpp.html#a180a125">MODE_CAPITAL_IMPLEMENT</a> = 2,
00161     <a class="code" href="Ofaci__if_8cpp.html#a180a126">MODE_CAPITAL_ANNOUNCE</a> = 1,
00162     <a class="code" href="Ofaci__if_8cpp.html#a180a127">MODE_CAPITAL_CONSIDER</a> = 0,
00163 };
00164 
00165 <span class="keyword">enum</span> {
00166     <a class="code" href="Ofaci__if_8cpp.html#a181a128">MODE_DEBT_BOX1_HEIGHT</a> = 70,
00167     <a class="code" href="Ofaci__if_8cpp.html#a181a129">MODE_DEBT_BOX2_HEIGHT</a> = 250,
00168     <a class="code" href="Ofaci__if_8cpp.html#a181a130">MODE_DEBT_GRAPH_WIDTH</a> = 400,
00169     <a class="code" href="Ofaci__if_8cpp.html#a181a131">MODE_DEBT_GRAPH_HEIGHT</a> = 340,
00170 
00171     <a class="code" href="Ofaci__if_8cpp.html#a181a132">MODE_DEBT_TAB1</a> = 400,
00172     <a class="code" href="Ofaci__if_8cpp.html#a181a133">MODE_DEBT_TAB2</a> = 405,
00173     <a class="code" href="Ofaci__if_8cpp.html#a181a134">MODE_DEBT_TAB3</a> = 430,
00174 
00175     <a class="code" href="Ofaci__if_8cpp.html#a181a135">MODE_DEBT_VTAB1</a> = 165,
00176     <a class="code" href="Ofaci__if_8cpp.html#a181a136">MODE_DEBT_VTAB2</a> = 170,
00177 
00178 };
00179 
00180 <span class="keyword">enum</span> {
00181     <a class="code" href="Ofaci__if_8cpp.html#a182a137">DEBT_BUTTON_X1</a> = <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a133">MODE_DEBT_TAB2</a>+40,
00182     <a class="code" href="Ofaci__if_8cpp.html#a182a138">DEBT_BUTTON_Y1</a> = <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+120,
00183     <a class="code" href="Ofaci__if_8cpp.html#a182a139">DEBT_BUTTON_X2</a> = <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>,
00184     <a class="code" href="Ofaci__if_8cpp.html#a182a140">DEBT_BUTTON_Y2</a> = <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+150
00185 };
00186 
00187 <span class="keyword">enum</span> {
00188     <a class="code" href="Ofaci__if_8cpp.html#a183a141">DEBT_BUTTON_WIDTH</a> = 200,
00189     <a class="code" href="Ofaci__if_8cpp.html#a183a142">DEBT_BUTTON_HEIGHT</a> = 25,
00190     <a class="code" href="Ofaci__if_8cpp.html#a183a143">DEBT_BUTTON_DISTANCE</a>  =0
00191 };
00192 
00193 <span class="keyword">enum</span> {
00194     <a class="code" href="Ofaci__if_8cpp.html#a184a144">DEBT_BUTTON2_X1</a> = <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a133">MODE_DEBT_TAB2</a>+40,
00195     <a class="code" href="Ofaci__if_8cpp.html#a184a145">DEBT_BUTTON2_Y1</a> = <a class="code" href="Ofaci__if_8cpp.html#a181a136">MODE_DEBT_VTAB2</a>+200,
00196     <a class="code" href="Ofaci__if_8cpp.html#a184a146">DEBT_BUTTON2_X2</a> = <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>,
00197     <a class="code" href="Ofaci__if_8cpp.html#a184a147">DEBT_BUTTON2_Y2</a> = <a class="code" href="Ofaci__if_8cpp.html#a181a136">MODE_DEBT_VTAB2</a>+230
00198 };
00199 
00200 <span class="keyword">enum</span> {
00201     <a class="code" href="Ofaci__if_8cpp.html#a185a148">DEBT_BUTTON2_WIDTH</a> = 200,
00202     <a class="code" href="Ofaci__if_8cpp.html#a185a149">DEBT_BUTTON2_HEIGHT</a> = 25,
00203     <a class="code" href="Ofaci__if_8cpp.html#a185a150">DEBT_BUTTON2_DISTANCE</a> =0
00204 };
00205 
00206 <span class="keyword">enum</span> {                                            <span class="comment">// the 'sub' view-modes</span>
00207     <a class="code" href="Ofaci__if_8cpp.html#a186a151">MODE_DEBT_IMPLEMENT</a> = 2,
00208     <a class="code" href="Ofaci__if_8cpp.html#a186a152">MODE_DEBT_ANNOUNCE</a> = 1,
00209     <a class="code" href="Ofaci__if_8cpp.html#a186a153">MODE_DEBT_CONSIDER</a> = 0,
00210 };
00211 
00212 <span class="comment">//-------- define static vars -----------//</span>
00213 
00214 <span class="keyword">static</span> <span class="keywordtype">char</span> report_init_flag = 0;
00215 <span class="keyword">static</span> <span class="keywordtype">char</span> mode_init_flag = -1;                  <span class="comment">// -1: non of the mode was init'ed</span>
00216 
00217 <span class="keyword">static</span> <a class="code" href="classButtonGroup.html">ButtonGroup</a> bottom_button_group(4);
00218 <span class="keyword">static</span> <span class="keywordtype">short</span> *bottom_button_up_bitmap[4];
00219 <span class="keyword">static</span> <span class="keywordtype">short</span> *bottom_button_down_bitmap[4];
00220 <span class="keyword">static</span> <span class="keywordtype">char</span> *bottom_button_label[] = {
00221     <span class="stringliteral">"O&amp;M"</span>, <span class="stringliteral">"Space in use"</span>, <span class="stringliteral">"Capital reserve"</span>, <span class="stringliteral">"Debt"</span>
00222 };
00223 
00224 <span class="comment">// Notes:       the strings could be moved to Ogamestr.cpp</span>
00225 
00226 <span class="comment">// Begin Financial Mode Setting</span>
00227 <span class="keyword">static</span> <span class="keywordtype">char</span> *mode_financial_str[] = {
00228     <span class="stringliteral">"O&amp;M expenditure"</span>,
00229     <span class="stringliteral">"Amount needed to offset without decay"</span>,
00230     <span class="stringliteral">"Current O&amp;M budget"</span>,
00231     <span class="stringliteral">"Change in deferred maintenance backlog"</span>,
00232     <span class="stringliteral">"Facilities staff morale"</span>,
00233     <span class="stringliteral">"Change"</span>,
00234     <span class="stringliteral">"Change in O&amp;M expenditure budget"</span>,
00235 };
00236 
00237 <span class="keyword">static</span> <span class="keywordtype">short</span> *mode_financial_stats_bitmap;
00238 <span class="keyword">static</span> <span class="keywordtype">short</span> *mode_financial_stats2_bitmap;
00239 <span class="keyword">static</span> <a class="code" href="classSpinner.html">Spinner</a> financial_spinner_budget1;
00240 <span class="keyword">static</span> <a class="code" href="classSpinner.html">Spinner</a> financial_spinner_budget2;
00241 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00242 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="classSpinner.html">Spinner</a> square_feet_spinner;
00243 <span class="preprocessor">#endif</span>
00244 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="classButtonGroup.html">ButtonGroup</a> financial_button_group(3);
00245 <span class="keyword">static</span> <span class="keywordtype">short</span> *financial_button_up_bitmap[3];
00246 <span class="keyword">static</span> <span class="keywordtype">short</span> *financial_button_down_bitmap[3];
00247 <span class="keyword">static</span> <span class="keywordtype">char</span> *financial_button_label[] = {
00248     <span class="stringliteral">"Consider for next year"</span>, <span class="stringliteral">"Promise for next year"</span>, <span class="stringliteral">"Implement now"</span>
00249 };
00250 <span class="keyword">static</span> <span class="keywordtype">char</span> financial_current_mode = <a class="code" href="Ofaci__if_8cpp.html#a176a105">MODE_FINANCIAL_CONSIDER</a>;
00251 
00252 <span class="keyword">static</span> <a class="code" href="classGraphYear.html">GraphYear</a> mode_financial_graph_profitloss;
00253 <span class="keyword">static</span> <span class="keywordtype">char</span> *mode_financial_graph_title=<span class="stringliteral">""</span>;
00254 <span class="keyword">static</span> <span class="keywordtype">char</span> *mode_financial_legend_label[] = {
00255     <span class="stringliteral">"O&amp;M expenditure"</span>, <span class="stringliteral">"Total deferred maintenance backlog"</span>,
00256 };
00257 
00258 <span class="comment">// End Financial Mode Setting</span>
00259 
00260 <span class="comment">// Begin SPACEUSAGE Mode Setting</span>
00261 <span class="keyword">static</span> <a class="code" href="classGraphNonFinancialMonth.html">GraphNonFinancialMonth</a> mode_spaceusage_graph;
00262 <span class="keyword">static</span> <span class="keywordtype">short</span> *mode_spaceusage_stats_bitmap;
00263 <span class="keyword">static</span> <span class="keywordtype">char</span> *mode_spaceusage_legend[]= {
00264     <span class="stringliteral">"Norm               "</span>,
00265     <span class="stringliteral">"Actual             "</span>,
00266     <span class="stringliteral">"Projected          "</span>,
00267     <span class="stringliteral">""</span>,<span class="stringliteral">""</span>,
00268 };
00269 <span class="comment">//static char *mode_spaceusage_title[]={"Space availability in relation to the norm"};</span>
00270 <span class="keyword">static</span> <span class="keywordtype">int</span>  report_spaceusage_recno = 1;
00271 <span class="keyword">static</span> <a class="code" href="classText.html">Text</a> report_spaceusage_text;
00272 <span class="keyword">static</span> <span class="keywordtype">char</span> *mode_spaceusage_str[] = {
00273     <span class="stringliteral">"Surplus space valved at $"</span>,
00274     <span class="stringliteral">"Investment needed to increase the space availability to the norm"</span>,
00275 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00276 <span class="preprocessor"></span>    <span class="stringliteral">"New construction authorization"</span>,
00277     <span class="stringliteral">"Square feet (K)"</span>,
00278     <span class="stringliteral">"Investment required  ($K)"</span>,
00279     <span class="stringliteral">"Additional debt  ($K)"</span>,
00280     <span class="stringliteral">"Authorize now"</span>,
00281 <span class="preprocessor">#endif</span>
00282 <span class="preprocessor"></span>};
00283 <span class="keyword">static</span> <span class="keywordtype">void</span>       disp_fin_rep_row(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>);
00284 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00285 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="classText.html">Text</a> investment_required;
00286 <span class="keyword">static</span> <a class="code" href="classText.html">Text</a> additional_debt;
00287 <span class="keyword">static</span> <a class="code" href="classButton.html">Button</a> authorize_button;
00288 <span class="preprocessor">#endif</span>
00289 <span class="preprocessor"></span>
00290 <span class="comment">// End SPACEUSAGE Mode Setting</span>
00291 
00292 <span class="comment">// Begin capital Mode Setting</span>
00293 <span class="keyword">static</span> <span class="keywordtype">char</span> *mode_capital_str[] = {
00294     <span class="stringliteral">"Transfer to capital reserve"</span>,
00295     <span class="stringliteral">"Expenditures from capital reserve"</span>,
00296     <span class="stringliteral">"Capital reserve balance"</span>,
00297     <span class="stringliteral">""</span>,
00298     <span class="stringliteral">"Change"</span>,
00299     <span class="stringliteral">"Change in annual transfer to \r\ncapital reserve"</span>,
00300     <span class="stringliteral">" :"</span>
00301 };
00302 
00303 <span class="keyword">static</span> <span class="keywordtype">short</span> *mode_capital_stats_bitmap;
00304 <span class="keyword">static</span> <a class="code" href="classSpinner.html">Spinner</a> capital_spinner_budget1;
00305 <span class="keyword">static</span> <a class="code" href="classSpinner.html">Spinner</a> capital_spinner_budget2;
00306 <span class="keyword">static</span> <a class="code" href="classButtonGroup.html">ButtonGroup</a> capital_button_group(3);
00307 <span class="keyword">static</span> <span class="keywordtype">short</span> *capital_button_up_bitmap[3];
00308 <span class="keyword">static</span> <span class="keywordtype">short</span> *capital_button_down_bitmap[3];
00309 <span class="keyword">static</span> <span class="keywordtype">char</span> *capital_button_label[] = {
00310     <span class="stringliteral">"Consider for next year"</span>, <span class="stringliteral">"Promise for next year"</span>, <span class="stringliteral">"Implement now"</span>
00311 };
00312 <span class="keyword">static</span> <span class="keywordtype">char</span> capital_current_mode = <a class="code" href="Ofaci__if_8cpp.html#a180a127">MODE_CAPITAL_CONSIDER</a>;
00313 
00314 <span class="keyword">static</span> <span class="keywordtype">char</span> *mode_capital_legend_label[] = {
00315     <span class="stringliteral">"Gifts to facilities"</span>, <span class="stringliteral">"Expenditures from capital reserve"</span>, <span class="stringliteral">"Transfer to capital reserve"</span>
00316 };
00317 
00318 <span class="keyword">static</span> <a class="code" href="classGraphYear.html">GraphYear</a> mode_capital_graph_profitloss;
00319 <span class="keyword">static</span> <span class="keywordtype">char</span> *mode_capital_graph_title=<span class="stringliteral">""</span>;
00320 
00321 <span class="comment">// End capital Mode Setting</span>
00322 
00323 <span class="comment">// Begin debt Mode Setting</span>
00324 <span class="keyword">static</span> <span class="keywordtype">char</span> *mode_debt_str[] = {
00325     <span class="stringliteral">"Percent of new construction funded by debt"</span>,   <span class="comment">//## chea 110899 change by b.massy</span>
00326     <span class="stringliteral">"University debt limit"</span>,
00327     <span class="stringliteral">""</span>,
00328     <span class="stringliteral">""</span>,
00329     <span class="stringliteral">"Change"</span>,
00330     <span class="stringliteral">"Change in O&amp;M expenditure budget"</span>,
00331     <span class="stringliteral">" :"</span>
00332 };
00333 
00334 <span class="keyword">static</span> <span class="keywordtype">short</span> *mode_debt_stats_bitmap;
00335 <span class="keyword">static</span> <a class="code" href="classSpinner.html">Spinner</a> debt_spinner_budget1;
00336 <span class="keyword">static</span> <a class="code" href="classSpinner.html">Spinner</a> debt_spinner_budget2;
00337 
00338 <span class="keyword">static</span> <a class="code" href="classButtonGroup.html">ButtonGroup</a> debt_button_group(1);
00339 <span class="keyword">static</span> <span class="keywordtype">short</span> *debt_button_up_bitmap[1];
00340 <span class="keyword">static</span> <span class="keywordtype">short</span> *debt_button_down_bitmap[1];
00341 <span class="keyword">static</span> <span class="keywordtype">char</span> *debt_button_label[] = {
00342     <span class="stringliteral">"Implement now"</span>,<span class="stringliteral">"Consider for next year"</span>, <span class="stringliteral">"Promise for next year"</span>
00343 };
00344 
00345 <span class="keyword">static</span> <a class="code" href="classButtonGroup.html">ButtonGroup</a> debt_button2_group(1);
00346 <span class="keyword">static</span> <span class="keywordtype">short</span> *debt_button2_up_bitmap[1];
00347 <span class="keyword">static</span> <span class="keywordtype">short</span> *debt_button2_down_bitmap[1];
00348 <span class="keyword">static</span> <span class="keywordtype">char</span> *debt_button2_label[] = {
00349     <span class="stringliteral">"Implement now"</span>,<span class="stringliteral">"Consider for next year"</span>, <span class="stringliteral">"Promise for next year"</span>
00350 };
00351 <span class="keyword">static</span> <span class="keywordtype">char</span> debt_current_mode = <a class="code" href="Ofaci__if_8cpp.html#a186a153">MODE_DEBT_CONSIDER</a>;
00352 
00353 <span class="keyword">static</span> <a class="code" href="classGraphArea2.html">GraphArea2</a> mode_debt_graph;
00354 <span class="keyword">static</span> <span class="keywordtype">char</span> *mode_debt_graph_title=<span class="stringliteral">""</span>;
00355 <span class="keyword">static</span> <span class="keywordtype">char</span> *mode_debt_legend_label[] = {
00356     <span class="stringliteral">"Debt capacity"</span>,
00357     <span class="stringliteral">"Debt balance"</span>,
00358     <span class="stringliteral">"Remaining debt capacity"</span>,
00359     <span class="stringliteral">""</span>,
00360     <span class="stringliteral">"University debt limit"</span>,
00361 };
00362 
00363 <span class="comment">// End debt Mode Setting</span>
00364 
00365 <span class="comment">//-------- define static functions ------//</span>
00366 
00367 <span class="comment">// Notes:       the deinit_x functions should deallocate memory used by the</span>
00368 <span class="comment">//                              GraphDoubleBar, ValueSlider, RadioButton, etc. objects</span>
00369 <span class="comment">//                              the functions are called when a mode-switching is triggered</span>
00370 <span class="comment">//      Norris 0716</span>
00371 
00372 <span class="keyword">static</span> <span class="keywordtype">void</span> report_spaceusage(<span class="keywordtype">int</span>);
00373 <span class="keyword">static</span> <span class="keywordtype">void</span> report_financial(<span class="keywordtype">int</span>);
00374 <span class="keyword">static</span> <span class="keywordtype">void</span> report_capital(<span class="keywordtype">int</span>);
00375 <span class="keyword">static</span> <span class="keywordtype">void</span> report_debt(<span class="keywordtype">int</span>);
00376 <span class="keyword">static</span> <span class="keywordtype">int</span> detect_spaceusage();
00377 <span class="keyword">static</span> <span class="keywordtype">int</span> detect_financial();
00378 <span class="keyword">static</span> <span class="keywordtype">int</span> detect_capital();
00379 <span class="keyword">static</span> <span class="keywordtype">int</span> detect_debt();
00380 <span class="keyword">static</span> <span class="keywordtype">void</span> deinit_spaceusage();
00381 <span class="keyword">static</span> <span class="keywordtype">void</span> deinit_financial();
00382 <span class="keyword">static</span> <span class="keywordtype">void</span> deinit_capital();
00383 <span class="keyword">static</span> <span class="keywordtype">void</span> deinit_debt();
00384 
<a name="l00385"></a><a class="code" href="Ofaci__if_8cpp.html#a53">00385</a> <span class="keyword">typedef</span> void (*<a class="code" href="Ofaci__if_8cpp.html#a53">ReportFP</a>)(<span class="keywordtype">int</span> refreshFlag);
<a name="l00386"></a><a class="code" href="Ofaci__if_8cpp.html#a54">00386</a> <span class="keyword">typedef</span> int (*<a class="code" href="Ofaci__if_8cpp.html#a54">DetectFP</a>)();
<a name="l00387"></a><a class="code" href="Ofaci__if_8cpp.html#a55">00387</a> <span class="keyword">typedef</span> void (*<a class="code" href="Ofaci__if_8cpp.html#a55">DeinitFP</a>)();
00388 
00389 <span class="keyword">static</span> <a class="code" href="Ofaci__if_8cpp.html#a53">ReportFP</a> report_func_ptr[] = {
00390     &amp;report_financial,
00391     &amp;report_spaceusage,
00392     &amp;report_capital,
00393     &amp;report_debt,
00394 };
00395 
00396 <span class="keyword">static</span> <a class="code" href="Ofaci__if_8cpp.html#a54">DetectFP</a> detect_func_ptr[] = {
00397     &amp;detect_financial,
00398     &amp;detect_spaceusage,
00399     &amp;detect_capital,
00400     &amp;detect_debt,
00401 };
00402 
00403 <span class="keyword">static</span> <a class="code" href="Ofaci__if_8cpp.html#a55">DeinitFP</a> deinit_func_ptr[] = {
00404     &amp;deinit_financial,
00405     &amp;deinit_spaceusage,
00406     &amp;deinit_capital,
00407     &amp;deinit_debt,
00408 };
00409 
00410 <span class="comment">//------- Begin of function Facility::Facility -----------//</span>
<a name="l00412"></a><a class="code" href="classFacility.html#a0">00412</a> <span class="comment">Facility::Facility() {</span>
00413     init();
00414 
00415 }
00416 
00417 <span class="comment">//--------- End of function Facility::Facility -----------//</span>
00418 
00419 <span class="comment">//------- Begin of function Facility::~Facility -----------//</span>
<a name="l00421"></a><a class="code" href="classFacility.html#a1">00421</a> <span class="comment">Facility::~Facility() {</span>
00422     deinit();
00423 }
00424 
00425 <span class="comment">//--------- End of function Facility::~Facility -----------//</span>
00426 
00427 <span class="comment">//------- Begin of function Facility::deinit ---------------//</span>
<a name="l00429"></a><a class="code" href="classFacility.html#a3">00429</a> <span class="comment">void Facility::deinit() {</span>
00430     <span class="comment">//--------- deallocate memory -------------//</span>
00431     <span class="comment">// ##### begin Gilbert 28/04/2001 #####//</span>
00432     bottom_button_group.<a class="code" href="classButtonGroup.html#a2">deinit_buttons</a>();
00433     <span class="comment">// ##### end Gilbert 28/04/2001 #####//</span>
00434     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++) {
00435         <span class="keywordflow">if</span> (bottom_button_up_bitmap[i]) {
00436             <a class="code" href="ALL_8H.html#a8">mem_del</a>(bottom_button_up_bitmap[i]);
00437             <a class="code" href="ALL_8H.html#a8">mem_del</a>(bottom_button_down_bitmap[i]);
00438             bottom_button_up_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00439             bottom_button_down_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00440         }
00441     }
00442 
00443     <span class="keywordflow">for</span> (i = 0; i &lt; 4; i++) {
00444         (*deinit_func_ptr[i])();
00445     }
00446 
00447     report_init_flag = 0;
00448 }
00449 
00450 <span class="comment">//--------- End of function Facility::deinit ---------------//</span>
00451 
00452 <span class="comment">//------- Begin of function Facility::init -----------------//</span>
<a name="l00454"></a><a class="code" href="classFacility.html#a2">00454</a> <span class="comment">void Facility::init() {</span>
00455     memset(<span class="keyword">this</span>, 0, <span class="keyword">sizeof</span>(<a class="code" href="classFacility.html">Facility</a>));
00456 
00457     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++) {
00458         bottom_button_up_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00459         bottom_button_down_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00460     }
00461     current_mode = <a class="code" href="Ofaci__if_8cpp.html#a167a59">MODE_FINANCIAL</a>;
00462 
00463     <span class="comment">/* BUGHERE --       break at once when the following code is called</span>
00464 <span class="comment">       //----- constants or other factors -----//</span>
00465 <span class="comment">       // Debt capacity parameters</span>
00466 <span class="comment">       maximum_debt_balance_as_a_percent_of_funds_balances = 0.5f;</span>
00467 <span class="comment">       max_interest_payments_as_a_percent_of_operating_expenditures = 0.08f;</span>
00468 <span class="comment"></span>
00469 <span class="comment">       //Construction policy parameters</span>
00470 <span class="comment">       percent_gap_required_before_new_construction_is_considered = 5f;</span>
00471 <span class="comment"></span>
00472 <span class="comment">       escalation_factor_for_deferrd_maintenance_per_year = 0.025f;</span>
00473 <span class="comment"></span>
00474 <span class="comment">       //---------- init player input/output -------------//</span>
00475 <span class="comment"></span>
00476 <span class="comment">       percent_project_funded_with_debt = 0.333f;</span>
00477 <span class="comment"></span>
00478 <span class="comment">       //BUGHERE assume finance is inited before</span>
00479 <span class="comment">       total_debt_capacity[THIS_YEAR] = (int) min(      // min(E22*'$G$12,'$F$257*E23/'$C$74);</span>
00480 <span class="comment">       maximum_debt_balance_as_a_percent_of_funds_balances</span>
00481 <span class="comment">       * ( finance.last_year.asset_array[AC_ASSET_TOTAL] - finance.last_year.liability_array[AC_LIABILITY_TOTAL] ),</span>
00482 <span class="comment">       finance.total_operating_expense.total *  max_interest_payments_as_a_percent_of_operating_expenditures</span>
00483 <span class="comment">       / (finance.long_term_debt_interest / 100.0f) );</span>
00484 <span class="comment">       err_when(total_debt_capacity[THIS_YEAR]&lt;=0);</span>
00485 <span class="comment"></span>
00486 <span class="comment">       cur_debt_limit = int(0.5f * total_debt_capacity[THIS_YEAR]);</span>
00487 <span class="comment"></span>
00488 <span class="comment">       int beginCapitalReserve = int(finance.last_year.asset_array[AC_CAPITAL_RESERVE]);</span>
00489 <span class="comment">       min_capital_reserve_balance = int(beginCapitalReserve * 0.6f);</span>
00490 <span class="comment"></span>
00491 <span class="comment">       ratio_of_square_footage_to_benchmark[THIS_YEAR] = 1.0f;</span>
00492 <span class="comment"></span>
00493 <span class="comment">       //---------- other vars -------------//</span>
00494 <span class="comment"></span>
00495 <span class="comment">       cur_change_backlog = 0;</span>
00496 <span class="comment"></span>
00497 <span class="comment">       //BUGHERE should we do:</span>
00498 <span class="comment">       //begin_space_inventory();</span>
00499 <span class="comment">       //update_backlog_monthly();</span>
00500 <span class="comment">       //run_new_construction();</span>
00502 <span class="comment">    */</span>
00503 }
00504 
00505 <span class="comment">//--------- End of function Facility::init -----------------//</span>
00506 
00507 <span class="comment">//------- Begin of function Facility::report ---------------//</span>
<a name="l00509"></a><a class="code" href="classFacility.html#a4">00509</a> <span class="comment">void Facility::report(int refreshFlag) {</span>
00510     vga.use_back();
00511 
00512 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00513 <span class="preprocessor"></span>    <span class="comment">// fix in version 2</span>
00514     sys.is_institution_report = 1;
00515 <span class="preprocessor">#endif</span>
00516 <span class="preprocessor"></span>
00517     <span class="keywordflow">if</span> (refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>) {
00518 
00519         <span class="keywordflow">if</span>(report_init_flag) {                        <span class="comment">// deinit it first if it has already been initialized</span>
00520             deinit();
00521         }
00522         report_init_flag = 1;
00523 
00524         <span class="comment">//------------- paint the background ----------------//</span>
00525         user_interface.bg_img(<a class="code" href="Ofaci__if_8cpp.html#a168a63">BG_PIC_ID</a>, &amp;vga_back);
00526 
00527         <span class="comment">//----- initialize the bottom sub-menus buttons -----//</span>
00528         <span class="keywordtype">short</span> x = <a class="code" href="Ofaci__if_8cpp.html#a170a68">BOTTOM_BUTTON_X1</a>;
00529         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++, x+=<a class="code" href="Ofaci__if_8cpp.html#a171a72">BOTTOM_BUTTON_WIDTH</a>+<a class="code" href="Ofaci__if_8cpp.html#a171a74">BOTTOM_BUTTON_DISTANCE</a>) {
00530 
00531             user_interface.create_button_bitmap(x, <a class="code" href="Ofaci__if_8cpp.html#a170a69">BOTTOM_BUTTON_Y1</a>,
00532                                                 x+<a class="code" href="Ofaci__if_8cpp.html#a171a72">BOTTOM_BUTTON_WIDTH</a>, <a class="code" href="Ofaci__if_8cpp.html#a170a69">BOTTOM_BUTTON_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a171a73">BOTTOM_BUTTON_HEIGHT</a>,
00533                                                 bottom_button_label[i], &amp;bottom_button_up_bitmap[i],
00534                                                 &amp;bottom_button_down_bitmap[i], &amp;vga_back);
00535             bottom_button_group[i].create_bitmapW(x, <a class="code" href="Ofaci__if_8cpp.html#a170a69">BOTTOM_BUTTON_Y1</a>,
00536                                                   x+<a class="code" href="Ofaci__if_8cpp.html#a171a72">BOTTOM_BUTTON_WIDTH</a>, <a class="code" href="Ofaci__if_8cpp.html#a170a69">BOTTOM_BUTTON_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a171a73">BOTTOM_BUTTON_HEIGHT</a>,
00537                                                   ((i == current_mode) ? bottom_button_down_bitmap[i] : bottom_button_up_bitmap[i])+4);
00538         }
00539         <span class="comment">//----------- paint the bottom button group ---------//</span>
00540         bottom_button_group.<a class="code" href="classButtonGroup.html#a3">paint</a>(current_mode);
00541     }
00542 
00543     <span class="comment">//---- repaint/refresh the display of the current mode ----//</span>
00544     (*report_func_ptr[current_mode])(refreshFlag);
00545 
00546     <span class="comment">// Comments:        blt buffer only if repaint, because the</span>
00547     <span class="comment">//                                  report_x functions would handle blt_buf</span>
00548     <span class="comment">//                                  when refresh</span>
00549     <span class="comment">//                                  equivalently, in the report_x functions,</span>
00550     <span class="comment">//                                  only blt buffer when refresh</span>
00551 
00552     <span class="keywordflow">if</span> (refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>) {
00553         <span class="comment">//------- blt the back buffer to front buffer -------//</span>
00554         vga.blt_buf(<a class="code" href="Oworldmt_8h.html#a12">ZOOM_X1</a>, <a class="code" href="Oworldmt_8h.html#a13">ZOOM_Y1</a>, <a class="code" href="Oworldmt_8h.html#a14">ZOOM_X2</a>, <a class="code" href="Oworldmt_8h.html#a15">ZOOM_Y2</a>);
00555     }
00556 
00557     <span class="comment">//##trevor 2807</span>
00558     vga.use_front();
00559     <span class="comment">//##trevor 2807</span>
00560 }
00561 
00562 <span class="comment">//---------- End of function Facility::report ------------//</span>
00563 
00564 <span class="comment">//-------- Begin of function Facility::detect ------------//</span>
<a name="l00568"></a><a class="code" href="classFacility.html#a5">00568</a> <span class="comment">int Facility::detect() {</span>
00569     vga.use_back();
00570 
00571     <span class="keywordtype">int</span> rc = detect2();
00572 
00573     vga.use_front();
00574 
00575     <span class="keywordflow">return</span> rc;
00576 }
00577 
00578 <span class="comment">//---------- End of function Facility::detect ------------//</span>
00579 
00580 <span class="comment">//-------- Begin of function Facility::detect2 ------------//</span>
<a name="l00584"></a><a class="code" href="classFacility.html#a6">00584</a> <span class="comment">int Facility::detect2() {</span>
00585     <span class="keywordflow">if</span> (!report_init_flag)
00586         <span class="keywordflow">return</span> 0;
00587 
00588     <span class="keywordtype">int</span> bottomButtonGroupDetect;
00589     <span class="keywordflow">if</span> ((bottomButtonGroupDetect = bottom_button_group.<a class="code" href="classButtonGroup.html#a4">detect</a>()) &gt;= 0) {
00590         <span class="comment">//---- deinit the modes to free memory ----//</span>
00591         <span class="keywordflow">if</span>(current_mode&gt;=0)
00592             (*deinit_func_ptr[current_mode])();
00593 
00594         <span class="comment">//-------- change display mode ------------//</span>
00595         bottom_button_group[current_mode].body_ptr = (<span class="keywordtype">void</span> *) (bottom_button_up_bitmap[current_mode] + 4);
00596         current_mode = bottomButtonGroupDetect;
00597         bottom_button_group[current_mode].body_ptr = (<span class="keywordtype">void</span> *) (bottom_button_down_bitmap[current_mode] + 4);
00598 
00599         <span class="comment">//-------- post display redraw flag -------//</span>
00600         sys.redraw_all_flag = 1;
00601 
00602         <span class="keywordflow">return</span> 1;
00603     }
00604 
00605     <span class="keywordflow">if</span> ((*detect_func_ptr[current_mode])())
00606         <span class="keywordflow">return</span> 1;
00607 
00608     <span class="keywordflow">return</span> 0;
00609 }
00610 
00611 <span class="comment">//---------- End of function Facility::detect ------------//</span>
00612 
00613 <span class="comment">//-------- Begin of function report_FINANCIAL ---------//</span>
00615 <span class="comment">static void report_financial(int refreshFlag) {</span>
00616     <span class="comment">// Notes:   temporary variables for debugging</span>
00617     <span class="comment">//                          to be interfaced with game engine</span>
00618 
00619     <span class="keyword">static</span> <span class="keywordtype">int</span> v11=1000,v12=1999,v13=8888;
00620     <span class="keyword">static</span> <span class="keywordtype">double</span> v21=663.23,v22=123.23,v23=17.23,v24=723.23,v25=13.23;
00621     <span class="keyword">static</span> <span class="keywordtype">double</span> v31=813.83,v32=888.23,v33=13.83,v34=188.23,v35=183.23;
00622     <span class="keyword">static</span> <span class="keywordtype">double</span> v41=88.28,v42=777.23,v43=166.27,v44=777.23,v45=173.23;
00623     <span class="keyword">static</span> <span class="keywordtype">double</span> v1=700,v2=800,v3=900,v4=123;
00624     <span class="keyword">static</span> <span class="keywordtype">int</span> sliderVar1=0;
00625     <span class="keyword">static</span> <span class="keywordtype">float</span> spinnerVar1=0.0;
00626     <span class="keyword">static</span> <span class="keywordtype">float</span> spinnerVar2;
00627     <span class="keyword">static</span> <span class="keywordtype">int</span> numSeriesData = HISTORY_YEAR_COUNT;  <span class="comment">//*** temporary ***//</span>
00628     <span class="keyword">static</span> <span class="keywordtype">int</span> *dataArray;                          <span class="comment">//*** temporary ***//</span>
00629     <span class="comment">//  static float dataArray[]={25,98,75,32,65,46,38,74,38,75,83,79,52,36,59,23};</span>
00630 
00631     <span class="comment">// ##### Begin Marco ##### //</span>
00632 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00633 <span class="preprocessor"></span>    <span class="keyword">static</span> <span class="keywordtype">double</span> initialv21=663.23;
00634 <span class="preprocessor">#endif</span>
00635 <span class="preprocessor"></span>    <span class="comment">// ##### End MArco ###### //</span>
00636     <span class="comment">//  Communicate with Sim Engine's Output</span>
00637     <span class="comment">//  dataArray=(float*)library_tech_office.history_value;</span>
00638 
00639     v12=info.financial_year();
00640     v11=v12-1;
00641     v13=v12+1;
00642 
00643     <span class="comment">// ##### Begin Marco ##### //</span>
00644 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00645 <span class="preprocessor"></span>    initialv21=finance.initial_expense_array[<a class="code" href="Ofinance_8h.html#a104a53">AC_OPERATIONS_AND_MAINTENANCE</a>].total;
00646 <span class="preprocessor">#endif</span>
00647 <span class="preprocessor"></span>    <span class="comment">// ##### End MArco ###### //</span>
00648 
00649     v21=finance.expense_array[<a class="code" href="Ofinance_8h.html#a104a53">AC_OPERATIONS_AND_MAINTENANCE</a>].total;
00650     v22=finance.projected_expense_array[<a class="code" href="Ofinance_8h.html#a104a53">AC_OPERATIONS_AND_MAINTENANCE</a>].change_last_year.total;
00651     v23=finance.projected_expense_array[<a class="code" href="Ofinance_8h.html#a104a53">AC_OPERATIONS_AND_MAINTENANCE</a>].this_year.total;
00652     v24=finance.projected_expense_array[<a class="code" href="Ofinance_8h.html#a104a53">AC_OPERATIONS_AND_MAINTENANCE</a>].change_next_year.total;
00653     v25=finance.projected_expense_array[<a class="code" href="Ofinance_8h.html#a104a53">AC_OPERATIONS_AND_MAINTENANCE</a>].next_year.total;
00654     v1=facility_office.total_normal_onm;
00655     v2=finance.budget_expense_array[<a class="code" href="Ofinance_8h.html#a104a53">AC_OPERATIONS_AND_MAINTENANCE</a>].total;
00656     v3=facility_office.begin_backlog;
00657     v4=facility_office.facility_staff_morale;
00658     dataArray=facility_office.onm_n_backlog_history;
00660 
00661     <span class="keywordtype">int</span> field_space=5*font_chartsm.max_font_width;
00662 
00663     <span class="keywordflow">if</span> (refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>) {
00664         <span class="comment">// top title</span>
00665         user_interface.brighten(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+150,<a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>-23,<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+575,<a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>-3);
00666         user_interface.rect(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+150,<a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>-23,<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+575,<a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>-3,1);
00667         font_charts.put(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+215,<a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>-18,<span class="stringliteral">"Operations and Maintenance Expenditure"</span>);
00668 
00669         <span class="keywordflow">if</span>(facility_office.current_mode&gt;=0)
00670             (*deinit_func_ptr[facility_office.current_mode])();
00671         <span class="comment">//--------- draw the brightened boxes ------------//</span>
00672         user_interface.brighten(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>);
00673         user_interface.brighten(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>-<a class="code" href="Ofaci__if_8cpp.html#a172a76">MODE_FINANCIAL_BOX2_HEIGHT</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a83">MODE_FINANCIAL_TAB3</a>-1, <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>);
00674         user_interface.brighten(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a83">MODE_FINANCIAL_TAB3</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>-<a class="code" href="Ofaci__if_8cpp.html#a172a76">MODE_FINANCIAL_BOX2_HEIGHT</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>+105);
00675         user_interface.brighten(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a83">MODE_FINANCIAL_TAB3</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>+110, <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>);
00676 
00677         user_interface.rect(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>);
00678         user_interface.rect(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>-<a class="code" href="Ofaci__if_8cpp.html#a172a76">MODE_FINANCIAL_BOX2_HEIGHT</a>-2, <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a83">MODE_FINANCIAL_TAB3</a>+2, <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>);
00679         user_interface.rect(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a83">MODE_FINANCIAL_TAB3</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>-<a class="code" href="Ofaci__if_8cpp.html#a172a76">MODE_FINANCIAL_BOX2_HEIGHT</a>-2, <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>+108);
00680         user_interface.rect(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a83">MODE_FINANCIAL_TAB3</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>+110-2, <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>);
00681 
00682         mode_init_flag = <a class="code" href="Ofaci__if_8cpp.html#a167a59">MODE_FINANCIAL</a>;
00683         <span class="comment">//              spinnerVar1=0.0;</span>
00684         spinnerVar1=(float)finance.get_policy_var(<span class="keyword">false</span>, <a class="code" href="Ofinance_8h.html#a104a53">AC_OPERATIONS_AND_MAINTENANCE</a>)-&gt;target_value;
00685         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {
00686             financial_button_up_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00687             financial_button_down_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
00688         }
00689 
00690         <span class="keywordtype">short</span> y = <a class="code" href="Ofaci__if_8cpp.html#a174a97">FINANCIAL_BUTTON_Y1</a>;
00691         <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++, y+=<a class="code" href="Ofaci__if_8cpp.html#a175a101">FINANCIAL_BUTTON_HEIGHT</a>+<a class="code" href="Ofaci__if_8cpp.html#a175a102">FINANCIAL_BUTTON_DISTANCE</a>) {
00692             user_interface.create_button_bitmap(<a class="code" href="Ofaci__if_8cpp.html#a174a96">FINANCIAL_BUTTON_X1</a>,y,
00693                                                 <a class="code" href="Ofaci__if_8cpp.html#a174a96">FINANCIAL_BUTTON_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a175a100">FINANCIAL_BUTTON_WIDTH</a>,y+<a class="code" href="Ofaci__if_8cpp.html#a175a101">FINANCIAL_BUTTON_HEIGHT</a>,
00694                                                 financial_button_label[i], &amp;financial_button_up_bitmap[i],
00695                                                 &amp;financial_button_down_bitmap[i], &amp;vga_back);
00696 
00697             financial_button_group[i].create_bitmapW(<a class="code" href="Ofaci__if_8cpp.html#a174a96">FINANCIAL_BUTTON_X1</a>,y,
00698                                                      <a class="code" href="Ofaci__if_8cpp.html#a174a96">FINANCIAL_BUTTON_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a175a100">FINANCIAL_BUTTON_WIDTH</a>,y+<a class="code" href="Ofaci__if_8cpp.html#a175a101">FINANCIAL_BUTTON_HEIGHT</a>,
00699                                                      (financial_button_up_bitmap[i])+4,0);
00700         }
00701 
00702         financial_spinner_budget1.<a class="code" href="classSpinner.html#a2">init</a>(
00703             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a84">MODE_FINANCIAL_TAB4</a>+30,
00704             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>+140,
00705             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a84">MODE_FINANCIAL_TAB4</a>+150,
00706             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>+170 ,
00707             <span class="comment">//### begin zhoubin 02/25/99</span>
00708             &amp;facility_office.spinner_var1,
00709             <span class="comment">//### end zhoubin 02/25/99</span>
00710             <span class="comment">//                          -100.0f,100.0f,0.1f,0,NULL,23);</span>
00711             -5.0f,5.0f,0.1f,0,<a class="code" href="OHELP_8H.html#a0">NULL</a>,25);                 <span class="comment">//## chea 170999</span>
00712 
00713         <span class="comment">//                 financial_spinner_budget2.init(</span>
00714         <span class="comment">//                              REPORT_X1+MODE_FINANCIAL_TAB5+60,</span>
00715         <span class="comment">//                              REPORT_Y1+MODE_FINANCIAL_BOX1_HEIGHT+70,</span>
00716         <span class="comment">//                              REPORT_X1+MODE_FINANCIAL_TAB5+180,</span>
00717         <span class="comment">//                              REPORT_Y1+MODE_FINANCIAL_BOX1_HEIGHT+100,</span>
00718         <span class="comment">//                              &amp;spinnerVar2,</span>
00719         <span class="comment">//                              -100.0f,100.0f,5.0f,0,NULL,3);</span>
00720 
00721         <span class="comment">//-------- graph title --------------//</span>
00722         mode_financial_graph_profitloss.<a class="code" href="classGraphYear.html#a2">init</a>(
00723             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>-<a class="code" href="Ofaci__if_8cpp.html#a172a76">MODE_FINANCIAL_BOX2_HEIGHT</a>-2,
00724             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a83">MODE_FINANCIAL_TAB3</a>+2, <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>,
00725             2,
00726             &amp;numSeriesData, dataArray,
00727             1,
00728             <a class="code" href="OHELP_8H.html#a0">NULL</a>, <span class="stringliteral">" "</span>,
00729             mode_financial_legend_label, 1, 1, 1, 2);
00730 
00731         <span class="comment">//-------- paint the buttons -----------//</span>
00732         financial_spinner_budget1.<a class="code" href="classSpinner.html#a4">paint</a>();
00733         <span class="keywordflow">for</span>(i=0;i&lt;3;i++)
00734             financial_button_group[i].<a class="code" href="classButtonGroup.html#a3">paint</a>();
00735 
00736         <span class="comment">//-------- display static strings -----------//</span>
00737 
00738         mode_financial_graph_profitloss.<a class="code" href="classGraphYear.html#a8">paint</a>();
00739 
00740         <span class="comment">//              user_interface.bar(REPORT_X1+10, REPORT_Y1+82, REPORT_X2-10, REPORT_Y1+84, V_BROWN);</span>
00741 
00742         font_chartsm.put(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a81">MODE_FINANCIAL_TAB1</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+40, mode_financial_str[0]);
00743 
00744         font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a83">MODE_FINANCIAL_TAB3</a>+field_space,
00745                                 <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+15,
00746                                 <span class="comment">//                                      REPORT_X1+MODE_FINANCIAL_TAB3+field_space,</span>
00747                                 <span class="comment">//                                      REPORT_Y1+15+font_chartsm.max_font_height,</span>
00748                                 mode_financial_str[5]);
00749         font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a85">MODE_FINANCIAL_TAB5</a>+field_space,
00750                                 <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+15,
00751                                 <span class="comment">//                                      REPORT_X1+MODE_FINANCIAL_TAB5+field_space,</span>
00752                                 <span class="comment">//                                      REPORT_Y1+15+font_chartsm.max_font_height,</span>
00753                                 mode_financial_str[5]);
00754 
00755         font_chartsm.put_paragraph(
00756             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a83">MODE_FINANCIAL_TAB3</a>+20,
00757             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+21+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>,
00758             <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>,
00759             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+41+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>,
00760             mode_financial_str[1]);
00761         font_chartsm.put_paragraph(
00762             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a83">MODE_FINANCIAL_TAB3</a>+20,
00763             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+41+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>,
00764             <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>,
00765             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+61+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>,
00766             mode_financial_str[2]);
00767         font_chartsm.put_paragraph(
00768             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a83">MODE_FINANCIAL_TAB3</a>+20,
00769             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+61+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>,
00770             <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>,
00771             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+81+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>,
00772             mode_financial_str[3]);
00773         font_chartsm.put_paragraph(
00774             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a83">MODE_FINANCIAL_TAB3</a>+20,
00775             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+81+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>,
00776             <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>,
00777             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+101+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>,
00778             mode_financial_str[4]);
00779 
00780         font_chartsm.put_paragraph(
00781             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a83">MODE_FINANCIAL_TAB3</a>+20,
00782             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+120+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>,
00783             <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>,
00784             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+140+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>,
00785             mode_financial_str[6]);
00786 
00787         <span class="comment">//              font_chartsm.put_paragraph(</span>
00788         <span class="comment">//                      REPORT_X1+MODE_FINANCIAL_TAB5+5,</span>
00789         <span class="comment">//                      REPORT_Y1+30+MODE_FINANCIAL_BOX1_HEIGHT,</span>
00790         <span class="comment">//                      REPORT_X1+MODE_FINANCIAL_TAB5+120,</span>
00791         <span class="comment">//                      REPORT_Y1+60+MODE_FINANCIAL_BOX1_HEIGHT,</span>
00792         <span class="comment">//                      mode_financial_str[6]);</span>
00793 
00794         mode_financial_stats_bitmap=<a class="code" href="OHELP_8H.html#a0">NULL</a>;
00795         mode_financial_stats_bitmap=vga_back.save_area(
00796             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a82">MODE_FINANCIAL_TAB2</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>,
00797             <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>,
00798             mode_financial_stats_bitmap);
00799         mode_financial_stats2_bitmap=<a class="code" href="OHELP_8H.html#a0">NULL</a>;
00800         mode_financial_stats2_bitmap=vga_back.save_area(
00801             <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>-75, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>,
00802             <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>+100,
00803             mode_financial_stats2_bitmap);
00804 
00805     }
00806     <span class="keywordflow">else</span> {                                          <span class="comment">// refreshFlag == INFO_REFRESH</span>
00807         <span class="comment">//-------- refresh dynamic data --------------//</span>
00808         <span class="comment">// refresh() == 1. rest()</span>
00809         <span class="comment">//                                              2. draw()</span>
00810         <span class="comment">//                                              3. blit buffer()</span>
00811 
00812         <span class="comment">//              financial_spinner_budget2.refresh();</span>
00813         mode_financial_graph_profitloss.<a class="code" href="classGraphYear.html#a9">refresh</a>();
00814         vga.blt_buf(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>,
00815                     <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>-<a class="code" href="Ofaci__if_8cpp.html#a172a76">MODE_FINANCIAL_BOX2_HEIGHT</a>,
00816                     <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a83">MODE_FINANCIAL_TAB3</a>-1,
00817                     <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>);
00818     }
00819     financial_spinner_budget1.<a class="code" href="classSpinner.html#a5">refresh</a>();
00820     <span class="keywordtype">int</span> pressed=finance.get_policy_var(<span class="keyword">false</span>, <a class="code" href="Ofinance_8h.html#a104a53">AC_OPERATIONS_AND_MAINTENANCE</a>)-&gt;applied_flag;
00821     <span class="keywordflow">if</span>(pressed==<a class="code" href="Ofinanc2_8h.html#a38a5">P_NONE</a>)
00822         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;3;i++)
00823             financial_button_group[i].<a class="code" href="classButtonGroup.html#a3">paint</a>();
00824     <span class="keywordflow">else</span>
00825         financial_button_group.<a class="code" href="classButtonGroup.html#a3">paint</a>(pressed-1);
00826 
00827     <span class="keywordtype">short</span> y = <a class="code" href="Ofaci__if_8cpp.html#a174a97">FINANCIAL_BUTTON_Y1</a>;
00828     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++, y+=<a class="code" href="Ofaci__if_8cpp.html#a175a101">FINANCIAL_BUTTON_HEIGHT</a>+<a class="code" href="Ofaci__if_8cpp.html#a175a102">FINANCIAL_BUTTON_DISTANCE</a>) {
00829         vga.blt_buf(<a class="code" href="Ofaci__if_8cpp.html#a174a96">FINANCIAL_BUTTON_X1</a>,y,
00830                     <a class="code" href="Ofaci__if_8cpp.html#a174a96">FINANCIAL_BUTTON_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a175a100">FINANCIAL_BUTTON_WIDTH</a>,y+<a class="code" href="Ofaci__if_8cpp.html#a175a101">FINANCIAL_BUTTON_HEIGHT</a>);
00831     }
00832 
00833     vga_back.rest_area(mode_financial_stats_bitmap,0,0);
00834     <a class="code" href="classString.html">String</a> *s1,*s2;
00835 
00836     s1=<span class="keyword">new</span> <a class="code" href="classString.html">String</a>(m.format(v11,16));
00837     s2=<span class="keyword">new</span> <a class="code" href="classString.html">String</a>(m.format(v11+1,16));
00838     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a82">MODE_FINANCIAL_TAB2</a>+field_space,
00839                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+15,
00840                             s1-&gt;<a class="code" href="classString.html#m0">str_buf</a>);
00841 
00842     (*s1)=m.format(v12,16);
00843     (*s2)=m.format(v12+1,16);
00844     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a84">MODE_FINANCIAL_TAB4</a>+field_space,
00845                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+15,
00846                             s1-&gt;<a class="code" href="classString.html#m0">str_buf</a>);
00847 
00848     (*s1)=m.format(v13,16);
00849     (*s2)=m.format(v13+1,16);
00850     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a86">MODE_FINANCIAL_TAB6</a>+field_space,
00851                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+15,
00852                             s1-&gt;<a class="code" href="classString.html#m0">str_buf</a>);
00853     <span class="keyword">delete</span> s1,s2;
00854 
00855     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a82">MODE_FINANCIAL_TAB2</a>+field_space,
00856                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+40,
00857                             m.format(v21, 2));
00858 
00859     <span class="comment">// ##### Begin Marco ##### //</span>
00860 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00861 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (info.financial_year() &gt; 1) {
00862         font_chart_purple_sm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a82">MODE_FINANCIAL_TAB2</a>,
00863                                         <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+15,
00864                                         <span class="stringliteral">"Yr. 0 (Initial)"</span>);
00865         font_chart_purple_sm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a82">MODE_FINANCIAL_TAB2</a>,
00866                                         <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+40,
00867                                         m.format(initialv21, 2));
00868     }
00869 <span class="preprocessor">#endif</span>
00870 <span class="preprocessor"></span>    <span class="comment">// ##### End Marco ##### //</span>
00871 
00872     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a83">MODE_FINANCIAL_TAB3</a>+field_space,
00873                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+40,
00874                             m.format(v22, 24));
00875 
00876     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a84">MODE_FINANCIAL_TAB4</a>+field_space,
00877                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+40,
00878                             m.format(v23, 2));
00879 
00880     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a85">MODE_FINANCIAL_TAB5</a>+field_space,
00881                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+40,
00882                             m.format(v24, 24));
00883 
00884     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a86">MODE_FINANCIAL_TAB6</a>+field_space,
00885                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+40,
00886                             m.format(v25, 2));
00887 
00888     vga.blt_buf(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a82">MODE_FINANCIAL_TAB2</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>,
00889                 <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>);
00890 
00891     vga_back.rest_area(mode_financial_stats2_bitmap,0,0);
00892     font_chartsm.right_put(
00893         <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>-87+field_space,
00894         <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+20+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>,
00895         <span class="comment">//                      REPORT_X2,</span>
00896         <span class="comment">//                      REPORT_Y1+40+MODE_FINANCIAL_BOX1_HEIGHT,</span>
00897         m.format(v1,2));
00898     font_chartsm.right_put(
00899         <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>-87+field_space,
00900         <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+40+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>,
00901         <span class="comment">//                      REPORT_X2,</span>
00902         <span class="comment">//                      REPORT_Y1+60+MODE_FINANCIAL_BOX1_HEIGHT,</span>
00903         m.format(v2,2));
00904     font_chartsm.right_put(
00905         <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>-87+field_space,
00906         <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+60+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>,
00907         <span class="comment">//                      REPORT_X2,</span>
00908         <span class="comment">//                      REPORT_Y1+80+MODE_FINANCIAL_BOX1_HEIGHT,</span>
00909         m.format(v3,2));
00910     font_chartsm.right_put(
00911         <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>-87+field_space,
00912         <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+80+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>,
00913         <span class="comment">//                      REPORT_X2,</span>
00914         <span class="comment">//                      REPORT_Y1+100+MODE_FINANCIAL_BOX1_HEIGHT,</span>
00915         m.format(v4,1));
00916     vga.blt_buf(<a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>-80, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>,
00917                 <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>+100 );
00918 
00919     <span class="keywordflow">for</span>(i=0;i&lt;3;i++) {
00920         financial_button_group[i].pop();
00921         financial_button_group[i].body_ptr=
00922             (<span class="keywordtype">void</span>*)(financial_button_up_bitmap[i]+4);
00923     }
00924 }
00925 
00926 <span class="comment">//---------- End of function report_FINANCIAL ---------//</span>
00927 
00928 <span class="comment">//-------- Begin of function report_spaceusage -------------//</span>
00930 <span class="comment">static void report_spaceusage(int refreshFlag) {</span>
00931     <span class="keyword">static</span> <span class="keywordtype">int</span> dataArray[3*HISTORY_MONTH_COUNT];
00932     <span class="keyword">static</span> <span class="keywordtype">int</span> numSeriesData = HISTORY_MONTH_COUNT;
00933 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00934 <span class="preprocessor"></span>    <span class="keyword">static</span> <span class="keywordtype">int</span> v1, v2;
00935 <span class="preprocessor">#endif</span>
00936 <span class="preprocessor"></span>
00937     <span class="comment">//  Communicate with Sim Engine's Output</span>
00938     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;numSeriesData;i++) {
00939         dataArray[i] = facility_office.normal_area[i];
00940         dataArray[numSeriesData+i] = facility_office.actual_area[i];
00941         dataArray[2*numSeriesData+i] = facility_office.projected_area[i];
00942     }
00944 
00945 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00946 <span class="preprocessor"></span>    v1 = int(facility_office.spinner_var4*department_res.general_dept_info.replacement_cost);
00947     v2 = int( v1*facility_office.debt_spinner_var1/100 );
00948 <span class="preprocessor">#endif</span>
00949 <span class="preprocessor"></span>
00950     <span class="keywordflow">if</span> (refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>) {
00951         <span class="comment">// top title</span>
00952         user_interface.brighten(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+150,<a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>-23,<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+575,<a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>-3);
00953         user_interface.rect(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+150,<a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>-23,<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+575,<a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>-3,1);
00954         font_charts.put(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+290,<a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>-18,<span class="stringliteral">"Space Availability"</span>);
00955 
00956         <span class="keywordflow">if</span>(facility_office.current_mode&gt;=0)
00957             (*deinit_func_ptr[facility_office.current_mode])();
00958 
00959         <span class="comment">//---------  initialization  -----------//</span>
00960         mode_init_flag= <a class="code" href="Ofaci__if_8cpp.html#a167a60">MODE_SPACEUSAGE</a>;
00961 
00962         <span class="comment">//--------- draw the brightened boxes ------------//</span>
00963 
00964         user_interface.brighten(
00965             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a173a92">MODE_SPACEUSAGE_TAB1</a>,
00966             <a class="code" href="Ofaci__if_8cpp.html#a173a94">MODE_SPACEUSAGE_VTAB2</a>,
00967             <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>,
00968             <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>
00969             );
00970 
00971         user_interface.rect(
00972             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a173a92">MODE_SPACEUSAGE_TAB1</a>,
00973             <a class="code" href="Ofaci__if_8cpp.html#a173a94">MODE_SPACEUSAGE_VTAB2</a>,
00974             <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>,
00975             <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>
00976             );
00977 
00978         user_interface.rect(
00979             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a173a92">MODE_SPACEUSAGE_TAB1</a>,
00980             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>,
00981             <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>,
00982             <a class="code" href="Ofaci__if_8cpp.html#a173a94">MODE_SPACEUSAGE_VTAB2</a>
00983             );
00984 
00985         mode_spaceusage_graph.<a class="code" href="classGraphNonFinancialMonth.html#a2">init</a>(
00986             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a173a92">MODE_SPACEUSAGE_TAB1</a>,
00987             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>,
00988             <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>/2-1,
00989             <a class="code" href="Ofaci__if_8cpp.html#a173a94">MODE_SPACEUSAGE_VTAB2</a>,
00990             3, &amp;numSeriesData, dataArray, 0,
00991             <a class="code" href="OHELP_8H.html#a0">NULL</a>, <span class="stringliteral">"Square feet"</span>, mode_spaceusage_legend, 1, 1, 1, 12);
00992 
00993         report_spaceusage_text.<a class="code" href="classText.html#a11">put</a>
00994             ( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+480,
00995               <a class="code" href="Ofaci__if_8cpp.html#a173a94">MODE_SPACEUSAGE_VTAB2</a>+15,
00996               facility_office.total_invest_close_gap,2);
00997 
00998 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
00999 <span class="preprocessor"></span>        font_chartsm.center_put( <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>/2-1, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+10,
01000                                  <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+20,
01001                                  mode_spaceusage_str[2]);
01002 
01003         font_chartsm.put( <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>/2-1+20, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+10+50,
01004                           mode_spaceusage_str[3]);
01005 
01006         font_chartsm.put( <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>/2-1+20, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+10+90,
01007                           mode_spaceusage_str[4]);
01008 
01009         font_chartsm.put( <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>/2-1+20, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+10+130,
01010                           mode_spaceusage_str[5]);
01011 
01012         <span class="keywordtype">int</span> oneStep = (int)(0.02*facility_office.normal_area[HISTORY_MONTH_COUNT-1]/1000);
01013 
01014         square_feet_spinner.<a class="code" href="classSpinner.html#a2">init</a>(
01015             <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>/2-1+20+170,
01016             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+10+40,
01017             <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>/2-1+20+170+120,
01018             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+10+40+30,
01019             <span class="comment">//### begin zhoubin 02/25/99</span>
01020             &amp;facility_office.spinner_var4,
01021             <span class="comment">//### end zhoubin 02/25/99</span>
01022             <span class="comment">//                          -100.0f,100.0f,0.1f,0,NULL,23);</span>
01023             0,10*oneStep,oneStep,0,<a class="code" href="OHELP_8H.html#a0">NULL</a>,1);             <span class="comment">//## chea 170999</span>
01024 
01025         investment_required.<a class="code" href="classText.html#a2">init</a>( <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>/2-1+20+170,
01026                                   <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+10+90,
01027                                   &amp;v1, 1);
01028         investment_required.<a class="code" href="classText.html#a24">paint</a>();
01029 
01030         additional_debt.<a class="code" href="classText.html#a2">init</a>( <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>/2-1+20+170,
01031                               <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+10+130,
01032                               &amp;v2, 1);
01033         additional_debt.<a class="code" href="classText.html#a24">paint</a>();
01034 
01035         authorize_button.<a class="code" href="classButton.html#a10">create_text</a>( <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>/2-1+20+100,
01036                                       <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+10+170,
01037                                       <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>/2-1+20+240,
01038                                       <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+10+190,
01039                                       <span class="stringliteral">"Authorize now"</span> );
01040         authorize_button.<a class="code" href="classButton.html#a20">paint</a>();
01041 <span class="preprocessor">#endif</span>
01042 <span class="preprocessor"></span>
01043         <span class="comment">// ##### Begin MArco ##### //</span>
01044 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01045 <span class="preprocessor"></span>        font_chart_purple_sm.put
01046             ( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+550,
01047               <a class="code" href="Ofaci__if_8cpp.html#a173a94">MODE_SPACEUSAGE_VTAB2</a>+15,
01048               m.format(facility_office.initial_total_invest_close_gap, 27));
01049 <span class="preprocessor">#endif</span>
01050 <span class="preprocessor"></span>        <span class="comment">// ##### End MArco ##### //</span>
01051 
01052         <span class="comment">//-----------Print message------//</span>
01053         font_chartsm.put(
01054             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+35,
01055             <a class="code" href="Ofaci__if_8cpp.html#a173a94">MODE_SPACEUSAGE_VTAB2</a>+15,
01056             mode_spaceusage_str[1]
01057             );
01058 
01059         mode_spaceusage_graph.<a class="code" href="classGraphNonFinancialMonth.html#a8">paint</a>();
01060         <span class="comment">/*              font_chartsm.put(</span>
01061 <span class="comment">                        REPORT_X1+235,</span>
01062 <span class="comment">                        MODE_SPACEUSAGE_VTAB1+20,</span>
01063 <span class="comment">                        mode_spaceusage_title[0]</span>
01064 <span class="comment">                        );</span>
01065 <span class="comment">        */</span>
01066     }  
01067     <span class="keywordflow">else</span> {                                          <span class="comment">// refreshFlag == INFO_REFRESH</span>
01068         mode_spaceusage_graph.<a class="code" href="classGraphNonFinancialMonth.html#a9">refresh</a>();
01069         vga.blt_buf(
01070             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a173a92">MODE_SPACEUSAGE_TAB1</a>,
01071             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>,
01072             <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>,
01073             <a class="code" href="Ofaci__if_8cpp.html#a173a94">MODE_SPACEUSAGE_VTAB2</a>);
01074         report_spaceusage_text.<a class="code" href="classText.html#a25">refresh</a>();
01075 
01076 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01077 <span class="preprocessor"></span>        square_feet_spinner.<a class="code" href="classSpinner.html#a5">refresh</a>();
01078         investment_required.<a class="code" href="classText.html#a25">refresh</a>();
01079         additional_debt.<a class="code" href="classText.html#a25">refresh</a>();
01080 <span class="preprocessor">#endif</span>
01081 <span class="preprocessor"></span>    }
01082 
01083     <span class="comment">//-----------Print message------//</span>
01084     <span class="comment">/*  </span>
01085 <span class="comment">        if(dataArray[numSeriesData]-dataArray[0]&gt;0)</span>
01086 <span class="comment">        {</span>
01087 <span class="comment">        font_chartsm.put(</span>
01088 <span class="comment">        REPORT_X1+35,</span>
01089 <span class="comment">        MODE_SPACEUSAGE_VTAB2+15,</span>
01090 <span class="comment">        mode_spaceusage_str[0]</span>
01091 <span class="comment">        );</span>
01092 <span class="comment">        font_chartsm.put(</span>
01093 <span class="comment">        REPORT_X1+480,</span>
01094 <span class="comment">        MODE_SPACEUSAGE_VTAB2+15,</span>
01095 <span class="comment">        m.format(dataArray[numSeriesData]-dataArray[0],1)</span>
01096 <span class="comment">        );</span>
01097 <span class="comment">        }</span>
01098 <span class="comment">        else</span>
01099 <span class="comment">        {</span>
01100 <span class="comment">    */</span>
01101 
01102     <span class="comment">//          font_chartsm.put(</span>
01103     <span class="comment">//                          REPORT_X1+35,</span>
01104     <span class="comment">//                          MODE_SPACEUSAGE_VTAB2+15,</span>
01105     <span class="comment">//                          mode_spaceusage_str[1]</span>
01106     <span class="comment">//                  );</span>
01107 
01108     vga.blt_buf(
01109         <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+35,
01110         <a class="code" href="Ofaci__if_8cpp.html#a173a94">MODE_SPACEUSAGE_VTAB2</a>+15,
01111         <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>-5,
01112         <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>
01113         );
01114     <span class="comment">// end Kevin 0904</span>
01115 }
01116 
01117 <span class="comment">//-------- Begin of function report_CAPITAL ---------//</span>
01119 <span class="comment">static void report_capital(int refreshFlag) {</span>
01120     <span class="comment">// Notes:   temporary variables for debugging</span>
01121     <span class="comment">//                          to be interfaced with game engine</span>
01122 
01123     <span class="keyword">static</span> <span class="keywordtype">int</span> v11=1000,v12=1999,v13=8888;
01124     <span class="keyword">static</span> <span class="keywordtype">double</span> v21=663.23,v22=123.23,v23=17.23,v24=723.23,v25=13.23;
01125     <span class="keyword">static</span> <span class="keywordtype">double</span> v31=813.83,v32=888.23,v33=13.83,v34=188.23,v35=183.23;
01126     <span class="keyword">static</span> <span class="keywordtype">double</span> v41=88.28,v42=777.23,v43=166.27,v44=777.23,v45=173.23;
01127     <span class="keyword">static</span> <span class="keywordtype">int</span> sliderVar1=0;
01128     <span class="keyword">static</span> <span class="keywordtype">float</span> spinnerVar3=0.0;
01129     <span class="keyword">static</span> <span class="keywordtype">float</span> spinnerVar4=0.0;
01130     <span class="keyword">static</span> <span class="keywordtype">int</span> numSeriesData = 8;                   <span class="comment">//*** temporary ***//</span>
01131     <span class="keyword">static</span> <span class="keywordtype">int</span> xStart = 1991, xEnd = 1998;          <span class="comment">//*** temporary ***//</span>
01132 
01133     <span class="comment">// ##### Begin Marco ##### //</span>
01134 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01135 <span class="preprocessor"></span>    <span class="keyword">static</span> <span class="keywordtype">double</span> initialv21=663.23;
01136     <span class="keyword">static</span> <span class="keywordtype">double</span> initialv31=813.83;
01137     <span class="keyword">static</span> <span class="keywordtype">double</span> initialv41=88.28;
01138 <span class="preprocessor">#endif</span>
01139 <span class="preprocessor"></span>    <span class="comment">// ##### End Marco ##### //</span>
01140     <span class="comment">//  static float *dataArray;                                                                                                                //*** temporary ***//</span>
01141     <span class="comment">//  static float dataArray[]={25,98,75,32,65,46,38,74,38,75,83,79,52,36,59,23,38,74,38,75,83,79,52,36,59,23};</span>
01142     <span class="keyword">static</span> dataArray[24];
01143     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;numSeriesData;i++) {
01144         dataArray[i]=facility_office.gifts_to_facility[i];
01145         dataArray[i+8]=(int)facility_office.captial_reserve_expense[i];
01146         dataArray[i+16]=facility_office.transfer_history[i];
01147     }
01148 
01149     <span class="comment">//  Communicate with Sim Engine's Output</span>
01150     v11=info.game_year-1;
01151     v12=info.game_year;
01152     v13=info.game_year+1;
01153     v21=finance.expense_array[<a class="code" href="Ofinance_8h.html#a104a56">AC_TRANSFER_TO_CAPITAL_RESERVE</a>].total;
01154     v23=finance.projected_expense_array[<a class="code" href="Ofinance_8h.html#a104a56">AC_TRANSFER_TO_CAPITAL_RESERVE</a>].this_year.total;
01155     v25=finance.projected_expense_array[<a class="code" href="Ofinance_8h.html#a104a56">AC_TRANSFER_TO_CAPITAL_RESERVE</a>].next_year.total;
01156     v22 = finance.calc_change(v23,v21);
01157     v24 = finance.calc_change(v25,v23);
01158 
01159     v31=(float)facility_office.captial_reserve_expense[<a class="code" href="Gamedef_8h.html#a82a48">H_PREV_YEAR</a>];
01160     v33=(float)facility_office.captial_reserve_expense[<a class="code" href="Gamedef_8h.html#a82a49">H_THIS_YEAR</a>];
01161     v35=(float)facility_office.captial_reserve_expense[<a class="code" href="Gamedef_8h.html#a82a50">H_NEXT_YEAR</a>];
01162     v32=finance.calc_change(v33,v31);
01163     v34=finance.calc_change(v35,v33);
01164 
01165     v41=finance.last_year.asset_array[<a class="code" href="Ofinance_8h.html#a97a21">AC_CAPITAL_RESERVE</a>];
01166     v43=finance.this_year.asset_array[<a class="code" href="Ofinance_8h.html#a97a21">AC_CAPITAL_RESERVE</a>];
01167     v45=finance.next_year.asset_array[<a class="code" href="Ofinance_8h.html#a97a21">AC_CAPITAL_RESERVE</a>];
01168     v42=finance.calc_change(v43,v41);
01169     v44=finance.calc_change(v45,v43);
01170 
01171   <span class="comment">// ##### Begin Marco ##### //</span>
01172 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01173 <span class="preprocessor"></span>    initialv21=finance.initial_expense_array[<a class="code" href="Ofinance_8h.html#a104a56">AC_TRANSFER_TO_CAPITAL_RESERVE</a>].total;
01174     <span class="comment">//  initialv31=(float)facility_office.initial_captial_reserve_expense[H_PREV_YEAR];</span>
01175     initialv41=finance.initial_last_year.asset_array[<a class="code" href="Ofinance_8h.html#a97a21">AC_CAPITAL_RESERVE</a>];
01176 
01177     initialv31=(float)facility_office.initial_captial_reserve_expense;
01178 <span class="preprocessor">#endif</span>
01179 <span class="preprocessor"></span>    <span class="comment">// ##### End Marco ##### //</span>
01180 
01181     xStart = info.game_year-numSeriesData+1;
01182     xEnd = info.game_year;
01184 
01185     <span class="keywordtype">int</span> field_space=5*font_chartsm.max_font_width;
01186 
01187     <span class="keywordflow">if</span> (refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>) {
01188         <span class="comment">// top title</span>
01189         user_interface.brighten(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+150,<a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>-23,<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+575,<a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>-3);
01190         user_interface.rect(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+150,<a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>-23,<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+575,<a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>-3,1);
01191         font_charts.put(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+295,<a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>-18,<span class="stringliteral">"Capital Reserve"</span>);
01192 
01193         spinnerVar3 = (float)finance.get_policy_var(<span class="keyword">false</span>, <a class="code" href="Ofinance_8h.html#a104a56">AC_TRANSFER_TO_CAPITAL_RESERVE</a>)-&gt;target_value;
01194 
01195         <span class="keywordflow">if</span>(facility_office.current_mode&gt;=0)
01196             (*deinit_func_ptr[facility_office.current_mode])();
01197         mode_init_flag = <a class="code" href="Ofaci__if_8cpp.html#a167a61">MODE_CAPITAL</a>;
01198 
01199         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {
01200             capital_button_up_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
01201             capital_button_down_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
01202         }
01203 
01204         <span class="comment">//--------- draw the brightened boxes ------------//</span>
01205         user_interface.brighten(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>);
01206 
01207         user_interface.rect(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a106">MODE_CAPITAL_BOX1_HEIGHT</a>+6);
01208         user_interface.rect(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>-<a class="code" href="Ofaci__if_8cpp.html#a177a107">MODE_CAPITAL_BOX2_HEIGHT</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a115">MODE_CAPITAL_TAB4</a>-1, <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>);
01209         user_interface.rect(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a115">MODE_CAPITAL_TAB4</a>-3, <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>-<a class="code" href="Ofaci__if_8cpp.html#a177a107">MODE_CAPITAL_BOX2_HEIGHT</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>);
01210 
01211         <span class="keywordtype">short</span> y = <a class="code" href="Ofaci__if_8cpp.html#a178a119">CAPITAL_BUTTON_Y1</a>;
01212         <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++, y+=<a class="code" href="Ofaci__if_8cpp.html#a179a123">CAPITAL_BUTTON_HEIGHT</a>+<a class="code" href="Ofaci__if_8cpp.html#a179a124">CAPITAL_BUTTON_DISTANCE</a>) {
01213             user_interface.create_button_bitmap(<a class="code" href="Ofaci__if_8cpp.html#a178a118">CAPITAL_BUTTON_X1</a>,y,
01214                                                 <a class="code" href="Ofaci__if_8cpp.html#a178a118">CAPITAL_BUTTON_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a179a122">CAPITAL_BUTTON_WIDTH</a>,y+<a class="code" href="Ofaci__if_8cpp.html#a179a123">CAPITAL_BUTTON_HEIGHT</a>,
01215                                                 capital_button_label[i], &amp;capital_button_up_bitmap[i],
01216                                                 &amp;capital_button_down_bitmap[i], &amp;vga_back);
01217 
01218             capital_button_group[i].create_bitmapW(<a class="code" href="Ofaci__if_8cpp.html#a178a118">CAPITAL_BUTTON_X1</a>,y,
01219                                                    <a class="code" href="Ofaci__if_8cpp.html#a178a118">CAPITAL_BUTTON_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a179a122">CAPITAL_BUTTON_WIDTH</a>,y+<a class="code" href="Ofaci__if_8cpp.html#a179a123">CAPITAL_BUTTON_HEIGHT</a>,
01220                                                    (capital_button_up_bitmap[i])+4,0);
01221         }
01222         capital_spinner_budget1.<a class="code" href="classSpinner.html#a2">init</a>(
01223             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a116">MODE_CAPITAL_TAB5</a>-20,
01224             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a106">MODE_CAPITAL_BOX1_HEIGHT</a>+100,
01225             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a116">MODE_CAPITAL_TAB5</a>+100,
01226             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a106">MODE_CAPITAL_BOX1_HEIGHT</a>+130 ,
01227             <span class="comment">//### begin zhoubin 02/25/99</span>
01228             &amp;facility_office.spinner_var3,
01229             <span class="comment">//### end zhoubin 02/25/99</span>
01230             <span class="comment">//                          -100.0f,100.0f,0.1f,0,NULL,23);</span>
01231             -5.0f,5.0f,0.1f,0,<a class="code" href="OHELP_8H.html#a0">NULL</a>,25);                 <span class="comment">//## chea 170999</span>
01232 
01233         <span class="comment">//-------- graph title --------------//</span>
01234         mode_capital_graph_profitloss.<a class="code" href="classGraphYear.html#a2">init</a>(
01235             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>-<a class="code" href="Ofaci__if_8cpp.html#a177a107">MODE_CAPITAL_BOX2_HEIGHT</a>,
01236             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a115">MODE_CAPITAL_TAB4</a>-1, <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>,
01237             3, &amp;numSeriesData, dataArray, 1,
01238             <a class="code" href="OHELP_8H.html#a0">NULL</a>,<span class="stringliteral">" "</span>,mode_capital_legend_label, 1, 1, 1, 2);
01239 
01240         <span class="comment">//-------- paint the buttons -----------//</span>
01241         capital_spinner_budget1.<a class="code" href="classSpinner.html#a4">paint</a>();
01242         <span class="keywordflow">for</span>(i=0;i&lt;3;i++)
01243             capital_button_group[i].<a class="code" href="classButtonGroup.html#a3">paint</a>();
01244 
01245         mode_capital_graph_profitloss.<a class="code" href="classGraphYear.html#a8">paint</a>();
01246 
01247         <span class="comment">//-------- display static strings -----------//</span>
01248         font_chartsm.put(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a112">MODE_CAPITAL_TAB1</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+17, mode_capital_str[0]);
01249         font_chartsm.put(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a112">MODE_CAPITAL_TAB1</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+37, mode_capital_str[1]);
01250         font_chartsm.put(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a112">MODE_CAPITAL_TAB1</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+57, mode_capital_str[2]);
01251 
01252         <span class="comment">//              user_interface.bar(REPORT_X1+10, REPORT_Y1+82, REPORT_X2-10, REPORT_Y1+84, V_BROWN);</span>
01253         <span class="comment">//              font_chartsm.put(REPORT_X1+MODE_CAPITAL_TAB1, REPORT_Y1+95, mode_capital_str[2]);</span>
01254 
01255         font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a114">MODE_CAPITAL_TAB3</a>+field_space,
01256                                 <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+5,
01257                                 <span class="comment">//                                      REPORT_X1+MODE_CAPITAL_TAB3+field_space,</span>
01258                                 <span class="comment">//                                      REPORT_Y1+5+font_chartsm.max_font_height,</span>
01259                                 mode_capital_str[4]);
01260         font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a116">MODE_CAPITAL_TAB5</a>+field_space,
01261                                 <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+5,
01262                                 <span class="comment">//                                      REPORT_X1+MODE_CAPITAL_TAB5+field_space,</span>
01263                                 <span class="comment">//                                      REPORT_Y1+5+font_chartsm.max_font_height,</span>
01264                                 mode_capital_str[4]);
01265 
01266         font_chartsm.put_paragraph(
01267             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a115">MODE_CAPITAL_TAB4</a>+20,
01268             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+55+<a class="code" href="Ofaci__if_8cpp.html#a177a106">MODE_CAPITAL_BOX1_HEIGHT</a>,
01269             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a116">MODE_CAPITAL_TAB5</a>+160,
01270             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+90+<a class="code" href="Ofaci__if_8cpp.html#a177a106">MODE_CAPITAL_BOX1_HEIGHT</a>,
01271             mode_capital_str[5]);
01272 
01273         mode_capital_stats_bitmap=<a class="code" href="OHELP_8H.html#a0">NULL</a>;
01274         mode_capital_stats_bitmap=vga_back.save_area(
01275             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a113">MODE_CAPITAL_TAB2</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>,
01276             <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a106">MODE_CAPITAL_BOX1_HEIGHT</a>,
01277             mode_capital_stats_bitmap);
01278 
01279     }
01280     <span class="keywordflow">else</span> {                                          <span class="comment">// refreshFlag == INFO_REFRESH</span>
01281         <span class="comment">//-------- refresh dynamic data --------------//</span>
01282         <span class="comment">// refresh() == 1. rest()</span>
01283         <span class="comment">//                                              2. draw()</span>
01284         <span class="comment">//                                              3. blit buffer()</span>
01285     }
01286 
01287     <span class="comment">//-------------------------------------------//</span>
01288 
01289     capital_spinner_budget1.<a class="code" href="classSpinner.html#a5">refresh</a>();
01290     mode_capital_graph_profitloss.<a class="code" href="classGraphYear.html#a9">refresh</a>();
01291 
01292     <span class="keywordtype">int</span> pressed=finance.get_policy_var(<span class="keyword">false</span>, <a class="code" href="Ofinance_8h.html#a104a56">AC_TRANSFER_TO_CAPITAL_RESERVE</a>)-&gt;applied_flag;
01293     <span class="keywordflow">if</span>(pressed==<a class="code" href="Ofinanc2_8h.html#a38a5">P_NONE</a>)
01294         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;3;i++)
01295             capital_button_group[i].<a class="code" href="classButtonGroup.html#a3">paint</a>();
01296     <span class="keywordflow">else</span>
01297         capital_button_group.<a class="code" href="classButtonGroup.html#a3">paint</a>(pressed-1);
01298 
01299     <span class="keywordtype">short</span> y = <a class="code" href="Ofaci__if_8cpp.html#a178a119">CAPITAL_BUTTON_Y1</a>;
01300     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++, y+=<a class="code" href="Ofaci__if_8cpp.html#a179a123">CAPITAL_BUTTON_HEIGHT</a>+<a class="code" href="Ofaci__if_8cpp.html#a179a124">CAPITAL_BUTTON_DISTANCE</a>) {
01301         vga.blt_buf(<a class="code" href="Ofaci__if_8cpp.html#a178a118">CAPITAL_BUTTON_X1</a>,y,
01302                     <a class="code" href="Ofaci__if_8cpp.html#a178a118">CAPITAL_BUTTON_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a179a122">CAPITAL_BUTTON_WIDTH</a>,y+<a class="code" href="Ofaci__if_8cpp.html#a179a123">CAPITAL_BUTTON_HEIGHT</a>);
01303     }
01304     vga_back.rest_area(mode_capital_stats_bitmap,0,0);
01305     <a class="code" href="classString.html">String</a> *s1,*s2;
01306 
01307     <span class="comment">//show years</span>
01308 
01309     s1=<span class="keyword">new</span> <a class="code" href="classString.html">String</a>(m.format(v11,16));
01310     s2=<span class="keyword">new</span> <a class="code" href="classString.html">String</a>(m.format(v11+1,16));
01311     <span class="comment">//          (*s1)+="-";    //## chea 061199 2.5.1</span>
01312     <span class="comment">//          (*s1)+=(*s2);  //## chea 061199 2.5.1</span>
01313     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a113">MODE_CAPITAL_TAB2</a>+field_space,
01314                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+5,
01315                             <span class="comment">//                                  REPORT_X1+MODE_CAPITAL_TAB2+field_space,</span>
01316                             <span class="comment">//                                  REPORT_Y1+5+font_chartsm.max_font_height,</span>
01317                             s1-&gt;<a class="code" href="classString.html#m0">str_buf</a>);
01318 
01319     (*s1)=m.format(v12,16);
01320     (*s2)=m.format(v12+1,16);
01321     <span class="comment">//          (*s1)+="-";    //## chea 061199 2.5.1</span>
01322     <span class="comment">//          (*s1)+=(*s2);  //## chea 061199 2.5.1</span>
01323     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a115">MODE_CAPITAL_TAB4</a>+field_space,
01324                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+5,
01325                             <span class="comment">//                                  REPORT_X1+MODE_CAPITAL_TAB4+field_space,</span>
01326                             <span class="comment">//                                  REPORT_Y1+5+font_chartsm.max_font_height,</span>
01327                             s1-&gt;<a class="code" href="classString.html#m0">str_buf</a>);
01328 
01329     (*s1)=m.format(v13,16);
01330     (*s2)=m.format(v13+1,16);
01331     <span class="comment">//          (*s1)+="-";    //## chea 061199 2.5.1</span>
01332     <span class="comment">//          (*s1)+=(*s2);  //## chea 061199 2.5.1</span>
01333     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a117">MODE_CAPITAL_TAB6</a>+field_space,
01334                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+5,
01335                             <span class="comment">//                                  REPORT_X1+MODE_CAPITAL_TAB6+field_space,</span>
01336                             <span class="comment">//                                  REPORT_Y1+5+font_chartsm.max_font_height,</span>
01337                             s1-&gt;<a class="code" href="classString.html#m0">str_buf</a>);
01338     <span class="keyword">delete</span> s1,s2;
01339 
01340   <span class="comment">//--------- transfer to capital reserve -------//</span>
01341   <span class="comment">// ##### Begin Marco ##### //</span>
01342 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01343 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (info.financial_year() &gt; 1) {
01344         font_chart_purple_sm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a113">MODE_CAPITAL_TAB2</a>,
01345                                         <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+5,
01346                                         <span class="stringliteral">"Yr. 0 (Initial)"</span>);
01347         font_chart_purple_sm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a113">MODE_CAPITAL_TAB2</a>,
01348                                         <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+23,
01349                                         m.format(initialv21, 2));
01350     }
01351 <span class="preprocessor">#endif</span>
01352 <span class="preprocessor"></span>    <span class="comment">// ##### End Marco ##### //</span>
01353 
01354     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a113">MODE_CAPITAL_TAB2</a>+field_space,
01355                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+23,
01356                             m.format(v21, 2));
01357 
01358     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a114">MODE_CAPITAL_TAB3</a>+field_space,
01359                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+23,
01360                             m.format(v22, 24));
01361 
01362     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a115">MODE_CAPITAL_TAB4</a>+field_space,
01363                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+23,
01364                             m.format(v23, 2));
01365 
01366     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a116">MODE_CAPITAL_TAB5</a>+field_space,
01367                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+23,
01368                             m.format(v24, 24));
01369 
01370     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a117">MODE_CAPITAL_TAB6</a>+field_space,
01371                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+23,
01372                             m.format(v25, 2));
01373 
01374     <span class="comment">//----- expenditures from capital reserve -------//</span>
01375     <span class="comment">// ##### Begin Marco ##### //</span>
01376 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01377 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (info.financial_year() &gt; 1) {
01378         font_chart_purple_sm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a113">MODE_CAPITAL_TAB2</a>,
01379                                         <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+40,
01380                                         m.format(initialv31, 2));
01381     }
01382 <span class="preprocessor">#endif</span>
01383 <span class="preprocessor"></span>    <span class="comment">// ##### End Marco ##### //</span>
01384     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a113">MODE_CAPITAL_TAB2</a>+field_space,
01385                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+40,
01386                             m.format(v31, 2));
01387 
01388     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a114">MODE_CAPITAL_TAB3</a>+field_space,
01389                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+40,
01390                             m.format(v32, 24));
01391 
01392     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a115">MODE_CAPITAL_TAB4</a>+field_space,
01393                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+40,
01394                             m.format(v33, 2));
01395 
01396     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a116">MODE_CAPITAL_TAB5</a>+field_space,
01397                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+40,
01398                             m.format(v34, 24));
01399 
01400     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a117">MODE_CAPITAL_TAB6</a>+field_space,
01401                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+40,
01402                             m.format(v35, 2));
01403 
01404     <span class="comment">//-------- capital reserve balance ---------//</span>
01405     <span class="comment">// ##### Begin Marco ##### //</span>
01406 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01407 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (info.financial_year() &gt; 1) {
01408         font_chart_purple_sm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a113">MODE_CAPITAL_TAB2</a>,
01409                                         <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+57,
01410                                         m.format(initialv41, 2));
01411     }
01412 <span class="preprocessor">#endif</span>
01413 <span class="preprocessor"></span>    <span class="comment">// ##### End Marco ##### //</span>
01414     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a113">MODE_CAPITAL_TAB2</a>+field_space,
01415                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+57,
01416                             m.format(v41, 2));
01417 
01418     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a114">MODE_CAPITAL_TAB3</a>+field_space,
01419                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+57,
01420                             m.format(v42, 24));
01421 
01422     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a115">MODE_CAPITAL_TAB4</a>+field_space,
01423                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+57,
01424                             m.format(v43, 2));
01425 
01426     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a116">MODE_CAPITAL_TAB5</a>+field_space,
01427                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+57,
01428                             m.format(v44, 24));
01429 
01430     font_chartsm.right_put( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a117">MODE_CAPITAL_TAB6</a>+field_space,
01431                             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+57,
01432                             m.format(v45, 2));
01433 
01434     <span class="comment">//-------------------------------------------//</span>
01435 
01436     vga.blt_buf(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a113">MODE_CAPITAL_TAB2</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>,
01437                 <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a106">MODE_CAPITAL_BOX1_HEIGHT</a>);
01438 
01439     vga.blt_buf(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>-<a class="code" href="Ofaci__if_8cpp.html#a177a107">MODE_CAPITAL_BOX2_HEIGHT</a>,
01440                 <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a115">MODE_CAPITAL_TAB4</a>-1, <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>);
01441 
01442     <span class="comment">//-------------------------------------------//</span>
01443 
01444     <span class="keywordflow">for</span>(i=0;i&lt;3;i++) {
01445         capital_button_group[i].pop();
01446         capital_button_group[i].body_ptr=
01447             (<span class="keywordtype">void</span>*)(capital_button_up_bitmap[i]+4);
01448     }
01449 }
01450 
01451 <span class="comment">//---------- End of function report_CAPITAL ---------//</span>
01452 
01453 <span class="comment">//-------- Begin of function report_DEBT ---------//</span>
01455 <span class="comment">static void report_debt(int refreshFlag) {</span>
01456     <span class="comment">// Notes:   temporary variables for debugging</span>
01457     <span class="comment">//                          to be interfaced with game engine</span>
01458 
01459     <span class="keyword">static</span> <span class="keywordtype">int</span> numSeriesData = 8;                   <span class="comment">//*** temporary ***//</span>
01460     <span class="keyword">static</span> <span class="keywordtype">int</span> xStart = 1991, xEnd = 1998;          <span class="comment">//*** temporary ***//</span>
01461     <span class="keyword">static</span> <span class="keywordtype">int</span> dataArray[24];                       <span class="comment">//*** temporary ***//</span>
01462     <span class="comment">//  static float dataArray[]={      25,98,75,32,65,46,38,74,</span>
01463     <span class="comment">//                                                                          38,75,83,79,52,36,75,83,</span>
01464     <span class="comment">//                                                                          79,52,36,59,23,59,23,25,</span>
01465     <span class="comment">//                                                                          98,75,32,65,46,38,74,38,</span>
01466     <span class="comment">//                                                                          75,62,83,79,52,36,59,23};</span>
01467 
01468     <span class="comment">//  Communicate with Sim Engine's Output</span>
01469     xStart = (int)(info.game_year+(info.game_month-9.0)/12-1);
01470     xEnd = xStart+numSeriesData;
01471     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;numSeriesData;i++) {
01472         dataArray[i]=facility_office.total_debt_capacity[i];
01473         dataArray[i+8]=facility_office.outstanding_debt_balance[i];
01474         dataArray[i+16]=facility_office.debt_limit[i];
01475     }
01476 
01477     <span class="keywordflow">if</span> (refreshFlag == <a class="code" href="Gamedef_8h.html#a71a16">INFO_REPAINT</a>) {
01478         <span class="comment">// top title</span>
01479         user_interface.brighten(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+150,<a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>-23,<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+575,<a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>-3);
01480         user_interface.rect(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+150,<a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>-23,<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+575,<a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>-3,1);
01481         font_charts.put(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+320,<a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>-18,<span class="stringliteral">"Debt"</span>);
01482 
01483         <span class="keywordflow">if</span>(facility_office.current_mode&gt;=0)
01484             (*deinit_func_ptr[facility_office.current_mode])();
01485         mode_init_flag = <a class="code" href="Ofaci__if_8cpp.html#a167a62">MODE_DEBT</a>;
01486         debt_button_up_bitmap[0] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
01487         debt_button_down_bitmap[0] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
01488         debt_button2_up_bitmap[0] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
01489         debt_button2_down_bitmap[0] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
01490 
01491         <span class="comment">//--------- draw the brightened boxes ------------//</span>
01492         user_interface.brighten(
01493             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a133">MODE_DEBT_TAB2</a>,
01494             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>,
01495             <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>,
01496             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a135">MODE_DEBT_VTAB1</a>);
01497         user_interface.brighten(
01498             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a133">MODE_DEBT_TAB2</a>,
01499             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a136">MODE_DEBT_VTAB2</a>,
01500             <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>,
01501             <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>);
01502 
01503         user_interface.rect(  <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a133">MODE_DEBT_TAB2</a>-2, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>,
01504                               <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a135">MODE_DEBT_VTAB1</a>+4);
01505         user_interface.rect(  <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a133">MODE_DEBT_TAB2</a>-2, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a136">MODE_DEBT_VTAB2</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>,
01506                               <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>);
01507 
01508         <span class="comment">//--------- draw the brightened boxes ------------//</span>
01509         <span class="comment">/*              user_interface.brighten(</span>
01510 <span class="comment">                        REPORT_X1+MODE_DEBT_TAB2, REPORT_Y1, REPORT_X2,</span>
01511 <span class="comment">                        REPORT_Y2);</span>
01512 <span class="comment">                        user_interface.rect(    REPORT_X1+MODE_DEBT_TAB2, REPORT_Y1, REPORT_X2,</span>
01513 <span class="comment">                        REPORT_Y1+MODE_DEBT_VTAB1+3);</span>
01514 <span class="comment">                        user_interface.rect(    REPORT_X1+MODE_DEBT_TAB2, REPORT_Y1+MODE_DEBT_VTAB2-1, REPORT_X2,</span>
01515 <span class="comment">                        REPORT_Y2);</span>
01516 <span class="comment">        */</span>
01517         user_interface.rect(  <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>,   
01518                               <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a132">MODE_DEBT_TAB1</a>+4, <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>);
01519 
01520         user_interface.create_button_bitmap(
01521             <a class="code" href="Ofaci__if_8cpp.html#a182a137">DEBT_BUTTON_X1</a>,<a class="code" href="Ofaci__if_8cpp.html#a182a138">DEBT_BUTTON_Y1</a>,
01522             <a class="code" href="Ofaci__if_8cpp.html#a182a137">DEBT_BUTTON_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a183a141">DEBT_BUTTON_WIDTH</a>,
01523             <a class="code" href="Ofaci__if_8cpp.html#a182a138">DEBT_BUTTON_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a183a142">DEBT_BUTTON_HEIGHT</a>,
01524             debt_button_label[0], &amp;debt_button_up_bitmap[0],
01525             &amp;debt_button_down_bitmap[0], &amp;vga_back);
01526 
01527         user_interface.create_button_bitmap(
01528             <a class="code" href="Ofaci__if_8cpp.html#a184a144">DEBT_BUTTON2_X1</a>,
01529             <a class="code" href="Ofaci__if_8cpp.html#a184a145">DEBT_BUTTON2_Y1</a>,
01530             <a class="code" href="Ofaci__if_8cpp.html#a184a144">DEBT_BUTTON2_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a185a148">DEBT_BUTTON2_WIDTH</a>,
01531             <a class="code" href="Ofaci__if_8cpp.html#a184a145">DEBT_BUTTON2_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a185a149">DEBT_BUTTON2_HEIGHT</a>,
01532             debt_button2_label[0], &amp;debt_button2_up_bitmap[0],
01533             &amp;debt_button2_down_bitmap[0], &amp;vga_back);
01534 
01535         debt_button_group[0].create_bitmapW(<a class="code" href="Ofaci__if_8cpp.html#a182a137">DEBT_BUTTON_X1</a>,<a class="code" href="Ofaci__if_8cpp.html#a182a138">DEBT_BUTTON_Y1</a>,
01536                                             <a class="code" href="Ofaci__if_8cpp.html#a182a137">DEBT_BUTTON_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a183a141">DEBT_BUTTON_WIDTH</a>,<a class="code" href="Ofaci__if_8cpp.html#a182a138">DEBT_BUTTON_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a183a142">DEBT_BUTTON_HEIGHT</a>,
01537                                             (debt_button_up_bitmap[0])+4,0);
01538 
01539         debt_button2_group[0].create_bitmapW(<a class="code" href="Ofaci__if_8cpp.html#a184a144">DEBT_BUTTON2_X1</a>,<a class="code" href="Ofaci__if_8cpp.html#a184a145">DEBT_BUTTON2_Y1</a>,
01540                                              <a class="code" href="Ofaci__if_8cpp.html#a184a144">DEBT_BUTTON2_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a185a148">DEBT_BUTTON2_WIDTH</a>,<a class="code" href="Ofaci__if_8cpp.html#a184a145">DEBT_BUTTON2_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a185a149">DEBT_BUTTON2_HEIGHT</a>,
01541                                              (debt_button2_up_bitmap[0])+4,0);
01542 
01543         debt_spinner_budget1.<a class="code" href="classSpinner.html#a2">init</a>(
01544             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a134">MODE_DEBT_TAB3</a>+60,
01545             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+70,
01546             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a134">MODE_DEBT_TAB3</a>+180,
01547             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+100 ,
01548             <span class="comment">//### begin zhoubin 02/25/99</span>
01549             &amp;facility_office.debt_spinner_var1,
01550             <span class="comment">//### end zhoubin 02/25/99</span>
01551             0.0f,100.0f,10.0f,0,<a class="code" href="OHELP_8H.html#a0">NULL</a>,3);
01552         debt_spinner_budget2.<a class="code" href="classSpinner.html#a2">init</a>(
01553             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a134">MODE_DEBT_TAB3</a>+50,
01554             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a136">MODE_DEBT_VTAB2</a>+70,
01555             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a134">MODE_DEBT_TAB3</a>+190,
01556             <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a136">MODE_DEBT_VTAB2</a>+100,
01557             &amp;facility_office.debt_spinner_var2,
01558             0.0f,100000000.0f,5000.0f,0,<a class="code" href="OHELP_8H.html#a0">NULL</a>,2);
01559 
01560         <span class="comment">//-------- graph title --------------//</span>
01561         mode_debt_graph.<a class="code" href="classGraphArea2.html#a2">init</a>(
01562             <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>,<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a132">MODE_DEBT_TAB1</a>+4, <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>, 3,
01563             &amp;numSeriesData,dataArray, 0,facility_office.cur_debt_limit,<span class="stringliteral">""</span>,
01564             <span class="stringliteral">""</span>, mode_debt_legend_label, 1, 1, 1,
01565             2);
01566 
01567         <span class="comment">//-------- paint the buttons -----------//</span>
01568         debt_spinner_budget1.<a class="code" href="classSpinner.html#a4">paint</a>();
01569         debt_spinner_budget2.<a class="code" href="classSpinner.html#a4">paint</a>();
01570         debt_button_group[0].<a class="code" href="classButtonGroup.html#a3">paint</a>();
01571         debt_button2_group[0].<a class="code" href="classButtonGroup.html#a3">paint</a>();
01572 
01573         mode_debt_graph.<a class="code" href="classGraphArea2.html#a8">paint</a>();
01574         <span class="comment">//-------- display static strings -----------//</span>
01575         font_chartsm.put_paragraph( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a133">MODE_DEBT_TAB2</a>+15, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+40,
01576                                     <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+70,
01577                                     mode_debt_str[0]);
01578         font_chartsm.put_paragraph( <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a133">MODE_DEBT_TAB2</a>+15, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a136">MODE_DEBT_VTAB2</a>+40,
01579                                     <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a136">MODE_DEBT_VTAB2</a>+70,
01580                                     mode_debt_str[1]);
01581 
01582         <span class="comment">//              user_interface.bar(REPORT_X1+10, REPORT_Y1+82, REPORT_X2-10, REPORT_Y1+84, V_BROWN);</span>
01583 
01584     }
01585     <span class="keywordflow">else</span> {                                          <span class="comment">// refreshFlag == INFO_REFRESH</span>
01586         <span class="comment">//-------- refresh dynamic data --------------//</span>
01587         <span class="comment">// refresh() == 1. rest()</span>
01588         <span class="comment">//                                              2. draw()</span>
01589         <span class="comment">//                                              3. blit buffer()</span>
01590 
01591         debt_button_group[0].<a class="code" href="classButtonGroup.html#a3">paint</a>();
01592         debt_button2_group[0].<a class="code" href="classButtonGroup.html#a3">paint</a>();
01593         debt_spinner_budget1.<a class="code" href="classSpinner.html#a5">refresh</a>();
01594         debt_spinner_budget2.<a class="code" href="classSpinner.html#a5">refresh</a>();
01595         mode_debt_graph.<a class="code" href="classGraphArea2.html#a9">refresh</a>();
01596         vga.blt_buf(<a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>-<a class="code" href="Ofaci__if_8cpp.html#a181a131">MODE_DEBT_GRAPH_HEIGHT</a>,
01597                     <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a132">MODE_DEBT_TAB1</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a67">REPORT_Y2</a>);
01598 
01599         vga.blt_buf(<a class="code" href="Ofaci__if_8cpp.html#a182a137">DEBT_BUTTON_X1</a>,<a class="code" href="Ofaci__if_8cpp.html#a182a138">DEBT_BUTTON_Y1</a>,
01600                     <a class="code" href="Ofaci__if_8cpp.html#a182a137">DEBT_BUTTON_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a183a141">DEBT_BUTTON_WIDTH</a>,<a class="code" href="Ofaci__if_8cpp.html#a182a138">DEBT_BUTTON_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a183a142">DEBT_BUTTON_HEIGHT</a>);
01601         vga.blt_buf(<a class="code" href="Ofaci__if_8cpp.html#a184a144">DEBT_BUTTON2_X1</a>,<a class="code" href="Ofaci__if_8cpp.html#a184a145">DEBT_BUTTON2_Y1</a>,
01602                     <a class="code" href="Ofaci__if_8cpp.html#a184a144">DEBT_BUTTON2_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a185a148">DEBT_BUTTON2_WIDTH</a>,<a class="code" href="Ofaci__if_8cpp.html#a184a145">DEBT_BUTTON2_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a185a149">DEBT_BUTTON2_HEIGHT</a>);
01603 
01604     }
01605 
01606     debt_button_group[0].pop();
01607     debt_button_group[0].body_ptr=
01608         (<span class="keywordtype">void</span>*)(debt_button_up_bitmap[0]+4);
01609     debt_button2_group[0].pop();
01610     debt_button2_group[0].body_ptr=
01611         (<span class="keywordtype">void</span>*)(debt_button2_up_bitmap[0]+4);
01612 }
01613 
01614 <span class="comment">//---------- End of function report_debt ---------//</span>
01615 
01616 <span class="comment">//-------- Begin of function detect_financial ---------//</span>
01618 <span class="comment">static int detect_financial() {</span>
01619     <span class="keywordflow">if</span> (mode_init_flag != <a class="code" href="Ofaci__if_8cpp.html#a167a59">MODE_FINANCIAL</a>)
01620         <span class="keywordflow">return</span> 0;
01621 
01622     vga.use_front();
01623 
01624     help.set_help(
01625         <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a172a83">MODE_FINANCIAL_TAB3</a>+20,
01626         <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+120+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>,
01627         <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>,
01628         <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+140+<a class="code" href="Ofaci__if_8cpp.html#a172a75">MODE_FINANCIAL_BOX1_HEIGHT</a>,
01629         <span class="stringliteral">"A.2.2.1."</span>);
01630 
01631     <span class="keywordflow">if</span> (financial_spinner_budget1.<a class="code" href="classSpinner.html#a6">detect</a>())
01632         <span class="keywordflow">return</span> 1;
01633     <span class="comment">//  if (financial_spinner_budget2.detect())</span>
01634     <span class="comment">//          return 1;</span>
01635 
01636     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;3;i++)
01637         <span class="keywordflow">if</span>(financial_button_group[i].<a class="code" href="classButtonGroup.html#a4">detect</a>()) {
01638             financial_button_group[i].body_ptr =
01639                 (<span class="keywordtype">void</span> *) (financial_button_down_bitmap[i] + 4);
01640             <span class="comment">//  Communicate with Sim Engine</span>
01641             finance.change_budget(i,<span class="keyword">false</span>, <a class="code" href="Ofinance_8h.html#a104a53">AC_OPERATIONS_AND_MAINTENANCE</a>,(*financial_spinner_budget1.<a class="code" href="classSpinner.html#m7">var_ptr</a>));
01642             <span class="comment">//##        begin zhoubin 000329</span>
01643             *financial_spinner_budget1.<a class="code" href="classSpinner.html#m7">var_ptr</a>=0;
01644             <span class="comment">//##        end zhoubin 000329</span>
01645         }
01646 
01647     <span class="keywordflow">return</span> 0;
01648 }
01649 
01650 <span class="comment">//---------- End of function detect_financial--//</span>
01651 
01652 <span class="comment">//-------- Begin of function detect_spaceusage ---------//</span>
01654 <span class="comment">static int detect_spaceusage() {</span>
01655 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01656 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (square_feet_spinner.<a class="code" href="classSpinner.html#a6">detect</a>()) {
01657         square_feet_spinner.<a class="code" href="classSpinner.html#a4">paint</a>();
01658         <span class="keywordflow">return</span> 1;
01659     }
01660     <span class="keywordflow">if</span> ( authorize_button.<a class="code" href="classButton.html#a21">detect</a>() ) {
01661         <span class="comment">// calculate money available</span>
01662         <span class="keywordtype">int</span> facilityReserve = finance.this_year.asset_array[1];
01663         <span class="keywordtype">float</span> fundedByDebt = facility_office.debt_spinner_var1/100;
01664         <span class="keywordtype">int</span> externalDebtLimit = facility_office.total_debt_capacity[THIS_YEAR];
01665         <span class="keywordtype">int</span> internalDebtLimit = facility_office.debt_limit[THIS_YEAR];
01666         <span class="keywordtype">int</span> existingDebt = facility_office.outstanding_debt_balance[THIS_YEAR];
01667 
01668         <span class="keywordtype">int</span> investmentRequirement = int(facility_office.spinner_var4*department_res.general_dept_info.replacement_cost);
01669         <span class="keywordtype">int</span> facilityReserveRequired = investmentRequirement*(1-fundedByDebt);
01670 
01671         <span class="keywordtype">int</span> debtRequirement = investmentRequirement*fundedByDebt;
01672 
01673         <span class="comment">// check there is enough money for new constructions</span>
01674         <span class="keywordflow">if</span> ( facilityReserveRequired &gt; facilityReserve || debtRequirement &gt; (min( externalDebtLimit, internalDebtLimit )-existingDebt) ) {
01675             <span class="comment">// not enough money</span>
01676             <span class="comment">// show dialog box</span>
01677             box.msg( <span class="stringliteral">"Your capital budget can't fund the proposed new construction. Reduce the program or budget more money."</span> );
01678             facility_office.spinner_var4=0;
01679             sys.redraw_all_flag=1;
01680             <span class="keywordflow">return</span> 1;
01681         }
01682         <span class="keywordflow">else</span> {
01683             <span class="comment">// have money, start construction</span>
01684             facility_office.run_new_construction();
01685             facility_office.spinner_var4=0;
01686             sys.redraw_all_flag=1;
01687             <span class="keywordflow">return</span> 1;
01688         }
01689     }
01690 <span class="preprocessor">#endif</span>
01691 <span class="preprocessor"></span>
01692     <span class="keywordflow">if</span> (mode_init_flag != <a class="code" href="Ofaci__if_8cpp.html#a167a60">MODE_SPACEUSAGE</a>)
01693         <span class="keywordflow">return</span> 0;
01694 
01695     vga.use_front();
01696     <span class="keywordflow">return</span> 0;
01697 }
01698 
01699 <span class="comment">//---------- End of function detect_spaceusage ---------//</span>
01700 
01701 <span class="comment">//-------- Begin of function detect_capital---//</span>
01703 <span class="comment">static int detect_capital() {</span>
01704     <span class="keywordflow">if</span> (mode_init_flag != <a class="code" href="Ofaci__if_8cpp.html#a167a61">MODE_CAPITAL</a>)
01705         <span class="keywordflow">return</span> 0;
01706 
01707     vga.use_front();
01708 
01709     help.set_help(
01710         <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a115">MODE_CAPITAL_TAB4</a>+20,
01711         <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+55+<a class="code" href="Ofaci__if_8cpp.html#a177a106">MODE_CAPITAL_BOX1_HEIGHT</a>,
01712         <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a177a116">MODE_CAPITAL_TAB5</a>+160,
01713         <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+90+<a class="code" href="Ofaci__if_8cpp.html#a177a106">MODE_CAPITAL_BOX1_HEIGHT</a>,
01714         <span class="stringliteral">"A.3.3.1."</span>);
01715 
01716     <span class="keywordflow">if</span> (capital_spinner_budget1.<a class="code" href="classSpinner.html#a6">detect</a>())
01717         <span class="keywordflow">return</span> 1;
01718 
01719     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;3;i++)
01720         <span class="keywordflow">if</span>(capital_button_group[i].<a class="code" href="classButtonGroup.html#a4">detect</a>()) {
01721             capital_button_group[i].body_ptr =
01722                 (<span class="keywordtype">void</span> *) (capital_button_down_bitmap[i] + 4);
01723             <span class="comment">//  Communicate with Sim Engine</span>
01724             finance.change_budget(i,<span class="keyword">false</span>, <a class="code" href="Ofinance_8h.html#a104a56">AC_TRANSFER_TO_CAPITAL_RESERVE</a>,(*capital_spinner_budget1.<a class="code" href="classSpinner.html#m7">var_ptr</a>));
01725             <span class="comment">//##        begin zhoubin 000329</span>
01726             *capital_spinner_budget1.<a class="code" href="classSpinner.html#m7">var_ptr</a>=0;
01727             <span class="comment">//##        end zhoubin 000329</span>
01728         }
01729 
01730     <span class="keywordflow">return</span> 0;
01731 }
01732 
01733 <span class="comment">//---------- End of function detect_CAPITAL ---------//</span>
01734 
01735 <span class="comment">//-------- Begin of function detect_debt ---------//</span>
01737 <span class="comment">static int detect_debt() {</span>
01738     <span class="keywordflow">if</span> (mode_init_flag != <a class="code" href="Ofaci__if_8cpp.html#a167a62">MODE_DEBT</a>)
01739         <span class="keywordflow">return</span> 0;
01740 
01741     vga.use_front();
01742 
01743     help.set_help(  <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a133">MODE_DEBT_TAB2</a>+15, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+40,
01744                     <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+70,
01745                     <span class="stringliteral">"A.4.4.1."</span>
01746         );
01747     help.set_help(  <a class="code" href="Ofaci__if_8cpp.html#a169a64">REPORT_X1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a133">MODE_DEBT_TAB2</a>+15, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a136">MODE_DEBT_VTAB2</a>+40,
01748                     <a class="code" href="Ofaci__if_8cpp.html#a169a66">REPORT_X2</a>, <a class="code" href="Ofaci__if_8cpp.html#a169a65">REPORT_Y1</a>+<a class="code" href="Ofaci__if_8cpp.html#a181a136">MODE_DEBT_VTAB2</a>+70,
01749                     <span class="stringliteral">"A.4.4.2."</span>
01750         );
01751 
01752     <span class="keywordflow">if</span> (debt_spinner_budget1.<a class="code" href="classSpinner.html#a6">detect</a>())
01753         <span class="keywordflow">return</span> 1;
01754 
01755     <span class="keywordflow">if</span> (debt_spinner_budget2.<a class="code" href="classSpinner.html#a6">detect</a>())
01756         <span class="keywordflow">return</span> 1;
01757 
01758     <span class="keywordflow">if</span>(debt_button_group[0].<a class="code" href="classButtonGroup.html#a4">detect</a>()) {
01759         debt_button_group[0].body_ptr =
01760             (<span class="keywordtype">void</span> *) (debt_button_down_bitmap[0] + 4);
01761         <span class="comment">//      Communicate with Sim Engine</span>
01762         facility_office.percent_project_funded_with_debt=(float)(*debt_spinner_budget1.<a class="code" href="classSpinner.html#m7">var_ptr</a>);
01763     }
01764 
01765     <span class="keywordflow">if</span>(debt_button2_group[0].<a class="code" href="classButtonGroup.html#a4">detect</a>()) {
01766         debt_button2_group[0].body_ptr =
01767             (<span class="keywordtype">void</span> *) (debt_button2_down_bitmap[0] + 4);
01768         <span class="comment">//      Communicate with Sim Engine</span>
01769         facility_office.cur_debt_limit=(int)(*debt_spinner_budget2.<a class="code" href="classSpinner.html#m7">var_ptr</a>);
01770 <span class="preprocessor">#if(GAME_VERSION&gt;=200)</span>
01771 <span class="preprocessor"></span>        facility_office.debt_limit[THIS_YEAR] = facility_office.cur_debt_limit;
01772         sys.redraw_all_flag=1;
01773 <span class="preprocessor">#endif</span>
01774 <span class="preprocessor"></span>    }
01775 
01776     <span class="keywordflow">return</span> 0;
01777 }
01778 
01779 <span class="comment">//---------- End of function detect_debt--//</span>
01780 
01781 <span class="comment">//-------- Begin of function deinit_financial ------//</span>
01783 <span class="comment">static void deinit_financial() {</span>
01784     <span class="comment">//  if (mode_init_flag == MODE_FINANCIAL)</span>
01785     <span class="comment">//  {</span>
01786     <span class="comment">// deallocate memory used by the radio buttons and the value sliders</span>
01787     <span class="keywordflow">if</span>(mode_financial_stats_bitmap) {
01788         <a class="code" href="ALL_8H.html#a8">mem_del</a>(mode_financial_stats_bitmap);
01789         mode_financial_stats_bitmap=<a class="code" href="OHELP_8H.html#a0">NULL</a>;
01790     }
01791 
01792     <span class="keywordflow">if</span>(mode_financial_stats2_bitmap) {
01793         <a class="code" href="ALL_8H.html#a8">mem_del</a>(mode_financial_stats2_bitmap);
01794         mode_financial_stats2_bitmap=<a class="code" href="OHELP_8H.html#a0">NULL</a>;
01795     }
01796 
01797     <span class="comment">// ##### begin Gilbert 28/04/2001 #####//</span>
01798     financial_button_group.<a class="code" href="classButtonGroup.html#a2">deinit_buttons</a>();
01799     <span class="comment">// ##### end Gilbert 28/04/2001 #####//</span>
01800     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {
01801         <span class="keywordflow">if</span> (financial_button_up_bitmap[i]) {
01802             <a class="code" href="ALL_8H.html#a8">mem_del</a>(financial_button_up_bitmap[i]);
01803             <a class="code" href="ALL_8H.html#a8">mem_del</a>(financial_button_down_bitmap[i]);
01804             financial_button_up_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
01805             financial_button_down_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
01806         }
01807     }
01808 
01809     financial_spinner_budget1.<a class="code" href="classSpinner.html#a3">deinit</a>();
01810     mode_financial_graph_profitloss.<a class="code" href="classGraphYear.html#a7">deinit</a>();
01811 
01812     <span class="comment">// reset flag</span>
01813     mode_init_flag = -1;
01814     <span class="comment">//  }</span>
01815 }
01816 
01817 <span class="comment">//---------- End of function deinit_financial ------//</span>
01818 
01819 <span class="comment">//-------- Begin of function deinit_spaceusage ---------//</span>
01821 <span class="comment">static void deinit_spaceusage() {</span>
01822     <span class="comment">// ##### begin Gilbert 28/04/2001 #######//</span>
01823     mode_spaceusage_graph.<a class="code" href="classGraphNonFinancialMonth.html#a7">deinit</a>();
01824     report_spaceusage_text.<a class="code" href="classText.html#a26">deinit</a>();
01825     <span class="comment">// ##### end Gilbert 28/04/2001 #######//</span>
01826 
01827     <span class="keywordflow">if</span>(mode_spaceusage_stats_bitmap) {
01828         <a class="code" href="ALL_8H.html#a8">mem_del</a>(mode_spaceusage_stats_bitmap);
01829         mode_spaceusage_stats_bitmap=<a class="code" href="OHELP_8H.html#a0">NULL</a>;
01830     }
01831     report_spaceusage_text.<a class="code" href="classText.html#a26">deinit</a>();
01832     mode_init_flag = -1;
01833 }
01834 
01835 <span class="comment">//---------- End of function deinit_spaceusage ---------//</span>
01836 
01837 <span class="comment">//-------- Begin of function deinit_capital ------//</span>
01839 <span class="comment">static void deinit_capital() {</span>
01840     <span class="comment">// deallocate memory used by the radio buttons and the value sliders</span>
01841     <span class="keywordflow">if</span>(mode_capital_stats_bitmap) {
01842         <a class="code" href="ALL_8H.html#a8">mem_del</a>(mode_capital_stats_bitmap);
01843         mode_capital_stats_bitmap=<a class="code" href="OHELP_8H.html#a0">NULL</a>;
01844     }
01845 
01846     <span class="comment">// ##### begin Gilbert 28/04/2001 #####//</span>
01847     capital_button_group.<a class="code" href="classButtonGroup.html#a2">deinit_buttons</a>();
01848     <span class="comment">// ##### end Gilbert 28/04/2001 #####//</span>
01849     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {
01850         <span class="keywordflow">if</span> (capital_button_up_bitmap[i]) {
01851             <a class="code" href="ALL_8H.html#a8">mem_del</a>(capital_button_up_bitmap[i]);
01852             <a class="code" href="ALL_8H.html#a8">mem_del</a>(capital_button_down_bitmap[i]);
01853             capital_button_up_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
01854             capital_button_down_bitmap[i] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
01855         }
01856     }
01857 
01858     capital_spinner_budget1.<a class="code" href="classSpinner.html#a3">deinit</a>();
01859     mode_capital_graph_profitloss.<a class="code" href="classGraphYear.html#a7">deinit</a>();
01860 
01861     <span class="comment">// reset flag</span>
01862     mode_init_flag = -1;
01863 
01864 }
01865 
01866 <span class="comment">//---------- End of function deinit_capital ------//</span>
01867 
01868 <span class="comment">//-------- Begin of function deinit_debt ------//</span>
01870 <span class="comment">static void deinit_debt() {</span>
01871     <span class="comment">// deallocate memory used by the radio buttons and the value sliders</span>
01872     <span class="comment">// #### begin Gilbert 28/04/2001 #######//</span>
01873     debt_button_group.<a class="code" href="classButtonGroup.html#a2">deinit_buttons</a>();
01874     <span class="comment">// #### end Gilbert 28/04/2001 #######//</span>
01875     <span class="keywordflow">if</span> (debt_button_up_bitmap[0]) {
01876         <a class="code" href="ALL_8H.html#a8">mem_del</a>(debt_button_up_bitmap[0]);
01877         <a class="code" href="ALL_8H.html#a8">mem_del</a>(debt_button_down_bitmap[0]);
01878         debt_button_up_bitmap[0] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
01879         debt_button_down_bitmap[0] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
01880     }
01881 
01882     <span class="comment">// #### begin Gilbert 28/04/2001 #######//</span>
01883     debt_button2_group.<a class="code" href="classButtonGroup.html#a2">deinit_buttons</a>();
01884     <span class="comment">// #### end Gilbert 28/04/2001 #######//</span>
01885     <span class="keywordflow">if</span> (debt_button2_up_bitmap[0]) {
01886         <a class="code" href="ALL_8H.html#a8">mem_del</a>(debt_button2_up_bitmap[0]);
01887         <a class="code" href="ALL_8H.html#a8">mem_del</a>(debt_button2_down_bitmap[0]);
01888         debt_button2_up_bitmap[0] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
01889         debt_button2_down_bitmap[0] = <a class="code" href="OHELP_8H.html#a0">NULL</a>;
01890     }
01891 
01892     debt_spinner_budget1.<a class="code" href="classSpinner.html#a3">deinit</a>();
01893     debt_spinner_budget2.<a class="code" href="classSpinner.html#a3">deinit</a>();
01894     mode_debt_graph.<a class="code" href="classGraphArea2.html#a7">deinit</a>();
01895     <span class="comment">// reset flag</span>
01896     mode_init_flag = -1;
01897 }
01898 
01899 <span class="comment">//---------- End of function deinit_debt ------//</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:37:31 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
