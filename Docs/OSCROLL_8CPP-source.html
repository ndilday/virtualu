<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>OSCROLL.CPP Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>OSCROLL.CPP</h1><a href="OSCROLL_8CPP.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//Filename    : OSCROLL.CPP</span>
00002 <span class="comment">//Description : Object scroll bar</span>
00003 
00004 <span class="preprocessor">#include &lt;<a class="code" href="ALL_8H.html">ALL.H</a>&gt;</span>
00005 <span class="preprocessor">#include &lt;<a class="code" href="KEY_8H.html">KEY.H</a>&gt;</span>
00006 <span class="preprocessor">#include &lt;OSYS.H&gt;</span>
00007 <span class="preprocessor">#include &lt;OMOUSE.H&gt;</span>
00008 <span class="preprocessor">#include &lt;<a class="code" href="OVGA_8H.html">OVGA.H</a>&gt;</span>
00009 <span class="preprocessor">#include &lt;OINFO.H&gt;</span>
00010 <span class="preprocessor">#include &lt;<a class="code" href="OIMGRES_8H.html">OIMGRES.H</a>&gt;</span>
00011 <span class="preprocessor">#include &lt;<a class="code" href="OSCROLL_8H.html">OSCROLL.H</a>&gt;</span>
00012 
00013 <span class="comment">//------- Define constant -----------//</span>
00014 
<a name="l00015"></a><a class="code" href="OSCROLL_8CPP.html#a0">00015</a> <span class="preprocessor">#define PRESS_INT_TIME  200                       // Press interval time, prevent too fast</span>
00016 <span class="preprocessor"></span><span class="comment">// and uncontrollable scrolling, 200ms</span>
00017 
<a name="l00018"></a><a class="code" href="OSCROLL_8CPP.html#a1">00018</a> <span class="preprocessor">#define MINI_INDICATOR_HEIGHT 10                  // Minimum height of scroll bar indicator</span>
00019 <span class="preprocessor"></span>
00020 <span class="comment">//------ Begin of function ScrollBar::init -------//</span>
<a name="l00036"></a><a class="code" href="classScrollBar.html#a1">00036</a> <span class="comment">void ScrollBar::init(int itype, int ix1, int iy1, int ix2, int iy2,</span>
00037                      <span class="keywordtype">int</span> pageSkipRec, <span class="keywordtype">int</span> dispMaxRec, <span class="keywordtype">int</span> totalRec, <span class="keywordtype">int</span> pageType, <span class="keywordtype">int</span> ifFlag, <span class="keywordtype">int</span> vgaFrontOnly) {
00038     x1 = ix1;
00039     y1 = iy1;
00040     x2 = ix2+1;
00041     y2 = iy2;
00042 
00043     type = itype;
00044 
00045     skip_rec_num  = pageSkipRec;
00046     disp_rec_num  = dispMaxRec;
00047     total_rec_num = totalRec;
00048     page_type     = pageType;
00049     vga_front_only = vgaFrontOnly;
00050 
00051     <span class="keywordflow">if</span>( total_rec_num==0 )                          <span class="comment">// at must at least be 1, otherwise divided by zero error will appear</span>
00052         total_rec_num=1;
00053 
00054     <span class="keywordflow">if</span>( type == VERTICAL )
00055         slot_height = y2-y1-28;
00056     <span class="keywordflow">else</span>
00057         slot_height = x2-x1-28;
00058 
00059     indicator_height = slot_height * disp_rec_num / total_rec_num;
00060 
00061     <span class="keywordflow">if</span>( indicator_height &lt; <a class="code" href="OSCROLL_8CPP.html#a1">MINI_INDICATOR_HEIGHT</a> )
00062         indicator_height = <a class="code" href="OSCROLL_8CPP.html#a1">MINI_INDICATOR_HEIGHT</a>;
00063 
00064     next_press_time = 0;
00065 }
00066 
00067 <span class="comment">//------- End of function ScrollBar::init -------//</span>
00068 
00069 <span class="comment">//------- Begin of function ScrollBar::paint -------//</span>
<a name="l00073"></a><a class="code" href="classScrollBar.html#a2">00073</a> <span class="comment">void ScrollBar::paint(int topRecNo) {</span>
00074     <a class="code" href="ALL_8H.html#a0">err_when</a>( type == -1 );                         <span class="comment">// haven't been init()</span>
00075 
00076     <span class="comment">// scroll panel</span>
00077     <a class="code" href="classVga.html#p0">Vga::active_buf</a>-&gt;<a class="code" href="classVgaBuf.html#a42">d3_panel_down</a>( x1, y1, x2, y2 );
00078 
00079     <span class="comment">//-------- cursor button --------//</span>
00080     <span class="keywordflow">if</span>( type == VERTICAL ) {
00081         <span class="comment">// up button</span>
00082         <a class="code" href="classVga.html#p0">Vga::active_buf</a>-&gt;<a class="code" href="classVgaBuf.html#a41">d3_panel_up</a>( x1+2, y1+2 , x2-2, y1+13);
00083         <span class="comment">// down button</span>
00084         <a class="code" href="classVga.html#p0">Vga::active_buf</a>-&gt;<a class="code" href="classVgaBuf.html#a41">d3_panel_up</a>( x1+2, y2-13, x2-2, y2-2 );
00085     }
00086     <span class="keywordflow">else</span> {
00087         <span class="comment">// left button</span>
00088         <a class="code" href="classVga.html#p0">Vga::active_buf</a>-&gt;<a class="code" href="classVgaBuf.html#a41">d3_panel_up</a>( x1+2 , y1+2, x1+13, y2-2);
00089         <span class="comment">// right button</span>
00090         <a class="code" href="classVga.html#p0">Vga::active_buf</a>-&gt;<a class="code" href="classVgaBuf.html#a41">d3_panel_up</a>( x2-13, y1+2, x2-2, y2-2 );
00091     }
00092 
00093     <span class="comment">//--------- display cursor bitmap ----------//</span>
00094     <span class="keywordflow">if</span>(vga.use_back_buf) {
00095         <span class="keywordflow">if</span>( type == VERTICAL ) {
00096             <span class="comment">//                  image_sys.put_back( x1+4, y1+4 , "SCROLL_U" );</span>
00097             <span class="comment">//                  image_sys.put_back( x1+4, y2-11, "SCROLL_D" );</span>
00098             image_interface.put_back( x1+2, y1+2 , <span class="stringliteral">"SPIN_U_O"</span> );
00099             image_interface.put_back( x1+2, y2-13, <span class="stringliteral">"SPIN_D_O"</span> );
00100         }
00101         <span class="keywordflow">else</span> {
00102             image_sys.put_back( x1+4 , y1+4, <span class="stringliteral">"SCROLL_L"</span> );
00103             image_sys.put_back( x2-11, y1+4, <span class="stringliteral">"SCROLL_R"</span> );
00104         }
00105     }
00106     <span class="keywordflow">else</span> {
00107         <span class="keywordflow">if</span>( type == VERTICAL ) {
00108             <span class="comment">//                  image_sys.put_front( x1+4, y1+4 , "SCROLL_U" );</span>
00109             <span class="comment">//                  image_sys.put_front( x1+4, y2-11, "SCROLL_D" );</span>
00110             image_interface.put_front( x1+2, y1+2 , <span class="stringliteral">"SPIN_U_O"</span> );
00111             image_interface.put_front( x1+2, y2-13, <span class="stringliteral">"SPIN_D_O"</span> );
00112         }
00113         <span class="keywordflow">else</span> {
00114             image_sys.put_front( x1+4 , y1+4, <span class="stringliteral">"SCROLL_L"</span> );
00115             image_sys.put_front( x2-11, y1+4, <span class="stringliteral">"SCROLL_R"</span> );
00116         }
00117     }
00118 
00119 }
00120 
00121 <span class="comment">//--------- End of function ScrollBar::paint ------------//</span>
00122 
00123 <span class="comment">//------- Begin of function ScrollBar::refresh -------//</span>
<a name="l00136"></a><a class="code" href="classScrollBar.html#a3">00136</a> <span class="comment">void ScrollBar::refresh(int topRecNo, int forceRefresh, int pageSkipRec, int dispMaxRec, int totalRec) {</span>
00137     <span class="keywordtype">int</span> oldTotalRec = total_rec_num;
00138 
00139     <a class="code" href="ALL_8H.html#a0">err_when</a>( type == -1 );                         <span class="comment">// haven't been init()</span>
00140 
00141     <span class="keywordflow">if</span>( pageSkipRec &gt;= 0 )
00142         skip_rec_num  = pageSkipRec;
00143 
00144     <span class="keywordflow">if</span>( dispMaxRec &gt;= 0 )
00145         disp_rec_num  = dispMaxRec;
00146 
00147     <span class="keywordflow">if</span>( totalRec &gt;= 0 )
00148         total_rec_num = totalRec;
00149 
00150     <span class="keywordflow">if</span>( total_rec_num==0 )                          <span class="comment">// at must at least be 1, otherwise divided by zero error will appear</span>
00151         total_rec_num=1;
00152 
00153     <span class="keywordflow">if</span>( type == VERTICAL )
00154         slot_height = y2-y1-28;
00155     <span class="keywordflow">else</span>
00156         slot_height = x2-x1-28;
00157 
00158     indicator_height = slot_height * disp_rec_num / total_rec_num;
00159 
00160     <span class="keywordflow">if</span>( indicator_height &lt; <a class="code" href="OSCROLL_8CPP.html#a1">MINI_INDICATOR_HEIGHT</a> )
00161         indicator_height = <a class="code" href="OSCROLL_8CPP.html#a1">MINI_INDICATOR_HEIGHT</a>;
00162 
00163     <span class="comment">//------------- refresh display ----------------//</span>
00164 
00165     <span class="keywordtype">int</span> newY;
00166 
00167     <span class="keywordflow">if</span>( (newY=rec_to_y(topRecNo)) != indicator_y ||
00168         total_rec_num != oldTotalRec || forceRefresh ) {
00169         indicator_y = newY;
00170         <span class="keywordflow">if</span>( type == VERTICAL ) {
00171             vga_front.d3_panel_down_clear( x1, y1+12, x2, y2-13 );
00172             vga_front.d3_panel_up( x1+2, indicator_y, x2-2, indicator_y+indicator_height-1 )
00173                 ;
00174             vga_back.d3_panel_down_clear( x1, y1+12, x2, y2-13 );
00175             vga_back.d3_panel_up( x1+2, indicator_y, x2-2, indicator_y+indicator_height-1 );
00176             <span class="comment">//                  image_interface.put_front( x1+2, indicator_y , "SPIN_DIS" );</span>
00177             <span class="comment">//                  image_interface.put_back( x1+2, indicator_y , "SPIN_DIS" );</span>
00178         }
00179         <span class="keywordflow">else</span> {
00180             vga_front.d3_panel_down_clear( x1+12, y1, x2-13, y2 );
00181             vga_front.d3_panel_up( indicator_y, y1+2, indicator_y+indicator_height-1, y2-2 );
00182             vga_back.d3_panel_down_clear( x1+12, y1, x2-13, y2 );
00183             vga_back.d3_panel_up( indicator_y, y1+2, indicator_y+indicator_height-1, y2-2 );
00184             <span class="comment">//                  image_interface.put_front( indicator_y,y1+2, "SPIN_DIS" );</span>
00185             <span class="comment">//                  image_interface.put_back( indicator_y,y1+2, "SPIN_DIS" );</span>
00186         }
00187 
00188         top_rec_no = topRecNo;
00189     }
00190 }
00191 
00192 <span class="comment">//--------- End of function ScrollBar::refresh ------------//</span>
00193 
00194 <span class="comment">//------- Begin of function ScrollBar::detect -------//</span>
<a name="l00199"></a><a class="code" href="classScrollBar.html#a4">00199</a> <span class="comment">int ScrollBar::detect() {</span>
00200     <span class="keywordtype">int</span> pos, topRecNo=top_rec_no;
00201 
00202     top_rec_flag = 1;                               <span class="comment">// whether the recno returned by detect()</span>
00203     <span class="comment">// is the top_recno or only current recno, is returned by detect_is_top()</span>
00204 
00205     <span class="comment">//----------- detect for pressing up button --------------//</span>
00206 
00207     <span class="keywordflow">if</span>( type==VERTICAL   &amp;&amp; mouse.any_click( x1+2, y1+2, x2-2 , y1+13 ) ||
00208         type==HORIZONTAL &amp;&amp; mouse.any_click( x1+2, y1+2, x1+13, y2-2  )
00209         <span class="comment">//||mouse.key_code == KEY_UP || mouse.key_code == KEY_LEFT</span>
00210         ) {
00211         <span class="keywordflow">if</span>( --topRecNo &lt; 1 )
00212             topRecNo = 1;
00213 
00214         top_rec_flag=0;                               <span class="comment">// return by detect_is_top()</span>
00215     }
00216 
00217     <span class="comment">//----------- detect for pressing down button ------------//</span>
00218 
00219     <span class="keywordflow">if</span>( type==VERTICAL   &amp;&amp; mouse.any_click( x1+2, y2-13, x2-2, y2-2 ) ||
00220         type==HORIZONTAL &amp;&amp; mouse.any_click( x2-13,y1+2 , x2-2, y2-2 )
00221         <span class="comment">//||mouse.key_code == KEY_DOWN || mouse.key_code == KEY_RIGHT</span>
00222         ) {
00223         <span class="keywordflow">if</span>( page_type ) {                             <span class="comment">// top record can't be the last record</span>
00224             <span class="keywordflow">if</span>( ++topRecNo &gt; total_rec_num - disp_rec_num+1 )
00225                 topRecNo = total_rec_num - disp_rec_num + 1;
00226         }
00227         <span class="keywordflow">else</span> {                                        <span class="comment">// top record can be the last record</span>
00228             <span class="keywordflow">if</span>( ++topRecNo &gt; total_rec_num )
00229                 topRecNo = total_rec_num;
00230         }
00231 
00232         top_rec_flag=0;
00233     }
00234 
00235     <span class="comment">//------ detect for pressing on scroll slot but not indicator -------//</span>
00236 
00237     <span class="keywordflow">if</span>( type==VERTICAL   &amp;&amp; mouse.any_click( x1+2 , y1+14, x2-2 , y2-14 ) ||
00238         type==HORIZONTAL &amp;&amp; mouse.any_click( x1+14, y1+2 , x2-14, y2-2  ) ||
00239         mouse.key_code == <a class="code" href="KEY_8H.html#a6">KEY_PGUP</a> || mouse.key_code == <a class="code" href="KEY_8H.html#a7">KEY_PGDN</a> ) {
00240         <span class="keywordflow">if</span>( type==VERTICAL )
00241             pos = mouse.click_y();
00242         <span class="keywordflow">else</span>
00243             pos = mouse.click_x();
00244 
00245         <span class="comment">// page up</span>
00246         <span class="keywordflow">if</span>( pos &lt; indicator_y || mouse.key_code == <a class="code" href="KEY_8H.html#a6">KEY_PGUP</a> ) {
00247             <span class="keywordflow">if</span>( ( topRecNo -= skip_rec_num ) &lt; 1 )
00248                 topRecNo = 1;
00249         }
00250 
00251         <span class="comment">// page down</span>
00252         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( pos &gt;= indicator_y+indicator_height || mouse.key_code == <a class="code" href="KEY_8H.html#a7">KEY_PGDN</a> ) {
00253             <span class="keywordflow">if</span>( (topRecNo += skip_rec_num) &gt; total_rec_num - disp_rec_num+1 ) {
00254                 topRecNo = total_rec_num - disp_rec_num + 1;
00255 
00256                 <span class="keywordflow">if</span> ( topRecNo &lt; 1 )
00257                     topRecNo = 1;
00258             }
00259         }
00260     }
00261 
00262     <span class="comment">//--------- check if display all needed -----------//</span>
00263 
00264     <span class="keywordflow">if</span>( topRecNo != top_rec_no ) {
00265         <span class="keywordflow">if</span>( m.get_time() &gt;= next_press_time ) {       <span class="comment">// prevent too fast scrolling</span>
00266             refresh(topRecNo,1);
00267 
00268             next_press_time = m.get_time() + <a class="code" href="OSCROLL_8CPP.html#a0">PRESS_INT_TIME</a>;
00269 
00270             <span class="keywordflow">return</span> topRecNo;
00271         }
00272     }
00273 
00274     <span class="comment">//-------- detect for pulling indicator ------------//</span>
00275 
00276     <span class="keywordflow">if</span>( type==VERTICAL   &amp;&amp; mouse.any_click( x1+2 , indicator_y, x2-2, indicator_y+indicator_height-1 ) ||
00277         type==HORIZONTAL &amp;&amp; mouse.any_click( indicator_y, y1+2, indicator_y+indicator_height-1, y2-2  ) ) {
00278         <span class="keywordtype">int</span> lastMouseY = -1;
00279 
00280         <span class="keywordflow">while</span>( mouse.left_press ) {
00281             sys.yield();
00282             mouse.get_event();
00283             sys.blt_virtual_buf();
00284 
00285             <span class="keywordflow">if</span>( type==VERTICAL ) {
00286                 <span class="keywordflow">if</span>( mouse.left_press &amp;&amp; lastMouseY != mouse.cur_y ) {
00287                     indicator_y = mouse.cur_y-indicator_height/2;
00288 
00289                     <span class="keywordflow">if</span>( indicator_y &lt; y1+14 )
00290                         indicator_y = y1+14;
00291 
00292                     <span class="keywordflow">if</span>( indicator_y &gt; y2-14-indicator_height )
00293                         indicator_y = y2-14-indicator_height;
00294 
00295                     <span class="comment">// scroll panel</span>
00296                     vga_front.d3_panel_down_clear( x1, y1+12, x2, y2-13 );
00297                     vga_front.d3_panel_down( x1+2, indicator_y, x2-2, indicator_y+indicator_height-1 );
00298                     <span class="comment">// scroll panel</span>
00299                     vga_back.d3_panel_down_clear( x1, y1+12, x2, y2-13 );
00300                     vga_back.d3_panel_down( x1+2, indicator_y, x2-2, indicator_y+indicator_height-1 );
00301 
00302                     lastMouseY = mouse.cur_y;
00303                 }
00304             }
00305             <span class="keywordflow">else</span> {
00306                 <span class="keywordflow">if</span>( mouse.left_press &amp;&amp; lastMouseY != mouse.cur_x ) {
00307                     indicator_y = mouse.cur_x-indicator_height/2;
00308 
00309                     <span class="keywordflow">if</span>( indicator_y &lt; x1+14 )
00310                         indicator_y = x1+14;
00311 
00312                     <span class="keywordflow">if</span>( indicator_y &gt; x2-14-indicator_height )
00313                         indicator_y = x2-14-indicator_height;
00314 
00315                     vga_front.d3_panel_down_clear( x1+12, y1, x2-13, y2 );
00316                     vga_front.d3_panel_down ( indicator_y, y1+2, indicator_y+indicator_height-1, y2-2 );
00317                     vga_back.d3_panel_down_clear( x1+12, y1, x2-13, y2 );
00318                     vga_back.d3_panel_down ( indicator_y, y1+2, indicator_y+indicator_height-1, y2-2 );
00319 
00320                     lastMouseY = mouse.cur_x;
00321                 }
00322             }
00323         }
00324 
00325         refresh(y_to_rec(indicator_y),1);
00326 
00327         <span class="keywordflow">return</span> top_rec_no;
00328     }
00329 
00330     <span class="comment">//-----------------------------------------------------------//</span>
00331 
00332     <span class="keywordflow">return</span> 0;
00333 }
00334 
00335 <span class="comment">//--------- End of function ScrollBar::detect ------------//</span>
00336 
00337 <span class="comment">//--------- Begin of function ScrollBar::page_up -------//</span>
<a name="l00349"></a><a class="code" href="classScrollBar.html#a6">00349</a> <span class="comment">int ScrollBar::page_up(int skipLess) {</span>
00350     <span class="keywordflow">if</span>( top_rec_no &gt; 1 ) {
00351         <span class="keywordflow">if</span>( (top_rec_no-=skip_rec_num-skipLess) &lt; 1 )
00352             top_rec_no = 1;
00353 
00354         refresh(top_rec_no,1);
00355     }
00356 
00357     <span class="keywordflow">return</span> top_rec_no;
00358 }
00359 
00360 <span class="comment">//--------- End of function ScrollBar::page_up ----------//</span>
00361 
00362 <span class="comment">//--------- Begin of function ScrollBar::page_down -------//</span>
<a name="l00374"></a><a class="code" href="classScrollBar.html#a7">00374</a> <span class="comment">int ScrollBar::page_down(int skipLess) {</span>
00375     <span class="keywordflow">if</span>( top_rec_no &lt; total_rec_num - disp_rec_num + 1 ) {
00376         <span class="keywordflow">if</span>( (top_rec_no += skip_rec_num-skipLess) &gt; total_rec_num - disp_rec_num + 1 ) {
00377             top_rec_no = total_rec_num - disp_rec_num + 1;
00378 
00379             <span class="keywordflow">if</span>( top_rec_no &lt; 1 )
00380                 top_rec_no = 1;
00381         }
00382 
00383         refresh(top_rec_no,1);
00384     }
00385 
00386     <span class="keywordflow">return</span> top_rec_no;
00387 }
00388 
00389 <span class="comment">//--------- End of function ScrollBar::page_down ----------//</span>
00390 
00391 <span class="comment">//--------- Begin of function ScrollBar::detect_top_rec -------//</span>
<a name="l00396"></a><a class="code" href="classScrollBar.html#a5">00396</a> <span class="comment">int ScrollBar::detect_top_rec() {</span>
00397     <span class="keywordflow">if</span>( top_rec_flag ) {
00398         <span class="keywordflow">if</span>( top_rec_no &gt; total_rec_num - disp_rec_num+1 )
00399             <span class="keywordflow">return</span> total_rec_num - disp_rec_num + 1;
00400         <span class="keywordflow">else</span>
00401             <span class="keywordflow">return</span> top_rec_no;
00402     }
00403     <span class="keywordflow">else</span>
00404         <span class="keywordflow">return</span> 0;
00405 }
00406 
00407 <span class="comment">//--------- End of function ScrollBar::detect_top_rec ----------//</span>
00408 
00409 <span class="comment">//--------- Begin of function ScrollBar::rec_to_y -------//</span>
<a name="l00413"></a><a class="code" href="classScrollBar.html#a8">00413</a> <span class="comment">int ScrollBar::rec_to_y(int recNo) {</span>
00414     <span class="keywordtype">int</span> t;
00415 
00416     <span class="keywordflow">if</span>( total_rec_num &lt;= 1 || disp_rec_num == total_rec_num )
00417         t = 0;
00418     <span class="keywordflow">else</span> {
00419         t = (slot_height-indicator_height) * (recNo-1) / (total_rec_num-disp_rec_num);
00420 
00421         <span class="keywordflow">if</span>( t+indicator_height &gt; slot_height )
00422             t = slot_height-indicator_height;
00423     }
00424 
00425     <span class="keywordflow">if</span>( type == VERTICAL )
00426         <span class="keywordflow">return</span> y1 + 14 + t;
00427     <span class="keywordflow">else</span>
00428         <span class="keywordflow">return</span> x1 + 14 + t;
00429 }
00430 
00431 <span class="comment">//---------- End of function ScrollBar::rec_to_y ----------//</span>
00432 
00433 <span class="comment">//--------- Begin of function ScrollBar::y_to_rec -------//</span>
<a name="l00437"></a><a class="code" href="classScrollBar.html#a9">00437</a> <span class="comment">int ScrollBar::y_to_rec(int y) {</span>
00438     <span class="keywordtype">int</span> t;
00439 
00440     <span class="keywordflow">if</span>( total_rec_num == 0 )
00441         <span class="keywordflow">return</span> 0;
00442 
00443     <span class="keywordflow">if</span>( slot_height-indicator_height == 0 || disp_rec_num == total_rec_num )
00444         <span class="keywordflow">return</span> 1;
00445 
00446     <span class="keywordflow">if</span>( type == VERTICAL )
00447         t = y1;
00448     <span class="keywordflow">else</span>
00449         t = x1;
00450 
00451     <span class="keywordflow">return</span> (y-t-14) * (total_rec_num-disp_rec_num) / (slot_height-indicator_height) + 1;
00452 }
00453 
00454 <span class="comment">//---------- End of function ScrollBar::y_to_rec ----------//</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Aug 23 01:38:21 2002 for VirtualU by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.17 </small></address>
</body>
</html>
